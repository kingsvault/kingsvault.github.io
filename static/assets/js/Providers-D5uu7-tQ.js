const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/assets/js/embedded-wallet-CBey_rsj.js","static/assets/js/Themecontext-C9ChY5WE.js","static/assets/js/index-Cn1eoEzf.js","static/assets/css/index-BFiHSIBA.css","static/assets/js/context-fek6OyC0.js","static/assets/js/if-defined-KiV3ezX4.js","static/assets/js/index-CeABVQnp.js","static/assets/js/index-C39vNi9v.js","static/assets/js/index-H56RFMly.js","static/assets/js/index-DyEeGinT.js","static/assets/js/index-pn3edAGs.js","static/assets/js/index-CUFvq5J8.js","static/assets/js/index-DPz9jTbF.js","static/assets/js/index-CiijcG3d.js","static/assets/js/email-_tWtlrJA.js","static/assets/js/index-DGxCr6qv.js","static/assets/js/socials-BZ5xT5xi.js","static/assets/js/index-Cbwx9dR7.js","static/assets/js/index-BKr9TKIE.js","static/assets/js/index-D3nwPRX3.js","static/assets/js/index-D_G4fbfF.js","static/assets/js/swaps-D4vKYttl.js","static/assets/js/index-BBxuh2xt.js","static/assets/js/index-Ck3q3Gta.js","static/assets/js/index-CJXGp6B4.js","static/assets/js/send-CoBfPAxt.js","static/assets/js/index-Ch1jPFpE.js","static/assets/js/receive-CBahSyy5.js","static/assets/js/index-B1DhaPlf.js","static/assets/js/onramp-CZMwhg9q.js","static/assets/js/index-DjBgPeT2.js","static/assets/js/index-Bx94EyM8.js","static/assets/js/transactions-DojEOgET.js","static/assets/js/index-C1h6dCNZ.js","static/assets/js/index-BwALIEL4.js","static/assets/js/index-kJjGpzBi.js","static/assets/js/w3m-modal-8Cul1RWG.js","static/assets/js/index-CYlSFoUR.js"])))=>i.map(i=>d[i]);
var zI=Object.defineProperty;var vw=r=>{throw TypeError(r)};var VI=(r,e,t)=>e in r?zI(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var F=(r,e,t)=>VI(r,typeof e!="symbol"?e+"":e,t),wp=(r,e,t)=>e.has(r)||vw("Cannot "+t);var w=(r,e,t)=>(wp(r,e,"read from private field"),t?t.call(r):e.get(r)),H=(r,e,t)=>e.has(r)?vw("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),R=(r,e,t,n)=>(wp(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),W=(r,e,t)=>(wp(r,e,"access private method"),t);var Pl=(r,e,t,n)=>({set _(s){R(r,e,s,t)},get _(){return w(r,e,n)}});import{r as Xe,R as at,g as GI,a as KI,p as hs,_ as Xr,j as Kn,L as Tg}from"./index-Cn1eoEzf.js";import{C as oe,e as Mn,O as Ch,b as Tl,a as WE,c as WI,N as uy,o as Ew,p as QE,d as G,A as Ae,f as st,R as Ts,g as An,B as io,S as it,s as JE,h as Og,r as QI,W as he,i as hn,j as JI,k as ZI,D as YI,l as go,m as me,n as ir,q as Aw,t as _w,u as XI,v as Cd,M as Ea,w as eN,P as Id,E as Kl,T as Wn,x as Nd,y as tN,z as rN,F as nN,G as Cw,H as sN,I as iN,J as oN}from"./Themecontext-C9ChY5WE.js";import{B as Ut,g as be,a as Iw,P as aN,s as cN,A as lN,b as uN,H as hN}from"./context-fek6OyC0.js";function ZE(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(t=ZE(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function Go(){for(var r,e,t=0,n="",s=arguments.length;t<s;t++)(r=arguments[t])&&(e=ZE(r))&&(n&&(n+=" "),n+=e);return n}function dN(r){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t),t.styleSheet?t.styleSheet.cssText=r:t.appendChild(document.createTextNode(r))}dN(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Ih=r=>typeof r=="number"&&!isNaN(r),Xo=r=>typeof r=="string",Zs=r=>typeof r=="function",fN=r=>Xo(r)||Ih(r),Sg=r=>Xo(r)||Zs(r)?r:null,pN=(r,e)=>r===!1||Ih(r)&&r>0?r:e,Rg=r=>Xe.isValidElement(r)||Xo(r)||Zs(r)||Ih(r);function gN(r,e,t=300){let{scrollHeight:n,style:s}=r;requestAnimationFrame(()=>{s.minHeight="initial",s.height=n+"px",s.transition=`all ${t}ms`,requestAnimationFrame(()=>{s.height="0",s.padding="0",s.margin="0",setTimeout(e,t)})})}function mN({enter:r,exit:e,appendPosition:t=!1,collapse:n=!0,collapseDuration:s=300}){return function({children:i,position:o,preventExitTransition:a,done:c,nodeRef:l,isIn:u,playToast:h}){let d=t?`${r}--${o}`:r,f=t?`${e}--${o}`:e,p=Xe.useRef(0);return Xe.useLayoutEffect(()=>{let m=l.current,v=d.split(" "),_=y=>{y.target===l.current&&(h(),m.removeEventListener("animationend",_),m.removeEventListener("animationcancel",_),p.current===0&&y.type!=="animationcancel"&&m.classList.remove(...v))};m.classList.add(...v),m.addEventListener("animationend",_),m.addEventListener("animationcancel",_)},[]),Xe.useEffect(()=>{let m=l.current,v=()=>{m.removeEventListener("animationend",v),n?gN(m,c,s):c()};u||(a?v():(p.current=1,m.className+=` ${f}`,m.addEventListener("animationend",v)))},[u]),at.createElement(at.Fragment,null,i)}}function Nw(r,e){return{content:YE(r.content,r.props),containerId:r.props.containerId,id:r.props.toastId,theme:r.props.theme,type:r.props.type,data:r.props.data||{},isLoading:r.props.isLoading,icon:r.props.icon,reason:r.removalReason,status:e}}function YE(r,e,t=!1){return Xe.isValidElement(r)&&!Xo(r.type)?Xe.cloneElement(r,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):Zs(r)?r({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):r}function yN({closeToast:r,theme:e,ariaLabel:t="close"}){return at.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:n=>{n.stopPropagation(),r(!0)},"aria-label":t},at.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},at.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function wN({delay:r,isRunning:e,closeToast:t,type:n="default",hide:s,className:i,controlledProgress:o,progress:a,rtl:c,isIn:l,theme:u}){let h=s||o&&a===0,d={animationDuration:`${r}ms`,animationPlayState:e?"running":"paused"};o&&(d.transform=`scaleX(${a})`);let f=Go("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${u}`,`Toastify__progress-bar--${n}`,{"Toastify__progress-bar--rtl":c}),p=Zs(i)?i({rtl:c,type:n,defaultClassName:f}):Go(f,i),m={[o&&a>=1?"onTransitionEnd":"onAnimationEnd"]:o&&a<1?null:()=>{l&&t()}};return at.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":h},at.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${u} Toastify__progress-bar--${n}`}),at.createElement("div",{role:"progressbar","aria-hidden":h?"true":"false","aria-label":"notification timer",className:p,style:d,...m}))}var bN=1,XE=()=>`${bN++}`;function vN(r,e,t){let n=1,s=0,i=[],o=[],a=e,c=new Map,l=new Set,u=y=>(l.add(y),()=>l.delete(y)),h=()=>{o=Array.from(c.values()),l.forEach(y=>y())},d=({containerId:y,toastId:C,updateId:U})=>{let L=y?y!==r:r!==1,B=c.has(C)&&U==null;return L||B},f=(y,C)=>{c.forEach(U=>{var L;(C==null||C===U.props.toastId)&&((L=U.toggle)==null||L.call(U,y))})},p=y=>{var C,U;(U=(C=y.props)==null?void 0:C.onClose)==null||U.call(C,y.removalReason),y.isActive=!1},m=y=>{if(y==null)c.forEach(p);else{let C=c.get(y);C&&p(C)}h()},v=()=>{s-=i.length,i=[]},_=y=>{var C,U;let{toastId:L,updateId:B}=y.props,$=B==null;y.staleId&&c.delete(y.staleId),y.isActive=!0,c.set(L,y),h(),t(Nw(y,$?"added":"updated")),$&&((U=(C=y.props).onOpen)==null||U.call(C))};return{id:r,props:a,observe:u,toggle:f,removeToast:m,toasts:c,clearQueue:v,buildToast:(y,C)=>{if(d(C))return;let{toastId:U,updateId:L,data:B,staleId:$,delay:g}=C,b=L==null;b&&s++;let N={...a,style:a.toastStyle,key:n++,...Object.fromEntries(Object.entries(C).filter(([I,D])=>D!=null)),toastId:U,updateId:L,data:B,isIn:!1,className:Sg(C.className||a.toastClassName),progressClassName:Sg(C.progressClassName||a.progressClassName),autoClose:C.isLoading?!1:pN(C.autoClose,a.autoClose),closeToast(I){c.get(U).removalReason=I,m(U)},deleteToast(){let I=c.get(U);if(I!=null){if(t(Nw(I,"removed")),c.delete(U),s--,s<0&&(s=0),i.length>0){_(i.shift());return}h()}}};N.closeButton=a.closeButton,C.closeButton===!1||Rg(C.closeButton)?N.closeButton=C.closeButton:C.closeButton===!0&&(N.closeButton=Rg(a.closeButton)?a.closeButton:!0);let x={content:y,props:N,staleId:$};a.limit&&a.limit>0&&s>a.limit&&b?i.push(x):Ih(g)?setTimeout(()=>{_(x)},g):_(x)},setProps(y){a=y},setToggle:(y,C)=>{let U=c.get(y);U&&(U.toggle=C)},isToastActive:y=>{var C;return(C=c.get(y))==null?void 0:C.isActive},getSnapshot:()=>o}}var ar=new Map,fu=[],Dg=new Set,EN=r=>Dg.forEach(e=>e(r)),e1=()=>ar.size>0;function AN(){fu.forEach(r=>r1(r.content,r.options)),fu=[]}var _N=(r,{containerId:e})=>{var t;return(t=ar.get(e||1))==null?void 0:t.toasts.get(r)};function t1(r,e){var t;if(e)return!!((t=ar.get(e))!=null&&t.isToastActive(r));let n=!1;return ar.forEach(s=>{s.isToastActive(r)&&(n=!0)}),n}function CN(r){if(!e1()){fu=fu.filter(e=>r!=null&&e.options.toastId!==r);return}if(r==null||fN(r))ar.forEach(e=>{e.removeToast(r)});else if(r&&("containerId"in r||"id"in r)){let e=ar.get(r.containerId);e?e.removeToast(r.id):ar.forEach(t=>{t.removeToast(r.id)})}}var IN=(r={})=>{ar.forEach(e=>{e.props.limit&&(!r.containerId||e.id===r.containerId)&&e.clearQueue()})};function r1(r,e){Rg(r)&&(e1()||fu.push({content:r,options:e}),ar.forEach(t=>{t.buildToast(r,e)}))}function NN(r){var e;(e=ar.get(r.containerId||1))==null||e.setToggle(r.id,r.fn)}function n1(r,e){ar.forEach(t=>{(e==null||!(e!=null&&e.containerId)||(e==null?void 0:e.containerId)===t.id)&&t.toggle(r,e==null?void 0:e.id)})}function xN(r){let e=r.containerId||1;return{subscribe(t){let n=vN(e,r,EN);ar.set(e,n);let s=n.observe(t);return AN(),()=>{s(),ar.delete(e)}},setProps(t){var n;(n=ar.get(e))==null||n.setProps(t)},getSnapshot(){var t;return(t=ar.get(e))==null?void 0:t.getSnapshot()}}}function PN(r){return Dg.add(r),()=>{Dg.delete(r)}}function TN(r){return r&&(Xo(r.toastId)||Ih(r.toastId))?r.toastId:XE()}function Nh(r,e){return r1(r,e),e.toastId}function Uf(r,e){return{...e,type:e&&e.type||r,toastId:TN(e)}}function Bf(r){return(e,t)=>Nh(e,Uf(r,t))}function et(r,e){return Nh(r,Uf("default",e))}et.loading=(r,e)=>Nh(r,Uf("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function ON(r,{pending:e,error:t,success:n},s){let i;e&&(i=Xo(e)?et.loading(e,s):et.loading(e.render,{...s,...e}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},a=(l,u,h)=>{if(u==null){et.dismiss(i);return}let d={type:l,...o,...s,data:h},f=Xo(u)?{render:u}:u;return i?et.update(i,{...d,...f}):et(f.render,{...d,...f}),h},c=Zs(r)?r():r;return c.then(l=>a("success",n,l)).catch(l=>a("error",t,l)),c}et.promise=ON;et.success=Bf("success");et.info=Bf("info");et.error=Bf("error");et.warning=Bf("warning");et.warn=et.warning;et.dark=(r,e)=>Nh(r,Uf("default",{theme:"dark",...e}));function SN(r){CN(r)}et.dismiss=SN;et.clearWaitingQueue=IN;et.isActive=t1;et.update=(r,e={})=>{let t=_N(r,e);if(t){let{props:n,content:s}=t,i={delay:100,...n,...e,toastId:e.toastId||r,updateId:XE()};i.toastId!==r&&(i.staleId=r);let o=i.render||s;delete i.render,Nh(o,i)}};et.done=r=>{et.update(r,{progress:1})};et.onChange=PN;et.play=r=>n1(!0,r);et.pause=r=>n1(!1,r);function RN(r){var e;let{subscribe:t,getSnapshot:n,setProps:s}=Xe.useRef(xN(r)).current;s(r);let i=(e=Xe.useSyncExternalStore(t,n,n))==null?void 0:e.slice();function o(a){if(!i)return[];let c=new Map;return r.newestOnTop&&i.reverse(),i.forEach(l=>{let{position:u}=l.props;c.has(u)||c.set(u,[]),c.get(u).push(l)}),Array.from(c,l=>a(l[0],l[1]))}return{getToastToRender:o,isToastActive:t1,count:i==null?void 0:i.length}}function DN(r){let[e,t]=Xe.useState(!1),[n,s]=Xe.useState(!1),i=Xe.useRef(null),o=Xe.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:a,pauseOnHover:c,closeToast:l,onClick:u,closeOnClick:h}=r;NN({id:r.toastId,containerId:r.containerId,fn:t}),Xe.useEffect(()=>{if(r.pauseOnFocusLoss)return d(),()=>{f()}},[r.pauseOnFocusLoss]);function d(){document.hasFocus()||_(),window.addEventListener("focus",v),window.addEventListener("blur",_)}function f(){window.removeEventListener("focus",v),window.removeEventListener("blur",_)}function p($){if(r.draggable===!0||r.draggable===$.pointerType){y();let g=i.current;o.canCloseOnClick=!0,o.canDrag=!0,g.style.transition="none",r.draggableDirection==="x"?(o.start=$.clientX,o.removalDistance=g.offsetWidth*(r.draggablePercent/100)):(o.start=$.clientY,o.removalDistance=g.offsetHeight*(r.draggablePercent===80?r.draggablePercent*1.5:r.draggablePercent)/100)}}function m($){let{top:g,bottom:b,left:N,right:x}=i.current.getBoundingClientRect();$.nativeEvent.type!=="touchend"&&r.pauseOnHover&&$.clientX>=N&&$.clientX<=x&&$.clientY>=g&&$.clientY<=b?_():v()}function v(){t(!0)}function _(){t(!1)}function y(){o.didMove=!1,document.addEventListener("pointermove",U),document.addEventListener("pointerup",L)}function C(){document.removeEventListener("pointermove",U),document.removeEventListener("pointerup",L)}function U($){let g=i.current;if(o.canDrag&&g){o.didMove=!0,e&&_(),r.draggableDirection==="x"?o.delta=$.clientX-o.start:o.delta=$.clientY-o.start,o.start!==$.clientX&&(o.canCloseOnClick=!1);let b=r.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;g.style.transform=`translate3d(${b},0)`,g.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function L(){C();let $=i.current;if(o.canDrag&&o.didMove&&$){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){s(!0),r.closeToast(!0),r.collapseAll();return}$.style.transition="transform 0.2s, opacity 0.2s",$.style.removeProperty("transform"),$.style.removeProperty("opacity")}}let B={onPointerDown:p,onPointerUp:m};return a&&c&&(B.onMouseEnter=_,r.stacked||(B.onMouseLeave=v)),h&&(B.onClick=$=>{u&&u($),o.canCloseOnClick&&l(!0)}),{playToast:v,pauseToast:_,isRunning:e,preventExitTransition:n,toastRef:i,eventHandlers:B}}var kN=typeof window<"u"?Xe.useLayoutEffect:Xe.useEffect,$f=({theme:r,type:e,isLoading:t,...n})=>at.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:r==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...n});function UN(r){return at.createElement($f,{...r},at.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function BN(r){return at.createElement($f,{...r},at.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function $N(r){return at.createElement($f,{...r},at.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function LN(r){return at.createElement($f,{...r},at.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function MN(){return at.createElement("div",{className:"Toastify__spinner"})}var kg={info:BN,warning:UN,success:$N,error:LN,spinner:MN},FN=r=>r in kg;function jN({theme:r,type:e,isLoading:t,icon:n}){let s=null,i={theme:r,type:e};return n===!1||(Zs(n)?s=n({...i,isLoading:t}):Xe.isValidElement(n)?s=Xe.cloneElement(n,i):t?s=kg.spinner():FN(e)&&(s=kg[e](i))),s}var HN=r=>{let{isRunning:e,preventExitTransition:t,toastRef:n,eventHandlers:s,playToast:i}=DN(r),{closeButton:o,children:a,autoClose:c,onClick:l,type:u,hideProgressBar:h,closeToast:d,transition:f,position:p,className:m,style:v,progressClassName:_,updateId:y,role:C,progress:U,rtl:L,toastId:B,deleteToast:$,isIn:g,isLoading:b,closeOnClick:N,theme:x,ariaLabel:I}=r,D=Go("Toastify__toast",`Toastify__toast-theme--${x}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":L},{"Toastify__toast--close-on-click":N}),S=Zs(m)?m({rtl:L,position:p,type:u,defaultClassName:D}):Go(D,m),E=jN(r),A=!!U||!c,T={closeToast:d,type:u,theme:x},O=null;return o===!1||(Zs(o)?O=o(T):Xe.isValidElement(o)?O=Xe.cloneElement(o,T):O=yN(T)),at.createElement(f,{isIn:g,done:$,position:p,preventExitTransition:t,nodeRef:n,playToast:i},at.createElement("div",{id:B,tabIndex:0,onClick:l,"data-in":g,className:S,...s,style:v,ref:n,...g&&{role:C,"aria-label":I}},E!=null&&at.createElement("div",{className:Go("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!b})},E),YE(a,r,!e),O,!r.customProgressBar&&at.createElement(wN,{...y&&!A?{key:`p-${y}`}:{},rtl:L,theme:x,delay:c,isRunning:e,isIn:g,closeToast:d,hide:h,type:u,className:_,controlledProgress:A,progress:U||0})))},qN=(r,e=!1)=>({enter:`Toastify--animate Toastify__${r}-enter`,exit:`Toastify--animate Toastify__${r}-exit`,appendPosition:e}),zN=mN(qN("bounce",!0)),VN={position:"top-right",transition:zN,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:r=>r.altKey&&r.code==="KeyT"};function GN(r){let e={...VN,...r},t=r.stacked,[n,s]=Xe.useState(!0),i=Xe.useRef(null),{getToastToRender:o,isToastActive:a,count:c}=RN(e),{className:l,style:u,rtl:h,containerId:d,hotKeys:f}=e;function p(v){let _=Go("Toastify__toast-container",`Toastify__toast-container--${v}`,{"Toastify__toast-container--rtl":h});return Zs(l)?l({position:v,rtl:h,defaultClassName:_}):Go(_,Sg(l))}function m(){t&&(s(!0),et.play())}return kN(()=>{var v;if(t){let _=i.current.querySelectorAll('[data-in="true"]'),y=12,C=(v=e.position)==null?void 0:v.includes("top"),U=0,L=0;Array.from(_).reverse().forEach((B,$)=>{let g=B;g.classList.add("Toastify__toast--stacked"),$>0&&(g.dataset.collapsed=`${n}`),g.dataset.pos||(g.dataset.pos=C?"top":"bot");let b=U*(n?.2:1)+(n?0:y*$);g.style.setProperty("--y",`${C?b:b*-1}px`),g.style.setProperty("--g",`${y}`),g.style.setProperty("--s",`${1-(n?L:0)}`),U+=g.offsetHeight,L+=.025})}},[n,c,t]),Xe.useEffect(()=>{function v(_){var y;let C=i.current;f(_)&&((y=C.querySelector('[tabIndex="0"]'))==null||y.focus(),s(!1),et.pause()),_.key==="Escape"&&(document.activeElement===C||C!=null&&C.contains(document.activeElement))&&(s(!0),et.play())}return document.addEventListener("keydown",v),()=>{document.removeEventListener("keydown",v)}},[f]),at.createElement("section",{ref:i,className:"Toastify",id:d,onMouseEnter:()=>{t&&(s(!1),et.pause())},onMouseLeave:m,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},o((v,_)=>{let y=_.length?{...u}:{...u,pointerEvents:"none"};return at.createElement("div",{tabIndex:-1,className:p(v),"data-stacked":t,style:y,key:`c-${v}`},_.map(({content:C,props:U})=>at.createElement(HN,{...U,stacked:t,collapseAll:m,isIn:a(U.toastId,U.containerId),key:`t-${U.key}`},C)))}))}var xd={exports:{}},KN=xd.exports,xw;function WN(){return xw||(xw=1,function(r,e){(function(t,n){r.exports=n()})(KN,function(){return function(t){function n(i){if(s[i])return s[i].exports;var o=s[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var s={};return n.m=t,n.c=s,n.p="dist/",n(0)}([function(t,n,s){function i(S){return S&&S.__esModule?S:{default:S}}var o=Object.assign||function(S){for(var E=1;E<arguments.length;E++){var A=arguments[E];for(var T in A)Object.prototype.hasOwnProperty.call(A,T)&&(S[T]=A[T])}return S},a=s(1),c=(i(a),s(6)),l=i(c),u=s(7),h=i(u),d=s(8),f=i(d),p=s(9),m=i(p),v=s(10),_=i(v),y=s(11),C=i(y),U=s(14),L=i(U),B=[],$=!1,g={offset:120,delay:0,easing:"ease",duration:400,disable:!1,once:!1,startEvent:"DOMContentLoaded",throttleDelay:99,debounceDelay:50,disableMutationObserver:!1},b=function(){var S=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(S&&($=!0),$)return B=(0,C.default)(B,g),(0,_.default)(B,g.once),B},N=function(){B=(0,L.default)(),b()},x=function(){B.forEach(function(S,E){S.node.removeAttribute("data-aos"),S.node.removeAttribute("data-aos-easing"),S.node.removeAttribute("data-aos-duration"),S.node.removeAttribute("data-aos-delay")})},I=function(S){return S===!0||S==="mobile"&&m.default.mobile()||S==="phone"&&m.default.phone()||S==="tablet"&&m.default.tablet()||typeof S=="function"&&S()===!0},D=function(S){g=o(g,S),B=(0,L.default)();var E=document.all&&!window.atob;return I(g.disable)||E?x():(g.disableMutationObserver||f.default.isSupported()||(console.info(`
      aos: MutationObserver is not supported on this browser,
      code mutations observing has been disabled.
      You may have to call "refreshHard()" by yourself.
    `),g.disableMutationObserver=!0),document.querySelector("body").setAttribute("data-aos-easing",g.easing),document.querySelector("body").setAttribute("data-aos-duration",g.duration),document.querySelector("body").setAttribute("data-aos-delay",g.delay),g.startEvent==="DOMContentLoaded"&&["complete","interactive"].indexOf(document.readyState)>-1?b(!0):g.startEvent==="load"?window.addEventListener(g.startEvent,function(){b(!0)}):document.addEventListener(g.startEvent,function(){b(!0)}),window.addEventListener("resize",(0,h.default)(b,g.debounceDelay,!0)),window.addEventListener("orientationchange",(0,h.default)(b,g.debounceDelay,!0)),window.addEventListener("scroll",(0,l.default)(function(){(0,_.default)(B,g.once)},g.throttleDelay)),g.disableMutationObserver||f.default.ready("[data-aos]",N),B)};t.exports={init:D,refresh:b,refreshHard:N}},function(t,n){},,,,,function(t,n){(function(s){function i(I,D,S){function E(ue){var Ee=J,Tr=Z;return J=Z=void 0,De=ue,re=I.apply(Tr,Ee)}function A(ue){return De=ue,pe=setTimeout(k,D),xe?E(ue):re}function T(ue){var Ee=ue-ge,Tr=ue-De,Gh=D-Ee;return Se?N(Gh,te-Tr):Gh}function O(ue){var Ee=ue-ge,Tr=ue-De;return ge===void 0||Ee>=D||Ee<0||Se&&Tr>=te}function k(){var ue=x();return O(ue)?j(ue):void(pe=setTimeout(k,T(ue)))}function j(ue){return pe=void 0,fe&&J?E(ue):(J=Z=void 0,re)}function q(){pe!==void 0&&clearTimeout(pe),De=0,J=ge=Z=pe=void 0}function z(){return pe===void 0?re:j(x())}function Q(){var ue=x(),Ee=O(ue);if(J=arguments,Z=this,ge=ue,Ee){if(pe===void 0)return A(ge);if(Se)return pe=setTimeout(k,D),E(ge)}return pe===void 0&&(pe=setTimeout(k,D)),re}var J,Z,te,re,pe,ge,De=0,xe=!1,Se=!1,fe=!0;if(typeof I!="function")throw new TypeError(d);return D=u(D)||0,a(S)&&(xe=!!S.leading,Se="maxWait"in S,te=Se?b(u(S.maxWait)||0,D):te,fe="trailing"in S?!!S.trailing:fe),Q.cancel=q,Q.flush=z,Q}function o(I,D,S){var E=!0,A=!0;if(typeof I!="function")throw new TypeError(d);return a(S)&&(E="leading"in S?!!S.leading:E,A="trailing"in S?!!S.trailing:A),i(I,D,{leading:E,maxWait:D,trailing:A})}function a(I){var D=typeof I>"u"?"undefined":h(I);return!!I&&(D=="object"||D=="function")}function c(I){return!!I&&(typeof I>"u"?"undefined":h(I))=="object"}function l(I){return(typeof I>"u"?"undefined":h(I))=="symbol"||c(I)&&g.call(I)==p}function u(I){if(typeof I=="number")return I;if(l(I))return f;if(a(I)){var D=typeof I.valueOf=="function"?I.valueOf():I;I=a(D)?D+"":D}if(typeof I!="string")return I===0?I:+I;I=I.replace(m,"");var S=_.test(I);return S||y.test(I)?C(I.slice(2),S?2:8):v.test(I)?f:+I}var h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},d="Expected a function",f=NaN,p="[object Symbol]",m=/^\s+|\s+$/g,v=/^[-+]0x[0-9a-f]+$/i,_=/^0b[01]+$/i,y=/^0o[0-7]+$/i,C=parseInt,U=(typeof s>"u"?"undefined":h(s))=="object"&&s&&s.Object===Object&&s,L=(typeof self>"u"?"undefined":h(self))=="object"&&self&&self.Object===Object&&self,B=U||L||Function("return this")(),$=Object.prototype,g=$.toString,b=Math.max,N=Math.min,x=function(){return B.Date.now()};t.exports=o}).call(n,function(){return this}())},function(t,n){(function(s){function i(x,I,D){function S(fe){var ue=Q,Ee=J;return Q=J=void 0,ge=fe,te=x.apply(Ee,ue)}function E(fe){return ge=fe,re=setTimeout(O,I),De?S(fe):te}function A(fe){var ue=fe-pe,Ee=fe-ge,Tr=I-ue;return xe?b(Tr,Z-Ee):Tr}function T(fe){var ue=fe-pe,Ee=fe-ge;return pe===void 0||ue>=I||ue<0||xe&&Ee>=Z}function O(){var fe=N();return T(fe)?k(fe):void(re=setTimeout(O,A(fe)))}function k(fe){return re=void 0,Se&&Q?S(fe):(Q=J=void 0,te)}function j(){re!==void 0&&clearTimeout(re),ge=0,Q=pe=J=re=void 0}function q(){return re===void 0?te:k(N())}function z(){var fe=N(),ue=T(fe);if(Q=arguments,J=this,pe=fe,ue){if(re===void 0)return E(pe);if(xe)return re=setTimeout(O,I),S(pe)}return re===void 0&&(re=setTimeout(O,I)),te}var Q,J,Z,te,re,pe,ge=0,De=!1,xe=!1,Se=!0;if(typeof x!="function")throw new TypeError(h);return I=l(I)||0,o(D)&&(De=!!D.leading,xe="maxWait"in D,Z=xe?g(l(D.maxWait)||0,I):Z,Se="trailing"in D?!!D.trailing:Se),z.cancel=j,z.flush=q,z}function o(x){var I=typeof x>"u"?"undefined":u(x);return!!x&&(I=="object"||I=="function")}function a(x){return!!x&&(typeof x>"u"?"undefined":u(x))=="object"}function c(x){return(typeof x>"u"?"undefined":u(x))=="symbol"||a(x)&&$.call(x)==f}function l(x){if(typeof x=="number")return x;if(c(x))return d;if(o(x)){var I=typeof x.valueOf=="function"?x.valueOf():x;x=o(I)?I+"":I}if(typeof x!="string")return x===0?x:+x;x=x.replace(p,"");var D=v.test(x);return D||_.test(x)?y(x.slice(2),D?2:8):m.test(x)?d:+x}var u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h="Expected a function",d=NaN,f="[object Symbol]",p=/^\s+|\s+$/g,m=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,_=/^0o[0-7]+$/i,y=parseInt,C=(typeof s>"u"?"undefined":u(s))=="object"&&s&&s.Object===Object&&s,U=(typeof self>"u"?"undefined":u(self))=="object"&&self&&self.Object===Object&&self,L=C||U||Function("return this")(),B=Object.prototype,$=B.toString,g=Math.max,b=Math.min,N=function(){return L.Date.now()};t.exports=i}).call(n,function(){return this}())},function(t,n){function s(u){var h=void 0,d=void 0;for(h=0;h<u.length;h+=1)if(d=u[h],d.dataset&&d.dataset.aos||d.children&&s(d.children))return!0;return!1}function i(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function o(){return!!i()}function a(u,h){var d=window.document,f=i(),p=new f(c);l=h,p.observe(d.documentElement,{childList:!0,subtree:!0,removedNodes:!0})}function c(u){u&&u.forEach(function(h){var d=Array.prototype.slice.call(h.addedNodes),f=Array.prototype.slice.call(h.removedNodes),p=d.concat(f);if(s(p))return l()})}Object.defineProperty(n,"__esModule",{value:!0});var l=function(){};n.default={isSupported:o,ready:a}},function(t,n){function s(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}function i(){return navigator.userAgent||navigator.vendor||window.opera||""}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function d(f,p){for(var m=0;m<p.length;m++){var v=p[m];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(f,v.key,v)}}return function(f,p,m){return p&&d(f.prototype,p),m&&d(f,m),f}}(),a=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,c=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,l=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,u=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,h=function(){function d(){s(this,d)}return o(d,[{key:"phone",value:function(){var f=i();return!(!a.test(f)&&!c.test(f.substr(0,4)))}},{key:"mobile",value:function(){var f=i();return!(!l.test(f)&&!u.test(f.substr(0,4)))}},{key:"tablet",value:function(){return this.mobile()&&!this.phone()}}]),d}();n.default=new h},function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var s=function(o,a,c){var l=o.node.getAttribute("data-aos-once");a>o.position?o.node.classList.add("aos-animate"):typeof l<"u"&&(l==="false"||!c&&l!=="true")&&o.node.classList.remove("aos-animate")},i=function(o,a){var c=window.pageYOffset,l=window.innerHeight;o.forEach(function(u,h){s(u,l+c,a)})};n.default=i},function(t,n,s){function i(l){return l&&l.__esModule?l:{default:l}}Object.defineProperty(n,"__esModule",{value:!0});var o=s(12),a=i(o),c=function(l,u){return l.forEach(function(h,d){h.node.classList.add("aos-init"),h.position=(0,a.default)(h.node,u.offset)}),l};n.default=c},function(t,n,s){function i(l){return l&&l.__esModule?l:{default:l}}Object.defineProperty(n,"__esModule",{value:!0});var o=s(13),a=i(o),c=function(l,u){var h=0,d=0,f=window.innerHeight,p={offset:l.getAttribute("data-aos-offset"),anchor:l.getAttribute("data-aos-anchor"),anchorPlacement:l.getAttribute("data-aos-anchor-placement")};switch(p.offset&&!isNaN(p.offset)&&(d=parseInt(p.offset)),p.anchor&&document.querySelectorAll(p.anchor)&&(l=document.querySelectorAll(p.anchor)[0]),h=(0,a.default)(l).top,p.anchorPlacement){case"top-bottom":break;case"center-bottom":h+=l.offsetHeight/2;break;case"bottom-bottom":h+=l.offsetHeight;break;case"top-center":h+=f/2;break;case"bottom-center":h+=f/2+l.offsetHeight;break;case"center-center":h+=f/2+l.offsetHeight/2;break;case"top-top":h+=f;break;case"bottom-top":h+=l.offsetHeight+f;break;case"center-top":h+=l.offsetHeight/2+f}return p.anchorPlacement||p.offset||isNaN(u)||(d=u),h+d};n.default=c},function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var s=function(i){for(var o=0,a=0;i&&!isNaN(i.offsetLeft)&&!isNaN(i.offsetTop);)o+=i.offsetLeft-(i.tagName!="BODY"?i.scrollLeft:0),a+=i.offsetTop-(i.tagName!="BODY"?i.scrollTop:0),i=i.offsetParent;return{top:a,left:o}};n.default=s},function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var s=function(i){return i=i||document.querySelectorAll("[data-aos]"),Array.prototype.map.call(i,function(o){return{node:o}})};n.default=s}])})}(xd)),xd.exports}var QN=WN();const JN=GI(QN),_s={validateCaipAddress(r){var e;if(((e=r.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return r},parseCaipAddress(r){const e=r.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${r}`);const[t,n,s]=e;if(!t||!n||!s)throw new Error(`Invalid CAIP-10 address: ${r}`);return{chainNamespace:t,chainId:n,address:s}},parseCaipNetworkId(r){const e=r.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${r}`);const[t,n]=e;if(!t||!n)throw new Error(`Invalid CAIP-2 network id: ${r}`);return{chainNamespace:t,chainId:n}}};function ZN(r){return(r==null?void 0:r.endsWith(oe.WC_NAME_SUFFIX_LEGACY))||(r==null?void 0:r.endsWith(oe.WC_NAME_SUFFIX))}var bp={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ug=function(r,e){return Ug=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},Ug(r,e)};function YN(r,e){Ug(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Bg=function(){return Bg=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Bg.apply(this,arguments)};function XN(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function ex(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function tx(r,e){return function(t,n){e(t,n,r)}}function rx(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function nx(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}function sx(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,s=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){t.label=l[1];break}if(l[0]===6&&t.label<i[1]){t.label=i[1],i=l;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(l);break}i[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(u){l=[6,u],s=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function ix(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function ox(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function $g(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function s1(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i}function ax(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(s1(arguments[e]));return r}function cx(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),s=0,e=0;e<t;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function pu(r){return this instanceof pu?(this.v=r,this):new pu(r)}function lx(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(d){n[d]&&(s[d]=function(f){return new Promise(function(p,m){i.push([d,f,p,m])>1||a(d,f)})})}function a(d,f){try{c(n[d](f))}catch(p){h(i[0][3],p)}}function c(d){d.value instanceof pu?Promise.resolve(d.value.v).then(l,u):h(i[0][2],d)}function l(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function ux(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:pu(r[s](o)),done:s==="return"}:i?i(o):o}:i}}function hx(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof $g=="function"?$g(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(a,c){o=r[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function dx(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function fx(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function px(r){return r&&r.__esModule?r:{default:r}}function gx(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function mx(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const yx=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Bg},__asyncDelegator:ux,__asyncGenerator:lx,__asyncValues:hx,__await:pu,__awaiter:nx,__classPrivateFieldGet:gx,__classPrivateFieldSet:mx,__createBinding:ix,__decorate:ex,__exportStar:ox,__extends:YN,__generator:sx,__importDefault:px,__importStar:fx,__makeTemplateObject:dx,__metadata:rx,__param:tx,__read:s1,__rest:XN,__spread:ax,__spreadArrays:cx,__values:$g},Symbol.toStringTag,{value:"Module"})),Lf=KI(yx);var vp={},Ol={},Pw;function wx(){if(Pw)return Ol;Pw=1,Object.defineProperty(Ol,"__esModule",{value:!0}),Ol.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return Ol.delay=r,Ol}var Ji={},Ep={},Zi={},Tw;function bx(){return Tw||(Tw=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.ONE_THOUSAND=Zi.ONE_HUNDRED=void 0,Zi.ONE_HUNDRED=100,Zi.ONE_THOUSAND=1e3),Zi}var Ap={},Ow;function vx(){return Ow||(Ow=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(Ap)),Ap}var Sw;function i1(){return Sw||(Sw=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Lf;e.__exportStar(bx(),r),e.__exportStar(vx(),r)}(Ep)),Ep}var Rw;function Ex(){if(Rw)return Ji;Rw=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.fromMiliseconds=Ji.toMiliseconds=void 0;const r=i1();function e(n){return n*r.ONE_THOUSAND}Ji.toMiliseconds=e;function t(n){return Math.floor(n/r.ONE_THOUSAND)}return Ji.fromMiliseconds=t,Ji}var Dw;function Ax(){return Dw||(Dw=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Lf;e.__exportStar(wx(),r),e.__exportStar(Ex(),r)}(vp)),vp}var Aa={},kw;function _x(){if(kw)return Aa;kw=1,Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const n=this.get(t);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const s=Date.now()-n.started;this.timestamps.set(t,{started:n.started,elapsed:s})}get(t){const n=this.timestamps.get(t);if(typeof n>"u")throw new Error(`No timestamp found for label: ${t}`);return n}elapsed(t){const n=this.get(t);return n.elapsed||Date.now()-n.started}}return Aa.Watch=r,Aa.default=r,Aa}var _p={},Sl={},Uw;function Cx(){if(Uw)return Sl;Uw=1,Object.defineProperty(Sl,"__esModule",{value:!0}),Sl.IWatch=void 0;class r{}return Sl.IWatch=r,Sl}var Bw;function Ix(){return Bw||(Bw=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Lf.__exportStar(Cx(),r)}(_p)),_p}var $w;function Nx(){return $w||($w=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Lf;e.__exportStar(Ax(),r),e.__exportStar(_x(),r),e.__exportStar(Ix(),r),e.__exportStar(i1(),r)}(bp)),bp}var X=Nx();class ma{}let xx=class extends ma{constructor(e){super()}};const Lw=X.FIVE_SECONDS,bl={pulse:"heartbeat_pulse"};let Px=class o1 extends xx{constructor(e){super(e),this.events=new Mn.EventEmitter,this.interval=Lw,this.interval=(e==null?void 0:e.interval)||Lw}static async init(e){const t=new o1(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),X.toMiliseconds(this.interval))}pulse(){this.events.emit(bl.pulse)}};const Tx=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Ox=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Sx=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Rx(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){Dx(r);return}return e}function Dx(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function Kh(r,e={}){if(typeof r!="string")return r;if(r[0]==='"'&&r[r.length-1]==='"'&&r.indexOf("\\")===-1)return r.slice(1,-1);const t=r.trim();if(t.length<=9)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!Sx.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(Tx.test(r)||Ox.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,Rx)}return JSON.parse(r)}catch(n){if(e.strict)throw n;return r}}function kx(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function xt(r,...e){try{return kx(r(...e))}catch(t){return Promise.reject(t)}}function Ux(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function Bx(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function Pd(r){if(Ux(r))return String(r);if(Bx(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return Pd(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Lg="base64:";function $x(r){return typeof r=="string"?r:Lg+Fx(r)}function Lx(r){return typeof r!="string"||!r.startsWith(Lg)?r:Mx(r.slice(Lg.length))}function Mx(r){return globalThis.Buffer?Ut.from(r,"base64"):Uint8Array.from(globalThis.atob(r),e=>e.codePointAt(0))}function Fx(r){return globalThis.Buffer?Ut.from(r).toString("base64"):globalThis.btoa(String.fromCodePoint(...r))}function yr(r){var e;return r&&((e=r.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function jx(...r){return yr(r.join(":"))}function Wh(r){return r=yr(r),r?r+":":""}function Hx(r,e){if(e===void 0)return!0;let t=0,n=r.indexOf(":");for(;n>-1;)t++,n=r.indexOf(":",n+1);return t<=e}function qx(r,e){return e?r.startsWith(e)&&r[r.length-1]!=="$":r[r.length-1]!=="$"}const zx="memory",Vx=()=>{const r=new Map;return{name:zx,getInstance:()=>r,hasItem(e){return r.has(e)},getItem(e){return r.get(e)??null},getItemRaw(e){return r.get(e)??null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return[...r.keys()]},clear(){r.clear()},dispose(){r.clear()}}};function Gx(r={}){const e={mounts:{"":r.driver||Vx()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},n=(l,u)=>e.mountpoints.filter(h=>h.startsWith(l)||u&&l.startsWith(h)).map(h=>({relativeBase:l.length>h.length?l.slice(h.length):void 0,mountpoint:h,driver:e.mounts[h]})),s=(l,u)=>{if(e.watching){u=yr(u);for(const h of e.watchListeners)h(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await Mw(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,h)=>{const d=new Map,f=p=>{let m=d.get(p.base);return m||(m={driver:p.driver,base:p.base,items:[]},d.set(p.base,m)),m};for(const p of l){const m=typeof p=="string",v=yr(m?p:p.key),_=m?void 0:p.value,y=m||!p.options?u:{...u,...p.options},C=t(v);f(C).items.push({key:v,value:_,relativeKey:C.relativeKey,options:y})}return Promise.all([...d.values()].map(p=>h(p))).then(p=>p.flat())},c={hasItem(l,u={}){l=yr(l);const{relativeKey:h,driver:d}=t(l);return xt(d.hasItem,h,u)},getItem(l,u={}){l=yr(l);const{relativeKey:h,driver:d}=t(l);return xt(d.getItem,h,u).then(f=>Kh(f))},getItems(l,u={}){return a(l,u,h=>h.driver.getItems?xt(h.driver.getItems,h.items.map(d=>({key:d.relativeKey,options:d.options})),u).then(d=>d.map(f=>({key:jx(h.base,f.key),value:Kh(f.value)}))):Promise.all(h.items.map(d=>xt(h.driver.getItem,d.relativeKey,d.options).then(f=>({key:d.key,value:Kh(f)})))))},getItemRaw(l,u={}){l=yr(l);const{relativeKey:h,driver:d}=t(l);return d.getItemRaw?xt(d.getItemRaw,h,u):xt(d.getItem,h,u).then(f=>Lx(f))},async setItem(l,u,h={}){if(u===void 0)return c.removeItem(l);l=yr(l);const{relativeKey:d,driver:f}=t(l);f.setItem&&(await xt(f.setItem,d,Pd(u),h),f.watch||s("update",l))},async setItems(l,u){await a(l,u,async h=>{if(h.driver.setItems)return xt(h.driver.setItems,h.items.map(d=>({key:d.relativeKey,value:Pd(d.value),options:d.options})),u);h.driver.setItem&&await Promise.all(h.items.map(d=>xt(h.driver.setItem,d.relativeKey,Pd(d.value),d.options)))})},async setItemRaw(l,u,h={}){if(u===void 0)return c.removeItem(l,h);l=yr(l);const{relativeKey:d,driver:f}=t(l);if(f.setItemRaw)await xt(f.setItemRaw,d,u,h);else if(f.setItem)await xt(f.setItem,d,$x(u),h);else return;f.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=yr(l);const{relativeKey:h,driver:d}=t(l);d.removeItem&&(await xt(d.removeItem,h,u),(u.removeMeta||u.removeMata)&&await xt(d.removeItem,h+"$",u),d.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=yr(l);const{relativeKey:h,driver:d}=t(l),f=Object.create(null);if(d.getMeta&&Object.assign(f,await xt(d.getMeta,h,u)),!u.nativeOnly){const p=await xt(d.getItem,h+"$",u).then(m=>Kh(m));p&&typeof p=="object"&&(typeof p.atime=="string"&&(p.atime=new Date(p.atime)),typeof p.mtime=="string"&&(p.mtime=new Date(p.mtime)),Object.assign(f,p))}return f},setMeta(l,u,h={}){return this.setItem(l+"$",u,h)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){var v;l=Wh(l);const h=n(l,!0);let d=[];const f=[];let p=!0;for(const _ of h){(v=_.driver.flags)!=null&&v.maxDepth||(p=!1);const y=await xt(_.driver.getKeys,_.relativeBase,u);for(const C of y){const U=_.mountpoint+yr(C);d.some(L=>U.startsWith(L))||f.push(U)}d=[_.mountpoint,...d.filter(C=>!C.startsWith(_.mountpoint))]}const m=u.maxDepth!==void 0&&!p;return f.filter(_=>(!m||Hx(_,u.maxDepth))&&qx(_,l))},async clear(l,u={}){l=Wh(l),await Promise.all(n(l,!1).map(async h=>{if(h.driver.clear)return xt(h.driver.clear,h.relativeBase,u);if(h.driver.removeItem){const d=await h.driver.getKeys(h.relativeBase||"",u);return Promise.all(d.map(f=>h.driver.removeItem(f,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>Fw(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=Wh(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((h,d)=>d.length-h.length)),e.mounts[l]=u,e.watching&&Promise.resolve(Mw(u,s,l)).then(h=>{e.unwatch[l]=h}).catch(console.error),c},async unmount(l,u=!0){var h,d;l=Wh(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&((d=(h=e.unwatch)[l])==null||d.call(h),delete e.unwatch[l]),u&&await Fw(e.mounts[l]),e.mountpoints=e.mountpoints.filter(f=>f!==l),delete e.mounts[l])},getMount(l=""){l=yr(l)+":";const u=t(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=yr(l),n(l,u.parents).map(d=>({driver:d.driver,base:d.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,h={})=>c.setItem(l,u,h),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function Mw(r,e,t){return r.watch?r.watch((n,s)=>e(n,t+s)):()=>{}}async function Fw(r){typeof r.dispose=="function"&&await xt(r.dispose)}function ya(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function a1(r,e){const t=indexedDB.open(r);t.onupgradeneeded=()=>t.result.createObjectStore(e);const n=ya(t);return(s,i)=>n.then(o=>i(o.transaction(e,s).objectStore(e)))}let Cp;function xh(){return Cp||(Cp=a1("keyval-store","keyval")),Cp}function jw(r,e=xh()){return e("readonly",t=>ya(t.get(r)))}function Kx(r,e,t=xh()){return t("readwrite",n=>(n.put(e,r),ya(n.transaction)))}function Wx(r,e=xh()){return e("readwrite",t=>(t.delete(r),ya(t.transaction)))}function Qx(r=xh()){return r("readwrite",e=>(e.clear(),ya(e.transaction)))}function Jx(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},ya(r.transaction)}function Zx(r=xh()){return r("readonly",e=>{if(e.getAllKeys)return ya(e.getAllKeys());const t=[];return Jx(e,n=>t.push(n.key)).then(()=>t)})}const Yx=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),Xx=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=r.replace(e,'$1"$2n"$3');return JSON.parse(t,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function ea(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return Xx(r)}catch{return r}}function Ys(r){return typeof r=="string"?r:Yx(r)||""}const eP="idb-keyval";var tP=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=s=>e+s;let n;return r.dbName&&r.storeName&&(n=a1(r.dbName,r.storeName)),{name:eP,options:r,async hasItem(s){return!(typeof await jw(t(s),n)>"u")},async getItem(s){return await jw(t(s),n)??null},setItem(s,i){return Kx(t(s),i,n)},removeItem(s){return Wx(t(s),n)},getKeys(){return Zx(n)},clear(){return Qx(n)}}};const rP="WALLET_CONNECT_V2_INDEXED_DB",nP="keyvaluestorage";let sP=class{constructor(){this.indexedDb=Gx({driver:tP({dbName:rP,storeName:nP})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,Ys(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Ip=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof be<"u"?be:typeof self<"u"?self:{},Td={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,n){this[t]=String(n)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ip<"u"&&Ip.localStorage?Td.exports=Ip.localStorage:typeof window<"u"&&window.localStorage?Td.exports=window.localStorage:Td.exports=new e})();function iP(r){var e;return[r[0],ea((e=r[1])!=null?e:"")]}let oP=class{constructor(){this.localStorage=Td.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(iP)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return ea(t)}async setItem(e,t){this.localStorage.setItem(e,Ys(t))}async removeItem(e){this.localStorage.removeItem(e)}};const aP="wc_storage_version",Hw=1,cP=async(r,e,t)=>{const n=aP,s=await e.getItem(n);if(s&&s>=Hw){t(e);return}const i=await r.getKeys();if(!i.length){t(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await r.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(n,Hw),t(e),lP(r,o)},lP=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};let uP=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new oP;this.storage=e;try{const t=new sP;cP(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};const hP={level:"info"},Ph="custom_context",hy=1e3*1024;let dP=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},qw=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new dP(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}},c1=class{constructor(e,t=hy){this.level=e??"error",this.levelValue=Tl.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new qw(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===Tl.levels.values.error?console.error(e):t===Tl.levels.values.warn?console.warn(e):t===Tl.levels.values.debug?console.debug(e):t===Tl.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Ys({timestamp:new Date().toISOString(),log:e}));const t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new qw(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(Ys({extraMetadata:e})),new Blob(t,{type:"application/json"})}},fP=class{constructor(e,t=hy){this.baseChunkLogger=new c1(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=t,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}},pP=class{constructor(e,t=hy){this.baseChunkLogger=new c1(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var gP=Object.defineProperty,mP=Object.defineProperties,yP=Object.getOwnPropertyDescriptors,zw=Object.getOwnPropertySymbols,wP=Object.prototype.hasOwnProperty,bP=Object.prototype.propertyIsEnumerable,Vw=(r,e,t)=>e in r?gP(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Wd=(r,e)=>{for(var t in e||(e={}))wP.call(e,t)&&Vw(r,t,e[t]);if(zw)for(var t of zw(e))bP.call(e,t)&&Vw(r,t,e[t]);return r},Qd=(r,e)=>mP(r,yP(e));function vl(r){return Qd(Wd({},r),{level:(r==null?void 0:r.level)||hP.level})}function vP(r,e=Ph){return r[e]||""}function EP(r,e,t=Ph){return r[t]=e,r}function xr(r,e=Ph){let t="";return typeof r.bindings>"u"?t=vP(r,e):t=r.bindings().context||"",t}function AP(r,e,t=Ph){const n=xr(r,t);return n.trim()?`${n}/${e}`:e}function er(r,e,t=Ph){const n=AP(r,e,t),s=r.child({context:n});return EP(s,n,t)}function _P(r){var e,t;const n=new fP((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:Ch(Qd(Wd({},r.opts),{level:"trace",browser:Qd(Wd({},(t=r.opts)==null?void 0:t.browser),{write:s=>n.write(s)})})),chunkLoggerController:n}}function CP(r){var e;const t=new pP((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:Ch(Qd(Wd({},r.opts),{level:"trace"}),t),chunkLoggerController:t}}function dy(r){return typeof r.loggerOverride<"u"&&typeof r.loggerOverride!="string"?{logger:r.loggerOverride,chunkLoggerController:null}:typeof window<"u"?_P(r):CP(r)}var IP=Object.defineProperty,NP=(r,e,t)=>e in r?IP(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Gw=(r,e,t)=>NP(r,typeof e!="symbol"?e+"":e,t);let xP=class extends ma{constructor(e){super(),this.opts=e,Gw(this,"protocol","wc"),Gw(this,"version",2)}};var PP=Object.defineProperty,TP=(r,e,t)=>e in r?PP(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,OP=(r,e,t)=>TP(r,e+"",t);let SP=class extends ma{constructor(e,t){super(),this.core=e,this.logger=t,OP(this,"records",new Map)}},RP=class{constructor(e,t){this.logger=e,this.core=t}};class DP extends ma{constructor(e,t){super(),this.relayer=e,this.logger=t}}let kP=class extends ma{constructor(e){super()}},UP=class{constructor(e,t,n,s){this.core=e,this.logger=t,this.name=n}},BP=class extends ma{constructor(e,t){super(),this.relayer=e,this.logger=t}},$P=class extends ma{constructor(e,t){super(),this.core=e,this.logger=t}},LP=class{constructor(e,t,n){this.core=e,this.logger=t,this.store=n}},MP=class{constructor(e,t){this.projectId=e,this.logger=t}},FP=class{constructor(e,t,n){this.core=e,this.logger=t,this.telemetryEnabled=n}};var jP=Object.defineProperty,HP=(r,e,t)=>e in r?jP(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Kw=(r,e,t)=>HP(r,typeof e!="symbol"?e+"":e,t);let qP=class{constructor(e){this.opts=e,Kw(this,"protocol","wc"),Kw(this,"version",2)}},zP=class{constructor(e){this.client=e}};function VP(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function l1(r,...e){if(!VP(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Ww(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function GP(r,e){l1(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const _a=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Np=r=>new DataView(r.buffer,r.byteOffset,r.byteLength);function KP(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function u1(r){return typeof r=="string"&&(r=KP(r)),l1(r),r}let WP=class{clone(){return this._cloneInto()}};function QP(r){const e=n=>r().update(u1(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function h1(r=32){if(_a&&typeof _a.getRandomValues=="function")return _a.getRandomValues(new Uint8Array(r));if(_a&&typeof _a.randomBytes=="function")return _a.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}function JP(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}let ZP=class extends WP{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Np(this.buffer)}update(e){Ww(this);const{view:t,buffer:n,blockLen:s}=this;e=u1(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Np(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ww(this),GP(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;JP(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Np(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}};const Qh=BigInt(2**32-1),Mg=BigInt(32);function d1(r,e=!1){return e?{h:Number(r&Qh),l:Number(r>>Mg&Qh)}:{h:Number(r>>Mg&Qh)|0,l:Number(r&Qh)|0}}function YP(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=d1(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const XP=(r,e)=>BigInt(r>>>0)<<Mg|BigInt(e>>>0),e2=(r,e,t)=>r>>>t,t2=(r,e,t)=>r<<32-t|e>>>t,r2=(r,e,t)=>r>>>t|e<<32-t,n2=(r,e,t)=>r<<32-t|e>>>t,s2=(r,e,t)=>r<<64-t|e>>>t-32,i2=(r,e,t)=>r>>>t-32|e<<64-t,o2=(r,e)=>e,a2=(r,e)=>r,c2=(r,e,t)=>r<<t|e>>>32-t,l2=(r,e,t)=>e<<t|r>>>32-t,u2=(r,e,t)=>e<<t-32|r>>>64-t,h2=(r,e,t)=>r<<t-32|e>>>64-t;function d2(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const f2=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),p2=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,g2=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),m2=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,y2=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),w2=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,Pe={fromBig:d1,split:YP,toBig:XP,shrSH:e2,shrSL:t2,rotrSH:r2,rotrSL:n2,rotrBH:s2,rotrBL:i2,rotr32H:o2,rotr32L:a2,rotlSH:c2,rotlSL:l2,rotlBH:u2,rotlBL:h2,add:d2,add3L:f2,add3H:p2,add4L:g2,add4H:m2,add5H:w2,add5L:y2},[b2,v2]=Pe.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),ri=new Uint32Array(80),ni=new Uint32Array(80);let E2=class extends ZP{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:d,Gh:f,Gl:p,Hh:m,Hl:v}=this;return[e,t,n,s,i,o,a,c,l,u,h,d,f,p,m,v]}set(e,t,n,s,i,o,a,c,l,u,h,d,f,p,m,v){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=d|0,this.Gh=f|0,this.Gl=p|0,this.Hh=m|0,this.Hl=v|0}process(e,t){for(let C=0;C<16;C++,t+=4)ri[C]=e.getUint32(t),ni[C]=e.getUint32(t+=4);for(let C=16;C<80;C++){const U=ri[C-15]|0,L=ni[C-15]|0,B=Pe.rotrSH(U,L,1)^Pe.rotrSH(U,L,8)^Pe.shrSH(U,L,7),$=Pe.rotrSL(U,L,1)^Pe.rotrSL(U,L,8)^Pe.shrSL(U,L,7),g=ri[C-2]|0,b=ni[C-2]|0,N=Pe.rotrSH(g,b,19)^Pe.rotrBH(g,b,61)^Pe.shrSH(g,b,6),x=Pe.rotrSL(g,b,19)^Pe.rotrBL(g,b,61)^Pe.shrSL(g,b,6),I=Pe.add4L($,x,ni[C-7],ni[C-16]),D=Pe.add4H(I,B,N,ri[C-7],ri[C-16]);ri[C]=D|0,ni[C]=I|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:d,Fh:f,Fl:p,Gh:m,Gl:v,Hh:_,Hl:y}=this;for(let C=0;C<80;C++){const U=Pe.rotrSH(h,d,14)^Pe.rotrSH(h,d,18)^Pe.rotrBH(h,d,41),L=Pe.rotrSL(h,d,14)^Pe.rotrSL(h,d,18)^Pe.rotrBL(h,d,41),B=h&f^~h&m,$=d&p^~d&v,g=Pe.add5L(y,L,$,v2[C],ni[C]),b=Pe.add5H(g,_,U,B,b2[C],ri[C]),N=g|0,x=Pe.rotrSH(n,s,28)^Pe.rotrBH(n,s,34)^Pe.rotrBH(n,s,39),I=Pe.rotrSL(n,s,28)^Pe.rotrBL(n,s,34)^Pe.rotrBL(n,s,39),D=n&i^n&a^i&a,S=s&o^s&c^o&c;_=m|0,y=v|0,m=f|0,v=p|0,f=h|0,p=d|0,{h,l:d}=Pe.add(l|0,u|0,b|0,N|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const E=Pe.add3L(N,I,S);n=Pe.add3H(E,b,x,D),s=E|0}({h:n,l:s}=Pe.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=Pe.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Pe.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Pe.add(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:d}=Pe.add(this.Eh|0,this.El|0,h|0,d|0),{h:f,l:p}=Pe.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:m,l:v}=Pe.add(this.Gh|0,this.Gl|0,m|0,v|0),{h:_,l:y}=Pe.add(this.Hh|0,this.Hl|0,_|0,y|0),this.set(n,s,i,o,a,c,l,u,h,d,f,p,m,v,_,y)}roundClean(){ri.fill(0),ni.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const A2=QP(()=>new E2);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const fy=BigInt(0),f1=BigInt(1),_2=BigInt(2);function py(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function gy(r){if(!py(r))throw new Error("Uint8Array expected")}function xp(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const C2=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function my(r){gy(r);let e="";for(let t=0;t<r.length;t++)e+=C2[r[t]];return e}function p1(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?fy:BigInt("0x"+r)}const ws={_0:48,_9:57,A:65,F:70,a:97,f:102};function Qw(r){if(r>=ws._0&&r<=ws._9)return r-ws._0;if(r>=ws.A&&r<=ws.F)return r-(ws.A-10);if(r>=ws.a&&r<=ws.f)return r-(ws.a-10)}function g1(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=Qw(r.charCodeAt(i)),a=Qw(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function I2(r){return p1(my(r))}function Od(r){return gy(r),p1(my(Uint8Array.from(r).reverse()))}function m1(r,e){return g1(r.toString(16).padStart(e*2,"0"))}function Fg(r,e){return m1(r,e).reverse()}function bs(r,e,t){let n;if(typeof e=="string")try{n=g1(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(py(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function Jw(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];gy(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}const Pp=r=>typeof r=="bigint"&&fy<=r;function N2(r,e,t){return Pp(r)&&Pp(e)&&Pp(t)&&e<=r&&r<t}function Rl(r,e,t,n){if(!N2(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function x2(r){let e;for(e=0;r>fy;r>>=f1,e+=1);return e}const P2=r=>(_2<<BigInt(r-1))-f1,T2={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||py(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function yy(r,e,t={}){const n=(s,i,o)=>{const a=T2[i];if(typeof a!="function")throw new Error("invalid validator function");const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}function Zw(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}const Rt=BigInt(0),gt=BigInt(1),oo=BigInt(2),O2=BigInt(3),jg=BigInt(4),Yw=BigInt(5),Xw=BigInt(8);function Ct(r,e){const t=r%e;return t>=Rt?t:e+t}function S2(r,e,t){if(e<Rt)throw new Error("invalid exponent, negatives unsupported");if(t<=Rt)throw new Error("invalid modulus");if(t===gt)return Rt;let n=gt;for(;e>Rt;)e&gt&&(n=n*r%t),r=r*r%t,e>>=gt;return n}function Hn(r,e,t){let n=r;for(;e-- >Rt;)n*=n,n%=t;return n}function e0(r,e){if(r===Rt)throw new Error("invert: expected non-zero number");if(e<=Rt)throw new Error("invert: expected positive modulus, got "+e);let t=Ct(r,e),n=e,s=Rt,i=gt;for(;t!==Rt;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==gt)throw new Error("invert: does not exist");return Ct(s,e)}function R2(r){const e=(r-gt)/oo;let t,n,s;for(t=r-gt,n=0;t%oo===Rt;t/=oo,n++);for(s=oo;s<r&&S2(s,e,r)!==r-gt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(r+gt)/jg;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(t+gt)/oo;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,l=o.pow(o.mul(o.ONE,s),t),u=o.pow(a,i),h=o.pow(a,t);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let d=1;for(let p=o.sqr(h);d<c&&!o.eql(p,o.ONE);d++)p=o.sqr(p);const f=o.pow(l,gt<<BigInt(c-d-1));l=o.sqr(f),u=o.mul(u,f),h=o.mul(h,l),c=d}return u}}function D2(r){if(r%jg===O2){const e=(r+gt)/jg;return function(t,n){const s=t.pow(n,e);if(!t.eql(t.sqr(s),n))throw new Error("Cannot find square root");return s}}if(r%Xw===Yw){const e=(r-Yw)/Xw;return function(t,n){const s=t.mul(n,oo),i=t.pow(s,e),o=t.mul(n,i),a=t.mul(t.mul(o,oo),i),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return R2(r)}const k2=(r,e)=>(Ct(r,e)&gt)===gt,U2=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function B2(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=U2.reduce((n,s)=>(n[s]="function",n),e);return yy(r,t)}function $2(r,e,t){if(t<Rt)throw new Error("invalid exponent, negatives unsupported");if(t===Rt)return r.ONE;if(t===gt)return e;let n=r.ONE,s=e;for(;t>Rt;)t&gt&&(n=r.mul(n,s)),s=r.sqr(s),t>>=gt;return n}function L2(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function y1(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function w1(r,e,t=!1,n={}){if(r<=Rt)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:i}=y1(r,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:s,BYTES:i,MASK:P2(s),ZERO:Rt,ONE:gt,create:c=>Ct(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Rt<=c&&c<r},is0:c=>c===Rt,isOdd:c=>(c&gt)===gt,neg:c=>Ct(-c,r),eql:(c,l)=>c===l,sqr:c=>Ct(c*c,r),add:(c,l)=>Ct(c+l,r),sub:(c,l)=>Ct(c-l,r),mul:(c,l)=>Ct(c*l,r),pow:(c,l)=>$2(a,c,l),div:(c,l)=>Ct(c*e0(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>e0(c,r),sqrt:n.sqrt||(c=>(o||(o=D2(r)),o(a,c))),invertBatch:c=>L2(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?Fg(c,i):m1(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?Od(c):I2(c)}});return Object.freeze(a)}const t0=BigInt(0),Jh=BigInt(1);function Tp(r,e){const t=e.negate();return r?t:e}function b1(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function Op(r,e){b1(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function M2(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function F2(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const Sp=new WeakMap,v1=new WeakMap;function Rp(r){return v1.get(r)||1}function j2(r,e){return{constTimeNegate:Tp,hasPrecomputes(t){return Rp(t)!==1},unsafeLadder(t,n,s=r.ZERO){let i=t;for(;n>t0;)n&Jh&&(s=s.add(i)),i=i.double(),n>>=Jh;return s},precomputeWindow(t,n){const{windows:s,windowSize:i}=Op(n,e),o=[];let a=t,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,s){const{windows:i,windowSize:o}=Op(t,e);let a=r.ZERO,c=r.BASE;const l=BigInt(2**t-1),u=2**t,h=BigInt(t);for(let d=0;d<i;d++){const f=d*o;let p=Number(s&l);s>>=h,p>o&&(p-=u,s+=Jh);const m=f,v=f+Math.abs(p)-1,_=d%2!==0,y=p<0;p===0?c=c.add(Tp(_,n[m])):a=a.add(Tp(y,n[v]))}return{p:a,f:c}},wNAFUnsafe(t,n,s,i=r.ZERO){const{windows:o,windowSize:a}=Op(t,e),c=BigInt(2**t-1),l=2**t,u=BigInt(t);for(let h=0;h<o;h++){const d=h*a;if(s===t0)break;let f=Number(s&c);if(s>>=u,f>a&&(f-=l,s+=Jh),f===0)continue;let p=n[d+Math.abs(f)-1];f<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(t,n,s){let i=Sp.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&Sp.set(n,s(i))),i},wNAFCached(t,n,s){const i=Rp(t);return this.wNAF(i,this.getPrecomputes(i,t,s),n)},wNAFCachedUnsafe(t,n,s,i){const o=Rp(t);return o===1?this.unsafeLadder(t,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),n,i)},setWindowSize(t,n){b1(n,e),v1.set(t,n),Sp.delete(t)}}}function H2(r,e,t,n){if(M2(t,r),F2(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=r.ZERO,i=x2(BigInt(t.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let h=l;h>=0;h-=o){c.fill(s);for(let f=0;f<n.length;f++){const p=n[f],m=Number(p>>BigInt(h)&BigInt(a));c[m]=c[m].add(t[f])}let d=s;for(let f=c.length-1,p=s;f>0;f--)p=p.add(c[f]),d=d.add(p);if(u=u.add(d),h!==0)for(let f=0;f<o;f++)u=u.double()}return u}function q2(r){return B2(r.Fp),yy(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...y1(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}const pn=BigInt(0),pr=BigInt(1),Zh=BigInt(2),z2=BigInt(8),V2={zip215:!0};function G2(r){const e=q2(r);return yy(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function K2(r){const e=G2(r),{Fp:t,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=Zh<<BigInt(a*8)-pr,u=t.create,h=w1(e.n,e.nBitLength),d=e.uvRatio||((E,A)=>{try{return{isValid:!0,value:t.sqrt(E*t.inv(A))}}catch{return{isValid:!1,value:pn}}}),f=e.adjustScalarBytes||(E=>E),p=e.domain||((E,A,T)=>{if(xp("phflag",T),A.length||T)throw new Error("Contexts/pre-hash are not supported");return E});function m(E,A){Rl("coordinate "+E,A,pn,l)}function v(E){if(!(E instanceof C))throw new Error("ExtendedPoint expected")}const _=Zw((E,A)=>{const{ex:T,ey:O,ez:k}=E,j=E.is0();A==null&&(A=j?z2:t.inv(k));const q=u(T*A),z=u(O*A),Q=u(k*A);if(j)return{x:pn,y:pr};if(Q!==pr)throw new Error("invZ was invalid");return{x:q,y:z}}),y=Zw(E=>{const{a:A,d:T}=e;if(E.is0())throw new Error("bad point: ZERO");const{ex:O,ey:k,ez:j,et:q}=E,z=u(O*O),Q=u(k*k),J=u(j*j),Z=u(J*J),te=u(z*A),re=u(J*u(te+Q)),pe=u(Z+u(T*u(z*Q)));if(re!==pe)throw new Error("bad point: equation left != right (1)");const ge=u(O*k),De=u(j*q);if(ge!==De)throw new Error("bad point: equation left != right (2)");return!0});class C{constructor(A,T,O,k){this.ex=A,this.ey=T,this.ez=O,this.et=k,m("x",A),m("y",T),m("z",O),m("t",k),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof C)throw new Error("extended point not allowed");const{x:T,y:O}=A||{};return m("x",T),m("y",O),new C(T,O,pr,u(T*O))}static normalizeZ(A){const T=t.invertBatch(A.map(O=>O.ez));return A.map((O,k)=>O.toAffine(T[k])).map(C.fromAffine)}static msm(A,T){return H2(C,h,A,T)}_setWindowSize(A){B.setWindowSize(this,A)}assertValidity(){y(this)}equals(A){v(A);const{ex:T,ey:O,ez:k}=this,{ex:j,ey:q,ez:z}=A,Q=u(T*z),J=u(j*k),Z=u(O*z),te=u(q*k);return Q===J&&Z===te}is0(){return this.equals(C.ZERO)}negate(){return new C(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:A}=e,{ex:T,ey:O,ez:k}=this,j=u(T*T),q=u(O*O),z=u(Zh*u(k*k)),Q=u(A*j),J=T+O,Z=u(u(J*J)-j-q),te=Q+q,re=te-z,pe=Q-q,ge=u(Z*re),De=u(te*pe),xe=u(Z*pe),Se=u(re*te);return new C(ge,De,Se,xe)}add(A){v(A);const{a:T,d:O}=e,{ex:k,ey:j,ez:q,et:z}=this,{ex:Q,ey:J,ez:Z,et:te}=A;if(T===BigInt(-1)){const fw=u((j-k)*(J+Q)),pw=u((j+k)*(J-Q)),yp=u(pw-fw);if(yp===pn)return this.double();const gw=u(q*Zh*te),mw=u(z*Zh*Z),yw=mw+gw,ww=pw+fw,bw=mw-gw,FI=u(yw*yp),jI=u(ww*bw),HI=u(yw*bw),qI=u(yp*ww);return new C(FI,jI,qI,HI)}const re=u(k*Q),pe=u(j*J),ge=u(z*O*te),De=u(q*Z),xe=u((k+j)*(Q+J)-re-pe),Se=De-ge,fe=De+ge,ue=u(pe-T*re),Ee=u(xe*Se),Tr=u(fe*ue),Gh=u(xe*ue),MI=u(Se*fe);return new C(Ee,Tr,MI,Gh)}subtract(A){return this.add(A.negate())}wNAF(A){return B.wNAFCached(this,A,C.normalizeZ)}multiply(A){const T=A;Rl("scalar",T,pr,n);const{p:O,f:k}=this.wNAF(T);return C.normalizeZ([O,k])[0]}multiplyUnsafe(A,T=C.ZERO){const O=A;return Rl("scalar",O,pn,n),O===pn?L:this.is0()||O===pr?this:B.wNAFCachedUnsafe(this,O,C.normalizeZ,T)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return B.unsafeLadder(this,n).is0()}toAffine(A){return _(this,A)}clearCofactor(){const{h:A}=e;return A===pr?this:this.multiplyUnsafe(A)}static fromHex(A,T=!1){const{d:O,a:k}=e,j=t.BYTES;A=bs("pointHex",A,j),xp("zip215",T);const q=A.slice(),z=A[j-1];q[j-1]=z&-129;const Q=Od(q),J=T?l:t.ORDER;Rl("pointHex.y",Q,pn,J);const Z=u(Q*Q),te=u(Z-pr),re=u(O*Z-k);let{isValid:pe,value:ge}=d(te,re);if(!pe)throw new Error("Point.fromHex: invalid y coordinate");const De=(ge&pr)===pr,xe=(z&128)!==0;if(!T&&ge===pn&&xe)throw new Error("Point.fromHex: x=0 and x_0=1");return xe!==De&&(ge=u(-ge)),C.fromAffine({x:ge,y:Q})}static fromPrivateKey(A){return b(A).point}toRawBytes(){const{x:A,y:T}=this.toAffine(),O=Fg(T,t.BYTES);return O[O.length-1]|=A&pr?128:0,O}toHex(){return my(this.toRawBytes())}}C.BASE=new C(e.Gx,e.Gy,pr,u(e.Gx*e.Gy)),C.ZERO=new C(pn,pr,pr,pn);const{BASE:U,ZERO:L}=C,B=j2(C,a*8);function $(E){return Ct(E,n)}function g(E){return $(Od(E))}function b(E){const A=t.BYTES;E=bs("private key",E,A);const T=bs("hashed private key",i(E),2*A),O=f(T.slice(0,A)),k=T.slice(A,2*A),j=g(O),q=U.multiply(j),z=q.toRawBytes();return{head:O,prefix:k,scalar:j,point:q,pointBytes:z}}function N(E){return b(E).pointBytes}function x(E=new Uint8Array,...A){const T=Jw(...A);return g(i(p(T,bs("context",E),!!s)))}function I(E,A,T={}){E=bs("message",E),s&&(E=s(E));const{prefix:O,scalar:k,pointBytes:j}=b(A),q=x(T.context,O,E),z=U.multiply(q).toRawBytes(),Q=x(T.context,z,j,E),J=$(q+Q*k);Rl("signature.s",J,pn,n);const Z=Jw(z,Fg(J,t.BYTES));return bs("result",Z,t.BYTES*2)}const D=V2;function S(E,A,T,O=D){const{context:k,zip215:j}=O,q=t.BYTES;E=bs("signature",E,2*q),A=bs("message",A),T=bs("publicKey",T,q),j!==void 0&&xp("zip215",j),s&&(A=s(A));const z=Od(E.slice(q,2*q));let Q,J,Z;try{Q=C.fromHex(T,j),J=C.fromHex(E.slice(0,q),j),Z=U.multiplyUnsafe(z)}catch{return!1}if(!j&&Q.isSmallOrder())return!1;const te=x(k,J.toRawBytes(),Q.toRawBytes(),A);return J.add(Q.multiplyUnsafe(te)).subtract(Z).clearCofactor().equals(C.ZERO)}return U._setWindowSize(8),{CURVE:e,getPublicKey:N,sign:I,verify:S,ExtendedPoint:C,utils:{getExtendedPublicKey:b,randomPrivateKey:()=>o(t.BYTES),precompute(E=8,A=C.BASE){return A._setWindowSize(E),A.multiply(BigInt(3)),A}}}}BigInt(0),BigInt(1);const wy=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),r0=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const W2=BigInt(1),n0=BigInt(2);BigInt(3);const Q2=BigInt(5),J2=BigInt(8);function Z2(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=wy,o=r*r%i*r%i,a=Hn(o,n0,i)*o%i,c=Hn(a,W2,i)*r%i,l=Hn(c,Q2,i)*c%i,u=Hn(l,e,i)*l%i,h=Hn(u,t,i)*u%i,d=Hn(h,n,i)*h%i,f=Hn(d,s,i)*d%i,p=Hn(f,s,i)*d%i,m=Hn(p,e,i)*l%i;return{pow_p_5_8:Hn(m,n0,i)*r%i,b2:o}}function Y2(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function X2(r,e){const t=wy,n=Ct(e*e*e,t),s=Ct(n*n*e,t),i=Z2(r*s).pow_p_5_8;let o=Ct(r*n*i,t);const a=Ct(e*o*o,t),c=o,l=Ct(o*r0,t),u=a===r,h=a===Ct(-r,t),d=a===Ct(-r*r0,t);return u&&(o=c),(h||d)&&(o=l),k2(o,t)&&(o=Ct(-o,t)),{isValid:u||h,value:o}}const eT=w1(wy,void 0,!0),tT={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:eT,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:J2,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:A2,randomBytes:h1,adjustScalarBytes:Y2,uvRatio:X2},E1=K2(tT),rT="EdDSA",nT="JWT",Jd=".",Mf="base64url",A1="utf8",_1="utf8",sT=":",iT="did",oT="key",s0="base58btc",aT="z",cT="K36",lT=32;function by(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function C1(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?by(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function I1(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=C1(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return by(t)}function uT(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,v=0,_=0,y=p.length;_!==y&&p[_]===0;)_++,m++;for(var C=(y-_)*u+1>>>0,U=new Uint8Array(C);_!==y;){for(var L=p[_],B=0,$=C-1;(L!==0||B<v)&&$!==-1;$--,B++)L+=256*U[$]>>>0,U[$]=L%a>>>0,L=L/a>>>0;if(L!==0)throw new Error("Non-zero carry");v=B,_++}for(var g=C-v;g!==C&&U[g]===0;)g++;for(var b=c.repeat(m);g<C;++g)b+=r.charAt(U[g]);return b}function d(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var v=0,_=0;p[m]===c;)v++,m++;for(var y=(p.length-m)*l+1>>>0,C=new Uint8Array(y);p[m];){var U=t[p.charCodeAt(m)];if(U===255)return;for(var L=0,B=y-1;(U!==0||L<_)&&B!==-1;B--,L++)U+=a*C[B]>>>0,C[B]=U%256>>>0,U=U/256>>>0;if(U!==0)throw new Error("Non-zero carry");_=L,m++}if(p[m]!==" "){for(var $=y-_;$!==y&&C[$]===0;)$++;for(var g=new Uint8Array(v+(y-$)),b=v;$!==y;)g[b++]=C[$++];return g}}}function f(p){var m=d(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var hT=uT,dT=hT;const N1=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},fT=r=>new TextEncoder().encode(r),pT=r=>new TextDecoder().decode(r);let gT=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},mT=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return x1(this,e)}},yT=class{constructor(e){this.decoders=e}or(e){return x1(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const x1=(r,e)=>new yT({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});let wT=class{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new gT(e,t,n),this.decoder=new mT(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Ff=({name:r,prefix:e,encode:t,decode:n})=>new wT(r,e,t,n),Th=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=dT(t,e);return Ff({prefix:r,name:e,encode:n,decode:i=>N1(s(i))})},bT=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const h=s[r[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},vT=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},Vt=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Ff({prefix:e,name:r,encode(s){return vT(s,n,t)},decode(s){return bT(s,n,t,r)}}),ET=Ff({prefix:"\0",name:"identity",encode:r=>pT(r),decode:r=>fT(r)});var AT=Object.freeze({__proto__:null,identity:ET});const _T=Vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var CT=Object.freeze({__proto__:null,base2:_T});const IT=Vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var NT=Object.freeze({__proto__:null,base8:IT});const xT=Th({prefix:"9",name:"base10",alphabet:"0123456789"});var PT=Object.freeze({__proto__:null,base10:xT});const TT=Vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),OT=Vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ST=Object.freeze({__proto__:null,base16:TT,base16upper:OT});const RT=Vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),DT=Vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),kT=Vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),UT=Vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),BT=Vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$T=Vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),LT=Vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),MT=Vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),FT=Vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var jT=Object.freeze({__proto__:null,base32:RT,base32upper:DT,base32pad:kT,base32padupper:UT,base32hex:BT,base32hexupper:$T,base32hexpad:LT,base32hexpadupper:MT,base32z:FT});const HT=Th({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),qT=Th({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var zT=Object.freeze({__proto__:null,base36:HT,base36upper:qT});const VT=Th({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),GT=Th({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var KT=Object.freeze({__proto__:null,base58btc:VT,base58flickr:GT});const WT=Vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),QT=Vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),JT=Vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ZT=Vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var YT=Object.freeze({__proto__:null,base64:WT,base64pad:QT,base64url:JT,base64urlpad:ZT});const P1=Array.from(""),XT=P1.reduce((r,e,t)=>(r[t]=e,r),[]),eO=P1.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function tO(r){return r.reduce((e,t)=>(e+=XT[t],e),"")}function rO(r){const e=[];for(const t of r){const n=eO[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const nO=Ff({prefix:"",name:"base256emoji",encode:tO,decode:rO});var sO=Object.freeze({__proto__:null,base256emoji:nO}),iO=T1,i0=128,oO=-128,aO=Math.pow(2,31);function T1(r,e,t){e=e||[],t=t||0;for(var n=t;r>=aO;)e[t++]=r&255|i0,r/=128;for(;r&oO;)e[t++]=r&255|i0,r>>>=7;return e[t]=r|0,T1.bytes=t-n+1,e}var cO=Hg,lO=128,o0=127;function Hg(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw Hg.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&o0)<<s:(o&o0)*Math.pow(2,s),s+=7}while(o>=lO);return Hg.bytes=i-n,t}var uO=Math.pow(2,7),hO=Math.pow(2,14),dO=Math.pow(2,21),fO=Math.pow(2,28),pO=Math.pow(2,35),gO=Math.pow(2,42),mO=Math.pow(2,49),yO=Math.pow(2,56),wO=Math.pow(2,63),bO=function(r){return r<uO?1:r<hO?2:r<dO?3:r<fO?4:r<pO?5:r<gO?6:r<mO?7:r<yO?8:r<wO?9:10},vO={encode:iO,decode:cO,encodingLength:bO},O1=vO;const a0=(r,e,t=0)=>(O1.encode(r,e,t),e),c0=r=>O1.encodingLength(r),qg=(r,e)=>{const t=e.byteLength,n=c0(r),s=n+c0(t),i=new Uint8Array(s+t);return a0(r,i,0),a0(t,i,n),i.set(e,s),new EO(r,t,e,i)};let EO=class{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}};const S1=({name:r,code:e,encode:t})=>new AO(r,e,t);let AO=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?qg(this.code,t):t.then(n=>qg(this.code,n))}else throw Error("Unknown type, must be binary type")}};const R1=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),_O=S1({name:"sha2-256",code:18,encode:R1("SHA-256")}),CO=S1({name:"sha2-512",code:19,encode:R1("SHA-512")});var IO=Object.freeze({__proto__:null,sha256:_O,sha512:CO});const D1=0,NO="identity",k1=N1,xO=r=>qg(D1,k1(r)),PO={code:D1,name:NO,encode:k1,digest:xO};var TO=Object.freeze({__proto__:null,identity:PO});new TextEncoder,new TextDecoder;const l0={...AT,...CT,...NT,...PT,...ST,...jT,...zT,...KT,...YT,...sO};({...IO,...TO});function U1(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const u0=U1("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Dp=U1("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=C1(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),B1={utf8:u0,"utf-8":u0,hex:l0.base16,latin1:Dp,ascii:Dp,binary:Dp,...l0};function jf(r,e="utf8"){const t=B1[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function El(r,e="utf8"){const t=B1[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?by(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function h0(r){return ea(jf(El(r,Mf),A1))}function Zd(r){return jf(El(Ys(r),A1),Mf)}function $1(r){const e=El(cT,s0),t=aT+jf(I1([e,r]),s0);return[iT,oT,t].join(sT)}function OO(r){return jf(r,Mf)}function SO(r){return El(r,Mf)}function RO(r){return El([Zd(r.header),Zd(r.payload)].join(Jd),_1)}function DO(r){return[Zd(r.header),Zd(r.payload),OO(r.signature)].join(Jd)}function zg(r){const e=r.split(Jd),t=h0(e[0]),n=h0(e[1]),s=SO(e[2]),i=El(e.slice(0,2).join(Jd),_1);return{header:t,payload:n,signature:s,data:i}}function d0(r=h1(lT)){const e=E1.getPublicKey(r);return{secretKey:I1([r,e]),publicKey:e}}async function kO(r,e,t,n,s=X.fromMiliseconds(Date.now())){const i={alg:rT,typ:nT},o=$1(n.publicKey),a=s+t,c={iss:o,sub:r,aud:e,iat:s,exp:a},l=RO({header:i,payload:c}),u=E1.sign(l,n.secretKey.slice(0,32));return DO({header:i,payload:c,signature:u})}var f0=function(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))},UO=function(){function r(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"}return r}(),BO=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=hs.platform}return r}(),$O=function(){function r(e,t,n,s){this.name=e,this.version=t,this.os=n,this.bot=s,this.type="bot-device"}return r}(),LO=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),MO=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),FO=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,jO=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,p0=3,HO=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",FO]],g0=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function qO(r){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new MO:typeof navigator<"u"?VO(navigator.userAgent):KO()}function zO(r){return r!==""&&HO.reduce(function(e,t){var n=t[0],s=t[1];if(e)return e;var i=s.exec(r);return!!i&&[n,i]},!1)}function VO(r){var e=zO(r);if(!e)return null;var t=e[0],n=e[1];if(t==="searchbot")return new LO;var s=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);s?s.length<p0&&(s=f0(f0([],s,!0),WO(p0-s.length),!0)):s=[];var i=s.join("."),o=GO(r),a=jO.exec(r);return a&&a[1]?new $O(t,i,o,a[1]):new UO(t,i,o)}function GO(r){for(var e=0,t=g0.length;e<t;e++){var n=g0[e],s=n[0],i=n[1],o=i.exec(r);if(o)return s}return null}function KO(){var r=typeof hs<"u"&&hs.version;return r?new BO(hs.version.slice(1)):null}function WO(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var Qe={},m0;function L1(){if(m0)return Qe;m0=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.getLocalStorage=Qe.getLocalStorageOrThrow=Qe.getCrypto=Qe.getCryptoOrThrow=Qe.getLocation=Qe.getLocationOrThrow=Qe.getNavigator=Qe.getNavigatorOrThrow=Qe.getDocument=Qe.getDocumentOrThrow=Qe.getFromWindowOrThrow=Qe.getFromWindow=void 0;function r(d){let f;return typeof window<"u"&&typeof window[d]<"u"&&(f=window[d]),f}Qe.getFromWindow=r;function e(d){const f=r(d);if(!f)throw new Error(`${d} is not defined in Window`);return f}Qe.getFromWindowOrThrow=e;function t(){return e("document")}Qe.getDocumentOrThrow=t;function n(){return r("document")}Qe.getDocument=n;function s(){return e("navigator")}Qe.getNavigatorOrThrow=s;function i(){return r("navigator")}Qe.getNavigator=i;function o(){return e("location")}Qe.getLocationOrThrow=o;function a(){return r("location")}Qe.getLocation=a;function c(){return e("crypto")}Qe.getCryptoOrThrow=c;function l(){return r("crypto")}Qe.getCrypto=l;function u(){return e("localStorage")}Qe.getLocalStorageOrThrow=u;function h(){return r("localStorage")}return Qe.getLocalStorage=h,Qe}var ta=L1(),Dl={},y0;function QO(){if(y0)return Dl;y0=1,Object.defineProperty(Dl,"__esModule",{value:!0}),Dl.getWindowMetadata=void 0;const r=L1();function e(){let t,n;try{t=r.getDocumentOrThrow(),n=r.getLocationOrThrow()}catch{return null}function s(){const f=t.getElementsByTagName("link"),p=[];for(let m=0;m<f.length;m++){const v=f[m],_=v.getAttribute("rel");if(_&&_.toLowerCase().indexOf("icon")>-1){const y=v.getAttribute("href");if(y)if(y.toLowerCase().indexOf("https:")===-1&&y.toLowerCase().indexOf("http:")===-1&&y.indexOf("//")!==0){let C=n.protocol+"//"+n.host;if(y.indexOf("/")===0)C+=y;else{const U=n.pathname.split("/");U.pop();const L=U.join("/");C+=L+"/"+y}p.push(C)}else if(y.indexOf("//")===0){const C=n.protocol+y;p.push(C)}else p.push(y)}}return p}function i(...f){const p=t.getElementsByTagName("meta");for(let m=0;m<p.length;m++){const v=p[m],_=["itemprop","property","name"].map(y=>v.getAttribute(y)).filter(y=>y?f.includes(y):!1);if(_.length&&_){const y=v.getAttribute("content");if(y)return y}}return""}function o(){let f=i("name","og:site_name","og:title","twitter:title");return f||(f=t.title),f}function a(){return i("description","og:description","twitter:description","keywords")}const c=o(),l=a(),u=n.origin,h=s();return{description:l,url:u,icons:h,name:c}}return Dl.getWindowMetadata=e,Dl}var JO=QO();function gu(r,{strict:e=!0}={}){return!r||typeof r!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(r):r.startsWith("0x")}function w0(r){return gu(r,{strict:!1})?Math.ceil((r.length-2)/2):r.length}const M1="2.23.2";let kl={getDocsUrl:({docsBaseUrl:r,docsPath:e="",docsSlug:t})=>e?`${r??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${M1}`},Hf=class Vg extends Error{constructor(e,t={}){var a;const n=(()=>{var c;return t.cause instanceof Vg?t.cause.details:(c=t.cause)!=null&&c.message?t.cause.message:t.details})(),s=t.cause instanceof Vg&&t.cause.docsPath||t.docsPath,i=(a=kl.getDocsUrl)==null?void 0:a.call(kl,{...t,docsPath:s}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...n?[`Details: ${n}`]:[],...kl.version?[`Version: ${kl.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=M1}walk(e){return F1(this,e)}};function F1(r,e){return e!=null&&e(r)?r:r&&typeof r=="object"&&"cause"in r&&r.cause!==void 0?F1(r.cause,e):e?null:r}let j1=class extends Hf{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}};function Al(r,{dir:e,size:t=32}={}){return typeof r=="string"?ZO(r,{dir:e,size:t}):YO(r,{dir:e,size:t})}function ZO(r,{dir:e,size:t=32}={}){if(t===null)return r;const n=r.replace("0x","");if(n.length>t*2)throw new j1({size:Math.ceil(n.length/2),targetSize:t,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function YO(r,{dir:e,size:t=32}={}){if(t===null)return r;if(r.length>t)throw new j1({size:r.length,targetSize:t,type:"bytes"});const n=new Uint8Array(t);for(let s=0;s<t;s++){const i=e==="right";n[i?s:t-s-1]=r[i?s:r.length-s-1]}return n}let XO=class extends Hf{constructor({max:e,min:t,signed:n,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}},eS=class extends Hf{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function _l(r,{size:e}){if(w0(r)>e)throw new eS({givenSize:w0(r),maxSize:e})}function Gg(r,e={}){const{signed:t}=e;e.size&&_l(r,{size:e.size});const n=BigInt(r);if(!t)return n;const s=(r.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return n<=i?n:n-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function tS(r,e={}){return Number(Gg(r,e))}const rS=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Kg(r,e={}){return typeof r=="number"||typeof r=="bigint"?q1(r,e):typeof r=="string"?iS(r,e):typeof r=="boolean"?nS(r,e):H1(r,e)}function nS(r,e={}){const t=`0x${Number(r)}`;return typeof e.size=="number"?(_l(t,{size:e.size}),Al(t,{size:e.size})):t}function H1(r,e={}){let t="";for(let s=0;s<r.length;s++)t+=rS[r[s]];const n=`0x${t}`;return typeof e.size=="number"?(_l(n,{size:e.size}),Al(n,{dir:"right",size:e.size})):n}function q1(r,e={}){const{signed:t,size:n}=e,s=BigInt(r);let i;n?t?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof r=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&t?-i-1n:0;if(i&&s>i||s<o){const c=typeof r=="bigint"?"n":"";throw new XO({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:t,size:n,value:`${r}${c}`})}const a=`0x${(t&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?Al(a,{size:n}):a}const sS=new TextEncoder;function iS(r,e={}){const t=sS.encode(r);return H1(t,e)}const oS=new TextEncoder;function aS(r,e={}){return typeof r=="number"||typeof r=="bigint"?lS(r,e):typeof r=="boolean"?cS(r,e):gu(r)?z1(r,e):V1(r,e)}function cS(r,e={}){const t=new Uint8Array(1);return t[0]=Number(r),typeof e.size=="number"?(_l(t,{size:e.size}),Al(t,{size:e.size})):t}const vs={zero:48,nine:57,A:65,F:70,a:97,f:102};function b0(r){if(r>=vs.zero&&r<=vs.nine)return r-vs.zero;if(r>=vs.A&&r<=vs.F)return r-(vs.A-10);if(r>=vs.a&&r<=vs.f)return r-(vs.a-10)}function z1(r,e={}){let t=r;e.size&&(_l(t,{size:e.size}),t=Al(t,{dir:"right",size:e.size}));let n=t.slice(2);n.length%2&&(n=`0${n}`);const s=n.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=b0(n.charCodeAt(a++)),l=b0(n.charCodeAt(a++));if(c===void 0||l===void 0)throw new Hf(`Invalid byte sequence ("${n[a-2]}${n[a-1]}" in "${n}").`);i[o]=c*16+l}return i}function lS(r,e){const t=q1(r,e);return z1(t)}function V1(r,e={}){const t=oS.encode(r);return typeof e.size=="number"?(_l(t,{size:e.size}),Al(t,{dir:"right",size:e.size})):t}function v0(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function uS(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function vy(r,...e){if(!uS(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function E0(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function hS(r,e){vy(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Yh=BigInt(2**32-1),A0=BigInt(32);function dS(r,e=!1){return e?{h:Number(r&Yh),l:Number(r>>A0&Yh)}:{h:Number(r>>A0&Yh)|0,l:Number(r&Yh)|0}}function fS(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=dS(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const pS=(r,e,t)=>r<<t|e>>>32-t,gS=(r,e,t)=>e<<t|r>>>32-t,mS=(r,e,t)=>e<<t-32|r>>>64-t,yS=(r,e,t)=>r<<t-32|e>>>64-t;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function wS(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}const _0=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function bS(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function C0(r){for(let e=0;e<r.length;e++)r[e]=bS(r[e])}function vS(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function G1(r){return typeof r=="string"&&(r=vS(r)),vy(r),r}let ES=class{clone(){return this._cloneInto()}};function AS(r){const e=n=>r().update(G1(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}const K1=[],W1=[],Q1=[],_S=BigInt(0),Ul=BigInt(1),CS=BigInt(2),IS=BigInt(7),NS=BigInt(256),xS=BigInt(113);for(let r=0,e=Ul,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],K1.push(2*(5*n+t)),W1.push((r+1)*(r+2)/2%64);let s=_S;for(let i=0;i<7;i++)e=(e<<Ul^(e>>IS)*xS)%NS,e&CS&&(s^=Ul<<(Ul<<BigInt(i))-Ul);Q1.push(s)}const[PS,TS]=fS(Q1,!0),I0=(r,e,t)=>t>32?mS(r,e,t):pS(r,e,t),N0=(r,e,t)=>t>32?yS(r,e,t):gS(r,e,t);function OS(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],h=I0(l,u,1)^t[a],d=N0(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)r[o+f]^=h,r[o+f+1]^=d}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=W1[o],c=I0(s,i,a),l=N0(s,i,a),u=K1[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=PS[n],r[1]^=TS[n]}t.fill(0)}let SS=class J1 extends ES{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,v0(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=wS(this.state)}keccak(){_0||C0(this.state32),OS(this.state32,this.rounds),_0||C0(this.state32),this.posOut=0,this.pos=0}update(e){E0(this);const{blockLen:t,state:n}=this;e=G1(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,(t&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){E0(this,!1),vy(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return v0(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(hS(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new J1(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const RS=(r,e,t)=>AS(()=>new SS(e,r,t)),DS=RS(1,136,256/8);function Z1(r,e){const t=e||"hex",n=DS(gu(r,{strict:!1})?aS(r):r);return t==="bytes"?n:Kg(n)}let kS=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}};const kp=new kS(8192);function US(r,e){if(kp.has(`${r}.${e}`))return kp.get(`${r}.${e}`);const t=r.substring(2).toLowerCase(),n=Z1(V1(t),"bytes"),s=t.split("");for(let o=0;o<40;o+=2)n[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(n[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return kp.set(`${r}.${e}`,i),i}function BS(r){const e=Z1(`0x${r.substring(4)}`).substring(26);return US(`0x${e}`)}async function $S({hash:r,signature:e}){const t=gu(r)?r:Kg(r),{secp256k1:n}=await Xr(async()=>{const{secp256k1:o}=await import("./secp256k1-CawA04_n.js");return{secp256k1:o}},[]);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:h,yParity:d}=e,f=Number(d??h),p=x0(f);return new n.Signature(Gg(l),Gg(u)).addRecoveryBit(p)}const o=gu(e)?e:Kg(e),a=tS(`0x${o.slice(130)}`),c=x0(a);return n.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(t.substring(2)).toHex(!1)}`}function x0(r){if(r===0||r===1)return r;if(r===27)return 0;if(r===28)return 1;throw new Error("Invalid yParityOrV value")}async function LS({hash:r,signature:e}){return BS(await $S({hash:r,signature:e}))}function Y1(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function su(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=Y1(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return t}function MS(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,v=0,_=0,y=p.length;_!==y&&p[_]===0;)_++,m++;for(var C=(y-_)*u+1>>>0,U=new Uint8Array(C);_!==y;){for(var L=p[_],B=0,$=C-1;(L!==0||B<v)&&$!==-1;$--,B++)L+=256*U[$]>>>0,U[$]=L%a>>>0,L=L/a>>>0;if(L!==0)throw new Error("Non-zero carry");v=B,_++}for(var g=C-v;g!==C&&U[g]===0;)g++;for(var b=c.repeat(m);g<C;++g)b+=r.charAt(U[g]);return b}function d(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var v=0,_=0;p[m]===c;)v++,m++;for(var y=(p.length-m)*l+1>>>0,C=new Uint8Array(y);p[m];){var U=t[p.charCodeAt(m)];if(U===255)return;for(var L=0,B=y-1;(U!==0||L<_)&&B!==-1;B--,L++)U+=a*C[B]>>>0,C[B]=U%256>>>0,U=U/256>>>0;if(U!==0)throw new Error("Non-zero carry");_=L,m++}if(p[m]!==" "){for(var $=y-_;$!==y&&C[$]===0;)$++;for(var g=new Uint8Array(v+(y-$)),b=v;$!==y;)g[b++]=C[$++];return g}}}function f(p){var m=d(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var FS=MS,jS=FS;const HS=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},qS=r=>new TextEncoder().encode(r),zS=r=>new TextDecoder().decode(r);class VS{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class GS{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return X1(this,e)}}class KS{constructor(e){this.decoders=e}or(e){return X1(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const X1=(r,e)=>new KS({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class WS{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new VS(e,t,n),this.decoder=new GS(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const qf=({name:r,prefix:e,encode:t,decode:n})=>new WS(r,e,t,n),Oh=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=jS(t,e);return qf({prefix:r,name:e,encode:n,decode:i=>HS(s(i))})},QS=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const h=s[r[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},JS=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},Gt=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>qf({prefix:e,name:r,encode(s){return JS(s,n,t)},decode(s){return QS(s,n,t,r)}}),ZS=qf({prefix:"\0",name:"identity",encode:r=>zS(r),decode:r=>qS(r)}),YS=Object.freeze(Object.defineProperty({__proto__:null,identity:ZS},Symbol.toStringTag,{value:"Module"})),XS=Gt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),eR=Object.freeze(Object.defineProperty({__proto__:null,base2:XS},Symbol.toStringTag,{value:"Module"})),tR=Gt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),rR=Object.freeze(Object.defineProperty({__proto__:null,base8:tR},Symbol.toStringTag,{value:"Module"})),nR=Oh({prefix:"9",name:"base10",alphabet:"0123456789"}),sR=Object.freeze(Object.defineProperty({__proto__:null,base10:nR},Symbol.toStringTag,{value:"Module"})),iR=Gt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),oR=Gt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),aR=Object.freeze(Object.defineProperty({__proto__:null,base16:iR,base16upper:oR},Symbol.toStringTag,{value:"Module"})),cR=Gt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),lR=Gt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),uR=Gt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),hR=Gt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),dR=Gt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),fR=Gt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),pR=Gt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),gR=Gt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),mR=Gt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),yR=Object.freeze(Object.defineProperty({__proto__:null,base32:cR,base32hex:dR,base32hexpad:pR,base32hexpadupper:gR,base32hexupper:fR,base32pad:uR,base32padupper:hR,base32upper:lR,base32z:mR},Symbol.toStringTag,{value:"Module"})),wR=Oh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),bR=Oh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),vR=Object.freeze(Object.defineProperty({__proto__:null,base36:wR,base36upper:bR},Symbol.toStringTag,{value:"Module"})),ER=Oh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),AR=Oh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),_R=Object.freeze(Object.defineProperty({__proto__:null,base58btc:ER,base58flickr:AR},Symbol.toStringTag,{value:"Module"})),CR=Gt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),IR=Gt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),NR=Gt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),xR=Gt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),PR=Object.freeze(Object.defineProperty({__proto__:null,base64:CR,base64pad:IR,base64url:NR,base64urlpad:xR},Symbol.toStringTag,{value:"Module"})),eA=Array.from(""),TR=eA.reduce((r,e,t)=>(r[t]=e,r),[]),OR=eA.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function SR(r){return r.reduce((e,t)=>(e+=TR[t],e),"")}function RR(r){const e=[];for(const t of r){const n=OR[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const DR=qf({prefix:"",name:"base256emoji",encode:SR,decode:RR}),kR=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:DR},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const P0={...YS,...eR,...rR,...sR,...aR,...yR,...vR,..._R,...PR,...kR};function tA(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const T0=tA("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Up=tA("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=Y1(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),rA={utf8:T0,"utf-8":T0,hex:P0.base16,latin1:Up,ascii:Up,binary:Up,...P0};function un(r,e="utf8"){const t=rA[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}function Ir(r,e="utf8"){const t=rA[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}const UR={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var BR={};const $R=":";function nc(r){const[e,t]=r.split($R);return{namespace:e,reference:t}}function nA(r,e){return r.includes(":")?[r]:e.chains||[]}var LR=Object.defineProperty,MR=Object.defineProperties,FR=Object.getOwnPropertyDescriptors,O0=Object.getOwnPropertySymbols,jR=Object.prototype.hasOwnProperty,HR=Object.prototype.propertyIsEnumerable,S0=(r,e,t)=>e in r?LR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,R0=(r,e)=>{for(var t in e||(e={}))jR.call(e,t)&&S0(r,t,e[t]);if(O0)for(var t of O0(e))HR.call(e,t)&&S0(r,t,e[t]);return r},qR=(r,e)=>MR(r,FR(e));const zR="ReactNative",Hr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},VR="js";function Yd(){return typeof hs<"u"&&typeof hs.versions<"u"&&typeof hs.versions.node<"u"}function Wi(){return!ta.getDocument()&&!!ta.getNavigator()&&navigator.product===zR}function GR(){return Wi()&&typeof be<"u"&&typeof(be==null?void 0:be.Platform)<"u"&&(be==null?void 0:be.Platform.OS)==="android"}function KR(){return Wi()&&typeof be<"u"&&typeof(be==null?void 0:be.Platform)<"u"&&(be==null?void 0:be.Platform.OS)==="ios"}function Sh(){return!Yd()&&!!ta.getNavigator()&&!!ta.getDocument()}function Rh(){return Wi()?Hr.reactNative:Yd()?Hr.node:Sh()?Hr.browser:Hr.unknown}function D0(){var r;try{return Wi()&&typeof be<"u"&&typeof(be==null?void 0:be.Application)<"u"?(r=be.Application)==null?void 0:r.applicationId:void 0}catch{return}}function WR(r,e){const t=new URLSearchParams(r);for(const n of Object.keys(e).sort())if(e.hasOwnProperty(n)){const s=e[n];s!==void 0&&t.set(n,s)}return t.toString()}function QR(r){var e,t;const n=sA();try{return r!=null&&r.url&&n.url&&r.url!==n.url&&(console.warn(`The configured WalletConnect 'metadata.url':${r.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),r.url=n.url),(e=r==null?void 0:r.icons)!=null&&e.length&&r.icons.length>0&&(r.icons=r.icons.filter(s=>s!=="")),qR(R0(R0({},n),r),{url:(r==null?void 0:r.url)||n.url,name:(r==null?void 0:r.name)||n.name,description:(r==null?void 0:r.description)||n.description,icons:(t=r==null?void 0:r.icons)!=null&&t.length&&r.icons.length>0?r.icons:n.icons})}catch(s){return console.warn("Error populating app metadata",s),r||n}}function sA(){return JO.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function JR(){if(Rh()===Hr.reactNative&&typeof be<"u"&&typeof(be==null?void 0:be.Platform)<"u"){const{OS:t,Version:n}=be.Platform;return[t,n].join("-")}const r=qO();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function ZR(){var r;const e=Rh();return e===Hr.browser?[e,((r=ta.getLocation())==null?void 0:r.host)||"unknown"].join(":"):e}function iA(r,e,t){const n=JR(),s=ZR();return[[r,e].join("-"),[VR,t].join("-"),n,s].join("/")}function YR({protocol:r,version:e,relayUrl:t,sdkVersion:n,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=t.split("?"),u=iA(r,e,n),h={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},d=WR(l[1]||"",h);return l[0]+"?"+d}function mo(r,e){return r.filter(t=>e.includes(t)).length===r.length}function Wg(r){return Object.fromEntries(r.entries())}function Qg(r){return new Map(Object.entries(r))}function ro(r=X.FIVE_MINUTES,e){const t=X.toMiliseconds(r||X.FIVE_MINUTES);let n,s,i,o;return{resolve:a=>{i&&n&&(clearTimeout(i),n(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},t),n=a,s=c})}}function $i(r,e,t){return new Promise(async(n,s)=>{const i=setTimeout(()=>s(new Error(t)),e);try{const o=await r;n(o)}catch(o){s(o)}clearTimeout(i)})}function oA(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function XR(r){return oA("topic",r)}function eD(r){return oA("id",r)}function aA(r){const[e,t]=r.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")n.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))n.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return n}function _t(r,e){return X.fromMiliseconds(Date.now()+X.toMiliseconds(r))}function fi(r){return Date.now()>=X.toMiliseconds(r)}function ze(r,e){return`${r}${e?`:${e}`:""}`}function Sd(r=[],e=[]){return[...new Set([...r,...e])]}async function tD({id:r,topic:e,wcDeepLink:t}){var n;try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=rD(i,r,e),a=Rh();if(a===Hr.browser){if(!((n=ta.getDocument())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}nD(o)}else a===Hr.reactNative&&typeof(be==null?void 0:be.Linking)<"u"&&await be.Linking.openURL(o)}catch(s){console.error(s)}}function rD(r,e,t){const n=`requestId=${e}&sessionTopic=${t}`;r.endsWith("/")&&(r=r.slice(0,-1));let s=`${r}`;if(r.startsWith("https://t.me")){const i=r.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${aD(n,!0)}`}else s=`${s}/wc?${n}`;return s}function nD(r){let e="_self";oD()?e="_top":(iD()||r.startsWith("https://")||r.startsWith("http://"))&&(e="_blank"),window.open(r,e,"noreferrer noopener")}async function sD(r,e){let t="";try{if(Sh()&&(t=localStorage.getItem(e),t))return t;t=await r.getItem(e)}catch(n){console.error(n)}return t}function k0(r,e){if(!r.includes(e))return null;const t=r.split(/([&,?,=])/),n=t.indexOf(e);return t[n+2]}function U0(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}function Ey(){return typeof hs<"u"&&BR.IS_VITEST==="true"}function iD(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function oD(){try{return window.self!==window.top}catch{return!1}}function aD(r,e=!1){const t=Ut.from(r).toString("base64");return e?t.replace(/[=]/g,""):t}function cA(r){return Ut.from(r,"base64").toString("utf-8")}function cD(r){return new Promise(e=>setTimeout(e,r))}function mu(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function lD(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Dh(r,...e){if(!lD(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Ay(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");mu(r.outputLen),mu(r.blockLen)}function Xc(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function lA(r,e){Dh(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Xh=BigInt(2**32-1),B0=BigInt(32);function uD(r,e=!1){return e?{h:Number(r&Xh),l:Number(r>>B0&Xh)}:{h:Number(r>>B0&Xh)|0,l:Number(r&Xh)|0}}function hD(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=uD(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const dD=(r,e,t)=>r<<t|e>>>32-t,fD=(r,e,t)=>e<<t|r>>>32-t,pD=(r,e,t)=>e<<t-32|r>>>64-t,gD=(r,e,t)=>r<<t-32|e>>>64-t,Ca=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function mD(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function Bp(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function qn(r,e){return r<<32-e|r>>>e}const $0=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function yD(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function L0(r){for(let e=0;e<r.length;e++)r[e]=yD(r[e])}function wD(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function el(r){return typeof r=="string"&&(r=wD(r)),Dh(r),r}function bD(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];Dh(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}let _y=class{clone(){return this._cloneInto()}};function uA(r){const e=n=>r().update(el(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Cl(r=32){if(Ca&&typeof Ca.getRandomValues=="function")return Ca.getRandomValues(new Uint8Array(r));if(Ca&&typeof Ca.randomBytes=="function")return Ca.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}const hA=[],dA=[],fA=[],vD=BigInt(0),Bl=BigInt(1),ED=BigInt(2),AD=BigInt(7),_D=BigInt(256),CD=BigInt(113);for(let r=0,e=Bl,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],hA.push(2*(5*n+t)),dA.push((r+1)*(r+2)/2%64);let s=vD;for(let i=0;i<7;i++)e=(e<<Bl^(e>>AD)*CD)%_D,e&ED&&(s^=Bl<<(Bl<<BigInt(i))-Bl);fA.push(s)}const[ID,ND]=hD(fA,!0),M0=(r,e,t)=>t>32?pD(r,e,t):dD(r,e,t),F0=(r,e,t)=>t>32?gD(r,e,t):fD(r,e,t);function xD(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],h=M0(l,u,1)^t[a],d=F0(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)r[o+f]^=h,r[o+f+1]^=d}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=dA[o],c=M0(s,i,a),l=F0(s,i,a),u=hA[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=ID[n],r[1]^=ND[n]}t.fill(0)}let PD=class pA extends _y{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,mu(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=mD(this.state)}keccak(){$0||L0(this.state32),xD(this.state32,this.rounds),$0||L0(this.state32),this.posOut=0,this.pos=0}update(e){Xc(this);const{blockLen:t,state:n}=this;e=el(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,(t&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Xc(this,!1),Dh(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return mu(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(lA(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new pA(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const TD=(r,e,t)=>uA(()=>new PD(e,r,t)),OD=TD(1,136,256/8),SD="https://rpc.walletconnect.org/v1";function gA(r){const e=`Ethereum Signed Message:
${r.length}`,t=new TextEncoder().encode(e+r);return"0x"+Ut.from(OD(t)).toString("hex")}async function RD(r,e,t,n,s,i){switch(t.t){case"eip191":return await DD(r,e,t.s);case"eip1271":return await kD(r,e,t.s,n,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}async function DD(r,e,t){return(await LS({hash:gA(e),signature:t})).toLowerCase()===r.toLowerCase()}async function kD(r,e,t,n,s,i){const o=nc(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l="0000000000000000000000000000000000000000000000000000000000000041",u=t.substring(2),h=gA(e).substring(2),d=a+h+c+l+u,f=await fetch(`${i||SD}/?chainId=${n}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:UD(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:d},"latest"]})}),{result:p}=await f.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function UD(){return Date.now()+Math.floor(Math.random()*1e3)}function BD(r){const e=atob(r),t=new Uint8Array(e.length);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);const n=t[0];if(n===0)throw new Error("No signatures found");const s=1+n*64;if(t.length<s)throw new Error("Transaction data too short for claimed signature count");if(t.length<100)throw new Error("Transaction too short");const i=Ut.from(r,"base64").slice(1,65);return WE.encode(i)}var $D=Object.defineProperty,LD=Object.defineProperties,MD=Object.getOwnPropertyDescriptors,j0=Object.getOwnPropertySymbols,FD=Object.prototype.hasOwnProperty,jD=Object.prototype.propertyIsEnumerable,H0=(r,e,t)=>e in r?$D(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,HD=(r,e)=>{for(var t in e||(e={}))FD.call(e,t)&&H0(r,t,e[t]);if(j0)for(var t of j0(e))jD.call(e,t)&&H0(r,t,e[t]);return r},qD=(r,e)=>LD(r,MD(e));const zD="did:pkh:",Cy=r=>r==null?void 0:r.split(":"),VD=r=>{const e=r&&Cy(r);if(e)return r.includes(zD)?e[3]:e[1]},Jg=r=>{const e=r&&Cy(r);if(e)return e[2]+":"+e[3]},Xd=r=>{const e=r&&Cy(r);if(e)return e.pop()};async function q0(r){const{cacao:e,projectId:t}=r,{s:n,p:s}=e,i=mA(s,s.iss),o=Xd(s.iss);return await RD(o,i,n,Jg(s.iss),t)}const mA=(r,e)=>{const t=`${r.domain} wants you to sign in with your Ethereum account:`,n=Xd(e);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=r.statement||void 0;const i=`URI: ${r.aud||r.uri}`,o=`Version: ${r.version}`,a=`Chain ID: ${VD(e)}`,c=`Nonce: ${r.nonce}`,l=`Issued At: ${r.iat}`,u=r.exp?`Expiration Time: ${r.exp}`:void 0,h=r.nbf?`Not Before: ${r.nbf}`:void 0,d=r.requestId?`Request ID: ${r.requestId}`:void 0,f=r.resources?`Resources:${r.resources.map(m=>`
- ${m}`).join("")}`:void 0,p=Rd(r.resources);if(p){const m=yu(p);s=e3(s,m)}return[t,n,"",s,"",i,o,a,c,l,u,h,d,f].filter(m=>m!=null).join(`
`)};function GD(r){return Ut.from(JSON.stringify(r)).toString("base64")}function KD(r){return JSON.parse(Ut.from(r,"base64").toString("utf-8"))}function ra(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const e=Object.keys(r.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const n=r.att[t];if(Array.isArray(n))throw new Error(`Resource must be an object: ${t}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(n).forEach(s=>{const i=n[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function WD(r,e,t,n={}){return t==null||t.sort((s,i)=>s.localeCompare(i)),{att:{[r]:QD(e,t,n)}}}function QD(r,e,t={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const n=e.map(s=>({[`${r}/${s}`]:[t]}));return Object.assign({},...n)}function yA(r){return ra(r),`urn:recap:${GD(r).replace(/=/g,"")}`}function yu(r){const e=KD(r.replace("urn:recap:",""));return ra(e),e}function JD(r,e,t){const n=WD(r,e,t);return yA(n)}function ZD(r){return r&&r.includes("urn:recap:")}function YD(r,e){const t=yu(r),n=yu(e),s=XD(t,n);return yA(s)}function XD(r,e){ra(r),ra(e);const t=Object.keys(r.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),n={att:{}};return t.forEach(s=>{var i,o;Object.keys(((i=r.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;n.att[s]=qD(HD({},n.att[s]),{[a]:((c=r.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),n}function e3(r="",e){ra(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(t))return r;const n=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(h=>({ability:h.split("/")[0],action:h.split("/")[1]}));c.sort((h,d)=>h.action.localeCompare(d.action));const l={};c.forEach(h=>{l[h.ability]||(l[h.ability]=[]),l[h.ability].push(h.action)});const u=Object.keys(l).map(h=>(s++,`(${s}) '${h}': '${l[h].join("', '")}' for '${a}'.`));n.push(u.join(", ").replace(".,","."))});const i=n.join(" "),o=`${t}${i}`;return`${r?r+" ":""}${o}`}function z0(r){var e;const t=yu(r);ra(t);const n=(e=t.att)==null?void 0:e.eip155;return n?Object.keys(n).map(s=>s.split("/")[1]):[]}function V0(r){const e=yu(r);ra(e);const t=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&t.push(s[0].chains)})}),[...new Set(t.flat())]}function Rd(r){if(!r)return;const e=r==null?void 0:r[r.length-1];return ZD(e)?e:void 0}function $p(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function wA(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Fr(r,...e){if(!wA(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function G0(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function t3(r,e){Fr(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function K0(r){if(typeof r!="boolean")throw new Error(`boolean expected, not ${r}`)}const Fi=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),r3=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),n3=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!n3)throw new Error("Non little-endian hardware is not supported");function s3(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function Zg(r){if(typeof r=="string")r=s3(r);else if(wA(r))r=Yg(r);else throw new Error("Uint8Array expected, got "+typeof r);return r}function i3(r,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(r,e)}function o3(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}const a3=(r,e)=>{function t(n,...s){if(Fr(n),r.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");r.varSizeNonce?Fr(l):Fr(l,r.nonceLength)}const i=r.tagLength;i&&s[1]!==void 0&&Fr(s[1]);const o=e(n,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");Fr(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Fr(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(Fr(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(t,r),t};function W0(r,e,t=!0){if(e===void 0)return new Uint8Array(r);if(e.length!==r)throw new Error("invalid output length, expected "+r+", got: "+e.length);if(t&&!c3(e))throw new Error("invalid output, must be aligned");return e}function Q0(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i);r.setUint32(e+4,o,n),r.setUint32(e+0,a,n)}function c3(r){return r.byteOffset%4===0}function Yg(r){return Uint8Array.from(r)}function tl(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}const bA=r=>Uint8Array.from(r.split("").map(e=>e.charCodeAt(0))),l3=bA("expand 16-byte k"),u3=bA("expand 32-byte k"),h3=Fi(l3),d3=Fi(u3);function Le(r,e){return r<<e|r>>>32-e}function Xg(r){return r.byteOffset%4===0}const ed=64,f3=16,vA=2**32-1,J0=new Uint32Array;function p3(r,e,t,n,s,i,o,a){const c=s.length,l=new Uint8Array(ed),u=Fi(l),h=Xg(s)&&Xg(i),d=h?Fi(s):J0,f=h?Fi(i):J0;for(let p=0;p<c;o++){if(r(e,t,n,u,o,a),o>=vA)throw new Error("arx: counter overflow");const m=Math.min(ed,c-p);if(h&&m===ed){const v=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let _=0,y;_<f3;_++)y=v+_,f[y]=d[y]^u[_];p+=ed;continue}for(let v=0,_;v<m;v++)_=p+v,i[_]=s[_]^l[v];p+=m}}function g3(r,e){const{allowShortKeys:t,extendNonceFn:n,counterLength:s,counterRight:i,rounds:o}=i3({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof r!="function")throw new Error("core must be a function");return $p(s),$p(o),K0(i),K0(t),(a,c,l,u,h=0)=>{Fr(a),Fr(c),Fr(l);const d=l.length;if(u===void 0&&(u=new Uint8Array(d)),Fr(u),$p(h),h<0||h>=vA)throw new Error("arx: counter overflow");if(u.length<d)throw new Error(`arx: output (${u.length}) is shorter than data (${d})`);const f=[];let p=a.length,m,v;if(p===32)f.push(m=Yg(a)),v=d3;else if(p===16&&t)m=new Uint8Array(32),m.set(a),m.set(a,16),v=h3,f.push(m);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);Xg(c)||f.push(c=Yg(c));const _=Fi(m);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(v,_,Fi(c.subarray(0,16)),_),c=c.subarray(16)}const y=16-s;if(y!==c.length)throw new Error(`arx: nonce must be ${y} or 16 bytes`);if(y!==12){const U=new Uint8Array(12);U.set(c,i?0:12-c.length),c=U,f.push(c)}const C=Fi(c);return p3(r,v,_,C,l,u,h,o),tl(...f),u}}const Bt=(r,e)=>r[e++]&255|(r[e++]&255)<<8;class m3{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Zg(e),Fr(e,32);const t=Bt(e,0),n=Bt(e,2),s=Bt(e,4),i=Bt(e,6),o=Bt(e,8),a=Bt(e,10),c=Bt(e,12),l=Bt(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Bt(e,16+2*u)}process(e,t,n=!1){const s=n?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],h=o[4],d=o[5],f=o[6],p=o[7],m=o[8],v=o[9],_=Bt(e,t+0),y=Bt(e,t+2),C=Bt(e,t+4),U=Bt(e,t+6),L=Bt(e,t+8),B=Bt(e,t+10),$=Bt(e,t+12),g=Bt(e,t+14);let b=i[0]+(_&8191),N=i[1]+((_>>>13|y<<3)&8191),x=i[2]+((y>>>10|C<<6)&8191),I=i[3]+((C>>>7|U<<9)&8191),D=i[4]+((U>>>4|L<<12)&8191),S=i[5]+(L>>>1&8191),E=i[6]+((L>>>14|B<<2)&8191),A=i[7]+((B>>>11|$<<5)&8191),T=i[8]+(($>>>8|g<<8)&8191),O=i[9]+(g>>>5|s),k=0,j=k+b*a+N*(5*v)+x*(5*m)+I*(5*p)+D*(5*f);k=j>>>13,j&=8191,j+=S*(5*d)+E*(5*h)+A*(5*u)+T*(5*l)+O*(5*c),k+=j>>>13,j&=8191;let q=k+b*c+N*a+x*(5*v)+I*(5*m)+D*(5*p);k=q>>>13,q&=8191,q+=S*(5*f)+E*(5*d)+A*(5*h)+T*(5*u)+O*(5*l),k+=q>>>13,q&=8191;let z=k+b*l+N*c+x*a+I*(5*v)+D*(5*m);k=z>>>13,z&=8191,z+=S*(5*p)+E*(5*f)+A*(5*d)+T*(5*h)+O*(5*u),k+=z>>>13,z&=8191;let Q=k+b*u+N*l+x*c+I*a+D*(5*v);k=Q>>>13,Q&=8191,Q+=S*(5*m)+E*(5*p)+A*(5*f)+T*(5*d)+O*(5*h),k+=Q>>>13,Q&=8191;let J=k+b*h+N*u+x*l+I*c+D*a;k=J>>>13,J&=8191,J+=S*(5*v)+E*(5*m)+A*(5*p)+T*(5*f)+O*(5*d),k+=J>>>13,J&=8191;let Z=k+b*d+N*h+x*u+I*l+D*c;k=Z>>>13,Z&=8191,Z+=S*a+E*(5*v)+A*(5*m)+T*(5*p)+O*(5*f),k+=Z>>>13,Z&=8191;let te=k+b*f+N*d+x*h+I*u+D*l;k=te>>>13,te&=8191,te+=S*c+E*a+A*(5*v)+T*(5*m)+O*(5*p),k+=te>>>13,te&=8191;let re=k+b*p+N*f+x*d+I*h+D*u;k=re>>>13,re&=8191,re+=S*l+E*c+A*a+T*(5*v)+O*(5*m),k+=re>>>13,re&=8191;let pe=k+b*m+N*p+x*f+I*d+D*h;k=pe>>>13,pe&=8191,pe+=S*u+E*l+A*c+T*a+O*(5*v),k+=pe>>>13,pe&=8191;let ge=k+b*v+N*m+x*p+I*f+D*d;k=ge>>>13,ge&=8191,ge+=S*h+E*u+A*l+T*c+O*a,k+=ge>>>13,ge&=8191,k=(k<<2)+k|0,k=k+j|0,j=k&8191,k=k>>>13,q+=k,i[0]=j,i[1]=q,i[2]=z,i[3]=Q,i[4]=J,i[5]=Z,i[6]=te,i[7]=re,i[8]=pe,i[9]=ge}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,n[0]=e[0]+5,s=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+s,s=n[a]>>>13,n[a]&=8191;n[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)n[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+t[a]|0)+(o>>>16)|0,e[a]=o&65535;tl(n)}update(e){G0(this);const{buffer:t,blockLen:n}=this;e=Zg(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o===n){for(;n<=s-i;i+=n)this.process(e,i);continue}t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){tl(this.h,this.r,this.buffer,this.pad)}digestInto(e){G0(this),t3(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:s}=this;if(s){for(t[s++]=1;s<16;s++)t[s]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}function y3(r){const e=(n,s)=>r(s).update(Zg(n)).digest(),t=r(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>r(n),e}const w3=y3(r=>new m3(r));function b3(r,e,t,n,s,i=20){let o=r[0],a=r[1],c=r[2],l=r[3],u=e[0],h=e[1],d=e[2],f=e[3],p=e[4],m=e[5],v=e[6],_=e[7],y=s,C=t[0],U=t[1],L=t[2],B=o,$=a,g=c,b=l,N=u,x=h,I=d,D=f,S=p,E=m,A=v,T=_,O=y,k=C,j=U,q=L;for(let Q=0;Q<i;Q+=2)B=B+N|0,O=Le(O^B,16),S=S+O|0,N=Le(N^S,12),B=B+N|0,O=Le(O^B,8),S=S+O|0,N=Le(N^S,7),$=$+x|0,k=Le(k^$,16),E=E+k|0,x=Le(x^E,12),$=$+x|0,k=Le(k^$,8),E=E+k|0,x=Le(x^E,7),g=g+I|0,j=Le(j^g,16),A=A+j|0,I=Le(I^A,12),g=g+I|0,j=Le(j^g,8),A=A+j|0,I=Le(I^A,7),b=b+D|0,q=Le(q^b,16),T=T+q|0,D=Le(D^T,12),b=b+D|0,q=Le(q^b,8),T=T+q|0,D=Le(D^T,7),B=B+x|0,q=Le(q^B,16),A=A+q|0,x=Le(x^A,12),B=B+x|0,q=Le(q^B,8),A=A+q|0,x=Le(x^A,7),$=$+I|0,O=Le(O^$,16),T=T+O|0,I=Le(I^T,12),$=$+I|0,O=Le(O^$,8),T=T+O|0,I=Le(I^T,7),g=g+D|0,k=Le(k^g,16),S=S+k|0,D=Le(D^S,12),g=g+D|0,k=Le(k^g,8),S=S+k|0,D=Le(D^S,7),b=b+N|0,j=Le(j^b,16),E=E+j|0,N=Le(N^E,12),b=b+N|0,j=Le(j^b,8),E=E+j|0,N=Le(N^E,7);let z=0;n[z++]=o+B|0,n[z++]=a+$|0,n[z++]=c+g|0,n[z++]=l+b|0,n[z++]=u+N|0,n[z++]=h+x|0,n[z++]=d+I|0,n[z++]=f+D|0,n[z++]=p+S|0,n[z++]=m+E|0,n[z++]=v+A|0,n[z++]=_+T|0,n[z++]=y+O|0,n[z++]=C+k|0,n[z++]=U+j|0,n[z++]=L+q|0}const v3=g3(b3,{counterRight:!1,counterLength:4,allowShortKeys:!1}),E3=new Uint8Array(16),Z0=(r,e)=>{r.update(e);const t=e.length%16;t&&r.update(E3.subarray(t))},A3=new Uint8Array(32);function Y0(r,e,t,n,s){const i=r(e,t,A3),o=w3.create(i);s&&Z0(o,s),Z0(o,n);const a=new Uint8Array(16),c=r3(a);Q0(c,0,BigInt(s?s.length:0),!0),Q0(c,8,BigInt(n.length),!0),o.update(a);const l=o.digest();return tl(i,a),l}const _3=r=>(e,t,n)=>({encrypt(s,i){const o=s.length;i=W0(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);r(e,t,a,a,1);const c=Y0(r,e,t,a,n);return i.set(c,o),tl(c),i},decrypt(s,i){i=W0(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=Y0(r,e,t,o,n);if(!o3(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),r(e,t,i,i,1),tl(c),i}}),EA=a3({blockSize:64,nonceLength:12,tagLength:16},_3(v3));let AA=class extends _y{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Ay(e);const n=el(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return Xc(this),this.iHash.update(e),this}digestInto(e){Xc(this),Dh(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const zf=(r,e,t)=>new AA(r,e).update(t).digest();zf.create=(r,e)=>new AA(r,e);function C3(r,e,t){return Ay(r),t===void 0&&(t=new Uint8Array(r.outputLen)),zf(r,el(t),el(e))}const Lp=new Uint8Array([0]),X0=new Uint8Array;function I3(r,e,t,n=32){if(Ay(r),mu(n),n>255*r.outputLen)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(n/r.outputLen);t===void 0&&(t=X0);const i=new Uint8Array(s*r.outputLen),o=zf.create(r,e),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let l=0;l<s;l++)Lp[0]=l+1,a.update(l===0?X0:c).update(t).update(Lp).digestInto(c),i.set(c,r.outputLen*l),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),Lp.fill(0),i.slice(0,n)}const N3=(r,e,t,n,s)=>I3(r,C3(r,e,t),n,s);function x3(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}function P3(r,e,t){return r&e^~r&t}function T3(r,e,t){return r&e^r&t^e&t}let O3=class extends _y{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Bp(this.buffer)}update(e){Xc(this);const{view:t,buffer:n,blockLen:s}=this;e=el(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Bp(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Xc(this),lA(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;x3(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Bp(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}};const S3=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),si=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ii=new Uint32Array(64);class R3 extends O3{constructor(){super(64,32,8,!1),this.A=si[0]|0,this.B=si[1]|0,this.C=si[2]|0,this.D=si[3]|0,this.E=si[4]|0,this.F=si[5]|0,this.G=si[6]|0,this.H=si[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)ii[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const d=ii[h-15],f=ii[h-2],p=qn(d,7)^qn(d,18)^d>>>3,m=qn(f,17)^qn(f,19)^f>>>10;ii[h]=m+ii[h-7]+p+ii[h-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let h=0;h<64;h++){const d=qn(a,6)^qn(a,11)^qn(a,25),f=u+d+P3(a,c,l)+S3[h]+ii[h]|0,p=(qn(n,2)^qn(n,13)^qn(n,22))+T3(n,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=n,n=f+p|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){ii.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const kh=uA(()=>new R3);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Vf=BigInt(0),Gf=BigInt(1),D3=BigInt(2);function na(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Uh(r){if(!na(r))throw new Error("Uint8Array expected")}function rl(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const k3=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function nl(r){Uh(r);let e="";for(let t=0;t<r.length;t++)e+=k3[r[t]];return e}function Qa(r){const e=r.toString(16);return e.length&1?"0"+e:e}function Iy(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?Vf:BigInt("0x"+r)}const Es={_0:48,_9:57,A:65,F:70,a:97,f:102};function eb(r){if(r>=Es._0&&r<=Es._9)return r-Es._0;if(r>=Es.A&&r<=Es.F)return r-(Es.A-10);if(r>=Es.a&&r<=Es.f)return r-(Es.a-10)}function sl(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=eb(r.charCodeAt(i)),a=eb(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function Ko(r){return Iy(nl(r))}function wu(r){return Uh(r),Iy(nl(Uint8Array.from(r).reverse()))}function il(r,e){return sl(r.toString(16).padStart(e*2,"0"))}function Kf(r,e){return il(r,e).reverse()}function U3(r){return sl(Qa(r))}function Mr(r,e,t){let n;if(typeof e=="string")try{n=sl(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(na(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function bu(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];Uh(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}function B3(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}function $3(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}const Mp=r=>typeof r=="bigint"&&Vf<=r;function Wf(r,e,t){return Mp(r)&&Mp(e)&&Mp(t)&&e<=r&&r<t}function Ks(r,e,t,n){if(!Wf(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function _A(r){let e;for(e=0;r>Vf;r>>=Gf,e+=1);return e}function L3(r,e){return r>>BigInt(e)&Gf}function M3(r,e,t){return r|(t?Gf:Vf)<<BigInt(e)}const Ny=r=>(D3<<BigInt(r-1))-Gf,Fp=r=>new Uint8Array(r),tb=r=>Uint8Array.from(r);function CA(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=Fp(r),s=Fp(r),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...u)=>t(s,n,...u),c=(u=Fp())=>{s=a(tb([0]),u),n=a(),u.length!==0&&(s=a(tb([1]),u),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const h=[];for(;u<e;){n=a();const d=n.slice();h.push(d),u+=n.length}return bu(...h)};return(u,h)=>{o(),c(u);let d;for(;!(d=h(l()));)c();return o(),d}}const F3={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||na(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Il(r,e,t={}){const n=(s,i,o)=>{const a=F3[i];if(typeof a!="function")throw new Error("invalid validator function");const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}const j3=()=>{throw new Error("not implemented")};function em(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}var H3=Object.freeze({__proto__:null,isBytes:na,abytes:Uh,abool:rl,bytesToHex:nl,numberToHexUnpadded:Qa,hexToNumber:Iy,hexToBytes:sl,bytesToNumberBE:Ko,bytesToNumberLE:wu,numberToBytesBE:il,numberToBytesLE:Kf,numberToVarBytesBE:U3,ensureBytes:Mr,concatBytes:bu,equalBytes:B3,utf8ToBytes:$3,inRange:Wf,aInRange:Ks,bitLen:_A,bitGet:L3,bitSet:M3,bitMask:Ny,createHmacDrbg:CA,validateObject:Il,notImplemented:j3,memoized:em});const Dt=BigInt(0),mt=BigInt(1),ao=BigInt(2),q3=BigInt(3),tm=BigInt(4),rb=BigInt(5),nb=BigInt(8);function Ar(r,e){const t=r%e;return t>=Dt?t:e+t}function IA(r,e,t){if(e<Dt)throw new Error("invalid exponent, negatives unsupported");if(t<=Dt)throw new Error("invalid modulus");if(t===mt)return Dt;let n=mt;for(;e>Dt;)e&mt&&(n=n*r%t),r=r*r%t,e>>=mt;return n}function bn(r,e,t){let n=r;for(;e-- >Dt;)n*=n,n%=t;return n}function rm(r,e){if(r===Dt)throw new Error("invert: expected non-zero number");if(e<=Dt)throw new Error("invert: expected positive modulus, got "+e);let t=Ar(r,e),n=e,s=Dt,i=mt;for(;t!==Dt;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==mt)throw new Error("invert: does not exist");return Ar(s,e)}function z3(r){const e=(r-mt)/ao;let t,n,s;for(t=r-mt,n=0;t%ao===Dt;t/=ao,n++);for(s=ao;s<r&&IA(s,e,r)!==r-mt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(r+mt)/tm;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(t+mt)/ao;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,l=o.pow(o.mul(o.ONE,s),t),u=o.pow(a,i),h=o.pow(a,t);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let d=1;for(let p=o.sqr(h);d<c&&!o.eql(p,o.ONE);d++)p=o.sqr(p);const f=o.pow(l,mt<<BigInt(c-d-1));l=o.sqr(f),u=o.mul(u,f),h=o.mul(h,l),c=d}return u}}function V3(r){if(r%tm===q3){const e=(r+mt)/tm;return function(t,n){const s=t.pow(n,e);if(!t.eql(t.sqr(s),n))throw new Error("Cannot find square root");return s}}if(r%nb===rb){const e=(r-rb)/nb;return function(t,n){const s=t.mul(n,ao),i=t.pow(s,e),o=t.mul(n,i),a=t.mul(t.mul(o,ao),i),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return z3(r)}const G3=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function K3(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=G3.reduce((n,s)=>(n[s]="function",n),e);return Il(r,t)}function W3(r,e,t){if(t<Dt)throw new Error("invalid exponent, negatives unsupported");if(t===Dt)return r.ONE;if(t===mt)return e;let n=r.ONE,s=e;for(;t>Dt;)t&mt&&(n=r.mul(n,s)),s=r.sqr(s),t>>=mt;return n}function Q3(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function NA(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function xA(r,e,t=!1,n={}){if(r<=Dt)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:i}=NA(r,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:s,BYTES:i,MASK:Ny(s),ZERO:Dt,ONE:mt,create:c=>Ar(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Dt<=c&&c<r},is0:c=>c===Dt,isOdd:c=>(c&mt)===mt,neg:c=>Ar(-c,r),eql:(c,l)=>c===l,sqr:c=>Ar(c*c,r),add:(c,l)=>Ar(c+l,r),sub:(c,l)=>Ar(c-l,r),mul:(c,l)=>Ar(c*l,r),pow:(c,l)=>W3(a,c,l),div:(c,l)=>Ar(c*rm(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>rm(c,r),sqrt:n.sqrt||(c=>(o||(o=V3(r)),o(a,c))),invertBatch:c=>Q3(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?Kf(c,i):il(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?wu(c):Ko(c)}});return Object.freeze(a)}function PA(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function TA(r){const e=PA(r);return e+Math.ceil(e/2)}function J3(r,e,t=!1){const n=r.length,s=PA(e),i=TA(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=t?wu(r):Ko(r),a=Ar(o,e-mt)+mt;return t?Kf(a,s):il(a,s)}const sb=BigInt(0),td=BigInt(1);function jp(r,e){const t=e.negate();return r?t:e}function OA(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function Hp(r,e){OA(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function Z3(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function Y3(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const qp=new WeakMap,SA=new WeakMap;function zp(r){return SA.get(r)||1}function X3(r,e){return{constTimeNegate:jp,hasPrecomputes(t){return zp(t)!==1},unsafeLadder(t,n,s=r.ZERO){let i=t;for(;n>sb;)n&td&&(s=s.add(i)),i=i.double(),n>>=td;return s},precomputeWindow(t,n){const{windows:s,windowSize:i}=Hp(n,e),o=[];let a=t,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,s){const{windows:i,windowSize:o}=Hp(t,e);let a=r.ZERO,c=r.BASE;const l=BigInt(2**t-1),u=2**t,h=BigInt(t);for(let d=0;d<i;d++){const f=d*o;let p=Number(s&l);s>>=h,p>o&&(p-=u,s+=td);const m=f,v=f+Math.abs(p)-1,_=d%2!==0,y=p<0;p===0?c=c.add(jp(_,n[m])):a=a.add(jp(y,n[v]))}return{p:a,f:c}},wNAFUnsafe(t,n,s,i=r.ZERO){const{windows:o,windowSize:a}=Hp(t,e),c=BigInt(2**t-1),l=2**t,u=BigInt(t);for(let h=0;h<o;h++){const d=h*a;if(s===sb)break;let f=Number(s&c);if(s>>=u,f>a&&(f-=l,s+=td),f===0)continue;let p=n[d+Math.abs(f)-1];f<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(t,n,s){let i=qp.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&qp.set(n,s(i))),i},wNAFCached(t,n,s){const i=zp(t);return this.wNAF(i,this.getPrecomputes(i,t,s),n)},wNAFCachedUnsafe(t,n,s,i){const o=zp(t);return o===1?this.unsafeLadder(t,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),n,i)},setWindowSize(t,n){OA(n,e),SA.set(t,n),qp.delete(t)}}}function ek(r,e,t,n){if(Z3(t,r),Y3(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=r.ZERO,i=_A(BigInt(t.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let h=l;h>=0;h-=o){c.fill(s);for(let f=0;f<n.length;f++){const p=n[f],m=Number(p>>BigInt(h)&BigInt(a));c[m]=c[m].add(t[f])}let d=s;for(let f=c.length-1,p=s;f>0;f--)p=p.add(c[f]),d=d.add(p);if(u=u.add(d),h!==0)for(let f=0;f<o;f++)u=u.double()}return u}function RA(r){return K3(r.Fp),Il(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...NA(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Ia=BigInt(0),Vp=BigInt(1);function tk(r){return Il(r,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...r})}function rk(r){const e=tk(r),{P:t}=e,n=y=>Ar(y,t),s=e.montgomeryBits,i=Math.ceil(s/8),o=e.nByteLength,a=e.adjustScalarBytes||(y=>y),c=e.powPminus2||(y=>IA(y,t-BigInt(2),t));function l(y,C,U){const L=n(y*(C-U));return C=n(C-L),U=n(U+L),[C,U]}const u=(e.a-BigInt(2))/BigInt(4);function h(y,C){Ks("u",y,Ia,t),Ks("scalar",C,Ia,t);const U=C,L=y;let B=Vp,$=Ia,g=y,b=Vp,N=Ia,x;for(let D=BigInt(s-1);D>=Ia;D--){const S=U>>D&Vp;N^=S,x=l(N,B,g),B=x[0],g=x[1],x=l(N,$,b),$=x[0],b=x[1],N=S;const E=B+$,A=n(E*E),T=B-$,O=n(T*T),k=A-O,j=g+b,q=g-b,z=n(q*E),Q=n(j*T),J=z+Q,Z=z-Q;g=n(J*J),b=n(L*n(Z*Z)),B=n(A*O),$=n(k*(A+n(u*k)))}x=l(N,B,g),B=x[0],g=x[1],x=l(N,$,b),$=x[0],b=x[1];const I=c($);return n(B*I)}function d(y){return Kf(n(y),i)}function f(y){const C=Mr("u coordinate",y,i);return o===32&&(C[31]&=127),wu(C)}function p(y){const C=Mr("scalar",y),U=C.length;if(U!==i&&U!==o){let L=""+i+" or "+o;throw new Error("invalid scalar, expected "+L+" bytes, got "+U)}return wu(a(C))}function m(y,C){const U=f(C),L=p(y),B=h(U,L);if(B===Ia)throw new Error("invalid private or public key received");return d(B)}const v=d(e.Gu);function _(y){return m(y,v)}return{scalarMult:m,scalarMultBase:_,getSharedSecret:(y,C)=>m(y,C),getPublicKey:y=>_(y),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:v}}const nm=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const nk=BigInt(1),ib=BigInt(2),sk=BigInt(3),ik=BigInt(5);BigInt(8);function ok(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=nm,o=r*r%i*r%i,a=bn(o,ib,i)*o%i,c=bn(a,nk,i)*r%i,l=bn(c,ik,i)*c%i,u=bn(l,e,i)*l%i,h=bn(u,t,i)*u%i,d=bn(h,n,i)*h%i,f=bn(d,s,i)*d%i,p=bn(f,s,i)*d%i,m=bn(p,e,i)*l%i;return{pow_p_5_8:bn(m,ib,i)*r%i,b2:o}}function ak(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}const sm=rk({P:nm,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:r=>{const e=nm,{pow_p_5_8:t,b2:n}=ok(r);return Ar(bn(t,sk,e)*n,e)},adjustScalarBytes:ak,randomBytes:Cl});function ob(r){r.lowS!==void 0&&rl("lowS",r.lowS),r.prehash!==void 0&&rl("prehash",r.prehash)}function ck(r){const e=RA(r);Il(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:lk,hexToBytes:uk}=H3;class hk extends Error{constructor(e=""){super(e)}}const Os={Err:hk,_tlv:{encode:(r,e)=>{const{Err:t}=Os;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const n=e.length/2,s=Qa(n);if(s.length/2&128)throw new t("tlv.encode: long form length too big");const i=n>127?Qa(s.length/2|128):"";return Qa(r)+i+s+e},decode(r,e){const{Err:t}=Os;let n=0;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[n++]!==r)throw new t("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new t("tlv.decode(long): indefinite length not supported");if(c>4)throw new t("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new t("tlv.decode: length bytes not complete");if(l[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new t("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(r){const{Err:e}=Os;if(r<zs)throw new e("integer: negative integers are not allowed");let t=Qa(r);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(r){const{Err:e}=Os;if(r[0]&128)throw new e("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return lk(r)}},toSig(r){const{Err:e,_int:t,_tlv:n}=Os,s=typeof r=="string"?uk(r):r;Uh(s);const{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(l)}},hexFromSig(r){const{_tlv:e,_int:t}=Os,n=e.encode(2,t.encode(r.r)),s=e.encode(2,t.encode(r.s)),i=n+s;return e.encode(48,i)}},zs=BigInt(0),Tt=BigInt(1);BigInt(2);const ab=BigInt(3);BigInt(4);function dk(r){const e=ck(r),{Fp:t}=e,n=xA(e.n,e.nBitLength),s=e.toBytes||((m,v,_)=>{const y=v.toAffine();return bu(Uint8Array.from([4]),t.toBytes(y.x),t.toBytes(y.y))}),i=e.fromBytes||(m=>{const v=m.subarray(1),_=t.fromBytes(v.subarray(0,t.BYTES)),y=t.fromBytes(v.subarray(t.BYTES,2*t.BYTES));return{x:_,y}});function o(m){const{a:v,b:_}=e,y=t.sqr(m),C=t.mul(y,m);return t.add(t.add(C,t.mul(m,v)),_)}if(!t.eql(t.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(m){return Wf(m,Tt,e.n)}function c(m){const{allowedPrivateKeyLengths:v,nByteLength:_,wrapPrivateKey:y,n:C}=e;if(v&&typeof m!="bigint"){if(na(m)&&(m=nl(m)),typeof m!="string"||!v.includes(m.length))throw new Error("invalid private key");m=m.padStart(_*2,"0")}let U;try{U=typeof m=="bigint"?m:Ko(Mr("private key",m,_))}catch{throw new Error("invalid private key, expected hex or "+_+" bytes, got "+typeof m)}return y&&(U=Ar(U,C)),Ks("private key",U,Tt,C),U}function l(m){if(!(m instanceof d))throw new Error("ProjectivePoint expected")}const u=em((m,v)=>{const{px:_,py:y,pz:C}=m;if(t.eql(C,t.ONE))return{x:_,y};const U=m.is0();v==null&&(v=U?t.ONE:t.inv(C));const L=t.mul(_,v),B=t.mul(y,v),$=t.mul(C,v);if(U)return{x:t.ZERO,y:t.ZERO};if(!t.eql($,t.ONE))throw new Error("invZ was invalid");return{x:L,y:B}}),h=em(m=>{if(m.is0()){if(e.allowInfinityPoint&&!t.is0(m.py))return;throw new Error("bad point: ZERO")}const{x:v,y:_}=m.toAffine();if(!t.isValid(v)||!t.isValid(_))throw new Error("bad point: x or y not FE");const y=t.sqr(_),C=o(v);if(!t.eql(y,C))throw new Error("bad point: equation left != right");if(!m.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class d{constructor(v,_,y){if(this.px=v,this.py=_,this.pz=y,v==null||!t.isValid(v))throw new Error("x required");if(_==null||!t.isValid(_))throw new Error("y required");if(y==null||!t.isValid(y))throw new Error("z required");Object.freeze(this)}static fromAffine(v){const{x:_,y}=v||{};if(!v||!t.isValid(_)||!t.isValid(y))throw new Error("invalid affine point");if(v instanceof d)throw new Error("projective point not allowed");const C=U=>t.eql(U,t.ZERO);return C(_)&&C(y)?d.ZERO:new d(_,y,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(v){const _=t.invertBatch(v.map(y=>y.pz));return v.map((y,C)=>y.toAffine(_[C])).map(d.fromAffine)}static fromHex(v){const _=d.fromAffine(i(Mr("pointHex",v)));return _.assertValidity(),_}static fromPrivateKey(v){return d.BASE.multiply(c(v))}static msm(v,_){return ek(d,n,v,_)}_setWindowSize(v){p.setWindowSize(this,v)}assertValidity(){h(this)}hasEvenY(){const{y:v}=this.toAffine();if(t.isOdd)return!t.isOdd(v);throw new Error("Field doesn't support isOdd")}equals(v){l(v);const{px:_,py:y,pz:C}=this,{px:U,py:L,pz:B}=v,$=t.eql(t.mul(_,B),t.mul(U,C)),g=t.eql(t.mul(y,B),t.mul(L,C));return $&&g}negate(){return new d(this.px,t.neg(this.py),this.pz)}double(){const{a:v,b:_}=e,y=t.mul(_,ab),{px:C,py:U,pz:L}=this;let B=t.ZERO,$=t.ZERO,g=t.ZERO,b=t.mul(C,C),N=t.mul(U,U),x=t.mul(L,L),I=t.mul(C,U);return I=t.add(I,I),g=t.mul(C,L),g=t.add(g,g),B=t.mul(v,g),$=t.mul(y,x),$=t.add(B,$),B=t.sub(N,$),$=t.add(N,$),$=t.mul(B,$),B=t.mul(I,B),g=t.mul(y,g),x=t.mul(v,x),I=t.sub(b,x),I=t.mul(v,I),I=t.add(I,g),g=t.add(b,b),b=t.add(g,b),b=t.add(b,x),b=t.mul(b,I),$=t.add($,b),x=t.mul(U,L),x=t.add(x,x),b=t.mul(x,I),B=t.sub(B,b),g=t.mul(x,N),g=t.add(g,g),g=t.add(g,g),new d(B,$,g)}add(v){l(v);const{px:_,py:y,pz:C}=this,{px:U,py:L,pz:B}=v;let $=t.ZERO,g=t.ZERO,b=t.ZERO;const N=e.a,x=t.mul(e.b,ab);let I=t.mul(_,U),D=t.mul(y,L),S=t.mul(C,B),E=t.add(_,y),A=t.add(U,L);E=t.mul(E,A),A=t.add(I,D),E=t.sub(E,A),A=t.add(_,C);let T=t.add(U,B);return A=t.mul(A,T),T=t.add(I,S),A=t.sub(A,T),T=t.add(y,C),$=t.add(L,B),T=t.mul(T,$),$=t.add(D,S),T=t.sub(T,$),b=t.mul(N,A),$=t.mul(x,S),b=t.add($,b),$=t.sub(D,b),b=t.add(D,b),g=t.mul($,b),D=t.add(I,I),D=t.add(D,I),S=t.mul(N,S),A=t.mul(x,A),D=t.add(D,S),S=t.sub(I,S),S=t.mul(N,S),A=t.add(A,S),I=t.mul(D,A),g=t.add(g,I),I=t.mul(T,A),$=t.mul(E,$),$=t.sub($,I),I=t.mul(E,D),b=t.mul(T,b),b=t.add(b,I),new d($,g,b)}subtract(v){return this.add(v.negate())}is0(){return this.equals(d.ZERO)}wNAF(v){return p.wNAFCached(this,v,d.normalizeZ)}multiplyUnsafe(v){const{endo:_,n:y}=e;Ks("scalar",v,zs,y);const C=d.ZERO;if(v===zs)return C;if(this.is0()||v===Tt)return this;if(!_||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,v,d.normalizeZ);let{k1neg:U,k1:L,k2neg:B,k2:$}=_.splitScalar(v),g=C,b=C,N=this;for(;L>zs||$>zs;)L&Tt&&(g=g.add(N)),$&Tt&&(b=b.add(N)),N=N.double(),L>>=Tt,$>>=Tt;return U&&(g=g.negate()),B&&(b=b.negate()),b=new d(t.mul(b.px,_.beta),b.py,b.pz),g.add(b)}multiply(v){const{endo:_,n:y}=e;Ks("scalar",v,Tt,y);let C,U;if(_){const{k1neg:L,k1:B,k2neg:$,k2:g}=_.splitScalar(v);let{p:b,f:N}=this.wNAF(B),{p:x,f:I}=this.wNAF(g);b=p.constTimeNegate(L,b),x=p.constTimeNegate($,x),x=new d(t.mul(x.px,_.beta),x.py,x.pz),C=b.add(x),U=N.add(I)}else{const{p:L,f:B}=this.wNAF(v);C=L,U=B}return d.normalizeZ([C,U])[0]}multiplyAndAddUnsafe(v,_,y){const C=d.BASE,U=(B,$)=>$===zs||$===Tt||!B.equals(C)?B.multiplyUnsafe($):B.multiply($),L=U(this,_).add(U(v,y));return L.is0()?void 0:L}toAffine(v){return u(this,v)}isTorsionFree(){const{h:v,isTorsionFree:_}=e;if(v===Tt)return!0;if(_)return _(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:v,clearCofactor:_}=e;return v===Tt?this:_?_(d,this):this.multiplyUnsafe(e.h)}toRawBytes(v=!0){return rl("isCompressed",v),this.assertValidity(),s(d,this,v)}toHex(v=!0){return rl("isCompressed",v),nl(this.toRawBytes(v))}}d.BASE=new d(e.Gx,e.Gy,t.ONE),d.ZERO=new d(t.ZERO,t.ONE,t.ZERO);const f=e.nBitLength,p=X3(d,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function fk(r){const e=RA(r);return Il(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function pk(r){const e=fk(r),{Fp:t,n}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o(S){return Ar(S,n)}function a(S){return rm(S,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:h}=dk({...e,toBytes(S,E,A){const T=E.toAffine(),O=t.toBytes(T.x),k=bu;return rl("isCompressed",A),A?k(Uint8Array.from([E.hasEvenY()?2:3]),O):k(Uint8Array.from([4]),O,t.toBytes(T.y))},fromBytes(S){const E=S.length,A=S[0],T=S.subarray(1);if(E===s&&(A===2||A===3)){const O=Ko(T);if(!Wf(O,Tt,t.ORDER))throw new Error("Point is not on curve");const k=u(O);let j;try{j=t.sqrt(k)}catch(z){const Q=z instanceof Error?": "+z.message:"";throw new Error("Point is not on curve"+Q)}const q=(j&Tt)===Tt;return(A&1)===1!==q&&(j=t.neg(j)),{x:O,y:j}}else if(E===i&&A===4){const O=t.fromBytes(T.subarray(0,t.BYTES)),k=t.fromBytes(T.subarray(t.BYTES,2*t.BYTES));return{x:O,y:k}}else{const O=s,k=i;throw new Error("invalid Point, expected length of "+O+", or uncompressed "+k+", got "+E)}}}),d=S=>nl(il(S,e.nByteLength));function f(S){const E=n>>Tt;return S>E}function p(S){return f(S)?o(-S):S}const m=(S,E,A)=>Ko(S.slice(E,A));class v{constructor(E,A,T){this.r=E,this.s=A,this.recovery=T,this.assertValidity()}static fromCompact(E){const A=e.nByteLength;return E=Mr("compactSignature",E,A*2),new v(m(E,0,A),m(E,A,2*A))}static fromDER(E){const{r:A,s:T}=Os.toSig(Mr("DER",E));return new v(A,T)}assertValidity(){Ks("r",this.r,Tt,n),Ks("s",this.s,Tt,n)}addRecoveryBit(E){return new v(this.r,this.s,E)}recoverPublicKey(E){const{r:A,s:T,recovery:O}=this,k=B(Mr("msgHash",E));if(O==null||![0,1,2,3].includes(O))throw new Error("recovery id invalid");const j=O===2||O===3?A+e.n:A;if(j>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const q=(O&1)===0?"02":"03",z=c.fromHex(q+d(j)),Q=a(j),J=o(-k*Q),Z=o(T*Q),te=c.BASE.multiplyAndAddUnsafe(z,J,Z);if(!te)throw new Error("point at infinify");return te.assertValidity(),te}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new v(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return sl(this.toDERHex())}toDERHex(){return Os.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return sl(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const _={isValidPrivateKey(S){try{return l(S),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const S=TA(e.n);return J3(e.randomBytes(S),e.n)},precompute(S=8,E=c.BASE){return E._setWindowSize(S),E.multiply(BigInt(3)),E}};function y(S,E=!0){return c.fromPrivateKey(S).toRawBytes(E)}function C(S){const E=na(S),A=typeof S=="string",T=(E||A)&&S.length;return E?T===s||T===i:A?T===2*s||T===2*i:S instanceof c}function U(S,E,A=!0){if(C(S))throw new Error("first arg must be private key");if(!C(E))throw new Error("second arg must be public key");return c.fromHex(E).multiply(l(S)).toRawBytes(A)}const L=e.bits2int||function(S){if(S.length>8192)throw new Error("input is too large");const E=Ko(S),A=S.length*8-e.nBitLength;return A>0?E>>BigInt(A):E},B=e.bits2int_modN||function(S){return o(L(S))},$=Ny(e.nBitLength);function g(S){return Ks("num < 2^"+e.nBitLength,S,zs,$),il(S,e.nByteLength)}function b(S,E,A=N){if(["recovered","canonical"].some(pe=>pe in A))throw new Error("sign() legacy options not supported");const{hash:T,randomBytes:O}=e;let{lowS:k,prehash:j,extraEntropy:q}=A;k==null&&(k=!0),S=Mr("msgHash",S),ob(A),j&&(S=Mr("prehashed msgHash",T(S)));const z=B(S),Q=l(E),J=[g(Q),g(z)];if(q!=null&&q!==!1){const pe=q===!0?O(t.BYTES):q;J.push(Mr("extraEntropy",pe))}const Z=bu(...J),te=z;function re(pe){const ge=L(pe);if(!h(ge))return;const De=a(ge),xe=c.BASE.multiply(ge).toAffine(),Se=o(xe.x);if(Se===zs)return;const fe=o(De*o(te+Se*Q));if(fe===zs)return;let ue=(xe.x===Se?0:2)|Number(xe.y&Tt),Ee=fe;return k&&f(fe)&&(Ee=p(fe),ue^=1),new v(Se,Ee,ue)}return{seed:Z,k2sig:re}}const N={lowS:e.lowS,prehash:!1},x={lowS:e.lowS,prehash:!1};function I(S,E,A=N){const{seed:T,k2sig:O}=b(S,E,A),k=e;return CA(k.hash.outputLen,k.nByteLength,k.hmac)(T,O)}c.BASE._setWindowSize(8);function D(S,E,A,T=x){var fe;const O=S;E=Mr("msgHash",E),A=Mr("publicKey",A);const{lowS:k,prehash:j,format:q}=T;if(ob(T),"strict"in T)throw new Error("options.strict was renamed to lowS");if(q!==void 0&&q!=="compact"&&q!=="der")throw new Error("format must be compact or der");const z=typeof O=="string"||na(O),Q=!z&&!q&&typeof O=="object"&&O!==null&&typeof O.r=="bigint"&&typeof O.s=="bigint";if(!z&&!Q)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let J,Z;try{if(Q&&(J=new v(O.r,O.s)),z){try{q!=="compact"&&(J=v.fromDER(O))}catch(ue){if(!(ue instanceof Os.Err))throw ue}!J&&q!=="der"&&(J=v.fromCompact(O))}Z=c.fromHex(A)}catch{return!1}if(!J||k&&J.hasHighS())return!1;j&&(E=e.hash(E));const{r:te,s:re}=J,pe=B(E),ge=a(re),De=o(pe*ge),xe=o(te*ge),Se=(fe=c.BASE.multiplyAndAddUnsafe(Z,De,xe))==null?void 0:fe.toAffine();return Se?o(Se.x)===te:!1}return{CURVE:e,getPublicKey:y,getSharedSecret:U,sign:I,verify:D,ProjectivePoint:c,Signature:v,utils:_}}function gk(r){return{hash:r,hmac:(e,...t)=>zf(r,e,bD(...t)),randomBytes:Cl}}function mk(r,e){const t=n=>pk({...r,...gk(n)});return{...t(e),create:t}}const DA=xA(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),yk=DA.create(BigInt("-3")),wk=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),bk=mk({a:yk,b:wk,Fp:DA,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},kh),kA="base10",dr="base16",Sn="base64pad",gi="base64url",Bh="utf8",UA=0,Ws=1,$h=2,vk=0,cb=1,iu=12,xy=32;function Ek(){const r=sm.utils.randomPrivateKey(),e=sm.getPublicKey(r);return{privateKey:Ir(r,dr),publicKey:Ir(e,dr)}}function im(){const r=Cl(xy);return Ir(r,dr)}function Ak(r,e){const t=sm.getSharedSecret(un(r,dr),un(e,dr)),n=N3(kh,t,void 0,void 0,xy);return Ir(n,dr)}function Dd(r){const e=kh(un(r,dr));return Ir(e,dr)}function as(r){const e=kh(un(r,Bh));return Ir(e,dr)}function BA(r){return un(`${r}`,kA)}function sa(r){return Number(Ir(r,kA))}function $A(r){return r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function LA(r){const e=r.replace(/-/g,"+").replace(/_/g,"/"),t=(4-e.length%4)%4;return e+"=".repeat(t)}function _k(r){const e=BA(typeof r.type<"u"?r.type:UA);if(sa(e)===Ws&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?un(r.senderPublicKey,dr):void 0,n=typeof r.iv<"u"?un(r.iv,dr):Cl(iu),s=un(r.symKey,dr),i=EA(s,n).encrypt(un(r.message,Bh)),o=MA({type:e,sealed:i,iv:n,senderPublicKey:t});return r.encoding===gi?$A(o):o}function Ck(r){const e=un(r.symKey,dr),{sealed:t,iv:n}=vu({encoded:r.encoded,encoding:r.encoding}),s=EA(e,n).decrypt(t);if(s===null)throw new Error("Failed to decrypt");return Ir(s,Bh)}function Ik(r,e){const t=BA($h),n=Cl(iu),s=un(r,Bh),i=MA({type:t,sealed:s,iv:n});return e===gi?$A(i):i}function Nk(r,e){const{sealed:t}=vu({encoded:r,encoding:e});return Ir(t,Bh)}function MA(r){if(sa(r.type)===$h)return Ir(su([r.type,r.sealed]),Sn);if(sa(r.type)===Ws){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Ir(su([r.type,r.senderPublicKey,r.iv,r.sealed]),Sn)}return Ir(su([r.type,r.iv,r.sealed]),Sn)}function vu(r){const e=(r.encoding||Sn)===gi?LA(r.encoded):r.encoded,t=un(e,Sn),n=t.slice(vk,cb),s=cb;if(sa(n)===Ws){const c=s+xy,l=c+iu,u=t.slice(s,c),h=t.slice(c,l),d=t.slice(l);return{type:n,sealed:d,iv:h,senderPublicKey:u}}if(sa(n)===$h){const c=t.slice(s),l=Cl(iu);return{type:n,sealed:c,iv:l}}const i=s+iu,o=t.slice(s,i),a=t.slice(i);return{type:n,sealed:a,iv:o}}function xk(r,e){const t=vu({encoded:r,encoding:e==null?void 0:e.encoding});return FA({type:sa(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?Ir(t.senderPublicKey,dr):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function FA(r){const e=(r==null?void 0:r.type)||UA;if(e===Ws){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function lb(r){return r.type===Ws&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function ub(r){return r.type===$h}function Pk(r){const e=Ut.from(r.x,"base64"),t=Ut.from(r.y,"base64");return su([new Uint8Array([4]),e,t])}function Tk(r,e){const[t,n,s]=r.split("."),i=Ut.from(LA(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${t}.${n}`,l=kh(c),u=Pk(e);if(!bk.verify(su([o,a]),l,u))throw new Error("Invalid signature");return zg(r).payload}const Ok="irn";function ef(r){return(r==null?void 0:r.relay)||{protocol:Ok}}function Wl(r){const e=UR[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}function Sk(r,e="-"){const t={},n="relay"+e;return Object.keys(r).forEach(s=>{if(s.startsWith(n)){const i=s.replace(n,""),o=r[s];t[i]=o}}),t}function hb(r){if(!r.includes("wc:")){const l=cA(r);l!=null&&l.includes("wc:")&&(r=l)}r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,n=r.substring(0,e),s=r.substring(e+1,t).split("@"),i=typeof t<"u"?r.substring(t):"",o=new URLSearchParams(i),a={};o.forEach((l,u)=>{a[u]=l});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:Rk(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:Sk(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function Rk(r){return r.startsWith("//")?r.substring(2):r}function Dk(r,e="-"){const t="relay",n={};return Object.keys(r).forEach(s=>{const i=s,o=t+e+i;r[i]&&(n[o]=r[i])}),n}function db(r){const e=new URLSearchParams,t=Dk(r.relay);Object.keys(t).sort().forEach(s=>{e.set(s,t[s])}),e.set("symKey",r.symKey),r.expiryTimestamp&&e.set("expiryTimestamp",r.expiryTimestamp.toString()),r.methods&&e.set("methods",r.methods.join(","));const n=e.toString();return`${r.protocol}:${r.topic}@${r.version}?${n}`}function rd(r,e,t){return`${r}?wc_ev=${t}&topic=${e}`}function Nl(r){const e=[];return r.forEach(t=>{const[n,s]=t.split(":");e.push(`${n}:${s}`)}),e}function kk(r){const e=[];return Object.values(r).forEach(t=>{e.push(...Nl(t.accounts))}),e}function Uk(r,e){const t=[];return Object.values(r).forEach(n=>{Nl(n.accounts).includes(e)&&t.push(...n.methods)}),t}function Bk(r,e){const t=[];return Object.values(r).forEach(n=>{Nl(n.accounts).includes(e)&&t.push(...n.events)}),t}function Py(r){return r.includes(":")}function Ql(r){return Py(r)?r.split(":")[0]:r}function $k(r){const e={};return r==null||r.forEach(t=>{var n;const[s,i]=t.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(t),(n=e[s].chains)==null||n.push(`${s}:${i}`)}),e}function fb(r,e){e=e.map(n=>n.replace("did:pkh:",""));const t=$k(e);for(const[n,s]of Object.entries(t))s.methods?s.methods=Sd(s.methods,r):s.methods=r,s.events=["chainChanged","accountsChanged"];return t}const Lk={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Mk={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ee(r,e){const{message:t,code:n}=Mk[r];return{message:e?`${t} ${e}`:t,code:n}}function Ke(r,e){const{message:t,code:n}=Lk[r];return{message:e?`${t} ${e}`:t,code:n}}function ji(r,e){return!!Array.isArray(r)}function Eu(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function jt(r){return typeof r>"u"}function Et(r,e){return e&&jt(r)?!0:typeof r=="string"&&!!r.trim().length}function Ty(r,e){return e&&jt(r)?!0:typeof r=="number"&&!isNaN(r)}function Fk(r,e){const{requiredNamespaces:t}=e,n=Object.keys(r.namespaces),s=Object.keys(t);let i=!0;return mo(s,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:l}=r.namespaces[o],u=Nl(a),h=t[o];(!mo(nA(o,h),u)||!mo(h.methods,c)||!mo(h.events,l))&&(i=!1)}),i):!1}function tf(r){return Et(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function jk(r){if(Et(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&tf(t)}}return!1}function Hk(r){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(Et(r,!1)){if(e(r))return!0;const t=cA(r);return e(t)}}catch{}return!1}function qk(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function zk(r){return r==null?void 0:r.topic}function Vk(r,e){let t=null;return Et(r==null?void 0:r.publicKey,!1)||(t=ee("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function pb(r){let e=!0;return ji(r)?r.length&&(e=r.every(t=>Et(t,!1))):e=!1,e}function Gk(r,e,t){let n=null;return ji(e)&&e.length?e.forEach(s=>{n||tf(s)||(n=Ke("UNSUPPORTED_CHAINS",`${t}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):tf(r)||(n=Ke("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function Kk(r,e,t){let n=null;return Object.entries(r).forEach(([s,i])=>{if(n)return;const o=Gk(s,nA(s,i),`${e} ${t}`);o&&(n=o)}),n}function Wk(r,e){let t=null;return ji(r)?r.forEach(n=>{t||jk(n)||(t=Ke("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):t=Ke("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function Qk(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=Wk(n==null?void 0:n.accounts,`${e} namespace`);s&&(t=s)}),t}function Jk(r,e){let t=null;return pb(r==null?void 0:r.methods)?pb(r==null?void 0:r.events)||(t=Ke("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Ke("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function jA(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=Jk(n,`${e}, namespace`);s&&(t=s)}),t}function Zk(r,e,t){let n=null;if(r&&Eu(r)){const s=jA(r,e);s&&(n=s);const i=Kk(r,e,t);i&&(n=i)}else n=ee("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return n}function Gp(r,e){let t=null;if(r&&Eu(r)){const n=jA(r,e);n&&(t=n);const s=Qk(r,e);s&&(t=s)}else t=ee("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function HA(r){return Et(r.protocol,!0)}function Yk(r,e){let t=!1;return r?r&&ji(r)&&r.length&&r.forEach(n=>{t=HA(n)}):t=!0,t}function Xk(r){return typeof r=="number"}function br(r){return typeof r<"u"&&typeof r!==null}function e8(r){return!(!r||typeof r!="object"||!r.code||!Ty(r.code,!1)||!r.message||!Et(r.message,!1))}function t8(r){return!(jt(r)||!Et(r.method,!1))}function r8(r){return!(jt(r)||jt(r.result)&&jt(r.error)||!Ty(r.id,!1)||!Et(r.jsonrpc,!1))}function n8(r){return!(jt(r)||!Et(r.name,!1))}function gb(r,e){return!(!tf(e)||!kk(r).includes(e))}function s8(r,e,t){return Et(t,!1)?Uk(r,e).includes(t):!1}function i8(r,e,t){return Et(t,!1)?Bk(r,e).includes(t):!1}function mb(r,e,t){let n=null;const s=o8(r),i=a8(e),o=Object.keys(s),a=Object.keys(i),c=yb(Object.keys(r)),l=yb(Object.keys(e)),u=c.filter(h=>!l.includes(h));return u.length&&(n=ee("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),mo(o,a)||(n=ee("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(h=>{if(!h.includes(":")||n)return;const d=Nl(e[h].accounts);d.includes(h)||(n=ee("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${h}
        Required: ${h}
        Approved: ${d.toString()}`))}),o.forEach(h=>{n||(mo(s[h].methods,i[h].methods)?mo(s[h].events,i[h].events)||(n=ee("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${h}`)):n=ee("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${h}`))}),n}function o8(r){const e={};return Object.keys(r).forEach(t=>{var n;t.includes(":")?e[t]=r[t]:(n=r[t].chains)==null||n.forEach(s=>{e[s]={methods:r[t].methods,events:r[t].events}})}),e}function yb(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function a8(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const n=Nl(r[t].accounts);n==null||n.forEach(s=>{e[s]={accounts:r[t].accounts.filter(i=>i.includes(`${s}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function c8(r,e){return Ty(r,!1)&&r<=e.max&&r>=e.min}function wb(){const r=Rh();return new Promise(e=>{switch(r){case Hr.browser:e(l8());break;case Hr.reactNative:e(u8());break;case Hr.node:e(h8());break;default:e(!0)}})}function l8(){return Sh()&&(navigator==null?void 0:navigator.onLine)}async function u8(){if(Wi()&&typeof be<"u"&&be!=null&&be.NetInfo){const r=await(be==null?void 0:be.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function h8(){return!0}function d8(r){switch(Rh()){case Hr.browser:f8(r);break;case Hr.reactNative:p8(r);break}}function f8(r){!Wi()&&Sh()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function p8(r){var e;Wi()&&typeof be<"u"&&be!=null&&be.NetInfo&&((e=be)==null||e.NetInfo.addEventListener(t=>r(t==null?void 0:t.isConnected)))}const Kp={};class $l{static get(e){return Kp[e]}static set(e,t){Kp[e]=t}static delete(e){delete Kp[e]}}const g8="PARSE_ERROR",m8="INVALID_REQUEST",y8="METHOD_NOT_FOUND",w8="INVALID_PARAMS",qA="INTERNAL_ERROR",Oy="SERVER_ERROR",b8=[-32700,-32600,-32601,-32602,-32603],ou={[g8]:{code:-32700,message:"Parse error"},[m8]:{code:-32600,message:"Invalid Request"},[y8]:{code:-32601,message:"Method not found"},[w8]:{code:-32602,message:"Invalid params"},[qA]:{code:-32603,message:"Internal error"},[Oy]:{code:-32e3,message:"Server error"}},zA=Oy;function v8(r){return b8.includes(r)}function bb(r){return Object.keys(ou).includes(r)?ou[r]:ou[zA]}function E8(r){const e=Object.values(ou).find(t=>t.code===r);return e||ou[zA]}function VA(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}function Jn(r=3){const e=Date.now()*Math.pow(10,r),t=Math.floor(Math.random()*Math.pow(10,r));return e+t}function yo(r=6){return BigInt(Jn(r))}function Li(r,e,t){return{id:t||Jn(),jsonrpc:"2.0",method:r,params:e}}function Qf(r,e){return{id:r,jsonrpc:"2.0",result:e}}function Jf(r,e,t){return{id:r,jsonrpc:"2.0",error:A8(e)}}function A8(r,e){return typeof r>"u"?bb(qA):(typeof r=="string"&&(r=Object.assign(Object.assign({},bb(Oy)),{message:r})),v8(r.code)&&(r=E8(r.code)),r)}class _8{}let C8=class extends _8{constructor(){super()}};class I8 extends C8{constructor(e){super()}}const N8="^https?:",x8="^wss?:";function P8(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function GA(r,e){const t=P8(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function vb(r){return GA(r,N8)}function Eb(r){return GA(r,x8)}function T8(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function KA(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function Sy(r){return KA(r)&&"method"in r}function Zf(r){return KA(r)&&(Zn(r)||cn(r))}function Zn(r){return"result"in r}function cn(r){return"error"in r}class dn extends I8{constructor(e){super(e),this.events=new Mn.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Li(e.method,e.params||[],e.id||yo().toString()),t)}async requestStrict(e,t){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{cn(i)?s(i.error):n(i.result)});try{await this.connection.send(e,t)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Zf(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const O8=()=>typeof WebSocket<"u"?WebSocket:typeof be<"u"&&typeof be.WebSocket<"u"?be.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),S8=()=>typeof WebSocket<"u"||typeof be<"u"&&typeof be.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Ab=r=>r.split("?")[0],_b=10,R8=O8();let D8=class{constructor(e){if(this.url=e,this.events=new Mn.EventEmitter,this.registering=!1,!Eb(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Ys(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!Eb(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,n)=>{const s=WI.isReactNative()?void 0:{rejectUnauthorized:!T8(e)},i=new R8(e,[],s);S8()?i.onerror=o=>{const a=o;n(this.emitError(a.error))}:i.on("error",o=>{n(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),t(i)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?ea(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),s=n.message||n.toString(),i=Jf(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return VA(e,Ab(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>_b&&this.events.setMaxListeners(_b)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Ab(this.url)}`));return this.events.emit("register_error",t),t}};var k8={};const WA="wc",QA=2,om="core",ps=`${WA}@2:${om}:`,U8={logger:"error"},B8={database:":memory:"},$8="crypto",Cb="client_ed25519_seed",L8=X.ONE_DAY,M8="keychain",F8="0.3",j8="messages",H8="0.3",Ib=X.SIX_HOURS,q8="publisher",JA="irn",z8="error",ZA="wss://relay.walletconnect.org",V8="relayer",St={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},G8="_subscription",Gr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},K8=.1,am="2.19.2",nt={link_mode:"link_mode",relay:"relay"},kd={inbound:"inbound",outbound:"outbound"},W8="0.3",Q8="WALLETCONNECT_CLIENT_ID",Nb="WALLETCONNECT_LINK_MODE_APPS",Dr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},J8="subscription",Z8="0.3",Y8="pairing",X8="0.3",Ll={wc_pairingDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:X.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:X.ONE_DAY,prompt:!1,tag:0},res:{ttl:X.ONE_DAY,prompt:!1,tag:0}}},co={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},gn={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},eU="history",tU="0.3",rU="expirer",en={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},nU="0.3",sU="verify-api",iU="https://verify.walletconnect.com",YA="https://verify.walletconnect.org",au=YA,oU=`${au}/v3`,aU=[iU,YA],cU="echo",lU="https://echo.walletconnect.com",Qn={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Cs={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},mn={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Yi={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Xi={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},Ml={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},uU=.1,hU="event-client",dU=86400,fU="https://pulse.walletconnect.org/batch";function pU(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,v=0,_=0,y=p.length;_!==y&&p[_]===0;)_++,m++;for(var C=(y-_)*u+1>>>0,U=new Uint8Array(C);_!==y;){for(var L=p[_],B=0,$=C-1;(L!==0||B<v)&&$!==-1;$--,B++)L+=256*U[$]>>>0,U[$]=L%a>>>0,L=L/a>>>0;if(L!==0)throw new Error("Non-zero carry");v=B,_++}for(var g=C-v;g!==C&&U[g]===0;)g++;for(var b=c.repeat(m);g<C;++g)b+=r.charAt(U[g]);return b}function d(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var v=0,_=0;p[m]===c;)v++,m++;for(var y=(p.length-m)*l+1>>>0,C=new Uint8Array(y);p[m];){var U=t[p.charCodeAt(m)];if(U===255)return;for(var L=0,B=y-1;(U!==0||L<_)&&B!==-1;B--,L++)U+=a*C[B]>>>0,C[B]=U%256>>>0,U=U/256>>>0;if(U!==0)throw new Error("Non-zero carry");_=L,m++}if(p[m]!==" "){for(var $=y-_;$!==y&&C[$]===0;)$++;for(var g=new Uint8Array(v+(y-$)),b=v;$!==y;)g[b++]=C[$++];return g}}}function f(p){var m=d(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var gU=pU,mU=gU;const XA=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},yU=r=>new TextEncoder().encode(r),wU=r=>new TextDecoder().decode(r);class bU{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class vU{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return e_(this,e)}}class EU{constructor(e){this.decoders=e}or(e){return e_(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const e_=(r,e)=>new EU({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class AU{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new bU(e,t,n),this.decoder=new vU(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Yf=({name:r,prefix:e,encode:t,decode:n})=>new AU(r,e,t,n),Lh=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=mU(t,e);return Yf({prefix:r,name:e,encode:n,decode:i=>XA(s(i))})},_U=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const h=s[r[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},CU=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},Kt=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Yf({prefix:e,name:r,encode(s){return CU(s,n,t)},decode(s){return _U(s,n,t,r)}}),IU=Yf({prefix:"\0",name:"identity",encode:r=>wU(r),decode:r=>yU(r)});var NU=Object.freeze({__proto__:null,identity:IU});const xU=Kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var PU=Object.freeze({__proto__:null,base2:xU});const TU=Kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var OU=Object.freeze({__proto__:null,base8:TU});const SU=Lh({prefix:"9",name:"base10",alphabet:"0123456789"});var RU=Object.freeze({__proto__:null,base10:SU});const DU=Kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),kU=Kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var UU=Object.freeze({__proto__:null,base16:DU,base16upper:kU});const BU=Kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),$U=Kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),LU=Kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),MU=Kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),FU=Kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),jU=Kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),HU=Kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),qU=Kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),zU=Kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var VU=Object.freeze({__proto__:null,base32:BU,base32upper:$U,base32pad:LU,base32padupper:MU,base32hex:FU,base32hexupper:jU,base32hexpad:HU,base32hexpadupper:qU,base32z:zU});const GU=Lh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),KU=Lh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var WU=Object.freeze({__proto__:null,base36:GU,base36upper:KU});const QU=Lh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),JU=Lh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ZU=Object.freeze({__proto__:null,base58btc:QU,base58flickr:JU});const YU=Kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),XU=Kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),eB=Kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),tB=Kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var rB=Object.freeze({__proto__:null,base64:YU,base64pad:XU,base64url:eB,base64urlpad:tB});const t_=Array.from(""),nB=t_.reduce((r,e,t)=>(r[t]=e,r),[]),sB=t_.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function iB(r){return r.reduce((e,t)=>(e+=nB[t],e),"")}function oB(r){const e=[];for(const t of r){const n=sB[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const aB=Yf({prefix:"",name:"base256emoji",encode:iB,decode:oB});var cB=Object.freeze({__proto__:null,base256emoji:aB}),lB=r_,xb=128,uB=-128,hB=Math.pow(2,31);function r_(r,e,t){e=e||[],t=t||0;for(var n=t;r>=hB;)e[t++]=r&255|xb,r/=128;for(;r&uB;)e[t++]=r&255|xb,r>>>=7;return e[t]=r|0,r_.bytes=t-n+1,e}var dB=cm,fB=128,Pb=127;function cm(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw cm.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&Pb)<<s:(o&Pb)*Math.pow(2,s),s+=7}while(o>=fB);return cm.bytes=i-n,t}var pB=Math.pow(2,7),gB=Math.pow(2,14),mB=Math.pow(2,21),yB=Math.pow(2,28),wB=Math.pow(2,35),bB=Math.pow(2,42),vB=Math.pow(2,49),EB=Math.pow(2,56),AB=Math.pow(2,63),_B=function(r){return r<pB?1:r<gB?2:r<mB?3:r<yB?4:r<wB?5:r<bB?6:r<vB?7:r<EB?8:r<AB?9:10},CB={encode:lB,decode:dB,encodingLength:_B},n_=CB;const Tb=(r,e,t=0)=>(n_.encode(r,e,t),e),Ob=r=>n_.encodingLength(r),lm=(r,e)=>{const t=e.byteLength,n=Ob(r),s=n+Ob(t),i=new Uint8Array(s+t);return Tb(r,i,0),Tb(t,i,n),i.set(e,s),new IB(r,t,e,i)};class IB{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const s_=({name:r,code:e,encode:t})=>new NB(r,e,t);class NB{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?lm(this.code,t):t.then(n=>lm(this.code,n))}else throw Error("Unknown type, must be binary type")}}const i_=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),xB=s_({name:"sha2-256",code:18,encode:i_("SHA-256")}),PB=s_({name:"sha2-512",code:19,encode:i_("SHA-512")});var TB=Object.freeze({__proto__:null,sha256:xB,sha512:PB});const o_=0,OB="identity",a_=XA,SB=r=>lm(o_,a_(r)),RB={code:o_,name:OB,encode:a_,digest:SB};var DB=Object.freeze({__proto__:null,identity:RB});new TextEncoder,new TextDecoder;const Sb={...NU,...PU,...OU,...RU,...UU,...VU,...WU,...ZU,...rB,...cB};({...TB,...DB});function kB(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function c_(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const Rb=c_("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Wp=c_("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=kB(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),UB={utf8:Rb,"utf-8":Rb,hex:Sb.base16,latin1:Wp,ascii:Wp,binary:Wp,...Sb};function BB(r,e="utf8"){const t=UB[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}var $B=Object.defineProperty,LB=(r,e,t)=>e in r?$B(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,zn=(r,e,t)=>LB(r,typeof e!="symbol"?e+"":e,t);class MB{constructor(e,t){this.core=e,this.logger=t,zn(this,"keychain",new Map),zn(this,"name",M8),zn(this,"version",F8),zn(this,"initialized",!1),zn(this,"storagePrefix",ps),zn(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),zn(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),zn(this,"set",async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()}),zn(this,"get",n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:i}=ee("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(i)}return s}),zn(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=er(t,this.name)}get context(){return xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Wg(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Qg(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}var FB=Object.defineProperty,jB=(r,e,t)=>e in r?FB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$t=(r,e,t)=>jB(r,typeof e!="symbol"?e+"":e,t);class HB{constructor(e,t,n){this.core=e,this.logger=t,$t(this,"name",$8),$t(this,"keychain"),$t(this,"randomSessionIdentifier",im()),$t(this,"initialized",!1),$t(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),$t(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),$t(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=d0(s);return $1(i.publicKey)}),$t(this,"generateKeyPair",()=>{this.isInitialized();const s=Ek();return this.setPrivateKey(s.publicKey,s.privateKey)}),$t(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=d0(i),a=this.randomSessionIdentifier;return await kO(a,s,L8,o)}),$t(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=Ak(a,i);return this.setSymKey(c,o)}),$t(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||Dd(s);return await this.keychain.set(o,s),o}),$t(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),$t(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),$t(this,"encode",async(s,i,o)=>{this.isInitialized();const a=FA(o),c=Ys(i);if(ub(a))return Ik(c,o==null?void 0:o.encoding);if(lb(a)){const d=a.senderPublicKey,f=a.receiverPublicKey;s=await this.generateSharedKey(d,f)}const l=this.getSymKey(s),{type:u,senderPublicKey:h}=a;return _k({type:u,symKey:l,message:c,senderPublicKey:h,encoding:o==null?void 0:o.encoding})}),$t(this,"decode",async(s,i,o)=>{this.isInitialized();const a=xk(i,o);if(ub(a)){const c=Nk(i,o==null?void 0:o.encoding);return ea(c)}if(lb(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=Ck({symKey:c,encoded:i,encoding:o==null?void 0:o.encoding});return ea(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),$t(this,"getPayloadType",(s,i=Sn)=>{const o=vu({encoded:s,encoding:i});return sa(o.type)}),$t(this,"getPayloadSenderPublicKey",(s,i=Sn)=>{const o=vu({encoded:s,encoding:i});return o.senderPublicKey?Ir(o.senderPublicKey,dr):void 0}),this.core=e,this.logger=er(t,this.name),this.keychain=n||new MB(this.core,this.logger)}get context(){return xr(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Cb)}catch{e=im(),await this.keychain.set(Cb,e)}return BB(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}var qB=Object.defineProperty,zB=Object.defineProperties,VB=Object.getOwnPropertyDescriptors,Db=Object.getOwnPropertySymbols,GB=Object.prototype.hasOwnProperty,KB=Object.prototype.propertyIsEnumerable,um=(r,e,t)=>e in r?qB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,WB=(r,e)=>{for(var t in e||(e={}))GB.call(e,t)&&um(r,t,e[t]);if(Db)for(var t of Db(e))KB.call(e,t)&&um(r,t,e[t]);return r},QB=(r,e)=>zB(r,VB(e)),Or=(r,e,t)=>um(r,typeof e!="symbol"?e+"":e,t);class JB extends RP{constructor(e,t){super(e,t),this.logger=e,this.core=t,Or(this,"messages",new Map),Or(this,"messagesWithoutClientAck",new Map),Or(this,"name",j8),Or(this,"version",H8),Or(this,"initialized",!1),Or(this,"storagePrefix",ps),Or(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),Or(this,"set",async(n,s,i)=>{this.isInitialized();const o=as(s);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(n,a),i===kd.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,QB(WB({},c),{[o]:s}))}return await this.persist(),o}),Or(this,"get",n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s}),Or(this,"getWithoutAck",n=>{this.isInitialized();const s={};for(const i of n){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),Or(this,"has",(n,s)=>{this.isInitialized();const i=this.get(n),o=as(s);return typeof i[o]<"u"}),Or(this,"ack",async(n,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(n);if(typeof i>"u")return;const o=as(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,i),await this.persist()}),Or(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=er(e,this.name),this.core=t}get context(){return xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Wg(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Wg(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Qg(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?Qg(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}var ZB=Object.defineProperty,YB=Object.defineProperties,XB=Object.getOwnPropertyDescriptors,kb=Object.getOwnPropertySymbols,e5=Object.prototype.hasOwnProperty,t5=Object.prototype.propertyIsEnumerable,hm=(r,e,t)=>e in r?ZB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,nd=(r,e)=>{for(var t in e||(e={}))e5.call(e,t)&&hm(r,t,e[t]);if(kb)for(var t of kb(e))t5.call(e,t)&&hm(r,t,e[t]);return r},Qp=(r,e)=>YB(r,XB(e)),yn=(r,e,t)=>hm(r,typeof e!="symbol"?e+"":e,t);class r5 extends DP{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,yn(this,"events",new Mn.EventEmitter),yn(this,"name",q8),yn(this,"queue",new Map),yn(this,"publishTimeout",X.toMiliseconds(X.ONE_MINUTE)),yn(this,"initialPublishTimeout",X.toMiliseconds(X.ONE_SECOND*15)),yn(this,"needsTransportRestart",!1),yn(this,"publish",async(n,s,i)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:i}});const a=(i==null?void 0:i.ttl)||Ib,c=ef(i),l=(i==null?void 0:i.prompt)||!1,u=(i==null?void 0:i.tag)||0,h=(i==null?void 0:i.id)||yo().toString(),d={topic:n,message:s,opts:{ttl:a,relay:c,prompt:l,tag:u,id:h,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}},f=`Failed to publish payload, please try again. id:${h} tag:${u}`;try{const p=new Promise(async m=>{const v=({id:y})=>{d.opts.id===y&&(this.removeRequestFromQueue(y),this.relayer.events.removeListener(St.publish,v),m(d))};this.relayer.events.on(St.publish,v);const _=$i(new Promise((y,C)=>{this.rpcPublish({topic:n,message:s,ttl:a,prompt:l,tag:u,id:h,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}).then(y).catch(U=>{this.logger.warn(U,U==null?void 0:U.message),C(U)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${h} tag:${u}`);try{await _,this.events.removeListener(St.publish,v)}catch(y){this.queue.set(h,Qp(nd({},d),{attempt:1})),this.logger.warn(y,y==null?void 0:y.message)}});this.logger.trace({type:"method",method:"publish",params:{id:h,topic:n,message:s,opts:i}}),await $i(p,this.publishTimeout,f)}catch(p){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(p),(o=i==null?void 0:i.internal)!=null&&o.throwOnFailedPublish)throw p}finally{this.queue.delete(h)}}),yn(this,"on",(n,s)=>{this.events.on(n,s)}),yn(this,"once",(n,s)=>{this.events.once(n,s)}),yn(this,"off",(n,s)=>{this.events.off(n,s)}),yn(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.relayer=e,this.logger=er(t,this.name),this.registerEventListeners()}get context(){return xr(this.logger)}async rpcPublish(e){var t,n,s,i;const{topic:o,message:a,ttl:c=Ib,prompt:l,tag:u,id:h,attestation:d,tvf:f}=e,p={method:Wl(ef().protocol).publish,params:nd({topic:o,message:a,ttl:c,prompt:l,tag:u,attestation:d},f),id:h};jt((t=p.params)==null?void 0:t.prompt)&&((n=p.params)==null||delete n.prompt),jt((s=p.params)==null?void 0:s.tag)&&((i=p.params)==null||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p});const m=await this.relayer.request(p);return this.relayer.events.emit(St.publish,e),this.logger.debug("Successfully Published Payload"),m}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{const n=e.attempt+1;this.queue.set(t,Qp(nd({},e),{attempt:n}));const{topic:s,message:i,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${n}`),await this.rpcPublish(Qp(nd({},e),{topic:s,message:i,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(bl.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(St.connection_stalled);return}this.checkQueue()}),this.relayer.on(St.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var n5=Object.defineProperty,s5=(r,e,t)=>e in r?n5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Na=(r,e,t)=>s5(r,typeof e!="symbol"?e+"":e,t);class i5{constructor(){Na(this,"map",new Map),Na(this,"set",(e,t)=>{const n=this.get(e);this.exists(e,t)||this.map.set(e,[...n,t])}),Na(this,"get",e=>this.map.get(e)||[]),Na(this,"exists",(e,t)=>this.get(e).includes(t)),Na(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,t))return;const s=n.filter(i=>i!==t);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),Na(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var o5=Object.defineProperty,a5=Object.defineProperties,c5=Object.getOwnPropertyDescriptors,Ub=Object.getOwnPropertySymbols,l5=Object.prototype.hasOwnProperty,u5=Object.prototype.propertyIsEnumerable,dm=(r,e,t)=>e in r?o5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Fl=(r,e)=>{for(var t in e||(e={}))l5.call(e,t)&&dm(r,t,e[t]);if(Ub)for(var t of Ub(e))u5.call(e,t)&&dm(r,t,e[t]);return r},Jp=(r,e)=>a5(r,c5(e)),Je=(r,e,t)=>dm(r,typeof e!="symbol"?e+"":e,t);class h5 extends BP{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Je(this,"subscriptions",new Map),Je(this,"topicMap",new i5),Je(this,"events",new Mn.EventEmitter),Je(this,"name",J8),Je(this,"version",Z8),Je(this,"pending",new Map),Je(this,"cached",[]),Je(this,"initialized",!1),Je(this,"storagePrefix",ps),Je(this,"subscribeTimeout",X.toMiliseconds(X.ONE_MINUTE)),Je(this,"initialSubscribeTimeout",X.toMiliseconds(X.ONE_SECOND*15)),Je(this,"clientId"),Je(this,"batchSubscribeTopicsLimit",500),Je(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Je(this,"subscribe",async(n,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const i=ef(s),o={topic:n,relay:i,transportType:s==null?void 0:s.transportType};this.pending.set(n,o);const a=await this.rpcSubscribe(n,i,s);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}})),a}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}}),Je(this,"unsubscribe",async(n,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)}),Je(this,"isSubscribed",n=>new Promise(s=>{s(this.topicMap.topics.includes(n))})),Je(this,"isKnownTopic",n=>new Promise(s=>{s(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(i=>i.topic===n))})),Je(this,"on",(n,s)=>{this.events.on(n,s)}),Je(this,"once",(n,s)=>{this.events.once(n,s)}),Je(this,"off",(n,s)=>{this.events.off(n,s)}),Je(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),Je(this,"start",async()=>{await this.onConnect()}),Je(this,"stop",async()=>{await this.onDisconnect()}),Je(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Je(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(s=>{n.push(s)}),await this.batchSubscribe(n)}),Je(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(bl.pulse,async()=>{await this.checkPending()}),this.events.on(Dr.created,async n=>{const s=Dr.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()}),this.events.on(Dr.deleted,async n=>{const s=Dr.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()})}),this.relayer=e,this.logger=er(t,this.name),this.clientId=""}get context(){return xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let n=!1;try{n=this.getSubscription(e).topic===t}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const n=this.topicMap.get(e);await Promise.all(n.map(async s=>await this.unsubscribeById(e,s,t)))}async unsubscribeById(e,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}});try{const s=ef(n);await this.restartToComplete({topic:e,id:t,relay:s}),await this.rpcUnsubscribe(e,t,s);const i=Ke("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,t,n){var s;(!n||(n==null?void 0:n.transportType)===nt.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});const i={method:Wl(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const o=(s=n==null?void 0:n.internal)==null?void 0:s.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if((n==null?void 0:n.transportType)===nt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch(u=>this.logger.warn(u))},X.toMiliseconds(X.ONE_SECOND)),a;const c=new Promise(async u=>{const h=d=>{d.topic===e&&(this.events.removeListener(Dr.created,h),u(d.id))};this.events.on(Dr.created,h);try{const d=await $i(new Promise((f,p)=>{this.relayer.request(i).catch(m=>{this.logger.warn(m,m==null?void 0:m.message),p(m)}).then(f)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Dr.created,h),u(d)}catch{}}),l=await $i(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!l&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return l?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(St.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,n={method:Wl(t.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await $i(new Promise(s=>{this.relayer.request(n).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(St.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,n={method:Wl(t.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let s;try{s=await await $i(new Promise((i,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(St.connection_stalled)}return s}rpcUnsubscribe(e,t,n){const s={method:Wl(n.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,t){this.setSubscription(e,Jp(Fl({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,Fl({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,Fl({},t)),this.topicMap.set(t.topic,e),this.events.emit(Dr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:n}=ee("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(Dr.deleted,Jp(Fl({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Dr.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<t;n++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Dr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async t=>Jp(Fl({},t),{id:await this.getSubscriptionId(t.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await cD(X.toMiliseconds(X.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return as(e+await this.getClientId())}}var d5=Object.defineProperty,Bb=Object.getOwnPropertySymbols,f5=Object.prototype.hasOwnProperty,p5=Object.prototype.propertyIsEnumerable,fm=(r,e,t)=>e in r?d5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$b=(r,e)=>{for(var t in e||(e={}))f5.call(e,t)&&fm(r,t,e[t]);if(Bb)for(var t of Bb(e))p5.call(e,t)&&fm(r,t,e[t]);return r},Me=(r,e,t)=>fm(r,typeof e!="symbol"?e+"":e,t);class g5 extends kP{constructor(e){super(e),Me(this,"protocol","wc"),Me(this,"version",2),Me(this,"core"),Me(this,"logger"),Me(this,"events",new Mn.EventEmitter),Me(this,"provider"),Me(this,"messages"),Me(this,"subscriber"),Me(this,"publisher"),Me(this,"name",V8),Me(this,"transportExplicitlyClosed",!1),Me(this,"initialized",!1),Me(this,"connectionAttemptInProgress",!1),Me(this,"relayUrl"),Me(this,"projectId"),Me(this,"packageName"),Me(this,"bundleId"),Me(this,"hasExperiencedNetworkDisruption",!1),Me(this,"pingTimeout"),Me(this,"heartBeatTimeout",X.toMiliseconds(X.THIRTY_SECONDS+X.FIVE_SECONDS)),Me(this,"reconnectTimeout"),Me(this,"connectPromise"),Me(this,"reconnectInProgress",!1),Me(this,"requestsInFlight",[]),Me(this,"connectTimeout",X.toMiliseconds(X.ONE_SECOND*15)),Me(this,"request",async t=>{var n,s;this.logger.debug("Publishing Request Payload");const i=t.id||yo().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:t.method,topic:(n=t.params)==null?void 0:n.topic},"relayer.request - publishing...");const o=`${i}:${((s=t.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(t);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),Me(this,"resetPingTimeout",()=>{Yd()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,n,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),Me(this,"onPayloadHandler",t=>{this.onProviderPayload(t),this.resetPingTimeout()}),Me(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(St.connect)}),Me(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),Me(this,"onProviderErrorHandler",t=>{this.logger.fatal(`Fatal socket error: ${t.message}`),this.events.emit(St.error,t),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Me(this,"registerProviderListeners",()=>{this.provider.on(Gr.payload,this.onPayloadHandler),this.provider.on(Gr.connect,this.onConnectHandler),this.provider.on(Gr.disconnect,this.onDisconnectHandler),this.provider.on(Gr.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?er(e.logger,this.name):Ch(vl({level:e.logger||z8})),this.messages=new JB(this.logger,e.core),this.subscriber=new h5(this,this.logger),this.publisher=new r5(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||ZA,this.projectId=e.projectId,GR()?this.packageName=D0():KR()&&(this.bundleId=D0()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e==null?void 0:e.message)}}get context(){return xr(this.logger)}get connected(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,t,n){this.isInitialized(),await this.publisher.publish(e,t,n),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:nt.relay},kd.outbound)}async subscribe(e,t){var n,s,i;this.isInitialized(),(!(t!=null&&t.transportType)||(t==null?void 0:t.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((n=t==null?void 0:t.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(s=t==null?void 0:t.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(Dr.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(Dr.created,l)}),new Promise(async(u,h)=>{a=await this.subscriber.subscribe(e,$b({internal:{throwOnFailedPublish:o}},t)).catch(d=>{o&&h(d)})||a,u()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await $i(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,n)=>{await this.connect(e).then(t).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await wb())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((n,s)=>n.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(const n of t)try{await this.onMessageEvent(n)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:n}=e;if(!t.sessionExists){const s=_t(X.FIVE_MINUTES),i={topic:n,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,i)}this.events.emit(St.message,e),await this.recordMessageEvent(e,kd.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(n,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Gr.disconnect,i),await $i(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(Gr.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{a(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Gr.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Gr.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const s=n;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(n=>setTimeout(n,X.toMiliseconds(t*1))),t++}}startPingTimeout(){var e,t,n,s,i;if(Yd())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new dn(new D8(YR({sdkVersion:am,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){const{topic:n,message:s}=e;await this.messages.set(n,s,t)}async shouldIgnoreMessageEvent(e){const{topic:t,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;const s=this.messages.has(t,n);return s&&this.logger.warn(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Sy(e)){if(!e.method.endsWith(G8))return;const t=e.params,{topic:n,message:s,publishedAt:i,attestation:o}=t.data,a={topic:n,message:s,publishedAt:i,transportType:nt.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace($b({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Zf(e)&&this.events.emit(St.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,kd.inbound),this.events.emit(St.message,e))}async acknowledgePayload(e){const t=Qf(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Gr.payload,this.onPayloadHandler),this.provider.off(Gr.connect,this.onConnectHandler),this.provider.off(Gr.disconnect,this.onDisconnectHandler),this.provider.off(Gr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await wb();d8(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(n=>this.logger.error(n,n==null?void 0:n.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(St.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},X.toMiliseconds(K8)))))}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&await this.connect()}}function m5(){}function Lb(r){if(!r||typeof r!="object")return!1;const e=Object.getPrototypeOf(r);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(r)==="[object Object]":!1}function Mb(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function Fb(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const y5="[object RegExp]",w5="[object String]",b5="[object Number]",v5="[object Boolean]",jb="[object Arguments]",E5="[object Symbol]",A5="[object Date]",_5="[object Map]",C5="[object Set]",I5="[object Array]",N5="[object Function]",x5="[object ArrayBuffer]",Zp="[object Object]",P5="[object Error]",T5="[object DataView]",O5="[object Uint8Array]",S5="[object Uint8ClampedArray]",R5="[object Uint16Array]",D5="[object Uint32Array]",k5="[object BigUint64Array]",U5="[object Int8Array]",B5="[object Int16Array]",$5="[object Int32Array]",L5="[object BigInt64Array]",M5="[object Float32Array]",F5="[object Float64Array]";function j5(r,e){return r===e||Number.isNaN(r)&&Number.isNaN(e)}function H5(r,e,t){return Jl(r,e,void 0,void 0,void 0,void 0,t)}function Jl(r,e,t,n,s,i,o){const a=o(r,e,t,n,s,i);if(a!==void 0)return a;if(typeof r==typeof e)switch(typeof r){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return r===e;case"number":return r===e||Object.is(r,e);case"function":return r===e;case"object":return cu(r,e,i,o)}return cu(r,e,i,o)}function cu(r,e,t,n){if(Object.is(r,e))return!0;let s=Fb(r),i=Fb(e);if(s===jb&&(s=Zp),i===jb&&(i=Zp),s!==i)return!1;switch(s){case w5:return r.toString()===e.toString();case b5:{const c=r.valueOf(),l=e.valueOf();return j5(c,l)}case v5:case A5:case E5:return Object.is(r.valueOf(),e.valueOf());case y5:return r.source===e.source&&r.flags===e.flags;case N5:return r===e}t=t??new Map;const o=t.get(r),a=t.get(e);if(o!=null&&a!=null)return o===e;t.set(r,e),t.set(e,r);try{switch(s){case _5:{if(r.size!==e.size)return!1;for(const[c,l]of r.entries())if(!e.has(c)||!Jl(l,e.get(c),c,r,e,t,n))return!1;return!0}case C5:{if(r.size!==e.size)return!1;const c=Array.from(r.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const h=c[u],d=l.findIndex(f=>Jl(h,f,void 0,r,e,t,n));if(d===-1)return!1;l.splice(d,1)}return!0}case I5:case O5:case S5:case R5:case D5:case k5:case U5:case B5:case $5:case L5:case M5:case F5:{if(typeof Ut<"u"&&Ut.isBuffer(r)!==Ut.isBuffer(e)||r.length!==e.length)return!1;for(let c=0;c<r.length;c++)if(!Jl(r[c],e[c],c,r,e,t,n))return!1;return!0}case x5:return r.byteLength!==e.byteLength?!1:cu(new Uint8Array(r),new Uint8Array(e),t,n);case T5:return r.byteLength!==e.byteLength||r.byteOffset!==e.byteOffset?!1:cu(new Uint8Array(r),new Uint8Array(e),t,n);case P5:return r.name===e.name&&r.message===e.message;case Zp:{if(!(cu(r.constructor,e.constructor,t,n)||Lb(r)&&Lb(e)))return!1;const c=[...Object.keys(r),...Mb(r)],l=[...Object.keys(e),...Mb(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const h=c[u],d=r[h];if(!Object.hasOwn(e,h))return!1;const f=e[h];if(!Jl(d,f,h,r,e,t,n))return!1}return!0}default:return!1}}finally{t.delete(r),t.delete(e)}}function q5(r,e){return H5(r,e,m5)}var z5=Object.defineProperty,Hb=Object.getOwnPropertySymbols,V5=Object.prototype.hasOwnProperty,G5=Object.prototype.propertyIsEnumerable,pm=(r,e,t)=>e in r?z5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,qb=(r,e)=>{for(var t in e||(e={}))V5.call(e,t)&&pm(r,t,e[t]);if(Hb)for(var t of Hb(e))G5.call(e,t)&&pm(r,t,e[t]);return r},gr=(r,e,t)=>pm(r,typeof e!="symbol"?e+"":e,t);class wa extends UP{constructor(e,t,n,s=ps,i=void 0){super(e,t,n,s),this.core=e,this.logger=t,this.name=n,gr(this,"map",new Map),gr(this,"version",W8),gr(this,"cached",[]),gr(this,"initialized",!1),gr(this,"getKey"),gr(this,"storagePrefix",ps),gr(this,"recentlyDeleted",[]),gr(this,"recentlyDeletedLimit",200),gr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!jt(o)?this.map.set(this.getKey(o),o):qk(o)?this.map.set(o.id,o):zk(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),gr(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),gr(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),gr(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>q5(a[c],o[c]))):this.values)),gr(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=qb(qb({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),gr(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=er(t,this.name),this.storagePrefix=s,this.getKey=i}get context(){return xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:s}=ee("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:n}=ee("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}var K5=Object.defineProperty,W5=(r,e,t)=>e in r?K5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ke=(r,e,t)=>W5(r,typeof e!="symbol"?e+"":e,t);class Q5{constructor(e,t){this.core=e,this.logger=t,ke(this,"name",Y8),ke(this,"version",X8),ke(this,"events",new uy),ke(this,"pairings"),ke(this,"initialized",!1),ke(this,"storagePrefix",ps),ke(this,"ignoredPayloadTypes",[Ws]),ke(this,"registeredMethods",[]),ke(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ke(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),ke(this,"create",async n=>{this.isInitialized();const s=im(),i=await this.core.crypto.setSymKey(s),o=_t(X.FIVE_MINUTES),a={protocol:JA},c={topic:i,expiry:o,relay:a,active:!1,methods:n==null?void 0:n.methods},l=db({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:n==null?void 0:n.methods});return this.events.emit(co.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:n==null?void 0:n.transportType}),{topic:i,uri:l}}),ke(this,"pair",async n=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:n==null?void 0:n.uri,trace:[Qn.pairing_started]}});this.isValidPair(n,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=hb(n.uri);s.props.properties.topic=i,s.addTrace(Qn.pairing_uri_validation_success),s.addTrace(Qn.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(Qn.existing_pairing),u.active)throw s.setError(Cs.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(Qn.pairing_not_expired)}const h=c||_t(X.FIVE_MINUTES),d={topic:i,relay:a,expiry:h,active:!1,methods:l};this.core.expirer.set(i,h),await this.pairings.set(i,d),s.addTrace(Qn.store_new_pairing),n.activatePairing&&await this.activate({topic:i}),this.events.emit(co.create,d),s.addTrace(Qn.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(Qn.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(Cs.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(f){throw s.setError(Cs.subscribe_pairing_topic_failure),f}return s.addTrace(Qn.subscribe_pairing_topic_success),d}),ke(this,"activate",async({topic:n})=>{this.isInitialized();const s=_t(X.FIVE_MINUTES);this.core.expirer.set(n,s),await this.pairings.update(n,{active:!0,expiry:s})}),ke(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=n;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=ro();this.events.once(ze("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),ke(this,"updateExpiry",async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})}),ke(this,"updateMetadata",async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})}),ke(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ke(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Ke("USER_DISCONNECTED")),await this.deletePairing(s))}),ke(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(s);return db({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),ke(this,"sendRequest",async(n,s,i)=>{const o=Li(s,i),a=await this.core.crypto.encode(n,o),c=Ll[s].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),ke(this,"sendResult",async(n,s,i)=>{const o=Qf(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=Ll[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ke(this,"sendError",async(n,s,i)=>{const o=Jf(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=Ll[c]?Ll[c].res:Ll.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ke(this,"deletePairing",async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Ke("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])}),ke(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(s=>fi(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))}),ke(this,"onRelayEventRequest",async n=>{const{topic:s,payload:i}=n;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),ke(this,"onRelayEventResponse",async n=>{const{topic:s,payload:i}=n,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),ke(this,"onPairingPingRequest",async(n,s)=>{const{id:i}=s;try{this.isValidPing({topic:n}),await this.sendResult(i,n,!0),this.events.emit(co.ping,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),ke(this,"onPairingPingResponse",(n,s)=>{const{id:i}=s;setTimeout(()=>{Zn(s)?this.events.emit(ze("pairing_ping",i),{}):cn(s)&&this.events.emit(ze("pairing_ping",i),{error:s.error})},500)}),ke(this,"onPairingDeleteRequest",async(n,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(co.delete,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),ke(this,"onUnknownRpcMethodRequest",async(n,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=Ke("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,n,a),this.logger.error(a)}catch(a){await this.sendError(i,n,a),this.logger.error(a)}}),ke(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(Ke("WC_METHOD_UNSUPPORTED",n))}),ke(this,"isValidPair",(n,s)=>{var i;if(!br(n)){const{message:a}=ee("MISSING_OR_INVALID",`pair() params: ${n}`);throw s.setError(Cs.malformed_pairing_uri),new Error(a)}if(!Hk(n.uri)){const{message:a}=ee("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw s.setError(Cs.malformed_pairing_uri),new Error(a)}const o=hb(n==null?void 0:n.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=ee("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(Cs.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=ee("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(Cs.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&X.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(Cs.pairing_expired);const{message:a}=ee("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ke(this,"isValidPing",async n=>{if(!br(n)){const{message:i}=ee("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),ke(this,"isValidDisconnect",async n=>{if(!br(n)){const{message:i}=ee("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),ke(this,"isValidPairingTopic",async n=>{if(!Et(n,!1)){const{message:s}=ee("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=ee("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(fi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=ee("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}}),this.core=e,this.logger=er(t,this.name),this.pairings=new wa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return xr(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(St.message,async e=>{const{topic:t,message:n,transportType:s}=e;if(this.pairings.keys.includes(t)&&s!==nt.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const i=await this.core.crypto.decode(t,n);Sy(i)?(this.core.history.set(t,i),await this.onRelayEventRequest({topic:t,payload:i})):Zf(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:t,payload:i}),this.core.history.delete(t,i.id)),await this.core.relayer.messages.ack(t,n)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(en.expired,async e=>{const{topic:t}=aA(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(co.expire,{topic:t}))})}}var J5=Object.defineProperty,Z5=(r,e,t)=>e in r?J5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Lt=(r,e,t)=>Z5(r,typeof e!="symbol"?e+"":e,t);class Y5 extends SP{constructor(e,t){super(e,t),this.core=e,this.logger=t,Lt(this,"records",new Map),Lt(this,"events",new Mn.EventEmitter),Lt(this,"name",eU),Lt(this,"version",tU),Lt(this,"cached",[]),Lt(this,"initialized",!1),Lt(this,"storagePrefix",ps),Lt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Lt(this,"set",(n,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:i,expiry:_t(X.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(gn.created,o)}),Lt(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=cn(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.persist(),this.events.emit(gn.updated,s))}),Lt(this,"get",async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s))),Lt(this,"delete",(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===n){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(gn.deleted,i)}}),this.persist()}),Lt(this,"exists",async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1)),Lt(this,"on",(n,s)=>{this.events.on(n,s)}),Lt(this,"once",(n,s)=>{this.events.once(n,s)}),Lt(this,"off",(n,s)=>{this.events.off(n,s)}),Lt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=er(t,this.name)}get context(){return xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:Li(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:n}=ee("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(gn.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(gn.created,e=>{const t=gn.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(gn.updated,e=>{const t=gn.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(gn.deleted,e=>{const t=gn.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(bl.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{X.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(gn.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}var X5=Object.defineProperty,e4=(r,e,t)=>e in r?X5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Wt=(r,e,t)=>e4(r,typeof e!="symbol"?e+"":e,t);class t4 extends $P{constructor(e,t){super(e,t),this.core=e,this.logger=t,Wt(this,"expirations",new Map),Wt(this,"events",new Mn.EventEmitter),Wt(this,"name",rU),Wt(this,"version",nU),Wt(this,"cached",[]),Wt(this,"initialized",!1),Wt(this,"storagePrefix",ps),Wt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Wt(this,"has",n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}}),Wt(this,"set",(n,s)=>{this.isInitialized();const i=this.formatTarget(n),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(en.created,{target:i,expiration:o})}),Wt(this,"get",n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)}),Wt(this,"del",n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(en.deleted,{target:s,expiration:i})}}),Wt(this,"on",(n,s)=>{this.events.on(n,s)}),Wt(this,"once",(n,s)=>{this.events.once(n,s)}),Wt(this,"off",(n,s)=>{this.events.off(n,s)}),Wt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=er(t,this.name)}get context(){return xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return XR(e);if(typeof e=="number")return eD(e);const{message:t}=ee("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(en.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:n}=ee("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return t}checkExpiry(e,t){const{expiry:n}=t;X.toMiliseconds(n)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(en.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(bl.pulse,()=>this.checkExpirations()),this.events.on(en.created,e=>{const t=en.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(en.expired,e=>{const t=en.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(en.deleted,e=>{const t=en.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}var r4=Object.defineProperty,n4=(r,e,t)=>e in r?r4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,vt=(r,e,t)=>n4(r,typeof e!="symbol"?e+"":e,t);class s4 extends LP{constructor(e,t,n){super(e,t,n),this.core=e,this.logger=t,this.store=n,vt(this,"name",sU),vt(this,"abortController"),vt(this,"isDevEnv"),vt(this,"verifyUrlV3",oU),vt(this,"storagePrefix",ps),vt(this,"version",QA),vt(this,"publicKey"),vt(this,"fetchPromise"),vt(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&X.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),vt(this,"register",async s=>{if(!Sh()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=ta.getDocument(),u=this.startAbortTimer(X.ONE_SECOND*5),h=await new Promise((d,f)=>{const p=()=>{window.removeEventListener("message",v),l.body.removeChild(m),f("attestation aborted")};this.abortController.signal.addEventListener("abort",p);const m=l.createElement("iframe");m.src=c,m.style.display="none",m.addEventListener("error",p,{signal:this.abortController.signal});const v=_=>{if(_.data&&typeof _.data=="string")try{const y=JSON.parse(_.data);if(y.type==="verify_attestation"){if(zg(y.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(m),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",v),d(y.attestation===null?"":y.attestation)}}catch(y){this.logger.warn(y)}};l.body.appendChild(m),window.addEventListener("message",v,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",h),h}catch(l){this.logger.warn(l)}return""}),vt(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(zg(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,c)}),vt(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(X.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),vt(this,"getVerifyUrl",s=>{let i=s||au;return aU.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${au}`),i=au),i}),vt(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(X.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),vt(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),vt(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),vt(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),vt(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),vt(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),vt(this,"validateAttestation",(s,i)=>{const o=Tk(s,i.publicKey),a={hasExpired:X.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=er(t,this.name),this.abortController=new AbortController,this.isDevEnv=Ey(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return xr(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),X.toMiliseconds(e))}}var i4=Object.defineProperty,o4=(r,e,t)=>e in r?i4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,zb=(r,e,t)=>o4(r,typeof e!="symbol"?e+"":e,t);class a4 extends MP{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,zb(this,"context",cU),zb(this,"registerDeviceToken",async n=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=n,c=`${lU}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=er(t,this.context)}}var c4=Object.defineProperty,Vb=Object.getOwnPropertySymbols,l4=Object.prototype.hasOwnProperty,u4=Object.prototype.propertyIsEnumerable,gm=(r,e,t)=>e in r?c4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,jl=(r,e)=>{for(var t in e||(e={}))l4.call(e,t)&&gm(r,t,e[t]);if(Vb)for(var t of Vb(e))u4.call(e,t)&&gm(r,t,e[t]);return r},It=(r,e,t)=>gm(r,typeof e!="symbol"?e+"":e,t);class h4 extends FP{constructor(e,t,n=!0){super(e,t,n),this.core=e,this.logger=t,It(this,"context",hU),It(this,"storagePrefix",ps),It(this,"storageVersion",uU),It(this,"events",new Map),It(this,"shouldPersist",!1),It(this,"init",async()=>{if(!Ey())try{const s={eventId:U0(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:iA(this.core.relayer.protocol,this.core.relayer.version,am)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),It(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=U0(),u=this.core.projectId||"",h=Date.now(),d=jl({eventId:l,timestamp:h,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,d),this.shouldPersist=!0),d}),It(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return jl(jl({},a),this.setMethods(a.eventId))}),It(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),It(this,"setEventListeners",()=>{this.core.heartbeat.on(bl.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{X.fromMiliseconds(Date.now())-X.fromMiliseconds(s.timestamp)>dU&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),It(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),It(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),It(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),It(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),It(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,jl(jl({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),It(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),It(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${fU}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${am}${i}`,{method:"POST",body:JSON.stringify(s)})}),It(this,"getAppDomain",()=>sA().url),this.logger=er(t,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var d4=Object.defineProperty,Gb=Object.getOwnPropertySymbols,f4=Object.prototype.hasOwnProperty,p4=Object.prototype.propertyIsEnumerable,mm=(r,e,t)=>e in r?d4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Kb=(r,e)=>{for(var t in e||(e={}))f4.call(e,t)&&mm(r,t,e[t]);if(Gb)for(var t of Gb(e))p4.call(e,t)&&mm(r,t,e[t]);return r},rt=(r,e,t)=>mm(r,typeof e!="symbol"?e+"":e,t);let g4=class l_ extends xP{constructor(e){var t;super(e),rt(this,"protocol",WA),rt(this,"version",QA),rt(this,"name",om),rt(this,"relayUrl"),rt(this,"projectId"),rt(this,"customStoragePrefix"),rt(this,"events",new Mn.EventEmitter),rt(this,"logger"),rt(this,"heartbeat"),rt(this,"relayer"),rt(this,"crypto"),rt(this,"storage"),rt(this,"history"),rt(this,"expirer"),rt(this,"pairing"),rt(this,"verify"),rt(this,"echoClient"),rt(this,"linkModeSupportedApps"),rt(this,"eventClient"),rt(this,"initialized",!1),rt(this,"logChunkController"),rt(this,"on",(a,c)=>this.events.on(a,c)),rt(this,"once",(a,c)=>this.events.once(a,c)),rt(this,"off",(a,c)=>this.events.off(a,c)),rt(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),rt(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:nt.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const n=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||ZA,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=vl({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:U8.logger,name:om}),{logger:i,chunkLoggerController:o}=dy({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=er(i,this.name),this.heartbeat=new Px,this.crypto=new HB(this,this.logger,e==null?void 0:e.keychain),this.history=new Y5(this,this.logger),this.expirer=new t4(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new uP(Kb(Kb({},B8),e==null?void 0:e.storageOptions)),this.relayer=new g5({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Q5(this,this.logger),this.verify=new s4(this,this.logger,this.storage),this.echoClient=new a4(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new h4(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const t=new l_(e);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(Q8,n),t}get context(){return xr(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(Nb,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Nb)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,n=`${t}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[t]}catch(t){console.warn("Failed to get global WalletConnect core",t);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((t=e.opts)==null?void 0:t.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof hs<"u"&&k8.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const m4=g4,u_="wc",h_=2,d_="client",Ry=`${u_}@${h_}:${d_}:`,Yp={name:d_,logger:"error"},Wb="WALLETCONNECT_DEEPLINK_CHOICE",y4="proposal",Qb="Proposal expired",w4="session",xa=X.SEVEN_DAYS,b4="engine",Nt={wc_sessionPropose:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1104},res:{ttl:X.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1106},res:{ttl:X.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1112},res:{ttl:X.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1114},res:{ttl:X.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:X.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:X.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1119}}},Xp={min:X.FIVE_MINUTES,max:X.SEVEN_DAYS},Vn={idle:"IDLE",active:"ACTIVE"},Jb={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},v4="request",E4=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],A4="wc",_4="auth",C4="authKeys",I4="pairingTopics",N4="requests",Xf=`${A4}@${1.5}:${_4}:`,Ud=`${Xf}:PUB_KEY`;var x4=Object.defineProperty,P4=Object.defineProperties,T4=Object.getOwnPropertyDescriptors,Zb=Object.getOwnPropertySymbols,O4=Object.prototype.hasOwnProperty,S4=Object.prototype.propertyIsEnumerable,ym=(r,e,t)=>e in r?x4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ze=(r,e)=>{for(var t in e||(e={}))O4.call(e,t)&&ym(r,t,e[t]);if(Zb)for(var t of Zb(e))S4.call(e,t)&&ym(r,t,e[t]);return r},tr=(r,e)=>P4(r,T4(e)),K=(r,e,t)=>ym(r,typeof e!="symbol"?e+"":e,t);class R4 extends zP{constructor(e){super(e),K(this,"name",b4),K(this,"events",new uy),K(this,"initialized",!1),K(this,"requestQueue",{state:Vn.idle,queue:[]}),K(this,"sessionRequestQueue",{state:Vn.idle,queue:[]}),K(this,"requestQueueDelay",X.ONE_SECOND),K(this,"expectedPairingMethodMap",new Map),K(this,"recentlyDeletedMap",new Map),K(this,"recentlyDeletedLimit",200),K(this,"relayMessageCache",[]),K(this,"pendingSessions",new Map),K(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Nt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay)))}),K(this,"connect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=tr(Ze({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=n;let u=s,h,d=!1;try{if(u){const B=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),d=B.active}}catch(B){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),B}if(!u||!d){const{topic:B,uri:$}=await this.client.core.pairing.create();u=B,h=$}if(!u){const{message:B}=ee("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(B)}const f=await this.client.core.crypto.generateKeyPair(),p=Nt.wc_sessionPropose.req.ttl||X.FIVE_MINUTES,m=_t(p),v=tr(Ze(Ze({requiredNamespaces:i,optionalNamespaces:o,relays:l??[{protocol:JA}],proposer:{publicKey:f,metadata:this.client.metadata},expiryTimestamp:m,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:Jn()}),_=ze("session_connect",v.id),{reject:y,resolve:C,done:U}=ro(p,Qb),L=({id:B})=>{B===v.id&&(this.client.events.off("proposal_expire",L),this.pendingSessions.delete(v.id),this.events.emit(_,{error:{message:Qb,code:0}}))};return this.client.events.on("proposal_expire",L),this.events.once(_,({error:B,session:$})=>{this.client.events.off("proposal_expire",L),B?y(B):$&&C($)}),await this.sendRequest({topic:u,method:"wc_sessionPropose",params:v,throwOnFailedPublish:!0,clientRpcId:v.id}),await this.setProposal(v.id,v),{uri:h,approval:U}}),K(this,"pair",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(n){throw this.client.logger.error("pair() failed"),n}}),K(this,"approve",async t=>{var n,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=t==null?void 0:t.id)==null?void 0:n.toString(),trace:[mn.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(b){throw o.setError(Yi.no_internet_connection),b}try{await this.isValidProposalId(t==null?void 0:t.id)}catch(b){throw this.client.logger.error(`approve() -> proposal.get(${t==null?void 0:t.id}) failed`),o.setError(Yi.proposal_not_found),b}try{await this.isValidApprove(t)}catch(b){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Yi.session_approve_namespace_validation_failure),b}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:d}=t,f=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:p,proposer:m,requiredNamespaces:v,optionalNamespaces:_}=f;let y=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:p});y||(y=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:mn.session_approve_started,properties:{topic:p,trace:[mn.session_approve_started,mn.session_namespaces_validation_success]}}));const C=await this.client.core.crypto.generateKeyPair(),U=m.publicKey,L=await this.client.core.crypto.generateSharedKey(C,U),B=Ze(Ze(Ze({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:C,metadata:this.client.metadata},expiry:_t(xa)},u&&{sessionProperties:u}),h&&{scopedProperties:h}),d&&{sessionConfig:d}),$=nt.relay;y.addTrace(mn.subscribing_session_topic);try{await this.client.core.relayer.subscribe(L,{transportType:$})}catch(b){throw y.setError(Yi.subscribe_session_topic_failure),b}y.addTrace(mn.subscribe_session_topic_success);const g=tr(Ze({},B),{topic:L,requiredNamespaces:v,optionalNamespaces:_,pairingTopic:p,acknowledged:!1,self:B.controller,peer:{publicKey:m.publicKey,metadata:m.metadata},controller:C,transportType:nt.relay});await this.client.session.set(L,g),y.addTrace(mn.store_session);try{y.addTrace(mn.publishing_session_settle),await this.sendRequest({topic:L,method:"wc_sessionSettle",params:B,throwOnFailedPublish:!0}).catch(b=>{throw y==null||y.setError(Yi.session_settle_publish_failure),b}),y.addTrace(mn.session_settle_publish_success),y.addTrace(mn.publishing_session_approve),await this.sendResult({id:a,topic:p,result:{relay:{protocol:c??"irn"},responderPublicKey:C},throwOnFailedPublish:!0}).catch(b=>{throw y==null||y.setError(Yi.session_approve_publish_failure),b}),y.addTrace(mn.session_approve_publish_success)}catch(b){throw this.client.logger.error(b),this.client.session.delete(L,Ke("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(L),b}return this.client.core.eventClient.deleteEvent({eventId:y.eventId}),await this.client.core.pairing.updateMetadata({topic:p,metadata:m.metadata}),await this.client.proposal.delete(a,Ke("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:p}),await this.setExpiry(L,_t(xa)),{topic:L,acknowledged:()=>Promise.resolve(this.client.session.get(L))}}),K(this,"reject",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:s}=t;let i;try{i=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}i&&(await this.sendError({id:n,topic:i,error:s,rpcOpts:Nt.wc_sessionPropose.reject}),await this.client.proposal.delete(n,Ke("USER_DISCONNECTED")))}),K(this,"update",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(h){throw this.client.logger.error("update() -> isValidUpdate() failed"),h}const{topic:n,namespaces:s}=t,{done:i,resolve:o,reject:a}=ro(),c=Jn(),l=yo().toString(),u=this.client.session.get(n).namespaces;return this.events.once(ze("session_update",c),({error:h})=>{h?a(h):o()}),await this.client.session.update(n,{namespaces:s}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(h=>{this.client.logger.error(h),this.client.session.update(n,{namespaces:u}),a(h)}),{acknowledged:i}}),K(this,"extend",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=t,s=Jn(),{done:i,resolve:o,reject:a}=ro();return this.events.once(ze("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,_t(xa)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),K(this,"request",async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(_){throw this.client.logger.error("request() -> isValidRequest() failed"),_}const{chainId:n,request:s,topic:i,expiry:o=Nt.wc_sessionRequest.req.ttl}=t,a=this.client.session.get(i);(a==null?void 0:a.transportType)===nt.relay&&await this.confirmOnlineStateOrThrow();const c=Jn(),l=yo().toString(),{done:u,resolve:h,reject:d}=ro(o,"Request expired. Please try again.");this.events.once(ze("session_request",c),({error:_,result:y})=>{_?d(_):h(y)});const f="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:{request:tr(Ze({},s),{expiryTimestamp:_t(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(_=>d(_)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),await u();const m={request:tr(Ze({},s),{expiryTimestamp:_t(o)}),chainId:n},v=this.shouldSetTVF(f,m);return await Promise.all([new Promise(async _=>{await this.sendRequest(Ze({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:m,expiry:o,throwOnFailedPublish:!0},v&&{tvf:this.getTVFParams(c,m)})).catch(y=>d(y)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),_()}),new Promise(async _=>{var y;if(!((y=a.sessionConfig)!=null&&y.disableDeepLink)){const C=await sD(this.client.core.storage,Wb);await tD({id:c,topic:i,wcDeepLink:C})}_()}),u()]).then(_=>_[2])}),K(this,"respond",async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:s}=t,{id:i}=s,o=this.client.session.get(n);o.transportType===nt.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Zn(s)?await this.sendResult({id:i,topic:n,result:s.result,throwOnFailedPublish:!0,appLink:a}):cn(s)&&await this.sendError({id:i,topic:n,error:s.error,appLink:a}),this.cleanupAfterResponse(t)}),K(this,"ping",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:n}=t;if(this.client.session.keys.includes(n)){const s=Jn(),i=yo().toString(),{done:o,resolve:a,reject:c}=ro();this.events.once(ze("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),K(this,"emit",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:n,event:s,chainId:i}=t,o=yo().toString(),a=Jn();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),K(this,"disconnect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:n}=t;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Ke("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:s}=ee("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(s)}}),K(this,"find",t=>(this.isInitialized(),this.client.session.getAll().filter(n=>Fk(n,t)))),K(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),K(this,"authenticate",async(t,n)=>{var s;this.isInitialized(),this.isValidAuthenticate(t);const i=n&&this.client.core.linkModeSupportedApps.includes(n)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?nt.link_mode:nt.relay;o===nt.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:h,type:d,exp:f,nbf:p,methods:m=[],expiry:v}=t,_=[...t.resources||[]],{topic:y,uri:C}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:y,uri:C}});const U=await this.client.core.crypto.generateKeyPair(),L=Dd(U);if(await Promise.all([this.client.auth.authKeys.set(Ud,{responseTopic:L,publicKey:U}),this.client.auth.pairingTopics.set(L,{topic:L,pairingTopic:y})]),await this.client.core.relayer.subscribe(L,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${y}`),m.length>0){const{namespace:k}=nc(a[0]);let j=JD(k,"request",m);Rd(_)&&(j=YD(j,_.pop())),_.push(j)}const B=v&&v>Nt.wc_sessionAuthenticate.req.ttl?v:Nt.wc_sessionAuthenticate.req.ttl,$={authPayload:{type:d??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:h,iat:new Date().toISOString(),exp:f,nbf:p,resources:_},requester:{publicKey:U,metadata:this.client.metadata},expiryTimestamp:_t(B)},g={eip155:{chains:a,methods:[...new Set(["personal_sign",...m])],events:["chainChanged","accountsChanged"]}},b={requiredNamespaces:{},optionalNamespaces:g,relays:[{protocol:"irn"}],pairingTopic:y,proposer:{publicKey:U,metadata:this.client.metadata},expiryTimestamp:_t(Nt.wc_sessionPropose.req.ttl),id:Jn()},{done:N,resolve:x,reject:I}=ro(B,"Request expired"),D=Jn(),S=ze("session_connect",b.id),E=ze("session_request",D),A=async({error:k,session:j})=>{this.events.off(E,T),k?I(k):j&&x({session:j})},T=async k=>{var j,q,z;if(await this.deletePendingAuthRequest(D,{message:"fulfilled",code:0}),k.error){const ge=Ke("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return k.error.code===ge.code?void 0:(this.events.off(S,A),I(k.error.message))}await this.deleteProposal(b.id),this.events.off(S,A);const{cacaos:Q,responder:J}=k.result,Z=[],te=[];for(const ge of Q){await q0({cacao:ge,projectId:this.client.core.projectId})||(this.client.logger.error(ge,"Signature verification failed"),I(Ke("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:De}=ge,xe=Rd(De.resources),Se=[Jg(De.iss)],fe=Xd(De.iss);if(xe){const ue=z0(xe),Ee=V0(xe);Z.push(...ue),Se.push(...Ee)}for(const ue of Se)te.push(`${ue}:${fe}`)}const re=await this.client.core.crypto.generateSharedKey(U,J.publicKey);let pe;Z.length>0&&(pe={topic:re,acknowledged:!0,self:{publicKey:U,metadata:this.client.metadata},peer:J,controller:J.publicKey,expiry:_t(xa),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:y,namespaces:fb([...new Set(Z)],[...new Set(te)]),transportType:o},await this.client.core.relayer.subscribe(re,{transportType:o}),await this.client.session.set(re,pe),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:J.metadata}),pe=this.client.session.get(re)),(j=this.client.metadata.redirect)!=null&&j.linkMode&&(q=J.metadata.redirect)!=null&&q.linkMode&&(z=J.metadata.redirect)!=null&&z.universal&&n&&(this.client.core.addLinkModeSupportedApp(J.metadata.redirect.universal),this.client.session.update(re,{transportType:nt.link_mode})),x({auths:Q,session:pe})};this.events.once(S,A),this.events.once(E,T);let O;try{if(i){const k=Li("wc_sessionAuthenticate",$,D);this.client.core.history.set(y,k);const j=await this.client.core.crypto.encode("",k,{type:$h,encoding:gi});O=rd(n,y,j)}else await Promise.all([this.sendRequest({topic:y,method:"wc_sessionAuthenticate",params:$,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:D}),this.sendRequest({topic:y,method:"wc_sessionPropose",params:b,expiry:Nt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:b.id})])}catch(k){throw this.events.off(S,A),this.events.off(E,T),k}return await this.setProposal(b.id,b),await this.setAuthRequest(D,{request:tr(Ze({},$),{verifyContext:{}}),pairingTopic:y,transportType:o}),{uri:O??C,response:N}}),K(this,"approveSessionAuthenticate",async t=>{const{id:n,auths:s}=t,i=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[Xi.authenticated_session_approve_started]}});try{this.isInitialized()}catch(v){throw i.setError(Ml.no_internet_connection),v}const o=this.getPendingAuthRequest(n);if(!o)throw i.setError(Ml.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||nt.relay;a===nt.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=Dd(c),h={type:Ws,receiverPublicKey:c,senderPublicKey:l},d=[],f=[];for(const v of s){if(!await q0({cacao:v,projectId:this.client.core.projectId})){i.setError(Ml.invalid_cacao);const L=Ke("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:u,error:L,encodeOpts:h}),new Error(L.message)}i.addTrace(Xi.cacaos_verified);const{p:_}=v,y=Rd(_.resources),C=[Jg(_.iss)],U=Xd(_.iss);if(y){const L=z0(y),B=V0(y);d.push(...L),C.push(...B)}for(const L of C)f.push(`${L}:${U}`)}const p=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(Xi.create_authenticated_session_topic);let m;if((d==null?void 0:d.length)>0){m={topic:p,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:_t(xa),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:fb([...new Set(d)],[...new Set(f)]),transportType:a},i.addTrace(Xi.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(v){throw i.setError(Ml.subscribe_authenticated_session_topic_failure),v}i.addTrace(Xi.subscribe_authenticated_session_topic_success),await this.client.session.set(p,m),i.addTrace(Xi.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Xi.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:n,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(v){throw i.setError(Ml.authenticated_session_approve_publish_failure),v}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:m}}),K(this,"rejectSessionAuthenticate",async t=>{this.isInitialized();const{id:n,reason:s}=t,i=this.getPendingAuthRequest(n);if(!i)throw new Error(`Could not find pending auth request with id ${n}`);i.transportType===nt.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=Dd(o),l={type:Ws,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:s,encodeOpts:l,rpcOpts:Nt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.client.proposal.delete(n,Ke("USER_DISCONNECTED"))}),K(this,"formatAuthMessage",t=>{this.isInitialized();const{request:n,iss:s}=t;return mA(n,s)}),K(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)}),K(this,"cleanupDuplicatePairings",async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===t.peer.metadata.url&&i.topic&&i.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),K(this,"deleteSession",async t=>{var n;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=t,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,Ke("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(Wb).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===s&&this.deletePendingSessionRequest(l.id,Ke("USER_DISCONNECTED"))}),s===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=Vn.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),K(this,"deleteProposal",async(t,n)=>{if(n)try{const s=this.client.proposal.get(t),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(Yi.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,Ke("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")}),K(this,"deletePendingSessionRequest",async(t,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==t),s&&(this.sessionRequestQueue.state=Vn.idle,this.client.events.emit("session_request_expire",{id:t}))}),K(this,"deletePendingAuthRequest",async(t,n,s=!1)=>{await Promise.all([this.client.auth.requests.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)])}),K(this,"setExpiry",async(t,n)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,n),await this.client.session.update(t,{expiry:n}))}),K(this,"setProposal",async(t,n)=>{this.client.core.expirer.set(t,_t(Nt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,n)}),K(this,"setAuthRequest",async(t,n)=>{const{request:s,pairingTopic:i,transportType:o=nt.relay}=n;this.client.core.expirer.set(t,s.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:t,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),K(this,"setPendingSessionRequest",async t=>{const{id:n,topic:s,params:i,verifyContext:o}=t,a=i.request.expiryTimestamp||_t(Nt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:s,params:i,verifyContext:o})}),K(this,"sendRequest",async t=>{const{topic:n,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:h}=t,d=Li(s,i,c);let f;const p=!!u;try{const _=p?gi:Sn;f=await this.client.core.crypto.encode(n,d,{encoding:_})}catch(_){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),_}let m;if(E4.includes(s)){const _=as(JSON.stringify(d)),y=as(f);m=await this.client.core.verify.register({id:y,decryptedId:_})}const v=Nt[s].req;if(v.attestation=m,o&&(v.ttl=o),a&&(v.id=a),this.client.core.history.set(n,d),p){const _=rd(u,n,f);await be.Linking.openURL(_,this.client.name)}else{const _=Nt[s].req;o&&(_.ttl=o),a&&(_.id=a),_.tvf=tr(Ze({},h),{correlationId:d.id}),l?(_.internal=tr(Ze({},_.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,f,_)):this.client.core.relayer.publish(n,f,_).catch(y=>this.client.logger.error(y))}return d.id}),K(this,"sendResult",async t=>{const{id:n,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=t,l=Qf(n,i);let u;const h=c&&typeof(be==null?void 0:be.Linking)<"u";try{const p=h?gi:Sn;u=await this.client.core.crypto.encode(s,l,tr(Ze({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),p}let d,f;try{d=await this.client.core.history.get(s,n);const p=d.request;try{this.shouldSetTVF(p.method,p.params)&&(f=this.getTVFParams(n,p.params,i))}catch(m){this.client.logger.warn("sendResult() -> getTVFParams() failed",m)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${n}) failed`),p}if(h){const p=rd(c,s,u);await be.Linking.openURL(p,this.client.name)}else{const p=d.request.method,m=Nt[p].res;m.tvf=tr(Ze({},f),{correlationId:n}),o?(m.internal=tr(Ze({},m.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,m)):this.client.core.relayer.publish(s,u,m).catch(v=>this.client.logger.error(v))}await this.client.core.history.resolve(l)}),K(this,"sendError",async t=>{const{id:n,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=t,l=Jf(n,i);let u;const h=c&&typeof(be==null?void 0:be.Linking)<"u";try{const f=h?gi:Sn;u=await this.client.core.crypto.encode(s,l,tr(Ze({},o||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),f}let d;try{d=await this.client.core.history.get(s,n)}catch(f){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),f}if(h){const f=rd(c,s,u);await be.Linking.openURL(f,this.client.name)}else{const f=d.request.method,p=a||Nt[f].res;this.client.core.relayer.publish(s,u,p)}await this.client.core.history.resolve(l)}),K(this,"cleanup",async()=>{const t=[],n=[];this.client.session.getAll().forEach(s=>{let i=!1;fi(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&t.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{fi(s.expiryTimestamp)&&n.push(s.id)}),await Promise.all([...t.map(s=>this.deleteSession({topic:s})),...n.map(s=>this.deleteProposal(s))])}),K(this,"onProviderMessageEvent",async t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):await this.onRelayMessage(t)}),K(this,"onRelayEventRequest",async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()}),K(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Vn.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Vn.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=Vn.idle}),K(this,"processRequest",async t=>{const{topic:n,payload:s,attestation:i,transportType:o,encryptedId:a}=t,c=s.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,s);case"wc_sessionPing":return await this.onSessionPingRequest(n,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),K(this,"onRelayEventResponse",async t=>{const{topic:n,payload:s,transportType:i}=t,o=(await this.client.core.history.get(n,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),K(this,"onRelayEventUnknownPayload",t=>{const{topic:n}=t,{message:s}=ee("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),K(this,"shouldIgnorePairingRequest",t=>{const{topic:n,requestMethod:s}=t,i=this.expectedPairingMethodMap.get(n);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),K(this,"onSessionProposeRequest",async t=>{const{topic:n,payload:s,attestation:i,encryptedId:o}=t,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l==null||l.setError(Cs.proposal_listener_not_found)),this.isValidConnect(Ze({},s.params));const u=a.expiryTimestamp||_t(Nt.wc_sessionPropose.req.ttl),h=Ze({id:c,pairingTopic:n,expiryTimestamp:u},a);await this.setProposal(c,h);const d=await this.getVerifyContext({attestationId:i,hash:as(JSON.stringify(s)),encryptedId:o,metadata:h.proposer.metadata});l==null||l.addTrace(Qn.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:h,verifyContext:d})}catch(l){await this.sendError({id:c,topic:n,error:l,rpcOpts:Nt.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),K(this,"onSessionProposeResponse",async(t,n,s)=>{const{id:i}=n;if(Zn(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:t,proposalId:i,publicKey:c});const h=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:h}),await this.client.core.pairing.activate({topic:t})}else if(cn(n)){await this.client.proposal.delete(i,Ke("USER_DISCONNECTED"));const o=ze("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),K(this,"onSessionSettleRequest",async(t,n)=>{const{id:s,params:i}=n;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:d}=n.params,f=[...this.pendingSessions.values()].find(v=>v.sessionTopic===t);if(!f)return this.client.logger.error(`Pending session not found for topic ${t}`);const p=this.client.proposal.get(f.proposalId),m=tr(Ze(Ze(Ze({topic:t,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:f.pairingTopic,requiredNamespaces:p.requiredNamespaces,optionalNamespaces:p.optionalNamespaces,controller:a.publicKey,self:{publicKey:f.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),h&&{scopedProperties:h}),d&&{sessionConfig:d}),{transportType:nt.relay});await this.client.session.set(m.topic,m),await this.setExpiry(m.topic,m.expiry),await this.client.core.pairing.updateMetadata({topic:f.pairingTopic,metadata:m.peer.metadata}),this.client.events.emit("session_connect",{session:m}),this.events.emit(ze("session_connect",f.proposalId),{session:m}),this.pendingSessions.delete(f.proposalId),this.deleteProposal(f.proposalId,!1),this.cleanupDuplicatePairings(m),await this.sendResult({id:n.id,topic:t,result:!0,throwOnFailedPublish:!0})}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),K(this,"onSessionSettleResponse",async(t,n)=>{const{id:s}=n;Zn(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(ze("session_approve",s),{})):cn(n)&&(await this.client.session.delete(t,Ke("USER_DISCONNECTED")),this.events.emit(ze("session_approve",s),{error:n.error}))}),K(this,"onSessionUpdateRequest",async(t,n)=>{const{params:s,id:i}=n;try{const o=`${t}_session_update`,a=$l.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:t,error:Ke("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Ze({topic:t},s));try{$l.set(o,i),await this.client.session.update(t,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0})}catch(c){throw $l.delete(o),c}this.client.events.emit("session_update",{id:i,topic:t,params:s})}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),K(this,"isRequestOutOfSync",(t,n)=>n.toString().slice(0,-3)<t.toString().slice(0,-3)),K(this,"onSessionUpdateResponse",(t,n)=>{const{id:s}=n,i=ze("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Zn(n)?this.events.emit(ze("session_update",s),{}):cn(n)&&this.events.emit(ze("session_update",s),{error:n.error})}),K(this,"onSessionExtendRequest",async(t,n)=>{const{id:s}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,_t(xa)),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),K(this,"onSessionExtendResponse",(t,n)=>{const{id:s}=n,i=ze("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Zn(n)?this.events.emit(ze("session_extend",s),{}):cn(n)&&this.events.emit(ze("session_extend",s),{error:n.error})}),K(this,"onSessionPingRequest",async(t,n)=>{const{id:s}=n;try{this.isValidPing({topic:t}),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),K(this,"onSessionPingResponse",(t,n)=>{const{id:s}=n,i=ze("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Zn(n)?this.events.emit(ze("session_ping",s),{}):cn(n)&&this.events.emit(ze("session_ping",s),{error:n.error})},500)}),K(this,"onSessionDeleteRequest",async(t,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),Promise.all([new Promise(i=>{this.client.core.relayer.once(St.publish,async()=>{i(await this.deleteSession({topic:t,id:s}))})}),this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:Ke("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),K(this,"onSessionRequest",async t=>{var n,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=t,{id:h,params:d}=a;try{await this.isValidRequest(Ze({topic:o},d));const f=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:as(JSON.stringify(Li("wc_sessionRequest",d,h))),encryptedId:l,metadata:f.peer.metadata,transportType:u}),m={id:h,topic:o,params:d,verifyContext:p};await this.setPendingSessionRequest(m),u===nt.link_mode&&(n=f.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((s=f.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(m):(this.addSessionRequestToSessionRequestQueue(m),this.processSessionRequestQueue())}catch(f){await this.sendError({id:h,topic:o,error:f}),this.client.logger.error(f)}}),K(this,"onSessionRequestResponse",(t,n)=>{const{id:s}=n,i=ze("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Zn(n)?this.events.emit(ze("session_request",s),{result:n.result}):cn(n)&&this.events.emit(ze("session_request",s),{error:n.error})}),K(this,"onSessionEventRequest",async(t,n)=>{const{id:s,params:i}=n;try{const o=`${t}_session_event_${i.event.name}`,a=$l.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(Ze({topic:t},i)),this.client.events.emit("session_event",{id:s,topic:t,params:i}),$l.set(o,s)}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),K(this,"onSessionAuthenticateResponse",(t,n)=>{const{id:s}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:n}),Zn(n)?this.events.emit(ze("session_request",s),{result:n.result}):cn(n)&&this.events.emit(ze("session_request",s),{error:n.error})}),K(this,"onSessionAuthenticateRequest",async t=>{var n;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=t;try{const{requester:l,authPayload:u,expiryTimestamp:h}=i.params,d=await this.getVerifyContext({attestationId:o,hash:as(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),f={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:d,expiryTimestamp:h};await this.setAuthRequest(i.id,{request:f,pairingTopic:s,transportType:c}),c===nt.link_mode&&(n=l.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:d})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),d=this.getAppLinkIfEnabled(i.params.requester.metadata,c),f={type:Ws,receiverPublicKey:u,senderPublicKey:h};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:f,rpcOpts:Nt.wc_sessionAuthenticate.autoReject,appLink:d})}}),K(this,"addSessionRequestToSessionRequestQueue",t=>{this.sessionRequestQueue.queue.push(t)}),K(this,"cleanupAfterResponse",t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Vn.idle,this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay))}),K(this,"cleanupPendingSentRequestsForTopic",({topic:t,error:n})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===t&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=ze("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(ze("session_request",i.request.id),{error:n})})}),K(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Vn.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Vn.active,this.emitSessionRequest(t)}catch(n){this.client.logger.error(n)}}),K(this,"emitSessionRequest",t=>{this.client.events.emit("session_request",t)}),K(this,"onPairingCreated",t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===t.topic);n&&this.onSessionProposeRequest({topic:t.topic,payload:Li("wc_sessionPropose",tr(Ze({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id)})}),K(this,"isValidConnect",async t=>{if(!br(t)){const{message:l}=ee("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(l)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=t;if(jt(n)||await this.isValidPairingTopic(n),!Yk(c)){const{message:l}=ee("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!jt(s)&&Eu(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!jt(i)&&Eu(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),jt(o)||this.validateSessionProps(o,"sessionProperties"),!jt(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u)))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),K(this,"validateNamespaces",(t,n)=>{const s=Zk(t,"connect()",n);if(s)throw new Error(s.message)}),K(this,"isValidApprove",async t=>{if(!br(t))throw new Error(ee("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=t;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),l=Gp(s,"approve()");if(l)throw new Error(l.message);const u=mb(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!Et(i,!0)){const{message:h}=ee("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(h)}if(jt(o)||this.validateSessionProps(o,"sessionProperties"),!jt(a)){this.validateSessionProps(a,"scopedProperties");const h=new Set(Object.keys(s));if(!Object.keys(a).every(d=>h.has(d)))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(h).join(", ")}`)}}),K(this,"isValidReject",async t=>{if(!br(t)){const{message:i}=ee("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(i)}const{id:n,reason:s}=t;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!e8(s)){const{message:i}=ee("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),K(this,"isValidSessionSettleRequest",t=>{if(!br(t)){const{message:l}=ee("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(l)}const{relay:n,controller:s,namespaces:i,expiry:o}=t;if(!HA(n)){const{message:l}=ee("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=Vk(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Gp(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(fi(o)){const{message:l}=ee("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),K(this,"isValidUpdate",async t=>{if(!br(t)){const{message:c}=ee("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(c)}const{topic:n,namespaces:s}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const i=this.client.session.get(n),o=Gp(s,"update()");if(o)throw new Error(o.message);const a=mb(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),K(this,"isValidExtend",async t=>{if(!br(t)){const{message:s}=ee("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(s)}const{topic:n}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),K(this,"isValidRequest",async t=>{if(!br(t)){const{message:c}=ee("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(c)}const{topic:n,request:s,chainId:i,expiry:o}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!gb(a,i)){const{message:c}=ee("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!t8(s)){const{message:c}=ee("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!s8(a,i,s.method)){const{message:c}=ee("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!c8(o,Xp)){const{message:c}=ee("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Xp.min} and ${Xp.max}`);throw new Error(c)}}),K(this,"isValidRespond",async t=>{var n;if(!br(t)){const{message:o}=ee("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(o)}const{topic:s,response:i}=t;try{await this.isValidSessionTopic(s)}catch(o){throw(n=t==null?void 0:t.response)!=null&&n.id&&this.cleanupAfterResponse(t),o}if(!r8(i)){const{message:o}=ee("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),K(this,"isValidPing",async t=>{if(!br(t)){const{message:s}=ee("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),K(this,"isValidEmit",async t=>{if(!br(t)){const{message:a}=ee("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(a)}const{topic:n,event:s,chainId:i}=t;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!gb(o,i)){const{message:a}=ee("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!n8(s)){const{message:a}=ee("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!i8(o,i,s.name)){const{message:a}=ee("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),K(this,"isValidDisconnect",async t=>{if(!br(t)){const{message:s}=ee("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),K(this,"isValidAuthenticate",t=>{const{chains:n,uri:s,domain:i,nonce:o}=t;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!Et(s,!1))throw new Error("uri is required parameter");if(!Et(i,!1))throw new Error("domain is required parameter");if(!Et(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>nc(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=nc(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),K(this,"getVerifyContext",async t=>{const{attestationId:n,hash:s,encryptedId:i,metadata:o,transportType:a}=t,c={verified:{verifyUrl:o.verifyUrl||au,validation:"UNKNOWN",origin:o.url||""}};try{if(a===nt.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:n,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),K(this,"validateSessionProps",(t,n)=>{Object.values(t).forEach((s,i)=>{if(s==null){const{message:o}=ee("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${s} for key ${Object.keys(t)[i]}`);throw new Error(o)}})}),K(this,"getPendingAuthRequest",t=>{const n=this.client.auth.requests.get(t);return typeof n=="object"?n:void 0}),K(this,"addToRecentlyDeleted",(t,n)=>{if(this.recentlyDeletedMap.set(t,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),K(this,"checkRecentlyDeleted",t=>{const n=this.recentlyDeletedMap.get(t);if(n){const{message:s}=ee("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${t}`);throw new Error(s)}}),K(this,"isLinkModeEnabled",(t,n)=>{var s,i,o,a,c,l,u,h,d;return!t||n!==nt.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=t==null?void 0:t.redirect)==null?void 0:u.universal)!==void 0&&((h=t==null?void 0:t.redirect)==null?void 0:h.universal)!==""&&((d=t==null?void 0:t.redirect)==null?void 0:d.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(be==null?void 0:be.Linking)<"u"}),K(this,"getAppLinkIfEnabled",(t,n)=>{var s;return this.isLinkModeEnabled(t,n)?(s=t==null?void 0:t.redirect)==null?void 0:s.universal:void 0}),K(this,"handleLinkModeMessage",({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const n=k0(t,"topic")||"",s=decodeURIComponent(k0(t,"wc_ev")||""),i=this.client.session.keys.includes(n);i&&this.client.session.update(n,{transportType:nt.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:s,sessionExists:i})}),K(this,"registerLinkModeListeners",async()=>{var t;if(Ey()||Wi()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const n=be==null?void 0:be.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await n.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),K(this,"shouldSetTVF",(t,n)=>{if(!n||t!=="wc_sessionRequest")return!1;const{request:s}=n;return Object.keys(Jb).includes(s.method)}),K(this,"getTVFParams",(t,n,s)=>{var i,o;try{const a=n.request.method,c=this.extractTxHashesFromResult(a,s);return tr(Ze({correlationId:t,rpcMethods:[a],chainId:n.chainId},this.isValidContractData(n.request.params)&&{contractAddresses:[(o=(i=n.request.params)==null?void 0:i[0])==null?void 0:o.to]}),{txHashes:c})}catch(a){this.client.logger.warn("Error getting TVF params",a)}return{}}),K(this,"isValidContractData",t=>{var n;if(!t)return!1;try{const s=(t==null?void 0:t.data)||((n=t==null?void 0:t[0])==null?void 0:n.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),K(this,"extractTxHashesFromResult",(t,n)=>{try{const s=Jb[t];if(typeof n=="string")return[n];const i=n[s.key];if(ji(i))return t==="solana_signAllTransactions"?i.map(o=>BD(o)):i;if(typeof i=="string")return[i]}catch(s){this.client.logger.warn("Error extracting tx hashes from result",s)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,s]of Object.entries(t))for(const i of s)try{await this.onProviderMessageEvent({topic:n,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(St.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:t,message:n,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(Ud)?this.client.auth.authKeys.get(Ud):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(t,n,{receiverPublicKey:o,encoding:i===nt.link_mode?gi:Sn});Sy(a)?(this.client.core.history.set(t,a),await this.onRelayEventRequest({topic:t,payload:a,attestation:s,transportType:i,encryptedId:as(n)})):Zf(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a,transportType:i}),this.client.core.history.delete(t,a.id)):await this.onRelayEventUnknownPayload({topic:t,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(t,n)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(en.expired,async e=>{const{topic:t,id:n}=aA(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,ee("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,ee("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(co.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(co.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!Et(e,!1)){const{message:t}=ee("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ee("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(fi(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ee("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Et(e,!1)){const{message:t}=ee("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=ee("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(fi(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=ee("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=ee("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Et(e,!1)){const{message:t}=ee("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ee("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!Xk(e)){const{message:t}=ee("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ee("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(fi(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=ee("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class D4 extends wa{constructor(e,t){super(e,t,y4,Ry),this.core=e,this.logger=t}}let k4=class extends wa{constructor(e,t){super(e,t,w4,Ry),this.core=e,this.logger=t}};class U4 extends wa{constructor(e,t){super(e,t,v4,Ry,n=>n.id),this.core=e,this.logger=t}}class B4 extends wa{constructor(e,t){super(e,t,C4,Xf,()=>Ud),this.core=e,this.logger=t}}class $4 extends wa{constructor(e,t){super(e,t,I4,Xf),this.core=e,this.logger=t}}class L4 extends wa{constructor(e,t){super(e,t,N4,Xf,n=>n.id),this.core=e,this.logger=t}}var M4=Object.defineProperty,F4=(r,e,t)=>e in r?M4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,eg=(r,e,t)=>F4(r,typeof e!="symbol"?e+"":e,t);class j4{constructor(e,t){this.core=e,this.logger=t,eg(this,"authKeys"),eg(this,"pairingTopics"),eg(this,"requests"),this.authKeys=new B4(this.core,this.logger),this.pairingTopics=new $4(this.core,this.logger),this.requests=new L4(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var H4=Object.defineProperty,q4=(r,e,t)=>e in r?H4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ue=(r,e,t)=>q4(r,typeof e!="symbol"?e+"":e,t);let z4=class f_ extends qP{constructor(e){super(e),Ue(this,"protocol",u_),Ue(this,"version",h_),Ue(this,"name",Yp.name),Ue(this,"metadata"),Ue(this,"core"),Ue(this,"logger"),Ue(this,"events",new Mn.EventEmitter),Ue(this,"engine"),Ue(this,"session"),Ue(this,"proposal"),Ue(this,"pendingRequest"),Ue(this,"auth"),Ue(this,"signConfig"),Ue(this,"on",(n,s)=>this.events.on(n,s)),Ue(this,"once",(n,s)=>this.events.once(n,s)),Ue(this,"off",(n,s)=>this.events.off(n,s)),Ue(this,"removeListener",(n,s)=>this.events.removeListener(n,s)),Ue(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),Ue(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"update",async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"request",async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"find",n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),Ue(this,"authenticate",async(n,s)=>{try{return await this.engine.authenticate(n,s)}catch(i){throw this.logger.error(i.message),i}}),Ue(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),Ue(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||Yp.name,this.metadata=QR(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ch(vl({level:(e==null?void 0:e.logger)||Yp.logger}));this.core=(e==null?void 0:e.core)||new m4(e),this.logger=er(t,this.name),this.session=new k4(this.core,this.logger),this.proposal=new D4(this.core,this.logger),this.pendingRequest=new U4(this.core,this.logger),this.engine=new R4(this),this.auth=new j4(this.core,this.logger)}static async init(e){const t=new f_(e);return await t.initialize(),t}get context(){return xr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},X.toMiliseconds(X.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var V4=Object.defineProperty,G4=Object.defineProperties,K4=Object.getOwnPropertyDescriptors,Yb=Object.getOwnPropertySymbols,W4=Object.prototype.hasOwnProperty,Q4=Object.prototype.propertyIsEnumerable,Xb=(r,e,t)=>e in r?V4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ev=(r,e)=>{for(var t in e||(e={}))W4.call(e,t)&&Xb(r,t,e[t]);if(Yb)for(var t of Yb(e))Q4.call(e,t)&&Xb(r,t,e[t]);return r},tv=(r,e)=>G4(r,K4(e));const J4={Accept:"application/json","Content-Type":"application/json"},Z4="POST",rv={headers:J4,method:Z4},nv=10;class Fn{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Mn.EventEmitter,this.isAvailable=!1,this.registering=!1,!vb(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=Ys(e),n=await(await Ew(this.url,tv(ev({},rv),{body:t}))).json();this.onPayload({data:n})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!vb(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Ys({id:1,jsonrpc:"2.0",method:"test",params:[]});await Ew(e,tv(ev({},rv),{body:t}))}this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?ea(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),s=n.message||n.toString(),i=Jf(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return VA(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>nv&&this.events.setMaxListeners(nv)}}const sv="error",Y4="wss://relay.walletconnect.org",X4="wc",e$="universal_provider",sd=`${X4}@2:${e$}:`,p_="https://rpc.walletconnect.org/v1/",qa="generic",t$=`${p_}bundler`,fn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function r$(){}function Dy(r){return r==null||typeof r!="object"&&typeof r!="function"}function ky(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function n$(r){if(Dy(r))return r;if(Array.isArray(r)||ky(r)||r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);const e=Object.getPrototypeOf(r),t=e.constructor;if(r instanceof Date||r instanceof Map||r instanceof Set)return new t(r);if(r instanceof RegExp){const n=new t(r);return n.lastIndex=r.lastIndex,n}if(r instanceof DataView)return new t(r.buffer.slice(0));if(r instanceof Error){const n=new t(r.message);return n.stack=r.stack,n.name=r.name,n.cause=r.cause,n}if(typeof File<"u"&&r instanceof File)return new t([r],r.name,{type:r.type,lastModified:r.lastModified});if(typeof r=="object"){const n=Object.create(e);return Object.assign(n,r)}return r}function iv(r){return typeof r=="object"&&r!==null}function g_(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function m_(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const s$="[object RegExp]",y_="[object String]",w_="[object Number]",b_="[object Boolean]",v_="[object Arguments]",i$="[object Symbol]",o$="[object Date]",a$="[object Map]",c$="[object Set]",l$="[object Array]",u$="[object ArrayBuffer]",h$="[object Object]",d$="[object DataView]",f$="[object Uint8Array]",p$="[object Uint8ClampedArray]",g$="[object Uint16Array]",m$="[object Uint32Array]",y$="[object Int8Array]",w$="[object Int16Array]",b$="[object Int32Array]",v$="[object Float32Array]",E$="[object Float64Array]";function A$(r,e){return Ja(r,void 0,r,new Map,e)}function Ja(r,e,t,n=new Map,s=void 0){const i=s==null?void 0:s(r,e,t,n);if(i!=null)return i;if(Dy(r))return r;if(n.has(r))return n.get(r);if(Array.isArray(r)){const o=new Array(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=Ja(r[a],a,t,n,s);return Object.hasOwn(r,"index")&&(o.index=r.index),Object.hasOwn(r,"input")&&(o.input=r.input),o}if(r instanceof Date)return new Date(r.getTime());if(r instanceof RegExp){const o=new RegExp(r.source,r.flags);return o.lastIndex=r.lastIndex,o}if(r instanceof Map){const o=new Map;n.set(r,o);for(const[a,c]of r)o.set(a,Ja(c,a,t,n,s));return o}if(r instanceof Set){const o=new Set;n.set(r,o);for(const a of r)o.add(Ja(a,void 0,t,n,s));return o}if(typeof Ut<"u"&&Ut.isBuffer(r))return r.subarray();if(ky(r)){const o=new(Object.getPrototypeOf(r)).constructor(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=Ja(r[a],a,t,n,s);return o}if(r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);if(r instanceof DataView){const o=new DataView(r.buffer.slice(0),r.byteOffset,r.byteLength);return n.set(r,o),lo(o,r,t,n,s),o}if(typeof File<"u"&&r instanceof File){const o=new File([r],r.name,{type:r.type});return n.set(r,o),lo(o,r,t,n,s),o}if(r instanceof Blob){const o=new Blob([r],{type:r.type});return n.set(r,o),lo(o,r,t,n,s),o}if(r instanceof Error){const o=new r.constructor;return n.set(r,o),o.message=r.message,o.name=r.name,o.stack=r.stack,o.cause=r.cause,lo(o,r,t,n,s),o}if(typeof r=="object"&&_$(r)){const o=Object.create(Object.getPrototypeOf(r));return n.set(r,o),lo(o,r,t,n,s),o}return r}function lo(r,e,t=r,n,s){const i=[...Object.keys(e),...g_(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(r,a);(c==null||c.writable)&&(r[a]=Ja(e[a],a,t,n,s))}}function _$(r){switch(m_(r)){case v_:case l$:case u$:case d$:case b_:case o$:case v$:case E$:case y$:case w$:case b$:case a$:case w_:case h$:case s$:case c$:case y_:case i$:case f$:case p$:case g$:case m$:return!0;default:return!1}}function C$(r,e){return A$(r,(t,n,s,i)=>{if(typeof r=="object")switch(Object.prototype.toString.call(r)){case w_:case y_:case b_:{const o=new r.constructor(r==null?void 0:r.valueOf());return lo(o,r),o}case v_:{const o={};return lo(o,r),o.length=r.length,o[Symbol.iterator]=r[Symbol.iterator],o}default:return}})}function ov(r){return C$(r)}function av(r){return r!==null&&typeof r=="object"&&m_(r)==="[object Arguments]"}function I$(r){return ky(r)}function N$(r){var t;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const n=r[Symbol.toStringTag];return n==null||!((t=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&t.writable)?!1:r.toString()===`[object ${n}]`}let e=r;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e}function x$(r,...e){const t=e.slice(0,-1),n=e[e.length-1];let s=r;for(let i=0;i<t.length;i++){const o=t[i];s=wm(s,o,n,new Map)}return s}function wm(r,e,t,n){if(Dy(r)&&(r=Object(r)),e==null||typeof e!="object")return r;if(n.has(e))return n$(n.get(e));if(n.set(e,r),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...g_(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=r[o];if(av(a)&&(a={...a}),av(c)&&(c={...c}),typeof Ut<"u"&&Ut.isBuffer(a)&&(a=ov(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],h=Reflect.ownKeys(c);for(let d=0;d<h.length;d++){const f=h[d];u[f]=c[f]}c=u}else c=[];const l=t(c,a,o,r,e,n);l!=null?r[o]=l:Array.isArray(a)||iv(c)&&iv(a)?r[o]=wm(c,a,t,n):c==null&&N$(a)?r[o]=wm({},a,t,n):c==null&&I$(a)?r[o]=ov(a):(c===void 0||a!==void 0)&&(r[o]=a)}return r}function P$(r,...e){return x$(r,...e,r$)}var T$=Object.defineProperty,O$=Object.defineProperties,S$=Object.getOwnPropertyDescriptors,cv=Object.getOwnPropertySymbols,R$=Object.prototype.hasOwnProperty,D$=Object.prototype.propertyIsEnumerable,lv=(r,e,t)=>e in r?T$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,id=(r,e)=>{for(var t in e||(e={}))R$.call(e,t)&&lv(r,t,e[t]);if(cv)for(var t of cv(e))D$.call(e,t)&&lv(r,t,e[t]);return r},k$=(r,e)=>O$(r,S$(e));function qr(r,e,t){var n;const s=nc(r);return((n=e.rpcMap)==null?void 0:n[s.reference])||`${p_}?chainId=${s.namespace}:${s.reference}&projectId=${t}`}function ba(r){return r.includes(":")?r.split(":")[1]:r}function E_(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function U$(r,e){const t=Object.keys(e.namespaces).filter(s=>s.includes(r));if(!t.length)return[];const n=[];return t.forEach(s=>{const i=e.namespaces[s].accounts;n.push(...i)}),n}function tg(r={},e={}){const t=uv(r),n=uv(e);return P$(t,n)}function uv(r){var e,t,n,s;const i={};if(!Eu(r))return i;for(const[o,a]of Object.entries(r)){const c=Py(o)?[o]:a.chains,l=a.methods||[],u=a.events||[],h=a.rpcMap||{},d=Ql(o);i[d]=k$(id(id({},i[d]),a),{chains:Sd(c,(e=i[d])==null?void 0:e.chains),methods:Sd(l,(t=i[d])==null?void 0:t.methods),events:Sd(u,(n=i[d])==null?void 0:n.events),rpcMap:id(id({},h),(s=i[d])==null?void 0:s.rpcMap)})}return i}function hv(r){return r.includes(":")?r.split(":")[2]:r}function dv(r){const e={};for(const[t,n]of Object.entries(r)){const s=n.methods||[],i=n.events||[],o=n.accounts||[],a=Py(t)?[t]:n.chains?n.chains:E_(n.accounts);e[t]={chains:a,methods:s,events:i,accounts:o}}return e}function rg(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}const A_={},qe=r=>A_[r],ng=(r,e)=>{A_[r]=e};var B$=Object.defineProperty,$$=(r,e,t)=>e in r?B$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Pa=(r,e,t)=>$$(r,typeof e!="symbol"?e+"":e,t);class L${constructor(e){Pa(this,"name","polkadot"),Pa(this,"client"),Pa(this,"httpProviders"),Pa(this,"events"),Pa(this,"namespace"),Pa(this,"chainId"),this.namespace=e.namespace,this.events=qe("events"),this.client=qe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=ba(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||qr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new dn(new Fn(n,qe("disableProviderPing")))}}var M$=Object.defineProperty,F$=Object.defineProperties,j$=Object.getOwnPropertyDescriptors,fv=Object.getOwnPropertySymbols,H$=Object.prototype.hasOwnProperty,q$=Object.prototype.propertyIsEnumerable,bm=(r,e,t)=>e in r?M$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,pv=(r,e)=>{for(var t in e||(e={}))H$.call(e,t)&&bm(r,t,e[t]);if(fv)for(var t of fv(e))q$.call(e,t)&&bm(r,t,e[t]);return r},gv=(r,e)=>F$(r,j$(e)),Ta=(r,e,t)=>bm(r,typeof e!="symbol"?e+"":e,t);class z${constructor(e){Ta(this,"name","eip155"),Ta(this,"client"),Ta(this,"chainId"),Ta(this,"namespace"),Ta(this,"httpProviders"),Ta(this,"events"),this.namespace=e.namespace,this.events=qe("events"),this.client=qe("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const n=t||qr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new dn(new Fn(n,qe("disableProviderPing")))}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=parseInt(ba(t));e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,n;let s=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,n,s;const i=(n=(t=e.request)==null?void 0:t.params)==null?void 0:n[0];if(!i)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const o=this.client.session.get(e.topic),a=((s=o==null?void 0:o.sessionProperties)==null?void 0:s.capabilities)||{};if(a!=null&&a[i])return a==null?void 0:a[i];const c=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:gv(pv({},o.sessionProperties||{}),{capabilities:gv(pv({},a||{}),{[i]:c})})})}catch(l){console.warn("Failed to update session with capabilities",l)}return c}async getCallStatus(e){var t,n;const s=this.client.session.get(e.topic),i=(t=s.sessionProperties)==null?void 0:t.bundler_name;if(i){const a=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(n=s.sessionProperties)==null?void 0:n.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var n;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Li("eth_getUserOperationReceipt",[(n=t.request.params)==null?void 0:n[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,t){return`${t$}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var V$=Object.defineProperty,G$=(r,e,t)=>e in r?V$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Oa=(r,e,t)=>G$(r,typeof e!="symbol"?e+"":e,t);class K${constructor(e){Oa(this,"name","solana"),Oa(this,"client"),Oa(this,"httpProviders"),Oa(this,"events"),Oa(this,"namespace"),Oa(this,"chainId"),this.namespace=e.namespace,this.events=qe("events"),this.client=qe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=ba(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||qr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new dn(new Fn(n,qe("disableProviderPing")))}}var W$=Object.defineProperty,Q$=(r,e,t)=>e in r?W$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Sa=(r,e,t)=>Q$(r,typeof e!="symbol"?e+"":e,t);class J${constructor(e){Sa(this,"name","cosmos"),Sa(this,"client"),Sa(this,"httpProviders"),Sa(this,"events"),Sa(this,"namespace"),Sa(this,"chainId"),this.namespace=e.namespace,this.events=qe("events"),this.client=qe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=ba(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||qr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new dn(new Fn(n,qe("disableProviderPing")))}}var Z$=Object.defineProperty,Y$=(r,e,t)=>e in r?Z$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ra=(r,e,t)=>Y$(r,typeof e!="symbol"?e+"":e,t);class X${constructor(e){Ra(this,"name","algorand"),Ra(this,"client"),Ra(this,"httpProviders"),Ra(this,"events"),Ra(this,"namespace"),Ra(this,"chainId"),this.namespace=e.namespace,this.events=qe("events"),this.client=qe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const n=t||qr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||qr(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new dn(new Fn(n,qe("disableProviderPing")))}}var eL=Object.defineProperty,tL=(r,e,t)=>e in r?eL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Da=(r,e,t)=>tL(r,typeof e!="symbol"?e+"":e,t);class rL{constructor(e){Da(this,"name","cip34"),Da(this,"client"),Da(this,"httpProviders"),Da(this,"events"),Da(this,"namespace"),Da(this,"chainId"),this.namespace=e.namespace,this.events=qe("events"),this.client=qe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=this.getCardanoRPCUrl(t),s=ba(t);e[s]=this.createHttpProvider(s,n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||this.getCardanoRPCUrl(e);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new dn(new Fn(n,qe("disableProviderPing")))}}var nL=Object.defineProperty,sL=(r,e,t)=>e in r?nL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ka=(r,e,t)=>sL(r,typeof e!="symbol"?e+"":e,t);class iL{constructor(e){ka(this,"name","elrond"),ka(this,"client"),ka(this,"httpProviders"),ka(this,"events"),ka(this,"namespace"),ka(this,"chainId"),this.namespace=e.namespace,this.events=qe("events"),this.client=qe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=ba(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||qr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new dn(new Fn(n,qe("disableProviderPing")))}}var oL=Object.defineProperty,aL=(r,e,t)=>e in r?oL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ua=(r,e,t)=>aL(r,typeof e!="symbol"?e+"":e,t);class cL{constructor(e){Ua(this,"name","multiversx"),Ua(this,"client"),Ua(this,"httpProviders"),Ua(this,"events"),Ua(this,"namespace"),Ua(this,"chainId"),this.namespace=e.namespace,this.events=qe("events"),this.client=qe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=ba(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||qr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new dn(new Fn(n,qe("disableProviderPing")))}}var lL=Object.defineProperty,uL=(r,e,t)=>e in r?lL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ba=(r,e,t)=>uL(r,typeof e!="symbol"?e+"":e,t);class hL{constructor(e){Ba(this,"name","near"),Ba(this,"client"),Ba(this,"httpProviders"),Ba(this,"events"),Ba(this,"namespace"),Ba(this,"chainId"),this.namespace=e.namespace,this.events=qe("events"),this.client=qe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||qr(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||qr(e,this.namespace);return typeof n>"u"?void 0:new dn(new Fn(n,qe("disableProviderPing")))}}var dL=Object.defineProperty,fL=(r,e,t)=>e in r?dL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$a=(r,e,t)=>fL(r,typeof e!="symbol"?e+"":e,t);class pL{constructor(e){$a(this,"name","tezos"),$a(this,"client"),$a(this,"httpProviders"),$a(this,"events"),$a(this,"namespace"),$a(this,"chainId"),this.namespace=e.namespace,this.events=qe("events"),this.client=qe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||qr(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||qr(e,this.namespace);return typeof n>"u"?void 0:new dn(new Fn(n))}}var gL=Object.defineProperty,mL=(r,e,t)=>e in r?gL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,La=(r,e,t)=>mL(r,typeof e!="symbol"?e+"":e,t);class yL{constructor(e){La(this,"name",qa),La(this,"client"),La(this,"httpProviders"),La(this,"events"),La(this,"namespace"),La(this,"chainId"),this.namespace=e.namespace,this.events=qe("events"),this.client=qe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const n={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(s=>{const i=nc(s);n[`${i.namespace}:${i.reference}`]=this.createHttpProvider(s)}),n}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||qr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new dn(new Fn(n,qe("disableProviderPing")))}}var wL=Object.defineProperty,bL=Object.defineProperties,vL=Object.getOwnPropertyDescriptors,mv=Object.getOwnPropertySymbols,EL=Object.prototype.hasOwnProperty,AL=Object.prototype.propertyIsEnumerable,vm=(r,e,t)=>e in r?wL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,od=(r,e)=>{for(var t in e||(e={}))EL.call(e,t)&&vm(r,t,e[t]);if(mv)for(var t of mv(e))AL.call(e,t)&&vm(r,t,e[t]);return r},sg=(r,e)=>bL(r,vL(e)),Kr=(r,e,t)=>vm(r,typeof e!="symbol"?e+"":e,t);class Uy{constructor(e){Kr(this,"client"),Kr(this,"namespaces"),Kr(this,"optionalNamespaces"),Kr(this,"sessionProperties"),Kr(this,"scopedProperties"),Kr(this,"events",new uy),Kr(this,"rpcProviders",{}),Kr(this,"session"),Kr(this,"providerOpts"),Kr(this,"logger"),Kr(this,"uri"),Kr(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ch(vl({level:(e==null?void 0:e.logger)||sv})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new Uy(e);return await t.initialize(),t}async request(e,t,n){const[s,i]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:od({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:n})}sendAsync(e,t,n,s){const i=new Date().getTime();this.request(e,n,s).then(o=>t(null,Qf(i,o))).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Ke("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:n,response:s}=await this.client.authenticate(e,t);n&&(this.uri=n,this.events.emit("display_uri",n));const i=await s();if(this.session=i.session,this.session){const o=dv(this.session.namespaces);this.namespaces=tg(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const s=await n();this.session=s;const i=dv(s.namespaces);return this.namespaces=tg(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[n,s]=this.validateChain(e),i=this.getProvider(n);i.name===qa?i.setDefaultChain(`${n}:${s}`,t):i.setDefaultChain(s,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(ji(t)){for(const n of t)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await z4.init({core:this.providerOpts.core,logger:this.providerOpts.logger||sv,relayUrl:this.providerOpts.relayUrl||Y4,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(n){throw this.logger.error("Failed to get session",n),new Error(`The provided session: ${(t=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:t.topic} doesn't exist in the Sign client`)}else{const n=this.client.session.getAll();this.session=n[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>Ql(t)))];ng("client",this.client),ng("events",this.events),ng("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const n=U$(t,this.session),s=E_(n),i=tg(this.namespaces,this.optionalNamespaces),o=sg(od({},i[t]),{accounts:n,chains:s});switch(t){case"eip155":this.rpcProviders[t]=new z$({namespace:o});break;case"algorand":this.rpcProviders[t]=new X$({namespace:o});break;case"solana":this.rpcProviders[t]=new K$({namespace:o});break;case"cosmos":this.rpcProviders[t]=new J$({namespace:o});break;case"polkadot":this.rpcProviders[t]=new L$({namespace:o});break;case"cip34":this.rpcProviders[t]=new rL({namespace:o});break;case"elrond":this.rpcProviders[t]=new iL({namespace:o});break;case"multiversx":this.rpcProviders[t]=new cL({namespace:o});break;case"near":this.rpcProviders[t]=new hL({namespace:o});break;case"tezos":this.rpcProviders[t]=new pL({namespace:o});break;default:this.rpcProviders[qa]?this.rpcProviders[qa].updateNamespace(o):this.rpcProviders[qa]=new yL({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:n}=e;n===((t=this.session)==null?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:n,topic:s}=e;if(s!==((t=this.session)==null?void 0:t.topic))return;const{event:i}=n;if(i.name==="accountsChanged"){const o=i.data;o&&ji(o)&&this.events.emit("accountsChanged",o.map(hv))}else if(i.name==="chainChanged"){const o=n.chainId,a=n.event.data,c=Ql(o),l=rg(o)!==rg(a)?`${c}:${rg(a)}`:o;this.onChainChanged(l)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var n,s;if(e!==((n=this.session)==null?void 0:n.topic))return;const{namespaces:i}=t,o=(s=this.client)==null?void 0:s.session.get(e);this.session=sg(od({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===((t=this.session)==null?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",sg(od({},Ke("USER_DISCONNECTED")),{data:e.topic})))}),this.on(fn.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[qa]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:n,sessionProperties:s,scopedProperties:i}=e;t&&Object.keys(t).length&&(this.namespaces=t),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[t,n]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map(o=>Ql(o)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const s=Ql(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;const[n,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(n,s),this.events.emit("chainChanged",s);const i=this.getProvider(n).getDefaultChain();t||this.getProvider(n).setDefaultChain(s),this.emitAccountsChangedOnChainChange({namespace:n,previousChainId:i,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:t,newChainId:n}){var s,i;try{if(t===n)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${n}:`)).map(hv);if(!ji(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,t){if(!this.namespaces)return;const n=this.namespaces[e]?e:`${e}:${t}`,s={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[n]?this.namespaces[n]&&(this.namespaces[n].defaultChain=t):this.namespaces[n]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var n;const s=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.setItem(`${sd}/${e}${s}`,t)}async getFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${sd}/${e}${n}`)}async deleteFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${sd}/${e}${n}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const n of t)n.startsWith(sd)&&await this.client.core.storage.removeItem(n)}catch(t){this.logger.warn("Failed to cleanup storage",t)}}}function _L(r,{strict:e=!0}={}){return!r||typeof r!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(r):r.startsWith("0x")}function yv(r){return _L(r,{strict:!1})?Math.ceil((r.length-2)/2):r.length}const __="2.27.0";let Hl={getDocsUrl:({docsBaseUrl:r,docsPath:e="",docsSlug:t})=>e?`${r??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${__}`};class zr extends Error{constructor(e,t={}){var a;const n=(()=>{var c;return t.cause instanceof zr?t.cause.details:(c=t.cause)!=null&&c.message?t.cause.message:t.details})(),s=t.cause instanceof zr&&t.cause.docsPath||t.docsPath,i=(a=Hl.getDocsUrl)==null?void 0:a.call(Hl,{...t,docsPath:s}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...n?[`Details: ${n}`]:[],...Hl.version?[`Version: ${Hl.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=__}walk(e){return C_(this,e)}}function C_(r,e){return e!=null&&e(r)?r:r&&typeof r=="object"&&"cause"in r&&r.cause!==void 0?C_(r.cause,e):e?null:r}class I_ extends zr{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function By(r,{dir:e,size:t=32}={}){return typeof r=="string"?CL(r,{dir:e,size:t}):IL(r,{dir:e,size:t})}function CL(r,{dir:e,size:t=32}={}){if(t===null)return r;const n=r.replace("0x","");if(n.length>t*2)throw new I_({size:Math.ceil(n.length/2),targetSize:t,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function IL(r,{dir:e,size:t=32}={}){if(t===null)return r;if(r.length>t)throw new I_({size:r.length,targetSize:t,type:"bytes"});const n=new Uint8Array(t);for(let s=0;s<t;s++){const i=e==="right";n[i?s:t-s-1]=r[i?s:r.length-s-1]}return n}class NL extends zr{constructor({max:e,min:t,signed:n,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class xL extends zr{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function N_(r,{size:e}){if(yv(r)>e)throw new xL({givenSize:yv(r),maxSize:e})}const PL=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function wv(r,e={}){return typeof r=="number"||typeof r=="bigint"?OL(r,e):typeof r=="string"?P_(r,e):typeof r=="boolean"?TL(r,e):x_(r,e)}function TL(r,e={}){const t=`0x${Number(r)}`;return typeof e.size=="number"?(N_(t,{size:e.size}),By(t,{size:e.size})):t}function x_(r,e={}){let t="";for(let s=0;s<r.length;s++)t+=PL[r[s]];const n=`0x${t}`;return typeof e.size=="number"?(N_(n,{size:e.size}),By(n,{dir:"right",size:e.size})):n}function OL(r,e={}){const{signed:t,size:n}=e,s=BigInt(r);let i;n?t?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof r=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&t?-i-1n:0;if(i&&s>i||s<o){const c=typeof r=="bigint"?"n":"";throw new NL({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:t,size:n,value:`${r}${c}`})}const a=`0x${(t&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?By(a,{size:n}):a}const SL=new TextEncoder;function P_(r,e={}){const t=SL.encode(r);return x_(t,e)}class RL extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const Wo=(r,e,t)=>JSON.stringify(r,(n,s)=>typeof s=="bigint"?s.toString():s,t),$y=r=>r;class lu extends zr{constructor({body:e,cause:t,details:n,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:t,details:n,metaMessages:[i&&`Status: ${i}`,`URL: ${$y(o)}`,e&&`Request body: ${Wo(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class T_ extends zr{constructor({body:e,error:t,url:n}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:[`URL: ${$y(n)}`,`Request body: ${Wo(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=t.code,this.data=t.data}}class bv extends zr{constructor({body:e,url:t}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${$y(t)}`,`Request body: ${Wo(e)}`],name:"TimeoutError"})}}const DL=-1;class Pr extends zr{constructor(e,{code:t,docsPath:n,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:n,metaMessages:s||(e==null?void 0:e.metaMessages),name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof T_?e.code:t??DL}}class Vr extends Pr{constructor(e,t){super(e,t),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t.data}}class Au extends Pr{constructor(e){super(e,{code:Au.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(Au,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class _u extends Pr{constructor(e){super(e,{code:_u.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(_u,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class Cu extends Pr{constructor(e,{method:t}={}){super(e,{code:Cu.code,name:"MethodNotFoundRpcError",shortMessage:`The method${t?` "${t}"`:""} does not exist / is not available.`})}}Object.defineProperty(Cu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class Iu extends Pr{constructor(e){super(e,{code:Iu.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Iu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class ol extends Pr{constructor(e){super(e,{code:ol.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(ol,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class Nu extends Pr{constructor(e){super(e,{code:Nu.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Nu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class xu extends Pr{constructor(e){super(e,{code:xu.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(xu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class Pu extends Pr{constructor(e){super(e,{code:Pu.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(Pu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class al extends Pr{constructor(e){super(e,{code:al.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(al,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class wo extends Pr{constructor(e,{method:t}={}){super(e,{code:wo.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${t?` "${t}"`:""} is not supported.`})}}Object.defineProperty(wo,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class cl extends Pr{constructor(e){super(e,{code:cl.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(cl,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class Tu extends Pr{constructor(e){super(e,{code:Tu.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(Tu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class Qo extends Vr{constructor(e){super(e,{code:Qo.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(Qo,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class Ou extends Vr{constructor(e){super(e,{code:Ou.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(Ou,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class Su extends Vr{constructor(e,{method:t}={}){super(e,{code:Su.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${t?` " ${t}"`:""}.`})}}Object.defineProperty(Su,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class Ru extends Vr{constructor(e){super(e,{code:Ru.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(Ru,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class Du extends Vr{constructor(e){super(e,{code:Du.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(Du,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class ku extends Vr{constructor(e){super(e,{code:ku.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(ku,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class Uu extends Vr{constructor(e){super(e,{code:Uu.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(Uu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class Bu extends Vr{constructor(e){super(e,{code:Bu.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(Bu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class $u extends Vr{constructor(e){super(e,{code:$u.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty($u,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class Lu extends Vr{constructor(e){super(e,{code:Lu.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(Lu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class Mu extends Vr{constructor(e){super(e,{code:Mu.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(Mu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class Fu extends Vr{constructor(e){super(e,{code:Fu.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(Fu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class ju extends Vr{constructor(e){super(e,{code:ju.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(ju,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class kL extends Pr{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}class Ly extends zr{constructor({cause:e,message:t}={}){var s;const n=(s=t==null?void 0:t.replace("execution reverted: ",""))==null?void 0:s.replace("execution reverted","");super(`Execution reverted ${n?`with reason: ${n}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(Ly,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(Ly,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});function UL(){let r=()=>{},e=()=>{};return{promise:new Promise((n,s)=>{r=n,e=s}),resolve:r,reject:e}}const ig=new Map;function BL({fn:r,id:e,shouldSplitBatch:t,wait:n=0,sort:s}){const i=async()=>{const u=c();o();const h=u.map(({args:d})=>d);h.length!==0&&r(h).then(d=>{s&&Array.isArray(d)&&d.sort(s);for(let f=0;f<u.length;f++){const{resolve:p}=u[f];p==null||p([d[f],d])}}).catch(d=>{for(let f=0;f<u.length;f++){const{reject:p}=u[f];p==null||p(d)}})},o=()=>ig.delete(e),a=()=>c().map(({args:u})=>u),c=()=>ig.get(e)||[],l=u=>ig.set(e,[...c(),u]);return{flush:o,async schedule(u){const{promise:h,resolve:d,reject:f}=UL();return(t==null?void 0:t([...a(),u]))&&i(),c().length>0?(l({args:u,resolve:d,reject:f}),h):(l({args:u,resolve:d,reject:f}),setTimeout(i,n),h)}}}async function O_(r){return new Promise(e=>setTimeout(e,r))}const Em=256;let ad=Em,cd;function $L(r=11){if(!cd||ad+r>Em*2){cd="",ad=0;for(let e=0;e<Em;e++)cd+=(256+Math.random()*256|0).toString(16).substring(1)}return cd.substring(ad,ad+++r)}const ld=new RL(8192);function LL(r,{enabled:e=!0,id:t}){if(!e||!t)return r();if(ld.get(t))return ld.get(t);const n=r().finally(()=>ld.delete(t));return ld.set(t,n),n}function ML(r,{delay:e=100,retryCount:t=2,shouldRetry:n=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:l})=>{const u=typeof e=="function"?e({count:a,error:l}):e;u&&await O_(u),o({count:a+1})};try{const l=await r();s(l)}catch(l){if(a<t&&await n({count:a,error:l}))return c({error:l});i(l)}};o()})}function FL(r,e={}){return async(t,n={})=>{var h;const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...e,...n},{method:l}=t;if((h=i==null?void 0:i.exclude)!=null&&h.includes(l))throw new wo(new Error("method not supported"),{method:l});if(i!=null&&i.include&&!i.include.includes(l))throw new wo(new Error("method not supported"),{method:l});const u=s?P_(`${c}.${Wo(t)}`):void 0;return LL(()=>ML(async()=>{try{return await r(t)}catch(d){const f=d;switch(f.code){case Au.code:throw new Au(f);case _u.code:throw new _u(f);case Cu.code:throw new Cu(f,{method:t.method});case Iu.code:throw new Iu(f);case ol.code:throw new ol(f);case Nu.code:throw new Nu(f);case xu.code:throw new xu(f);case Pu.code:throw new Pu(f);case al.code:throw new al(f);case wo.code:throw new wo(f,{method:t.method});case cl.code:throw new cl(f);case Tu.code:throw new Tu(f);case Qo.code:throw new Qo(f);case Ou.code:throw new Ou(f);case Su.code:throw new Su(f);case Ru.code:throw new Ru(f);case Du.code:throw new Du(f);case ku.code:throw new ku(f);case Uu.code:throw new Uu(f);case Bu.code:throw new Bu(f);case $u.code:throw new $u(f);case Lu.code:throw new Lu(f);case Mu.code:throw new Mu(f);case Fu.code:throw new Fu(f);case ju.code:throw new ju(f);case 5e3:throw new Qo(f);default:throw d instanceof zr?d:new kL(f)}}},{delay:({count:d,error:f})=>{var p;if(f&&f instanceof lu){const m=(p=f==null?void 0:f.headers)==null?void 0:p.get("Retry-After");if(m!=null&&m.match(/\d/))return Number.parseInt(m)*1e3}return~~(1<<d)*o},retryCount:a,shouldRetry:({error:d})=>jL(d)}),{enabled:s,id:u})}}function jL(r){return"code"in r&&typeof r.code=="number"?r.code===-1||r.code===cl.code||r.code===ol.code:r instanceof lu&&r.status?r.status===403||r.status===408||r.status===413||r.status===429||r.status===500||r.status===502||r.status===503||r.status===504:!0}function S_({key:r,methods:e,name:t,request:n,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const l=$L();return{config:{key:r,methods:e,name:t,request:n,retryCount:s,retryDelay:i,timeout:o,type:a},request:FL(n,{methods:e,retryCount:s,retryDelay:i,uid:l}),value:c}}function vv(r,e={}){const{key:t="fallback",name:n="Fallback",rank:s=!1,shouldThrow:i=HL,retryCount:o,retryDelay:a}=e;return({chain:c,pollingInterval:l=4e3,timeout:u,...h})=>{let d=r,f=()=>{};const p=S_({key:t,name:n,async request({method:m,params:v}){let _;const y=async(C=0)=>{const U=d[C]({...h,chain:c,retryCount:0,timeout:u});try{const L=await U.request({method:m,params:v});return f({method:m,params:v,response:L,transport:U,status:"success"}),L}catch(L){if(f({error:L,method:m,params:v,transport:U,status:"error"}),i(L)||C===d.length-1||(_??(_=d.slice(C+1).some(B=>{const{include:$,exclude:g}=B({chain:c}).config.methods||{};return $?$.includes(m):g?!g.includes(m):!0})),!_))throw L;return y(C+1)}};return y()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:m=>f=m,transports:d.map(m=>m({chain:c,retryCount:0}))});if(s){const m=typeof s=="object"?s:{};qL({chain:c,interval:m.interval??l,onTransports:v=>d=v,ping:m.ping,sampleCount:m.sampleCount,timeout:m.timeout,transports:d,weights:m.weights})}return p}}function HL(r){return!!("code"in r&&typeof r.code=="number"&&(r.code===al.code||r.code===Qo.code||Ly.nodeMessage.test(r.message)||r.code===5e3))}function qL({chain:r,interval:e=4e3,onTransports:t,ping:n,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,u=[],h=async()=>{const d=await Promise.all(o.map(async m=>{const v=m({chain:r,retryCount:0,timeout:i}),_=Date.now();let y,C;try{await(n?n({transport:v}):v.request({method:"net_listening"})),C=1}catch{C=0}finally{y=Date.now()}return{latency:y-_,success:C}}));u.push(d),u.length>s&&u.shift();const f=Math.max(...u.map(m=>Math.max(...m.map(({latency:v})=>v)))),p=o.map((m,v)=>{const _=u.map(B=>B[v].latency),C=1-_.reduce((B,$)=>B+$,0)/_.length/f,U=u.map(B=>B[v].success),L=U.reduce((B,$)=>B+$,0)/U.length;return L===0?[0,v]:[l*C+c*L,v]}).sort((m,v)=>v[0]-m[0]);t(p.map(([,m])=>o[m])),await O_(e),h()};h()}class zL extends zr{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function VL(r,{errorInstance:e=new Error("timed out"),timeout:t,signal:n}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;t>0&&(o=setTimeout(()=>{n&&a.abort()},t)),s(await r({signal:(a==null?void 0:a.signal)||null}))}catch(a){(a==null?void 0:a.name)==="AbortError"&&i(e),i(a)}finally{clearTimeout(o)}})()})}function GL(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const Ev=GL();function KL(r,e={}){return{async request(t){var h;const{body:n,onRequest:s=e.onRequest,onResponse:i=e.onResponse,timeout:o=e.timeout??1e4}=t,a={...e.fetchOptions??{},...t.fetchOptions??{}},{headers:c,method:l,signal:u}=a;try{const d=await VL(async({signal:p})=>{const m={...a,body:Array.isArray(n)?Wo(n.map(C=>({jsonrpc:"2.0",id:C.id??Ev.take(),...C}))):Wo({jsonrpc:"2.0",id:n.id??Ev.take(),...n}),headers:{"Content-Type":"application/json",...c},method:l||"POST",signal:u||(o>0?p:null)},v=new Request(r,m),_=await(s==null?void 0:s(v,m))??{...m,url:r};return await fetch(_.url??r,_)},{errorInstance:new bv({body:n,url:r}),timeout:o,signal:!0});i&&await i(d);let f;if((h=d.headers.get("Content-Type"))!=null&&h.startsWith("application/json"))f=await d.json();else{f=await d.text();try{f=JSON.parse(f||"{}")}catch(p){if(d.ok)throw p;f={error:f}}}if(!d.ok)throw new lu({body:n,details:Wo(f.error)||d.statusText,headers:d.headers,status:d.status,url:r});return f}catch(d){throw d instanceof lu||d instanceof bv?d:new lu({body:n,cause:d,url:r})}}}}function ud(r,e={}){const{batch:t,fetchOptions:n,key:s="http",methods:i,name:o="HTTP JSON-RPC",onFetchRequest:a,onFetchResponse:c,retryDelay:l,raw:u}=e;return({chain:h,retryCount:d,timeout:f})=>{const{batchSize:p=1e3,wait:m=0}=typeof t=="object"?t:{},v=e.retryCount??d,_=f??e.timeout??1e4,y=r||(h==null?void 0:h.rpcUrls.default.http[0]);if(!y)throw new zL;const C=KL(y,{fetchOptions:n,onRequest:a,onResponse:c,timeout:_});return S_({key:s,methods:i,name:o,async request({method:U,params:L}){const B={method:U,params:L},{schedule:$}=BL({id:y,wait:m,shouldSplitBatch(x){return x.length>p},fn:x=>C.request({body:x}),sort:(x,I)=>x.id-I.id}),g=async x=>t?$(x):[await C.request({body:x})],[{error:b,result:N}]=await g(B);if(u)return{error:b,result:N};if(b)throw new T_({body:B,error:b,url:y});return N},retryCount:v,retryDelay:l,timeout:_,type:"http"},{fetchOptions:n,url:y})}}function WL(r){return{formatters:void 0,fees:void 0,serializers:void 0,...r}}const Av=2147483648,QL={convertEVMChainIdToCoinType(r){if(r>=Av)throw new Error("Invalid chainId");return(Av|r)>>>0}},Wr=QE({suggestions:[],loading:!1}),R_={state:Wr,subscribe(r){return Og(Wr,()=>r(Wr))},subscribeKey(r,e){return JE(Wr,r,e)},async resolveName(r){var e,t;try{return await io.lookupEnsName(r)}catch(n){const s=n;throw new Error(((t=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:t.description)||"Error resolving name")}},async isNameRegistered(r){try{return await io.lookupEnsName(r),!0}catch{return!1}},async getSuggestions(r){try{Wr.loading=!0,Wr.suggestions=[];const e=await io.getEnsNameSuggestions(r);return Wr.suggestions=e.suggestions.map(t=>({...t,name:t.name}))||[],Wr.suggestions}catch(e){const t=this.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(t)}finally{Wr.loading=!1}},async getNamesForAddress(r){try{if(!G.state.activeCaipNetwork)return[];const t=it.getEnsFromCacheForAddress(r);if(t)return t;const n=await io.reverseLookupEnsName({address:r});return it.updateEnsCache({address:r,ens:n,timestamp:Date.now()}),n}catch(e){const t=this.parseEnsApiError(e,"Error fetching names for address");throw new Error(t)}},async registerName(r){const e=G.state.activeCaipNetwork;if(!e)throw new Error("Network not found");const t=Ae.state.address,n=st.getAuthConnector();if(!t||!n)throw new Error("Address or auth connector not found");Wr.loading=!0;try{const s=JSON.stringify({name:r,attributes:{},timestamp:Math.floor(Date.now()/1e3)});Ts.pushTransactionStack({view:"RegisterAccountNameSuccess",goBack:!1,replace:!0,onCancel(){Wr.loading=!1}});const i=await An.signMessage(s),o=e.id;if(!o)throw new Error("Network not found");const a=QL.convertEVMChainIdToCoinType(Number(o));await io.registerEnsName({coinType:a,address:t,signature:i,message:s}),Ae.setProfileName(r,e.chainNamespace),Ts.replace("RegisterAccountNameSuccess")}catch(s){const i=this.parseEnsApiError(s,`Error registering name ${r}`);throw Ts.replace("RegisterAccountName"),new Error(i)}finally{Wr.loading=!1}},validateName(r){return/^[a-zA-Z0-9-]{4,}$/u.test(r)},parseEnsApiError(r,e){var n,s;const t=r;return((s=(n=t==null?void 0:t.reasons)==null?void 0:n[0])==null?void 0:s.description)||e}},Ye={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:"eip155",ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"},cs={ConnectorExplorerIds:{[oe.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[oe.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[oe.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[oe.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[oe.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[Ye.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[Ye.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[Ye.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[Ye.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[Ye.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[Ye.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[Ye.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[Ye.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[Ye.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[Ye.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[Ye.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[oe.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[oe.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[oe.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[oe.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[oe.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[oe.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[oe.CONNECTOR_ID.INJECTED]:"Browser Wallet",[oe.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[oe.CONNECTOR_ID.COINBASE]:"Coinbase",[oe.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[oe.CONNECTOR_ID.LEDGER]:"Ledger",[oe.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[oe.CONNECTOR_ID.INJECTED]:"INJECTED",[oe.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[oe.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[oe.CONNECTOR_ID.AUTH]:"AUTH"}},ep={getCaipTokens(r){if(!r)return;const e={};return Object.entries(r).forEach(([t,n])=>{e[`${Ye.EIP155}:${t}`]=n}),e},isLowerCaseMatch(r,e){return(r==null?void 0:r.toLowerCase())===(e==null?void 0:e.toLowerCase())}},Zl={UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"INVALID_APP_CONFIGURATION"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found - please make sure it is included in 'networks' array in createAppKit function"},INVALID_APP_CONFIGURATION:{shortMessage:"Invalid App Configuration",longMessage:()=>`Origin ${JL()?window.origin:"unknown"} not found on Allowlist - update configuration on cloud.reown.com`},SOCIALS_TIMEOUT:{shortMessage:"Invalid App Configuration",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at cloud.reown.com"},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider - please check your time settings and connect again"},INVALID_PROJECT_ID:{shortMessage:"Invalid App Configuration",longMessage:"Invalid Project ID - update configuration"},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured - update configuration on cloud.reown.com"}}};function JL(){return typeof window<"u"}const ZL={createLogger(r,e="error"){const t=vl({level:e}),{logger:n}=dy({opts:t});return n.error=(...s)=>{for(const i of s)if(i instanceof Error){r(i,...s);return}r(void 0,...s)},n}},YL="rpc.walletconnect.org";function _v(r,e){const t=new URL("https://rpc.walletconnect.org/v1/");return t.searchParams.set("chainId",r),t.searchParams.set("projectId",e),t.toString()}const og=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],za={extendRpcUrlWithProjectId(r,e){let t=!1;try{t=new URL(r).host===YL}catch{t=!1}if(t){const n=new URL(r);return n.searchParams.has("projectId")||n.searchParams.set("projectId",e),n.toString()}return r},isCaipNetwork(r){return"chainNamespace"in r&&"caipNetworkId"in r},getChainNamespace(r){return this.isCaipNetwork(r)?r.chainNamespace:oe.CHAIN.EVM},getCaipNetworkId(r){return this.isCaipNetwork(r)?r.caipNetworkId:`${oe.CHAIN.EVM}:${r.id}`},getDefaultRpcUrl(r,e,t){var s,i,o;const n=(o=(i=(s=r.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null?void 0:o[0];return og.includes(e)?_v(e,t):n||""},extendCaipNetwork(r,{customNetworkImageUrls:e,projectId:t,customRpcUrls:n}){var d,f,p,m,v;const s=this.getChainNamespace(r),i=this.getCaipNetworkId(r),o=(d=r.rpcUrls.default.http)==null?void 0:d[0],a=this.getDefaultRpcUrl(r,i,t),c=((m=(p=(f=r==null?void 0:r.rpcUrls)==null?void 0:f.chainDefault)==null?void 0:p.http)==null?void 0:m[0])||o,l=((v=n==null?void 0:n[i])==null?void 0:v.map(_=>_.url))||[],u=[...l,a],h=[...l];return c&&!h.includes(c)&&h.push(c),{...r,chainNamespace:s,caipNetworkId:i,assets:{imageId:cs.NetworkImageIds[r.id],imageUrl:e==null?void 0:e[r.id]},rpcUrls:{...r.rpcUrls,default:{http:u},chainDefault:{http:h}}}},extendCaipNetworks(r,{customNetworkImageUrls:e,projectId:t,customRpcUrls:n}){return r.map(s=>za.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:n,projectId:t}))},getViemTransport(r,e,t){var s,i,o;const n=[];return t==null||t.forEach(a=>{n.push(ud(a.url,a.config))}),og.includes(r.caipNetworkId)&&n.push(ud(_v(r.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),(o=(i=(s=r==null?void 0:r.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null||o.forEach(a=>{n.push(ud(a))}),vv(n)},extendWagmiTransports(r,e,t){if(og.includes(r.caipNetworkId)){const n=this.getDefaultRpcUrl(r,r.caipNetworkId,e);return vv([t,ud(n)])}return t},getUnsupportedNetwork(r){return{id:r.split(":")[1],caipNetworkId:r,name:oe.UNSUPPORTED_NETWORK_NAME,chainNamespace:r.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(r){var c;const e=it.getActiveCaipNetworkId(),t=G.getAllRequestedCaipNetworks(),n=Array.from(((c=G.state.chains)==null?void 0:c.keys())||[]),s=e==null?void 0:e.split(":")[0],i=s?n.includes(s):!1,o=t==null?void 0:t.find(l=>l.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||r||(t==null?void 0:t[0])}},rf={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0},mr=QE({providers:{...rf},providerIds:{...rf}}),je={state:mr,subscribeKey(r,e){return JE(mr,r,e)},subscribe(r){return Og(mr,()=>{r(mr)})},subscribeProviders(r){return Og(mr.providers,()=>r(mr.providers))},setProvider(r,e){e&&(mr.providers[r]=QI(e))},getProvider(r){return mr.providers[r]},setProviderId(r,e){e&&(mr.providerIds[r]=e)},getProviderId(r){if(r)return mr.providerIds[r]},reset(){mr.providers={...rf},mr.providerIds={...rf}},resetChain(r){mr.providers[r]=void 0,mr.providerIds[r]=void 0}},Cv={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},Mt={set(r,e){jr.isClient&&localStorage.setItem(`${he.STORAGE_KEY}${r}`,e)},get(r){return jr.isClient?localStorage.getItem(`${he.STORAGE_KEY}${r}`):null},delete(r,e){jr.isClient&&(e?localStorage.removeItem(r):localStorage.removeItem(`${he.STORAGE_KEY}${r}`))}},hd=30*1e3,jr={checkIfAllowedToTriggerEmail(){const r=Mt.get(he.LAST_EMAIL_LOGIN_TIME);if(r){const e=Date.now()-Number(r);if(e<hd){const t=Math.ceil((hd-e)/1e3);throw new Error(`Please try again after ${t} seconds`)}}},getTimeToNextEmailLogin(){const r=Mt.get(he.LAST_EMAIL_LOGIN_TIME);if(r){const e=Date.now()-Number(r);if(e<hd)return Math.ceil((hd-e)/1e3)}return 0},checkIfRequestExists(r){return hn.NOT_SAFE_RPC_METHODS.includes(r.method)||hn.SAFE_RPC_METHODS.includes(r.method)},getResponseType(r){return typeof r=="string"&&((r==null?void 0:r.match(Cv.transactionHash))||(r==null?void 0:r.match(Cv.signedMessage)))?he.RPC_RESPONSE_TYPE_TX:he.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(r){return hn.SAFE_RPC_METHODS.includes(r.method)},isClient:typeof window<"u"};var He;(function(r){r.assertEqual=s=>s;function e(s){}r.assertIs=e;function t(s){throw new Error}r.assertNever=t,r.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},r.getValidEnumValues=s=>{const i=r.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return r.objectValues(o)},r.objectValues=s=>r.objectKeys(s).map(function(i){return s[i]}),r.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},r.find=(s,i)=>{for(const o of s)if(i(o))return o},r.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}r.joinValues=n,r.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(He||(He={}));var Am;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(Am||(Am={}));const ne=He.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),mi=r=>{switch(typeof r){case"undefined":return ne.undefined;case"string":return ne.string;case"number":return isNaN(r)?ne.nan:ne.number;case"boolean":return ne.boolean;case"function":return ne.function;case"bigint":return ne.bigint;case"symbol":return ne.symbol;case"object":return Array.isArray(r)?ne.array:r===null?ne.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?ne.promise:typeof Map<"u"&&r instanceof Map?ne.map:typeof Set<"u"&&r instanceof Set?ne.set:typeof Date<"u"&&r instanceof Date?ne.date:ne.object;default:return ne.unknown}},Y=He.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),XL=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class kn extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(i){return i.message},n={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)n._errors.push(t(o));else{let a=n,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(t(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return s(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,He.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}kn.create=r=>new kn(r);const Hu=(r,e)=>{let t;switch(r.code){case Y.invalid_type:r.received===ne.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case Y.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,He.jsonStringifyReplacer)}`;break;case Y.unrecognized_keys:t=`Unrecognized key(s) in object: ${He.joinValues(r.keys,", ")}`;break;case Y.invalid_union:t="Invalid input";break;case Y.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${He.joinValues(r.options)}`;break;case Y.invalid_enum_value:t=`Invalid enum value. Expected ${He.joinValues(r.options)}, received '${r.received}'`;break;case Y.invalid_arguments:t="Invalid function arguments";break;case Y.invalid_return_type:t="Invalid function return type";break;case Y.invalid_date:t="Invalid date";break;case Y.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:He.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case Y.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case Y.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case Y.custom:t="Invalid input";break;case Y.invalid_intersection_types:t="Intersection results could not be merged";break;case Y.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case Y.not_finite:t="Number must be finite";break;default:t=e.defaultError,He.assertNever(r)}return{message:t}};let D_=Hu;function eM(r){D_=r}function nf(){return D_}const sf=r=>{const{data:e,path:t,errorMaps:n,issueData:s}=r,i=[...t,...s.path||[]],o={...s,path:i};let a="";const c=n.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},tM=[];function ae(r,e){const t=sf({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,nf(),Hu].filter(n=>!!n)});r.common.issues.push(t)}class Xt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const s of t){if(s.status==="aborted")return _e;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const s of t)n.push({key:await s.key,value:await s.value});return Xt.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const s of t){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return _e;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(n[i.value]=o.value)}return{status:e.value,value:n}}}const _e=Object.freeze({status:"aborted"}),k_=r=>({status:"dirty",value:r}),fr=r=>({status:"valid",value:r}),_m=r=>r.status==="aborted",Cm=r=>r.status==="dirty",qu=r=>r.status==="valid",of=r=>typeof Promise<"u"&&r instanceof Promise;var ye;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ye||(ye={}));class gs{constructor(e,t,n,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Iv=(r,e)=>{if(qu(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new kn(r.common.issues);return this._error=t,this._error}}};function Ie(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:s}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:n??a.defaultError}:{message:t??a.defaultError},description:s}}class Oe{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return mi(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:mi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Xt,ctx:{common:e.parent.common,data:e.data,parsedType:mi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(of(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const s={common:{issues:[],async:(n=t==null?void 0:t.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:mi(e)},i=this._parseSync({data:e,path:s.path,parent:s});return Iv(s,i)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:mi(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(of(s)?s:Promise.resolve(s));return Iv(n,i)}refine(e,t){const n=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:Y.custom,...n(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof t=="function"?t(n,s):t),!1))}_refinement(e){return new Bn({schema:this,typeName:ve.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Qs.create(this,this._def)}nullable(){return aa.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Un.create(this,this._def)}promise(){return ul.create(this,this._def)}or(e){return Ku.create([this,e],this._def)}and(e){return Wu.create(this,e,this._def)}transform(e){return new Bn({...Ie(this._def),schema:this,typeName:ve.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Xu({...Ie(this._def),innerType:this,defaultValue:t,typeName:ve.ZodDefault})}brand(){return new B_({typeName:ve.ZodBranded,type:this,...Ie(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new uf({...Ie(this._def),innerType:this,catchValue:t,typeName:ve.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Mh.create(this,e)}readonly(){return df.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const rM=/^c[^\s-]{8,}$/i,nM=/^[a-z][a-z0-9]*$/,sM=/^[0-9A-HJKMNP-TV-Z]{26}$/,iM=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,oM=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,aM="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ag;const cM=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,lM=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,uM=r=>r.precision?r.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}Z$`):r.precision===0?r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function hM(r,e){return!!((e==="v4"||!e)&&cM.test(r)||(e==="v6"||!e)&&lM.test(r))}class Rn extends Oe{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ne.string){const i=this._getOrReturnCtx(e);return ae(i,{code:Y.invalid_type,expected:ne.string,received:i.parsedType}),_e}const n=new Xt;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),ae(s,{code:Y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),ae(s,{code:Y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?ae(s,{code:Y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&ae(s,{code:Y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")oM.test(e.data)||(s=this._getOrReturnCtx(e,s),ae(s,{validation:"email",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")ag||(ag=new RegExp(aM,"u")),ag.test(e.data)||(s=this._getOrReturnCtx(e,s),ae(s,{validation:"emoji",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")iM.test(e.data)||(s=this._getOrReturnCtx(e,s),ae(s,{validation:"uuid",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")rM.test(e.data)||(s=this._getOrReturnCtx(e,s),ae(s,{validation:"cuid",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")nM.test(e.data)||(s=this._getOrReturnCtx(e,s),ae(s,{validation:"cuid2",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")sM.test(e.data)||(s=this._getOrReturnCtx(e,s),ae(s,{validation:"ulid",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),ae(s,{validation:"url",code:Y.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),ae(s,{validation:"regex",code:Y.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),ae(s,{code:Y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),ae(s,{code:Y.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),ae(s,{code:Y.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?uM(i).test(e.data)||(s=this._getOrReturnCtx(e,s),ae(s,{code:Y.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="ip"?hM(e.data,i.version)||(s=this._getOrReturnCtx(e,s),ae(s,{validation:"ip",code:Y.invalid_string,message:i.message}),n.dirty()):He.assertNever(i);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(s=>e.test(s),{validation:t,code:Y.invalid_string,...ye.errToObj(n)})}_addCheck(e){return new Rn({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ye.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ye.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ye.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ye.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ye.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ye.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ye.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ye.errToObj(e)})}datetime(e){var t;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,...ye.errToObj(e==null?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...ye.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...ye.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...ye.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...ye.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...ye.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...ye.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...ye.errToObj(t)})}nonempty(e){return this.min(1,ye.errToObj(e))}trim(){return new Rn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Rn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Rn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Rn.create=r=>{var e;return new Rn({checks:[],typeName:ve.ZodString,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...Ie(r)})};function dM(r,e){const t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=t>n?t:n,i=parseInt(r.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class qi extends Oe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ne.number){const i=this._getOrReturnCtx(e);return ae(i,{code:Y.invalid_type,expected:ne.number,received:i.parsedType}),_e}let n;const s=new Xt;for(const i of this._def.checks)i.kind==="int"?He.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),ae(n,{code:Y.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),ae(n,{code:Y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),ae(n,{code:Y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?dM(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),ae(n,{code:Y.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),ae(n,{code:Y.not_finite,message:i.message}),s.dirty()):He.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ye.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ye.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ye.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ye.toString(t))}setLimit(e,t,n,s){return new qi({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:ye.toString(s)}]})}_addCheck(e){return new qi({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ye.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ye.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ye.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ye.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ye.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ye.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:ye.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ye.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ye.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&He.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}qi.create=r=>new qi({checks:[],typeName:ve.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...Ie(r)});class zi extends Oe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ne.bigint){const i=this._getOrReturnCtx(e);return ae(i,{code:Y.invalid_type,expected:ne.bigint,received:i.parsedType}),_e}let n;const s=new Xt;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),ae(n,{code:Y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),ae(n,{code:Y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),ae(n,{code:Y.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):He.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ye.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ye.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ye.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ye.toString(t))}setLimit(e,t,n,s){return new zi({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:ye.toString(s)}]})}_addCheck(e){return new zi({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ye.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ye.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ye.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ye.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ye.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}zi.create=r=>{var e;return new zi({checks:[],typeName:ve.ZodBigInt,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...Ie(r)})};class zu extends Oe{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ne.boolean){const n=this._getOrReturnCtx(e);return ae(n,{code:Y.invalid_type,expected:ne.boolean,received:n.parsedType}),_e}return fr(e.data)}}zu.create=r=>new zu({typeName:ve.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...Ie(r)});class ia extends Oe{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ne.date){const i=this._getOrReturnCtx(e);return ae(i,{code:Y.invalid_type,expected:ne.date,received:i.parsedType}),_e}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return ae(i,{code:Y.invalid_date}),_e}const n=new Xt;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),ae(s,{code:Y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),ae(s,{code:Y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):He.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ia({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:ye.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:ye.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}ia.create=r=>new ia({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:ve.ZodDate,...Ie(r)});class af extends Oe{_parse(e){if(this._getType(e)!==ne.symbol){const n=this._getOrReturnCtx(e);return ae(n,{code:Y.invalid_type,expected:ne.symbol,received:n.parsedType}),_e}return fr(e.data)}}af.create=r=>new af({typeName:ve.ZodSymbol,...Ie(r)});class Vu extends Oe{_parse(e){if(this._getType(e)!==ne.undefined){const n=this._getOrReturnCtx(e);return ae(n,{code:Y.invalid_type,expected:ne.undefined,received:n.parsedType}),_e}return fr(e.data)}}Vu.create=r=>new Vu({typeName:ve.ZodUndefined,...Ie(r)});class Gu extends Oe{_parse(e){if(this._getType(e)!==ne.null){const n=this._getOrReturnCtx(e);return ae(n,{code:Y.invalid_type,expected:ne.null,received:n.parsedType}),_e}return fr(e.data)}}Gu.create=r=>new Gu({typeName:ve.ZodNull,...Ie(r)});class ll extends Oe{constructor(){super(...arguments),this._any=!0}_parse(e){return fr(e.data)}}ll.create=r=>new ll({typeName:ve.ZodAny,...Ie(r)});class Jo extends Oe{constructor(){super(...arguments),this._unknown=!0}_parse(e){return fr(e.data)}}Jo.create=r=>new Jo({typeName:ve.ZodUnknown,...Ie(r)});class Xs extends Oe{_parse(e){const t=this._getOrReturnCtx(e);return ae(t,{code:Y.invalid_type,expected:ne.never,received:t.parsedType}),_e}}Xs.create=r=>new Xs({typeName:ve.ZodNever,...Ie(r)});class cf extends Oe{_parse(e){if(this._getType(e)!==ne.undefined){const n=this._getOrReturnCtx(e);return ae(n,{code:Y.invalid_type,expected:ne.void,received:n.parsedType}),_e}return fr(e.data)}}cf.create=r=>new cf({typeName:ve.ZodVoid,...Ie(r)});class Un extends Oe{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),s=this._def;if(t.parsedType!==ne.array)return ae(t,{code:Y.invalid_type,expected:ne.array,received:t.parsedType}),_e;if(s.exactLength!==null){const o=t.data.length>s.exactLength.value,a=t.data.length<s.exactLength.value;(o||a)&&(ae(t,{code:o?Y.too_big:Y.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(ae(t,{code:Y.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(ae(t,{code:Y.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>s.type._parseAsync(new gs(t,o,t.path,a)))).then(o=>Xt.mergeArray(n,o));const i=[...t.data].map((o,a)=>s.type._parseSync(new gs(t,o,t.path,a)));return Xt.mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new Un({...this._def,minLength:{value:e,message:ye.toString(t)}})}max(e,t){return new Un({...this._def,maxLength:{value:e,message:ye.toString(t)}})}length(e,t){return new Un({...this._def,exactLength:{value:e,message:ye.toString(t)}})}nonempty(e){return this.min(1,e)}}Un.create=(r,e)=>new Un({type:r,minLength:null,maxLength:null,exactLength:null,typeName:ve.ZodArray,...Ie(e)});function Va(r){if(r instanceof ut){const e={};for(const t in r.shape){const n=r.shape[t];e[t]=Qs.create(Va(n))}return new ut({...r._def,shape:()=>e})}else return r instanceof Un?new Un({...r._def,type:Va(r.element)}):r instanceof Qs?Qs.create(Va(r.unwrap())):r instanceof aa?aa.create(Va(r.unwrap())):r instanceof ms?ms.create(r.items.map(e=>Va(e))):r}class ut extends Oe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=He.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==ne.object){const l=this._getOrReturnCtx(e);return ae(l,{code:Y.invalid_type,expected:ne.object,received:l.parsedType}),_e}const{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Xs&&this._def.unknownKeys==="strip"))for(const l in s.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const u=i[l],h=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new gs(s,h,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof Xs){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(l==="strict")a.length>0&&(ae(s,{code:Y.unrecognized_keys,keys:a}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of a){const h=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new gs(s,h,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const h=await u.key;l.push({key:h,value:await u.value,alwaysSet:u.alwaysSet})}return l}).then(l=>Xt.mergeObjectSync(n,l)):Xt.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return ye.errToObj,new ut({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,t,n).message)!==null&&o!==void 0?o:n.defaultError;return t.code==="unrecognized_keys"?{message:(a=ye.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new ut({...this._def,unknownKeys:"strip"})}passthrough(){return new ut({...this._def,unknownKeys:"passthrough"})}extend(e){return new ut({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ut({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ve.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ut({...this._def,catchall:e})}pick(e){const t={};return He.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new ut({...this._def,shape:()=>t})}omit(e){const t={};return He.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new ut({...this._def,shape:()=>t})}deepPartial(){return Va(this)}partial(e){const t={};return He.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];e&&!e[n]?t[n]=s:t[n]=s.optional()}),new ut({...this._def,shape:()=>t})}required(e){const t={};return He.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Qs;)i=i._def.innerType;t[n]=i}}),new ut({...this._def,shape:()=>t})}keyof(){return U_(He.objectKeys(this.shape))}}ut.create=(r,e)=>new ut({shape:()=>r,unknownKeys:"strip",catchall:Xs.create(),typeName:ve.ZodObject,...Ie(e)});ut.strictCreate=(r,e)=>new ut({shape:()=>r,unknownKeys:"strict",catchall:Xs.create(),typeName:ve.ZodObject,...Ie(e)});ut.lazycreate=(r,e)=>new ut({shape:r,unknownKeys:"strip",catchall:Xs.create(),typeName:ve.ZodObject,...Ie(e)});class Ku extends Oe{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new kn(a.ctx.common.issues));return ae(t,{code:Y.invalid_union,unionErrors:o}),_e}if(t.common.async)return Promise.all(n.map(async i=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of n){const l={...t,common:{...t.common,issues:[]},parent:null},u=c._parseSync({data:t.data,path:t.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new kn(c));return ae(t,{code:Y.invalid_union,unionErrors:a}),_e}}get options(){return this._def.options}}Ku.create=(r,e)=>new Ku({options:r,typeName:ve.ZodUnion,...Ie(e)});const Bd=r=>r instanceof Ju?Bd(r.schema):r instanceof Bn?Bd(r.innerType()):r instanceof Zu?[r.value]:r instanceof Vi?r.options:r instanceof Yu?Object.keys(r.enum):r instanceof Xu?Bd(r._def.innerType):r instanceof Vu?[void 0]:r instanceof Gu?[null]:null;class tp extends Oe{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ne.object)return ae(t,{code:Y.invalid_type,expected:ne.object,received:t.parsedType}),_e;const n=this.discriminator,s=t.data[n],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(ae(t,{code:Y.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),_e)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const s=new Map;for(const i of t){const o=Bd(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new tp({typeName:ve.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...Ie(n)})}}function Im(r,e){const t=mi(r),n=mi(e);if(r===e)return{valid:!0,data:r};if(t===ne.object&&n===ne.object){const s=He.objectKeys(e),i=He.objectKeys(r).filter(a=>s.indexOf(a)!==-1),o={...r,...e};for(const a of i){const c=Im(r[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(t===ne.array&&n===ne.array){if(r.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<r.length;i++){const o=r[i],a=e[i],c=Im(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return t===ne.date&&n===ne.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class Wu extends Oe{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=(i,o)=>{if(_m(i)||_m(o))return _e;const a=Im(i.value,o.value);return a.valid?((Cm(i)||Cm(o))&&t.dirty(),{status:t.value,value:a.data}):(ae(n,{code:Y.invalid_intersection_types}),_e)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Wu.create=(r,e,t)=>new Wu({left:r,right:e,typeName:ve.ZodIntersection,...Ie(t)});class ms extends Oe{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ne.array)return ae(n,{code:Y.invalid_type,expected:ne.array,received:n.parsedType}),_e;if(n.data.length<this._def.items.length)return ae(n,{code:Y.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),_e;!this._def.rest&&n.data.length>this._def.items.length&&(ae(n,{code:Y.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...n.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new gs(n,o,n.path,a)):null}).filter(o=>!!o);return n.common.async?Promise.all(i).then(o=>Xt.mergeArray(t,o)):Xt.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new ms({...this._def,rest:e})}}ms.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ms({items:r,typeName:ve.ZodTuple,rest:null,...Ie(e)})};class Qu extends Oe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ne.object)return ae(n,{code:Y.invalid_type,expected:ne.object,received:n.parsedType}),_e;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in n.data)s.push({key:i._parse(new gs(n,a,n.path,a)),value:o._parse(new gs(n,n.data[a],n.path,a))});return n.common.async?Xt.mergeObjectAsync(t,s):Xt.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof Oe?new Qu({keyType:e,valueType:t,typeName:ve.ZodRecord,...Ie(n)}):new Qu({keyType:Rn.create(),valueType:e,typeName:ve.ZodRecord,...Ie(t)})}}class lf extends Oe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ne.map)return ae(n,{code:Y.invalid_type,expected:ne.map,received:n.parsedType}),_e;const s=this._def.keyType,i=this._def.valueType,o=[...n.data.entries()].map(([a,c],l)=>({key:s._parse(new gs(n,a,n.path,[l,"key"])),value:i._parse(new gs(n,c,n.path,[l,"value"]))}));if(n.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return _e;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(l.value,u.value)}return{status:t.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return _e;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(l.value,u.value)}return{status:t.value,value:a}}}}lf.create=(r,e,t)=>new lf({valueType:e,keyType:r,typeName:ve.ZodMap,...Ie(t)});class oa extends Oe{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ne.set)return ae(n,{code:Y.invalid_type,expected:ne.set,received:n.parsedType}),_e;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(ae(n,{code:Y.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(ae(n,{code:Y.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const i=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return _e;u.status==="dirty"&&t.dirty(),l.add(u.value)}return{status:t.value,value:l}}const a=[...n.data.values()].map((c,l)=>i._parse(new gs(n,c,n.path,l)));return n.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,t){return new oa({...this._def,minSize:{value:e,message:ye.toString(t)}})}max(e,t){return new oa({...this._def,maxSize:{value:e,message:ye.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}oa.create=(r,e)=>new oa({valueType:r,minSize:null,maxSize:null,typeName:ve.ZodSet,...Ie(e)});class sc extends Oe{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ne.function)return ae(t,{code:Y.invalid_type,expected:ne.function,received:t.parsedType}),_e;function n(a,c){return sf({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,nf(),Hu].filter(l=>!!l),issueData:{code:Y.invalid_arguments,argumentsError:c}})}function s(a,c){return sf({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,nf(),Hu].filter(l=>!!l),issueData:{code:Y.invalid_return_type,returnTypeError:c}})}const i={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof ul){const a=this;return fr(async function(...c){const l=new kn([]),u=await a._def.args.parseAsync(c,i).catch(f=>{throw l.addIssue(n(c,f)),l}),h=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(h,i).catch(f=>{throw l.addIssue(s(h,f)),l})})}else{const a=this;return fr(function(...c){const l=a._def.args.safeParse(c,i);if(!l.success)throw new kn([n(c,l.error)]);const u=Reflect.apply(o,this,l.data),h=a._def.returns.safeParse(u,i);if(!h.success)throw new kn([s(u,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new sc({...this._def,args:ms.create(e).rest(Jo.create())})}returns(e){return new sc({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new sc({args:e||ms.create([]).rest(Jo.create()),returns:t||Jo.create(),typeName:ve.ZodFunction,...Ie(n)})}}class Ju extends Oe{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Ju.create=(r,e)=>new Ju({getter:r,typeName:ve.ZodLazy,...Ie(e)});class Zu extends Oe{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return ae(t,{received:t.data,code:Y.invalid_literal,expected:this._def.value}),_e}return{status:"valid",value:e.data}}get value(){return this._def.value}}Zu.create=(r,e)=>new Zu({value:r,typeName:ve.ZodLiteral,...Ie(e)});function U_(r,e){return new Vi({values:r,typeName:ve.ZodEnum,...Ie(e)})}class Vi extends Oe{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return ae(t,{expected:He.joinValues(n),received:t.parsedType,code:Y.invalid_type}),_e}if(this._def.values.indexOf(e.data)===-1){const t=this._getOrReturnCtx(e),n=this._def.values;return ae(t,{received:t.data,code:Y.invalid_enum_value,options:n}),_e}return fr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return Vi.create(e)}exclude(e){return Vi.create(this.options.filter(t=>!e.includes(t)))}}Vi.create=U_;class Yu extends Oe{_parse(e){const t=He.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==ne.string&&n.parsedType!==ne.number){const s=He.objectValues(t);return ae(n,{expected:He.joinValues(s),received:n.parsedType,code:Y.invalid_type}),_e}if(t.indexOf(e.data)===-1){const s=He.objectValues(t);return ae(n,{received:n.data,code:Y.invalid_enum_value,options:s}),_e}return fr(e.data)}get enum(){return this._def.values}}Yu.create=(r,e)=>new Yu({values:r,typeName:ve.ZodNativeEnum,...Ie(e)});class ul extends Oe{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ne.promise&&t.common.async===!1)return ae(t,{code:Y.invalid_type,expected:ne.promise,received:t.parsedType}),_e;const n=t.parsedType===ne.promise?t.data:Promise.resolve(t.data);return fr(n.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}ul.create=(r,e)=>new ul({type:r,typeName:ve.ZodPromise,...Ie(e)});class Bn extends Oe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ve.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{ae(n,o),o.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(n.data,i);return n.common.issues.length?{status:"dirty",value:n.data}:n.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:n.path,parent:n})):this._def.schema._parseSync({data:o,path:n.path,parent:n})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?_e:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?_e:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(s.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!qu(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>qu(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:t.value,value:a})):o);He.assertNever(s)}}Bn.create=(r,e,t)=>new Bn({schema:r,typeName:ve.ZodEffects,effect:e,...Ie(t)});Bn.createWithPreprocess=(r,e,t)=>new Bn({schema:e,effect:{type:"preprocess",transform:r},typeName:ve.ZodEffects,...Ie(t)});class Qs extends Oe{_parse(e){return this._getType(e)===ne.undefined?fr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Qs.create=(r,e)=>new Qs({innerType:r,typeName:ve.ZodOptional,...Ie(e)});class aa extends Oe{_parse(e){return this._getType(e)===ne.null?fr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}aa.create=(r,e)=>new aa({innerType:r,typeName:ve.ZodNullable,...Ie(e)});class Xu extends Oe{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===ne.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Xu.create=(r,e)=>new Xu({innerType:r,typeName:ve.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ie(e)});class uf extends Oe{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return of(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new kn(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new kn(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}uf.create=(r,e)=>new uf({innerType:r,typeName:ve.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ie(e)});class hf extends Oe{_parse(e){if(this._getType(e)!==ne.nan){const n=this._getOrReturnCtx(e);return ae(n,{code:Y.invalid_type,expected:ne.nan,received:n.parsedType}),_e}return{status:"valid",value:e.data}}}hf.create=r=>new hf({typeName:ve.ZodNaN,...Ie(r)});const fM=Symbol("zod_brand");class B_ extends Oe{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class Mh extends Oe{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?_e:i.status==="dirty"?(t.dirty(),k_(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?_e:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,t){return new Mh({in:e,out:t,typeName:ve.ZodPipeline})}}class df extends Oe{_parse(e){const t=this._def.innerType._parse(e);return qu(t)&&(t.value=Object.freeze(t.value)),t}}df.create=(r,e)=>new df({innerType:r,typeName:ve.ZodReadonly,...Ie(e)});const $_=(r,e={},t)=>r?ll.create().superRefine((n,s)=>{var i,o;if(!r(n)){const a=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:t)!==null&&o!==void 0?o:!0,l=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...l,fatal:c})}}):ll.create(),pM={object:ut.lazycreate};var ve;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(ve||(ve={}));const gM=(r,e={message:`Input not instance of ${r.name}`})=>$_(t=>t instanceof r,e),L_=Rn.create,M_=qi.create,mM=hf.create,yM=zi.create,F_=zu.create,wM=ia.create,bM=af.create,vM=Vu.create,EM=Gu.create,AM=ll.create,_M=Jo.create,CM=Xs.create,IM=cf.create,NM=Un.create,xM=ut.create,PM=ut.strictCreate,TM=Ku.create,OM=tp.create,SM=Wu.create,RM=ms.create,DM=Qu.create,kM=lf.create,UM=oa.create,BM=sc.create,$M=Ju.create,LM=Zu.create,MM=Vi.create,FM=Yu.create,jM=ul.create,Nv=Bn.create,HM=Qs.create,qM=aa.create,zM=Bn.createWithPreprocess,VM=Mh.create,GM=()=>L_().optional(),KM=()=>M_().optional(),WM=()=>F_().optional(),QM={string:r=>Rn.create({...r,coerce:!0}),number:r=>qi.create({...r,coerce:!0}),boolean:r=>zu.create({...r,coerce:!0}),bigint:r=>zi.create({...r,coerce:!0}),date:r=>ia.create({...r,coerce:!0})},JM=_e;var P=Object.freeze({__proto__:null,defaultErrorMap:Hu,setErrorMap:eM,getErrorMap:nf,makeIssue:sf,EMPTY_PATH:tM,addIssueToContext:ae,ParseStatus:Xt,INVALID:_e,DIRTY:k_,OK:fr,isAborted:_m,isDirty:Cm,isValid:qu,isAsync:of,get util(){return He},get objectUtil(){return Am},ZodParsedType:ne,getParsedType:mi,ZodType:Oe,ZodString:Rn,ZodNumber:qi,ZodBigInt:zi,ZodBoolean:zu,ZodDate:ia,ZodSymbol:af,ZodUndefined:Vu,ZodNull:Gu,ZodAny:ll,ZodUnknown:Jo,ZodNever:Xs,ZodVoid:cf,ZodArray:Un,ZodObject:ut,ZodUnion:Ku,ZodDiscriminatedUnion:tp,ZodIntersection:Wu,ZodTuple:ms,ZodRecord:Qu,ZodMap:lf,ZodSet:oa,ZodFunction:sc,ZodLazy:Ju,ZodLiteral:Zu,ZodEnum:Vi,ZodNativeEnum:Yu,ZodPromise:ul,ZodEffects:Bn,ZodTransformer:Bn,ZodOptional:Qs,ZodNullable:aa,ZodDefault:Xu,ZodCatch:uf,ZodNaN:hf,BRAND:fM,ZodBranded:B_,ZodPipeline:Mh,ZodReadonly:df,custom:$_,Schema:Oe,ZodSchema:Oe,late:pM,get ZodFirstPartyTypeKind(){return ve},coerce:QM,any:AM,array:NM,bigint:yM,boolean:F_,date:wM,discriminatedUnion:OM,effect:Nv,enum:MM,function:BM,instanceof:gM,intersection:SM,lazy:$M,literal:LM,map:kM,nan:mM,nativeEnum:FM,never:CM,null:EM,nullable:qM,number:M_,object:xM,oboolean:WM,onumber:KM,optional:HM,ostring:GM,pipeline:VM,preprocess:zM,promise:jM,record:DM,set:UM,strictObject:PM,string:L_,symbol:bM,transformer:Nv,tuple:RM,undefined:vM,union:TM,unknown:_M,void:IM,NEVER:JM,ZodIssueCode:Y,quotelessJson:XL,ZodError:kn});const dt=P.object({message:P.string()});function se(r){return P.literal(he[r])}P.object({accessList:P.array(P.string()),blockHash:P.string().nullable(),blockNumber:P.string().nullable(),chainId:P.string().or(P.number()),from:P.string(),gas:P.string(),hash:P.string(),input:P.string().nullable(),maxFeePerGas:P.string(),maxPriorityFeePerGas:P.string(),nonce:P.string(),r:P.string(),s:P.string(),to:P.string(),transactionIndex:P.string().nullable(),type:P.string(),v:P.string(),value:P.string()});const ZM=P.object({chainId:P.string().or(P.number())}),YM=P.object({email:P.string().email()}),XM=P.object({otp:P.string()}),e6=P.object({uri:P.string()}),t6=P.object({chainId:P.optional(P.string().or(P.number())),preferredAccountType:P.optional(P.string())}),r6=P.object({provider:P.enum(["google","github","apple","facebook","x","discord"])}),n6=P.object({email:P.string().email()}),s6=P.object({otp:P.string()}),i6=P.object({otp:P.string()}),o6=P.object({themeMode:P.optional(P.enum(["light","dark"])),themeVariables:P.optional(P.record(P.string(),P.string().or(P.number()))),w3mThemeVariables:P.optional(P.record(P.string(),P.string()))}),a6=P.object({metadata:P.object({name:P.string(),description:P.string(),url:P.string(),icons:P.array(P.string())}).optional(),sdkVersion:P.string().optional(),sdkType:P.string().optional(),projectId:P.string()}),c6=P.object({type:P.string()}),l6=P.object({action:P.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),u6=P.object({url:P.string()}),h6=P.object({userName:P.string()}),d6=P.object({email:P.string().optional().nullable(),address:P.string(),chainId:P.string().or(P.number()),accounts:P.array(P.object({address:P.string(),type:P.enum([hn.ACCOUNT_TYPES.EOA,hn.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:P.string().optional().nullable()}),f6=P.object({action:P.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),p6=P.object({email:P.string().email().optional().nullable(),address:P.string(),chainId:P.string().or(P.number()),smartAccountDeployed:P.optional(P.boolean()),accounts:P.array(P.object({address:P.string(),type:P.enum([hn.ACCOUNT_TYPES.EOA,hn.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:P.optional(P.string())}),g6=P.object({uri:P.string()}),m6=P.object({isConnected:P.boolean()}),y6=P.object({chainId:P.string().or(P.number())}),w6=P.object({chainId:P.string().or(P.number())}),b6=P.object({newEmail:P.string().email()}),v6=P.object({smartAccountEnabledNetworks:P.array(P.number())});P.object({address:P.string(),isDeployed:P.boolean()});const E6=P.object({version:P.string().optional()}),A6=P.object({type:P.string(),address:P.string()}),_6=P.any(),C6=P.object({method:P.literal("eth_accounts")}),I6=P.object({method:P.literal("eth_blockNumber")}),N6=P.object({method:P.literal("eth_call"),params:P.array(P.any())}),x6=P.object({method:P.literal("eth_chainId")}),P6=P.object({method:P.literal("eth_estimateGas"),params:P.array(P.any())}),T6=P.object({method:P.literal("eth_feeHistory"),params:P.array(P.any())}),O6=P.object({method:P.literal("eth_gasPrice")}),S6=P.object({method:P.literal("eth_getAccount"),params:P.array(P.any())}),R6=P.object({method:P.literal("eth_getBalance"),params:P.array(P.any())}),D6=P.object({method:P.literal("eth_getBlockByHash"),params:P.array(P.any())}),k6=P.object({method:P.literal("eth_getBlockByNumber"),params:P.array(P.any())}),U6=P.object({method:P.literal("eth_getBlockReceipts"),params:P.array(P.any())}),B6=P.object({method:P.literal("eth_getBlockTransactionCountByHash"),params:P.array(P.any())}),$6=P.object({method:P.literal("eth_getBlockTransactionCountByNumber"),params:P.array(P.any())}),L6=P.object({method:P.literal("eth_getCode"),params:P.array(P.any())}),M6=P.object({method:P.literal("eth_getFilterChanges"),params:P.array(P.any())}),F6=P.object({method:P.literal("eth_getFilterLogs"),params:P.array(P.any())}),j6=P.object({method:P.literal("eth_getLogs"),params:P.array(P.any())}),H6=P.object({method:P.literal("eth_getProof"),params:P.array(P.any())}),q6=P.object({method:P.literal("eth_getStorageAt"),params:P.array(P.any())}),z6=P.object({method:P.literal("eth_getTransactionByBlockHashAndIndex"),params:P.array(P.any())}),V6=P.object({method:P.literal("eth_getTransactionByBlockNumberAndIndex"),params:P.array(P.any())}),G6=P.object({method:P.literal("eth_getTransactionByHash"),params:P.array(P.any())}),K6=P.object({method:P.literal("eth_getTransactionCount"),params:P.array(P.any())}),W6=P.object({method:P.literal("eth_getTransactionReceipt"),params:P.array(P.any())}),Q6=P.object({method:P.literal("eth_getUncleCountByBlockHash"),params:P.array(P.any())}),J6=P.object({method:P.literal("eth_getUncleCountByBlockNumber"),params:P.array(P.any())}),Z6=P.object({method:P.literal("eth_maxPriorityFeePerGas")}),Y6=P.object({method:P.literal("eth_newBlockFilter")}),X6=P.object({method:P.literal("eth_newFilter"),params:P.array(P.any())}),eF=P.object({method:P.literal("eth_newPendingTransactionFilter")}),tF=P.object({method:P.literal("eth_sendRawTransaction"),params:P.array(P.any())}),rF=P.object({method:P.literal("eth_syncing"),params:P.array(P.any())}),nF=P.object({method:P.literal("eth_uninstallFilter"),params:P.array(P.any())}),xv=P.object({method:P.literal("personal_sign"),params:P.array(P.any())}),sF=P.object({method:P.literal("eth_signTypedData_v4"),params:P.array(P.any())}),iF=P.object({method:P.literal("eth_sendTransaction"),params:P.array(P.any())}),oF=P.object({method:P.literal("solana_signMessage"),params:P.object({message:P.string(),pubkey:P.string()})}),aF=P.object({method:P.literal("solana_signTransaction"),params:P.object({transaction:P.string()})}),cF=P.object({method:P.literal("solana_signAllTransactions"),params:P.object({transactions:P.array(P.string())})}),lF=P.object({method:P.literal("solana_signAndSendTransaction"),params:P.object({transaction:P.string(),options:P.object({skipPreflight:P.boolean().optional(),preflightCommitment:P.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:P.number().optional(),minContextSlot:P.number().optional()}).optional()})}),uF=P.object({method:P.literal("wallet_sendCalls"),params:P.array(P.object({chainId:P.string().or(P.number()).optional(),from:P.string().optional(),version:P.string().optional(),capabilities:P.any().optional(),calls:P.array(P.object({to:P.string().startsWith("0x"),data:P.string().startsWith("0x").optional(),value:P.string().optional()}))}))}),hF=P.object({method:P.literal("wallet_getCallsStatus"),params:P.array(P.string())}),dF=P.object({method:P.literal("wallet_getCapabilities")}),fF=P.object({method:P.literal("wallet_grantPermissions"),params:P.array(P.any())}),pF=P.object({method:P.literal("wallet_revokePermissions"),params:P.any()}),gF=P.object({method:P.literal("wallet_getAssets"),params:P.any()}),Pv=P.object({token:P.string()}),ie=P.object({id:P.string().optional()}),ql={appEvent:ie.extend({type:se("APP_SWITCH_NETWORK"),payload:ZM}).or(ie.extend({type:se("APP_CONNECT_EMAIL"),payload:YM})).or(ie.extend({type:se("APP_CONNECT_DEVICE")})).or(ie.extend({type:se("APP_CONNECT_OTP"),payload:XM})).or(ie.extend({type:se("APP_CONNECT_SOCIAL"),payload:e6})).or(ie.extend({type:se("APP_GET_FARCASTER_URI")})).or(ie.extend({type:se("APP_CONNECT_FARCASTER")})).or(ie.extend({type:se("APP_GET_USER"),payload:P.optional(t6)})).or(ie.extend({type:se("APP_GET_SOCIAL_REDIRECT_URI"),payload:r6})).or(ie.extend({type:se("APP_SIGN_OUT")})).or(ie.extend({type:se("APP_IS_CONNECTED"),payload:P.optional(Pv)})).or(ie.extend({type:se("APP_GET_CHAIN_ID")})).or(ie.extend({type:se("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(ie.extend({type:se("APP_INIT_SMART_ACCOUNT")})).or(ie.extend({type:se("APP_SET_PREFERRED_ACCOUNT"),payload:c6})).or(ie.extend({type:se("APP_RPC_REQUEST"),payload:xv.or(gF).or(C6).or(I6).or(N6).or(x6).or(P6).or(T6).or(O6).or(S6).or(R6).or(D6).or(k6).or(U6).or(B6).or($6).or(L6).or(M6).or(F6).or(j6).or(H6).or(q6).or(z6).or(V6).or(G6).or(K6).or(W6).or(Q6).or(J6).or(Z6).or(Y6).or(X6).or(eF).or(tF).or(rF).or(nF).or(xv).or(sF).or(iF).or(oF).or(aF).or(cF).or(lF).or(hF).or(uF).or(dF).or(fF).or(pF)})).or(ie.extend({type:se("APP_UPDATE_EMAIL"),payload:n6})).or(ie.extend({type:se("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:s6})).or(ie.extend({type:se("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:i6})).or(ie.extend({type:se("APP_SYNC_THEME"),payload:o6})).or(ie.extend({type:se("APP_SYNC_DAPP_DATA"),payload:a6})).or(ie.extend({type:se("APP_RELOAD")})),frameEvent:ie.extend({type:se("FRAME_SWITCH_NETWORK_ERROR"),payload:dt}).or(ie.extend({type:se("FRAME_SWITCH_NETWORK_SUCCESS"),payload:w6})).or(ie.extend({type:se("FRAME_CONNECT_EMAIL_SUCCESS"),payload:l6})).or(ie.extend({type:se("FRAME_CONNECT_EMAIL_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:u6})).or(ie.extend({type:se("FRAME_GET_FARCASTER_URI_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:h6})).or(ie.extend({type:se("FRAME_CONNECT_FARCASTER_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_CONNECT_OTP_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_CONNECT_OTP_SUCCESS")})).or(ie.extend({type:se("FRAME_CONNECT_DEVICE_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_CONNECT_DEVICE_SUCCESS")})).or(ie.extend({type:se("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:d6})).or(ie.extend({type:se("FRAME_CONNECT_SOCIAL_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_GET_USER_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_GET_USER_SUCCESS"),payload:p6})).or(ie.extend({type:se("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:g6})).or(ie.extend({type:se("FRAME_SIGN_OUT_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_SIGN_OUT_SUCCESS")})).or(ie.extend({type:se("FRAME_IS_CONNECTED_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_IS_CONNECTED_SUCCESS"),payload:m6})).or(ie.extend({type:se("FRAME_GET_CHAIN_ID_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_GET_CHAIN_ID_SUCCESS"),payload:y6})).or(ie.extend({type:se("FRAME_RPC_REQUEST_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_RPC_REQUEST_SUCCESS"),payload:_6})).or(ie.extend({type:se("FRAME_SESSION_UPDATE"),payload:Pv})).or(ie.extend({type:se("FRAME_UPDATE_EMAIL_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_UPDATE_EMAIL_SUCCESS"),payload:f6})).or(ie.extend({type:se("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(ie.extend({type:se("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:b6})).or(ie.extend({type:se("FRAME_SYNC_THEME_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_SYNC_THEME_SUCCESS")})).or(ie.extend({type:se("FRAME_SYNC_DAPP_DATA_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(ie.extend({type:se("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:v6})).or(ie.extend({type:se("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:A6})).or(ie.extend({type:se("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_READY"),payload:E6})).or(ie.extend({type:se("FRAME_RELOAD_ERROR"),payload:dt})).or(ie.extend({type:se("FRAME_RELOAD_SUCCESS")}))};function cg(r,e={}){var t;return typeof(e==null?void 0:e.type)=="string"&&((t=e==null?void 0:e.type)==null?void 0:t.includes(r))}class mF{constructor({projectId:e,isAppClient:t=!1,chainId:n="eip155:1",enableLogger:s=!0}){if(this.iframe=null,this.rpcUrl=oe.BLOCKCHAIN_API_RPC_URL,this.initFrame=()=>{const i=document.getElementById("w3m-iframe");this.iframe&&!i&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(i,o,a)=>{function c({data:l}){if(!cg(he.FRAME_EVENT_KEY,l))return;const u=ql.frameEvent.parse(l);u.id===i&&(o(u),window.removeEventListener("message",c))}jr.isClient&&(window.addEventListener("message",c),a.addEventListener("abort",()=>{window.removeEventListener("message",c)}))},onFrameEvent:i=>{jr.isClient&&window.addEventListener("message",({data:o})=>{if(!cg(he.FRAME_EVENT_KEY,o))return;const a=ql.frameEvent.parse(o);i(a)})},onAppEvent:i=>{jr.isClient&&window.addEventListener("message",({data:o})=>{if(!cg(he.APP_EVENT_KEY,o))return;const a=ql.appEvent.parse(o);i(a)})},postAppEvent:i=>{var o;if(jr.isClient){if(!((o=this.iframe)!=null&&o.contentWindow))throw new Error("W3mFrame: iframe is not set");ql.appEvent.parse(i),this.iframe.contentWindow.postMessage(i,"*")}},postFrameEvent:i=>{if(jr.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");ql.frameEvent.parse(i),parent.postMessage(i,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((i,o)=>{this.frameLoadPromiseResolver={resolve:i,reject:o}}),t&&(this.frameLoadPromise=new Promise((i,o)=>{this.frameLoadPromiseResolver={resolve:i,reject:o}}),jr.isClient)){const i=document.createElement("iframe");i.id="w3m-iframe",i.src=`${JI}?projectId=${e}&chainId=${n}&version=${ZI}&enableLogger=${s}`,i.name="w3m-secure-iframe",i.style.position="fixed",i.style.zIndex="999999",i.style.display="none",i.style.animationDelay="0s, 50ms",i.style.borderBottomLeftRadius="clamp(0px, var(--wui-border-radius-l), 44px)",i.style.borderBottomRightRadius="clamp(0px, var(--wui-border-radius-l), 44px)",this.iframe=i,this.iframe.onerror=()=>{var o;(o=this.frameLoadPromiseResolver)==null||o.reject("Unable to load email login dependency")},this.events.onFrameEvent(o=>{var a;o.type==="@w3m-frame/READY"&&((a=this.frameLoadPromiseResolver)==null||a.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(t=>({[t]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${t}&projectId=${this.projectId}`,chainId:t}}));return Object.assign({},...e)}}class yF{constructor(e){var i;const t=vl({level:YI}),{logger:n,chunkLoggerController:s}=dy({opts:t});this.logger=er(n,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&((i=this.chunkLoggerController)!=null&&i.downloadLogsBlobInBrowser)&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{var o;(o=this.chunkLoggerController)!=null&&o.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class wF{constructor({projectId:e,chainId:t,enableLogger:n=!0,onTimeout:s}){this.openRpcRequests=[],n&&(this.w3mLogger=new yF(e)),this.w3mFrame=new mF({projectId:e,isAppClient:!0,chainId:t,enableLogger:n}),this.onTimeout=s,this.getLoginEmailUsed()&&this.w3mFrame.initFrame(),this.initPromise=new Promise(i=>{this.w3mFrame.events.onFrameEvent(async o=>{o.type===he.FRAME_READY&&(this.initPromise=void 0,await new Promise(a=>{setTimeout(a,500)}),i())})})}async init(){this.w3mFrame.initFrame(),this.initPromise&&await this.initPromise}getLoginEmailUsed(){return!!Mt.get(he.EMAIL_LOGIN_USED_KEY)}getEmail(){return Mt.get(he.EMAIL)}getUsername(){return Mt.get(he.SOCIAL_USERNAME)}async reload(){var e;try{this.w3mFrame.initFrame(),await this.appEvent({type:he.APP_RELOAD})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error reloading iframe"),t}}async connectEmail(e){var t;try{jr.checkIfAllowedToTriggerEmail(),this.w3mFrame.initFrame();const n=await this.appEvent({type:he.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting email"),n}}async connectDevice(){var e;try{return this.appEvent({type:he.APP_CONNECT_DEVICE})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error connecting device"),t}}async connectOtp(e){var t;try{return this.appEvent({type:he.APP_CONNECT_OTP,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting otp"),n}}async isConnected(){var e;try{if(!this.getLoginEmailUsed())return{isConnected:!1};const t=await this.appEvent({type:he.APP_IS_CONNECTED});return t!=null&&t.isConnected||this.deleteAuthLoginCache(),t}catch(t){throw this.deleteAuthLoginCache(),(e=this.w3mLogger)==null||e.logger.error({error:t},"Error checking connection"),t}}async getChainId(){var e;try{const t=await this.appEvent({type:he.APP_GET_CHAIN_ID});return this.setLastUsedChainId(t.chainId),t}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting chain id"),t}}async getSocialRedirectUri(e){var t;try{return this.w3mFrame.initFrame(),this.appEvent({type:he.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error getting social redirect uri"),n}}async updateEmail(e){var t;try{const n=await this.appEvent({type:he.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error updating email"),n}}async updateEmailPrimaryOtp(e){var t;try{return this.appEvent({type:he.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error updating email primary otp"),n}}async updateEmailSecondaryOtp(e){var t;try{const n=await this.appEvent({type:he.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(n.newEmail),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error updating email secondary otp"),n}}async syncTheme(e){var t;try{return this.appEvent({type:he.APP_SYNC_THEME,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error syncing theme"),n}}async syncDappData(e){var t;try{return this.appEvent({type:he.APP_SYNC_DAPP_DATA,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error syncing dapp data"),n}}async getSmartAccountEnabledNetworks(){var e;try{const t=await this.appEvent({type:he.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(t.smartAccountEnabledNetworks),t}catch(t){throw this.persistSmartAccountEnabledNetworks([]),(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting smart account enabled networks"),t}}async setPreferredAccount(e){var t;try{return this.appEvent({type:he.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error setting preferred account"),n}}async connect(e){var t;try{const n=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.getUser({chainId:n,preferredAccountType:e==null?void 0:e.preferredAccountType});return this.setLoginSuccess(s.email),this.setLastUsedChainId(s.chainId),this.user=s,s}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting"),n}}async getUser(e){var t;try{const n=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.appEvent({type:he.APP_GET_USER,payload:{...e,chainId:n}});return this.user=s,s}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting"),n}}async connectSocial(e){var t;try{this.w3mFrame.initFrame();const n=await this.appEvent({type:he.APP_CONNECT_SOCIAL,payload:{uri:e}});return n.userName&&this.setSocialLoginSuccess(n.userName),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting social"),n}}async getFarcasterUri(){var e;try{return this.w3mFrame.initFrame(),await this.appEvent({type:he.APP_GET_FARCASTER_URI})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting farcaster uri"),t}}async connectFarcaster(){var e;try{const t=await this.appEvent({type:he.APP_CONNECT_FARCASTER});return t.userName&&this.setSocialLoginSuccess(t.userName),t}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error connecting farcaster"),t}}async switchNetwork(e){var t;try{const n=await this.appEvent({type:he.APP_SWITCH_NETWORK,payload:{chainId:e}});return this.setLastUsedChainId(n.chainId),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error switching network"),n}}async disconnect(){var e;try{const t=await this.appEvent({type:he.APP_SIGN_OUT});return this.deleteAuthLoginCache(),t}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error disconnecting"),t}}async request(e){var t,n,s,i;try{if(hn.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();(t=this.rpcRequestHandler)==null||t.call(this,e);const o=await this.appEvent({type:he.APP_RPC_REQUEST,payload:e});return(n=this.rpcSuccessHandler)==null||n.call(this,o,e),o}catch(o){throw(s=this.rpcErrorHandler)==null||s.call(this,o,e),(i=this.w3mLogger)==null||i.logger.error({error:o},"Error requesting"),o}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===he.FRAME_IS_CONNECTED_SUCCESS&&t.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===he.FRAME_IS_CONNECTED_ERROR&&e(),t.type===he.FRAME_IS_CONNECTED_SUCCESS&&!t.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===he.FRAME_GET_USER_SUCCESS&&e(t.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===he.FRAME_CONNECT_SOCIAL_SUCCESS&&e(t.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===he.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(t.payload):t.type===he.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:hn.ACCOUNT_TYPES.EOA})})}onGetSmartAccountEnabledNetworks(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===he.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS?e(t.payload.smartAccountEnabledNetworks):t.type===he.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR&&e([])})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}rejectRpcRequests(){var e;try{this.openRpcRequests.forEach(({abortController:t,method:n})=>{hn.SAFE_RPC_METHODS.includes(n)||t.abort()}),this.openRpcRequests=[]}catch(t){(e=this.w3mLogger)==null||e.logger.error({error:t},"Error aborting RPC request")}}async appEvent(e){await this.w3mFrame.frameLoadPromise;let t;function n(a){return a.replace("@w3m-app/","")}const s=new AbortController,i=n(e.type);return[he.APP_CONNECT_EMAIL,he.APP_CONNECT_DEVICE,he.APP_CONNECT_OTP,he.APP_CONNECT_SOCIAL,he.APP_GET_SOCIAL_REDIRECT_URI].map(n).includes(i)&&(t=setTimeout(()=>{var a;(a=this.onTimeout)==null||a.call(this),s.abort()},3e4)),new Promise((a,c)=>{var h,d,f;const l=Math.random().toString(36).substring(7);if((f=(h=this.w3mLogger)==null?void 0:(d=h.logger).info)==null||f.call(d,{event:e,id:l},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:l}),i==="RPC_REQUEST"){const p=e;this.openRpcRequests=[...this.openRpcRequests,{...p.payload,abortController:s}]}s.signal.addEventListener("abort",()=>{i==="RPC_REQUEST"?c(new Error("Request was aborted")):i!=="GET_FARCASTER_URI"&&c(new Error("Something went wrong"))});function u(p,m){var v,_,y;p.id===l&&((_=m==null?void 0:(v=m.logger).info)==null||_.call(v,{framEvent:p,id:l},"Received frame response"),p.type===`@w3m-frame/${i}_SUCCESS`?(t&&clearTimeout(t),"payload"in p&&a(p.payload),a(void 0)):p.type===`@w3m-frame/${i}_ERROR`&&(t&&clearTimeout(t),"payload"in p&&c(new Error(((y=p.payload)==null?void 0:y.message)||"An error occurred")),c(new Error("An error occurred"))))}this.w3mFrame.events.registerFrameEventHandler(l,p=>u(p,this.w3mLogger),s.signal)})}setNewLastEmailLoginTime(){Mt.set(he.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){Mt.set(he.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&Mt.set(he.EMAIL,e),Mt.set(he.EMAIL_LOGIN_USED_KEY,"true"),Mt.delete(he.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){Mt.delete(he.EMAIL_LOGIN_USED_KEY),Mt.delete(he.EMAIL),Mt.delete(he.LAST_USED_CHAIN_KEY),Mt.delete(he.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&Mt.set(he.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=Mt.get(he.LAST_USED_CHAIN_KEY)??void 0,t=Number(e);return isNaN(t)?e:t}persistSmartAccountEnabledNetworks(e){Mt.set(he.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}}class uu{constructor(){}static getInstance({projectId:e,chainId:t,enableLogger:n,onTimeout:s}){return uu.instance||(uu.instance=new wF({projectId:e,chainId:t,enableLogger:n,onTimeout:s})),uu.instance}}var Tv={};const bF={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof hs<"u"&&typeof Tv<"u"?Tv.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}},Nm={filterOutDuplicatesByRDNS(r){const e=me.state.enableEIP6963?st.state.connectors:[],t=it.getRecentWallets(),n=e.map(a=>{var c;return(c=a.info)==null?void 0:c.rdns}).filter(Boolean),s=t.map(a=>a.rdns).filter(Boolean),i=n.concat(s);if(i.includes("io.metamask.mobile")&&ir.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return r.filter(a=>!i.includes(String(a==null?void 0:a.rdns)))},filterOutDuplicatesByIds(r){const e=st.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),t=it.getRecentWallets(),n=e.map(a=>a.explorerId),s=t.map(a=>a.id),i=n.concat(s);return r.filter(a=>!i.includes(a==null?void 0:a.id))},filterOutDuplicateWallets(r){const e=this.filterOutDuplicatesByRDNS(r);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(r){const{connectors:e}=st.state,t=e.filter(i=>i.type==="ANNOUNCED").reduce((i,o)=>{var a;return(a=o.info)!=null&&a.rdns&&(i[o.info.rdns]=!0),i},{});return r.map(i=>({...i,installed:!!i.rdns&&!!t[i.rdns??""]})).sort((i,o)=>Number(o.installed)-Number(i.installed))},getConnectOrderMethod(r,e){var c;const t=(r==null?void 0:r.connectMethodsOrder)||((c=me.state.features)==null?void 0:c.connectMethodsOrder),n=e||st.state.connectors;if(t)return t;const{injected:s,announced:i}=$d.getConnectorsByType(n,go.state.recommended,go.state.featured),o=s.filter($d.showConnector),a=i.filter($d.showConnector);return o.length||a.length?["wallet","email","social"]:bF.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(r){const e=!!r.rdns&&go.state.excludedWallets.some(n=>n.rdns===r.rdns),t=!!r.name&&go.state.excludedWallets.some(n=>ep.isLowerCaseMatch(n.name,r.name));return e||t}},$d={getConnectorsByType(r,e,t){const{customWallets:n}=me.state,s=it.getRecentWallets(),i=Nm.filterOutDuplicateWallets(e),o=Nm.filterOutDuplicateWallets(t),a=r.filter(h=>h.type==="MULTI_CHAIN"),c=r.filter(h=>h.type==="ANNOUNCED"),l=r.filter(h=>h.type==="INJECTED"),u=r.filter(h=>h.type==="EXTERNAL");return{custom:n,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(r){var s;const e=(s=r.info)==null?void 0:s.rdns,t=!!e&&go.state.excludedWallets.some(i=>!!i.rdns&&i.rdns===e),n=!!r.name&&go.state.excludedWallets.some(i=>ep.isLowerCaseMatch(i.name,r.name));return!(r.type==="INJECTED"&&(!ir.isMobile()&&r.name==="Browser Wallet"||!e&&!An.checkInstalled()||t||n)||(r.type==="ANNOUNCED"||r.type==="EXTERNAL")&&(t||n))},getIsConnectedWithWC(){return Array.from(G.state.chains.values()).some(t=>st.getConnectorId(t.namespace)===oe.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:r,featured:e,custom:t,recent:n,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=(l=>(l=me.state.features)==null?void 0:l.connectorTypeOrder)()??[]}){const u=$d.getIsConnectedWithWC(),f=[{type:"walletConnect",isEnabled:me.state.enableWalletConnect&&!u},{type:"recent",isEnabled:n.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:t&&t.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:r.length>0}].filter(_=>_.isEnabled),p=new Set(f.map(_=>_.type)),m=c.filter(_=>p.has(_)).map(_=>({type:_,isEnabled:!0})),v=f.filter(({type:_})=>!m.some(({type:C})=>C===_));return Array.from(new Set([...m,...v].map(({type:_})=>_)))}},Mi={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603},j_=WL({id:11155111,name:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.drpc.org"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.etherscan.io",apiUrl:"https://api-sepolia.etherscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:751532},ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xc8Af999e38273D658BE1b921b88A9Ddf005769cC",blockCreated:5317080}},testnet:!0}),vF={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},My={getMethodsByChainNamespace(r){return vF[r]||[]},createDefaultNamespace(r){return{methods:this.getMethodsByChainNamespace(r),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(r,e){if(!e)return{...r};const t={...r},n=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>n.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>n.add(s)),e.events&&Object.keys(e.events).forEach(s=>n.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&n.add(i)}),n.forEach(s=>{t[s]||(t[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{t[s]&&(t[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{t[s]&&(t[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{t[s]&&(t[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!t[a]||(t[a].rpcMap||(t[a].rpcMap={}),s.has(a)||(t[a].rpcMap={},s.add(a)),t[a].rpcMap[c]=o)})}return t},createNamespaces(r,e){const t=r.reduce((n,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];n[o]||(n[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=n[o];switch(u.chains.push(l),l){case _w.caipNetworkId:u.chains.push(_w.deprecatedCaipNetworkId);break;case Aw.caipNetworkId:u.chains.push(Aw.deprecatedCaipNetworkId);break}return u!=null&&u.rpcMap&&c&&(u.rpcMap[i]=c),n},{});return this.applyNamespaceOverrides(t,e)},resolveReownName:async r=>{var n;const e=await R_.resolveName(r);return((n=(Object.values(e==null?void 0:e.addresses)||[])[0])==null?void 0:n.address)||!1},getChainsFromNamespaces(r={}){return Object.values(r).flatMap(e=>{const t=e.chains||[],n=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...t,...n]))})},isSessionEventData(r){return typeof r=="object"&&r!==null&&"id"in r&&"topic"in r&&"params"in r&&typeof r.params=="object"&&r.params!==null&&"chainId"in r.params&&"event"in r.params&&typeof r.params.event=="object"&&r.params.event!==null}};class Fy{constructor({provider:e,namespace:t}){this.id=oe.CONNECTOR_ID.WALLET_CONNECT,this.name=cs.ConnectorNamesMap[oe.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=cs.ConnectorImageIds[oe.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=G.getCaipNetworks.bind(G),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=t}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const t=this.getCaipNetworks(),n=me.state.universalProviderConfigOverride,s=My.createNamespaces(t,n);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(t=>t.caipNetworkId);return XI.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:EF})}}const EF=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];class H_{constructor(e){this.availableConnectors=[],this.eventListeners=new Map,this.getCaipNetworks=t=>G.getCaipNetworks(t),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get networks(){return this.getCaipNetworks(this.namespace)}setAuthProvider(e){this.addConnector({id:oe.CONNECTOR_ID.AUTH,type:"AUTH",name:oe.CONNECTOR_NAMES.AUTH,provider:e,imageId:cs.ConnectorImageIds[oe.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const t=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(n=>t.has(n.id)?!1:(t.add(n.id),!0)),this.emit("connectors",this.availableConnectors)}setStatus(e,t){Ae.setStatus(e,t)}on(e,t){var n;this.eventListeners.has(e)||this.eventListeners.set(e,new Set),(n=this.eventListeners.get(e))==null||n.add(t)}off(e,t){const n=this.eventListeners.get(e);n&&n.delete(t)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,t){const n=this.eventListeners.get(e);n&&n.forEach(s=>s(t))}async connectWalletConnect(e){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(e){var i;const{caipNetwork:t,providerType:n}=e;if(!e.provider)return;const s="provider"in e.provider?e.provider.provider:e.provider;if(n==="WALLET_CONNECT"){s.setDefaultChain(t.caipNetworkId);return}if(s&&n==="AUTH"){const o=s,a=(i=Ae.state.preferredAccountTypes)==null?void 0:i[t.chainNamespace];await o.switchNetwork(t.caipNetworkId);const c=await o.getUser({chainId:t.caipNetworkId,preferredAccountType:a});this.emit("switchNetwork",c)}}getWalletConnectConnector(){const e=this.connectors.find(t=>t instanceof Fy);if(!e)throw new Error("WalletConnectConnector not found");return e}}class AF extends H_{setUniversalProvider(e){this.addConnector(new Fy({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace}))}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect()}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}}async getAccounts({namespace:e}){var s,i,o,a;const t=this.provider,n=((a=(o=(i=(s=t==null?void 0:t.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const[,,l]=c.split(":");return l}).filter((c,l,u)=>u.indexOf(c)===l))||[];return Promise.resolve({accounts:n.map(c=>ir.createAccount(e,c,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){var i,o,a,c,l;if(!(e.caipNetwork&&Cd.BALANCE_SUPPORTED_CHAINS.includes((i=e.caipNetwork)==null?void 0:i.chainNamespace))||(o=e.caipNetwork)!=null&&o.testnet)return{balance:"0.00",symbol:((a=e.caipNetwork)==null?void 0:a.nativeCurrency.symbol)||""};if(Ae.state.balanceLoading&&e.chainId===((c=G.state.activeCaipNetwork)==null?void 0:c.id))return{balance:Ae.state.balance||"0.00",symbol:Ae.state.balanceSymbol||""};const s=(await Ae.fetchTokenBalance()).find(u=>{var h,d;return u.chainId===`${(h=e.caipNetwork)==null?void 0:h.chainNamespace}:${e.chainId}`&&u.symbol===((d=e.caipNetwork)==null?void 0:d.nativeCurrency.symbol)});return{balance:(s==null?void 0:s.quantity.numeric)||"0.00",symbol:(s==null?void 0:s.symbol)||((l=e.caipNetwork)==null?void 0:l.nativeCurrency.symbol)||""}}async signMessage(e){var o,a,c;const{provider:t,message:n,address:s}=e;if(!t)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return((o=G.state.activeCaipNetwork)==null?void 0:o.chainNamespace)===oe.CHAIN.SOLANA?i=(await t.request({method:"solana_signMessage",params:{message:WE.encode(new TextEncoder().encode(n)),pubkey:s}},(a=G.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)).signature:i=await t.request({method:"personal_sign",params:[n,s]},(c=G.state.activeCaipNetwork)==null?void 0:c.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async getProfile(){return Promise.resolve({profileImage:"",profileName:""})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}async getEnsAddress(){return Promise.resolve({address:!1})}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){var s,i,o,a,c,l;const{caipNetwork:t}=e,n=this.getWalletConnectConnector();if(t.chainNamespace===oe.CHAIN.EVM)try{await((s=n.provider)==null?void 0:s.request({method:"wallet_switchEthereumChain",params:[{chainId:wv(t.id)}]}))}catch(u){if(u.code===Mi.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||u.code===Mi.ERROR_INVALID_CHAIN_ID||u.code===Mi.ERROR_CODE_DEFAULT||((o=(i=u==null?void 0:u.data)==null?void 0:i.originalError)==null?void 0:o.code)===Mi.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await((l=n.provider)==null?void 0:l.request({method:"wallet_addEthereumChain",params:[{chainId:wv(t.id),rpcUrls:[(a=t==null?void 0:t.rpcUrls.chainDefault)==null?void 0:a.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[(c=t.blockExplorers)==null?void 0:c.default.url]}]}))}catch{throw new Error("Chain is not supported")}}n.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(n=>n.type==="WALLET_CONNECT");return e==null?void 0:e.provider}}class _F{constructor(e){this.chainNamespaces=[],this.reportedAlertErrors={},this.getCaipNetwork=(t,n)=>{var s,i,o,a;if(t){const c=(i=(s=G.getNetworkData(t))==null?void 0:s.requestedCaipNetworks)==null?void 0:i.find(u=>u.id===n);if(c)return c;const l=(o=G.getNetworkData(t))==null?void 0:o.caipNetwork;return l||((a=G.getRequestedCaipNetworks(t).filter(u=>u.chainNamespace===t))==null?void 0:a[0])}return G.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const t=this.getCaipNetwork();if(t)return t.id},this.getCaipNetworks=t=>G.getCaipNetworks(t),this.getActiveChainNamespace=()=>G.state.activeChain,this.setRequestedCaipNetworks=(t,n)=>{G.setRequestedCaipNetworks(t,n)},this.getApprovedCaipNetworkIds=()=>G.getAllApprovedCaipNetworkIds(),this.getCaipAddress=t=>G.state.activeChain===t||!t?G.state.activeCaipAddress:G.getAccountProp("caipAddress",t),this.setClientId=t=>{io.setClientId(t)},this.getProvider=t=>je.getProvider(t),this.getProviderType=t=>je.getProviderId(t),this.getPreferredAccountType=t=>{var n;return(n=Ae.state.preferredAccountTypes)==null?void 0:n[t]},this.setCaipAddress=(t,n)=>{Ae.setCaipAddress(t,n)},this.setBalance=(t,n,s)=>{Ae.setBalance(t,n,s)},this.setProfileName=(t,n)=>{Ae.setProfileName(t,n)},this.setProfileImage=(t,n)=>{Ae.setProfileImage(t,n)},this.setUser=(t,n)=>{Ae.setUser(t,n),me.state.enableEmbedded&&Ea.close()},this.resetAccount=t=>{Ae.resetAccount(t)},this.setCaipNetwork=t=>{G.setActiveCaipNetwork(t)},this.setCaipNetworkOfNamespace=(t,n)=>{G.setChainNetworkData(n,{caipNetwork:t})},this.setAllAccounts=(t,n)=>{Ae.setAllAccounts(t,n),me.setHasMultipleAddresses((t==null?void 0:t.length)>1)},this.setStatus=(t,n)=>{Ae.setStatus(t,n),st.isConnected()?it.setConnectionStatus("connected"):it.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=t=>G.getAccountProp("address",t),this.setConnectors=t=>{const n=[...st.state.allConnectors,...t];st.setConnectors(n)},this.fetchIdentity=t=>io.fetchIdentity(t),this.getReownName=t=>R_.getNamesForAddress(t),this.getConnectors=()=>st.getConnectors(),this.getConnectorImage=t=>eN.getConnectorImage(t),this.setConnectedWalletInfo=(t,n)=>{const s=je.getProviderId(n),i=t?{...t,type:s}:void 0;Ae.setConnectedWalletInfo(i,n)},this.getIsConnectedState=()=>!!G.state.activeCaipAddress,this.addAddressLabel=(t,n,s)=>{Ae.addAddressLabel(t,n,s)},this.removeAddressLabel=(t,n)=>{Ae.removeAddressLabel(t,n)},this.getAddress=t=>G.state.activeChain===t||!t?Ae.state.address:G.getAccountProp("address",t),this.setApprovedCaipNetworksData=t=>G.setApprovedCaipNetworksData(t),this.resetNetwork=t=>{G.resetNetwork(t)},this.addConnector=t=>{st.addConnector(t)},this.resetWcConnection=()=>{An.resetWcConnection()},this.setAddressExplorerUrl=(t,n)=>{Ae.setAddressExplorerUrl(t,n)},this.setSmartAccountDeployed=(t,n)=>{Ae.setSmartAccountDeployed(t,n)},this.setSmartAccountEnabledNetworks=(t,n)=>{G.setSmartAccountEnabledNetworks(t,n)},this.setPreferredAccountType=(t,n)=>{Ae.setPreferredAccountType(t,n)},this.setEIP6963Enabled=t=>{me.setEIP6963Enabled(t)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.initialize(e)}getChainNamespacesSet(e,t){const n=e==null?void 0:e.map(i=>i.namespace).filter(i=>!!i);if(n!=null&&n.length)return[...new Set(n)];const s=t==null?void 0:t.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){this.initControllers(e),await this.initChainAdapters(),await this.injectModalUi(),this.sendInitializeEvent(e),Id.set({initialized:!0}),await this.syncExistingConnection()}sendInitializeEvent(e){var n;const{...t}=e;delete t.adapters,delete t.universalProvider,Kl.sendEvent({type:"track",event:"INITIALIZE",properties:{...t,networks:e.networks.map(s=>s.id),siweConfig:{options:((n=e.siweConfig)==null?void 0:n.options)||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&Wn.setThemeMode(e.themeMode),e.themeVariables&&Wn.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");G.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const t=this.getDefaultNetwork();t&&G.setActiveCaipNetwork(t)}initializeConnectionController(e){An.setWcBasic(e.basic??!1)}initializeConnectorController(){st.initialize(this.chainNamespaces)}initializeOptionsController(e){var o;me.setDebug(e.debug!==!1),me.setEnableWalletConnect(e.enableWalletConnect!==!1),me.setEnableWalletGuide(e.enableWalletGuide!==!1),me.setEnableWallets(e.enableWallets!==!1),me.setEIP6963Enabled(e.enableEIP6963!==!1),me.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),me.setEnableAuthLogger(e.enableAuthLogger!==!1),me.setCustomRpcUrls(e.customRpcUrls),me.setSdkVersion(e.sdkVersion),me.setProjectId(e.projectId),me.setEnableEmbedded(e.enableEmbedded),me.setAllWallets(e.allWallets),me.setIncludeWalletIds(e.includeWalletIds),me.setExcludeWalletIds(e.excludeWalletIds),me.setFeaturedWalletIds(e.featuredWalletIds),me.setTokens(e.tokens),me.setTermsConditionsUrl(e.termsConditionsUrl),me.setPrivacyPolicyUrl(e.privacyPolicyUrl),me.setCustomWallets(e.customWallets),me.setFeatures(e.features),me.setAllowUnsupportedChain(e.allowUnsupportedChain),me.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),me.setDefaultAccountTypes(e.defaultAccountTypes);const t=it.getPreferredAccountTypes(),n={...me.state.defaultAccountTypes,...t};Ae.setPreferredAccountTypes(n);const s=this.getDefaultMetaData();if(!e.metadata&&s&&(e.metadata=s),me.setMetadata(e.metadata),me.setDisableAppend(e.disableAppend),me.setEnableEmbedded(e.enableEmbedded),me.setSIWX(e.siwx),!e.projectId){Nd.open(Zl.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(((o=e.adapters)==null?void 0:o.find(a=>a.namespace===oe.CHAIN.EVM))&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");me.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){var e,t,n,s;return typeof window<"u"&&typeof document<"u"?{name:((t=(e=document.getElementsByTagName("title"))==null?void 0:e[0])==null?void 0:t.textContent)||"",description:((n=document.querySelector('meta[property="og:description"]'))==null?void 0:n.content)||"",url:window.location.origin,icons:[((s=document.querySelector('link[rel~="icon"]'))==null?void 0:s.href)||""]}:null}setUnsupportedNetwork(e){const t=this.getActiveChainNamespace();if(t){const n=za.getUnsupportedNetwork(`${t}:${e}`);G.setActiveCaipNetwork(n)}}getDefaultNetwork(){return za.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return za.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return za.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const t=e.networks.find(s=>{var i;return s.id===((i=e.defaultNetwork)==null?void 0:i.id)});return t?za.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{var i;const e=G.state.activeChain,t=this.getAdapter(e),n=(i=this.getCaipNetwork(e))==null?void 0:i.id;if(!t)throw new Error("Adapter not found");const s=await t.connectWalletConnect(n);this.close(),this.setClientId((s==null?void 0:s.clientId)||null),it.setConnectedNamespaces([...G.state.chains.keys()]),this.chainNamespaces.forEach(o=>{st.setConnectorId(Ye.CONNECTOR_TYPE_WALLET_CONNECT,o)}),await this.syncWalletConnectAccount()},connectExternal:async({id:e,info:t,type:n,provider:s,chain:i,caipNetwork:o})=>{var f,p,m,v,_,y;const a=G.state.activeChain,c=i||a,l=this.getAdapter(c);if(i&&i!==a&&!o){const C=this.getCaipNetworks().find(U=>U.chainNamespace===i);C&&this.setCaipNetwork(C)}if(!l)throw new Error("Adapter not found");const u=this.getCaipNetwork(c),h=await l.connect({id:e,info:t,type:n,provider:s,chainId:(o==null?void 0:o.id)||(u==null?void 0:u.id),rpcUrl:((m=(p=(f=o==null?void 0:o.rpcUrls)==null?void 0:f.default)==null?void 0:p.http)==null?void 0:m[0])||((y=(_=(v=u==null?void 0:u.rpcUrls)==null?void 0:v.default)==null?void 0:_.http)==null?void 0:y[0])});if(!h)return;it.addConnectedNamespace(c),this.syncProvider({...h,chainNamespace:c});const{accounts:d}=await l.getAccounts({namespace:c,id:e});this.setAllAccounts(d,c),this.setStatus("connected",c)},reconnectExternal:async({id:e,info:t,type:n,provider:s})=>{var a;const i=G.state.activeChain,o=this.getAdapter(i);o!=null&&o.reconnect&&(await(o==null?void 0:o.reconnect({id:e,info:t,type:n,provider:s,chainId:(a=this.getCaipNetwork())==null?void 0:a.id})),it.addConnectedNamespace(i))},disconnect:async e=>{const t=e||G.state.activeChain,n=this.getAdapter(t),s=je.getProvider(t),i=je.getProviderId(t);await(n==null?void 0:n.disconnect({provider:s,providerType:i})),it.removeConnectedNamespace(t),je.resetChain(t),this.setUser(void 0,t),this.setStatus("disconnected",t)},checkInstalled:e=>e?e.some(t=>{var n;return!!((n=window.ethereum)!=null&&n[String(t)])}):!!window.ethereum,signMessage:async e=>{const t=this.getAdapter(G.state.activeChain),n=await(t==null?void 0:t.signMessage({message:e,address:Ae.state.address,provider:je.getProvider(G.state.activeChain)}));return(n==null?void 0:n.signature)||""},sendTransaction:async e=>{if(e.chainNamespace===oe.CHAIN.EVM){const t=this.getAdapter(G.state.activeChain),n=je.getProvider(G.state.activeChain),s=await(t==null?void 0:t.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:n}));return(s==null?void 0:s.hash)||""}return""},estimateGas:async e=>{if(e.chainNamespace===oe.CHAIN.EVM){const t=this.getAdapter(G.state.activeChain),n=je.getProvider(G.state.activeChain),s=this.getCaipNetwork();if(!s)throw new Error("CaipNetwork is undefined");const i=await(t==null?void 0:t.estimateGas({...e,provider:n,caipNetwork:s}));return(i==null?void 0:i.gas)||0n}return 0n},getEnsAvatar:async()=>{var n;const e=this.getAdapter(G.state.activeChain),t=await(e==null?void 0:e.getProfile({address:Ae.state.address,chainId:Number((n=this.getCaipNetwork())==null?void 0:n.id)}));return(t==null?void 0:t.profileImage)||!1},getEnsAddress:async e=>{const t=this.getAdapter(G.state.activeChain),n=this.getCaipNetwork();if(!n)return!1;const s=await(t==null?void 0:t.getEnsAddress({name:e,caipNetwork:n}));return(s==null?void 0:s.address)||!1},writeContract:async e=>{const t=this.getAdapter(G.state.activeChain),n=this.getCaipNetwork(),s=this.getCaipAddress(),i=je.getProvider(G.state.activeChain);if(!n||!s)throw new Error("CaipNetwork or CaipAddress is undefined");const o=await(t==null?void 0:t.writeContract({...e,caipNetwork:n,provider:i,caipAddress:s}));return o==null?void 0:o.hash},parseUnits:(e,t)=>{const n=this.getAdapter(G.state.activeChain);return(n==null?void 0:n.parseUnits({value:e,decimals:t}))??0n},formatUnits:(e,t)=>{const n=this.getAdapter(G.state.activeChain);return(n==null?void 0:n.formatUnits({value:e,decimals:t}))??"0"},getCapabilities:async e=>{const t=this.getAdapter(G.state.activeChain);return await(t==null?void 0:t.getCapabilities(e))},grantPermissions:async e=>{const t=this.getAdapter(G.state.activeChain);return await(t==null?void 0:t.grantPermissions(e))},revokePermissions:async e=>{const t=this.getAdapter(G.state.activeChain);return t!=null&&t.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{const t=this.getAdapter(G.state.activeChain);return await(t==null?void 0:t.walletGetAssets(e))??{}}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},An.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){var t,n,s,i,o;if(je.getProviderId(G.state.activeChain)===Ye.CONNECTOR_TYPE_WALLET_CONNECT){const a=(n=(t=this.universalProvider)==null?void 0:t.session)==null?void 0:n.namespaces;return{supportsAllNetworks:((o=(i=(s=this.universalProvider)==null?void 0:s.session)==null?void 0:i.peer)==null?void 0:o.metadata.name)==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(a)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=je.getProvider(t),i=je.getProviderId(t);if(e.chainNamespace===G.state.activeChain){const o=this.getAdapter(t);await(o==null?void 0:o.switchNetwork({caipNetwork:e,provider:s,providerType:i}))}else if(this.setCaipNetwork(e),i===Ye.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(t);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(t=>{const n=t.chains||[],s=t.accounts.map(i=>{const{chainId:o,chainNamespace:a}=_s.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...n,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,n)=>{var i;const s=e==null?void 0:e.find(o=>o.namespace===n);return s?(s.construct({namespace:n,projectId:(i=this.options)==null?void 0:i.projectId,networks:this.getCaipNetworks()}),t[n]=s):t[n]=new AF({namespace:n,networks:this.getCaipNetworks()}),t},{})}async initChainAdapter(e){var t;this.onConnectors(e),this.listenAdapter(e),(t=this.chainAdapters)==null||t[e].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){const t=this.getAdapter(e);t==null||t.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const t=this.getAdapter(e);if(!t)return;const n=it.getConnectionStatus();n==="connected"?this.setStatus("connecting",e):n==="disconnected"?(it.clearAddressCache(),this.setStatus(n,e)):this.setStatus(n,e),t.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(l=>l.id===i||l.caipNetworkId===i),a=G.state.activeChain===e,c=G.getAccountProp("address",e);if(o){const l=a&&s?s:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),t.on("disconnect",this.disconnect.bind(this,e)),t.on("pendingTransactions",()=>{const s=Ae.state.address,i=G.state.activeCaipNetwork;!s||!(i!=null&&i.id)||this.updateNativeBalance(s,i.id,i.chainNamespace)}),t.on("accountChanged",({address:s,chainId:i})=>{var a,c;const o=G.state.activeChain===e;o&&i?this.syncAccount({address:s,chainId:i,chainNamespace:e}):o&&((a=G.state.activeCaipNetwork)!=null&&a.id)?this.syncAccount({address:s,chainId:(c=G.state.activeCaipNetwork)==null?void 0:c.id,chainNamespace:e}):this.syncAccountInfo(s,i,e)})}async createUniversalProviderForAdapter(e){var t,n,s;await this.getUniversalProvider(),this.universalProvider&&((s=(n=(t=this.chainAdapters)==null?void 0:t[e])==null?void 0:n.setUniversalProvider)==null||s.call(n,this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async syncNamespaceConnection(e){try{const t=st.getConnectorId(e);switch(this.setStatus("connecting",e),t){case oe.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case oe.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}async syncAdapterConnection(e){var o,a,c;const t=this.getAdapter(e),n=st.getConnectorId(e),s=this.getCaipNetwork(e),i=st.getConnectors(e).find(l=>l.id===n);try{if(!t||!i)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!(s!=null&&s.id))throw new Error("CaipNetwork not found");const l=await(t==null?void 0:t.syncConnection({namespace:e,id:i.id,chainId:s.id,rpcUrl:(c=(a=(o=s==null?void 0:s.rpcUrls)==null?void 0:o.default)==null?void 0:a.http)==null?void 0:c[0]}));if(l){const u=await(t==null?void 0:t.getAccounts({namespace:e,id:i.id}));u&&u.accounts.length>0?this.setAllAccounts(u.accounts,e):this.setAllAccounts([ir.createAccount(e,l.address,"eoa")],e),this.syncProvider({...l,chainNamespace:e}),await this.syncAccount({...l,chainNamespace:e}),this.setStatus("connected",e)}else this.setStatus("disconnected",e)}catch{this.setStatus("disconnected",e)}}async syncWalletConnectAccount(){const e=this.chainNamespaces.map(async t=>{var a,c,l,u,h;const n=this.getAdapter(t),s=((u=(l=(c=(a=this.universalProvider)==null?void 0:a.session)==null?void 0:c.namespaces)==null?void 0:l[t])==null?void 0:u.accounts)||[],i=(h=G.state.activeCaipNetwork)==null?void 0:h.id,o=s.find(d=>{const{chainId:f}=_s.parseCaipAddress(d);return f===(i==null?void 0:i.toString())})||s[0];if(o){const d=_s.validateCaipAddress(o),{chainId:f,address:p}=_s.parseCaipAddress(d);if(je.setProviderId(t,Ye.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&G.state.activeCaipNetwork&&(n==null?void 0:n.namespace)!==oe.CHAIN.EVM){const m=n==null?void 0:n.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:G.state.activeCaipNetwork});je.setProvider(t,m)}else je.setProvider(t,this.universalProvider);st.setConnectorId(oe.CONNECTOR_ID.WALLET_CONNECT,t),it.addConnectedNamespace(t),this.syncWalletConnectAccounts(t),await this.syncAccount({address:p,chainId:f,chainNamespace:t})}else this.setStatus("disconnected",t);await G.setApprovedCaipNetworksData(t)});await Promise.all(e)}syncWalletConnectAccounts(e){var n,s,i,o,a;const t=(a=(o=(i=(s=(n=this.universalProvider)==null?void 0:n.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const{address:l}=_s.parseCaipAddress(c);return l}).filter((c,l,u)=>u.indexOf(c)===l);t&&this.setAllAccounts(t.map(c=>ir.createAccount(e,c,e==="bip122"?"payment":"eoa")),e)}syncProvider({type:e,provider:t,id:n,chainNamespace:s}){je.setProviderId(s,e),je.setProvider(s,t),st.setConnectorId(n,s)}async syncAccount(e){var h,d;const t=e.chainNamespace===G.state.activeChain,n=G.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=it.getActiveNetworkProps(),c=i||a,l=((h=G.state.activeCaipNetwork)==null?void 0:h.name)===oe.UNSUPPORTED_NETWORK_NAME,u=G.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let f=this.getCaipNetworks().find(v=>v.id.toString()===c.toString()),p=this.getCaipNetworks().find(v=>v.chainNamespace===o);if(!u&&!f&&!p){const v=this.getApprovedCaipNetworkIds()||[],_=v.find(C=>{var U;return((U=_s.parseCaipNetworkId(C))==null?void 0:U.chainId)===c.toString()}),y=v.find(C=>{var U;return((U=_s.parseCaipNetworkId(C))==null?void 0:U.chainNamespace)===o});f=this.getCaipNetworks().find(C=>C.caipNetworkId===_),p=this.getCaipNetworks().find(C=>C.caipNetworkId===y||"deprecatedCaipNetworkId"in C&&C.deprecatedCaipNetworkId===y)}const m=f||p;(m==null?void 0:m.chainNamespace)===G.state.activeChain?me.state.enableNetworkSwitch&&!me.state.allowUnsupportedChain&&((d=G.state.activeCaipNetwork)==null?void 0:d.name)===oe.UNSUPPORTED_NETWORK_NAME?G.showUnsupportedChainUI():this.setCaipNetwork(m):t||n&&this.setCaipNetworkOfNamespace(n,o),this.syncConnectedWalletInfo(o),ep.isLowerCaseMatch(s,Ae.state.address)||this.syncAccountInfo(s,m==null?void 0:m.id,o),t?await this.syncBalance({address:s,chainId:m==null?void 0:m.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:n==null?void 0:n.id,chainNamespace:o})}}async syncAccountInfo(e,t,n){const s=this.getCaipAddress(n),i=t||(s==null?void 0:s.split(":")[1]);if(!i)return;const o=`${n}:${i}:${e}`;this.setCaipAddress(o,n),await this.syncIdentity({address:e,chainId:i,chainNamespace:n})}async syncReownName(e,t){try{const n=await this.getReownName(e);if(n[0]){const s=n[0];this.setProfileName(s.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){var s;const t=st.getConnectorId(e),n=je.getProviderId(e);if(n===Ye.CONNECTOR_TYPE_ANNOUNCED||n===Ye.CONNECTOR_TYPE_INJECTED){if(t){const i=this.getConnectors().find(o=>o.id===t);if(i){const{info:o,name:a,imageUrl:c}=i,l=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:l,...o},e)}}}else if(n===Ye.CONNECTOR_TYPE_WALLET_CONNECT){const i=je.getProvider(e);i!=null&&i.session&&this.setConnectedWalletInfo({...i.session.peer.metadata,name:i.session.peer.metadata.name,icon:(s=i.session.peer.metadata.icons)==null?void 0:s[0]},e)}else if(t)if(t===oe.CONNECTOR_ID.COINBASE){const i=this.getConnectors().find(o=>o.id===oe.CONNECTOR_ID.COINBASE);this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(i)},e)}else this.setConnectedWalletInfo({name:t},e)}async syncBalance(e){!tN.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(n=>{var s;return n.id.toString()===((s=e.chainId)==null?void 0:s.toString())})||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async updateNativeBalance(e,t,n){const s=this.getAdapter(n),i=G.getCaipNetworkByNamespace(n,t);if(s){const o=await s.getBalance({address:e,chainId:t,caipNetwork:i,tokens:this.options.tokens});this.setBalance(o.balance,o.symbol,n)}}async initializeUniversalAdapter(){var n,s,i,o,a,c,l,u,h,d;const e=ZL.createLogger((f,...p)=>{f&&this.handleAlertError(f),console.error(...p)}),t={projectId:(n=this.options)==null?void 0:n.projectId,metadata:{name:(s=this.options)!=null&&s.metadata?(i=this.options)==null?void 0:i.metadata.name:"",description:(o=this.options)!=null&&o.metadata?(a=this.options)==null?void 0:a.metadata.description:"",url:(c=this.options)!=null&&c.metadata?(l=this.options)==null?void 0:l.metadata.url:"",icons:(u=this.options)!=null&&u.metadata?(h=this.options)==null?void 0:h.metadata.icons:[""]},logger:e};me.setManualWCControl(!!((d=this.options)!=null&&d.manualWCControl)),this.universalProvider=this.options.universalProvider??await Uy.init(t),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&(this.universalProvider.on("display_uri",e=>{An.setUri(e)}),this.universalProvider.on("connect",An.finalizeWcConnection),this.universalProvider.on("disconnect",()=>{this.chainNamespaces.forEach(e=>{this.resetAccount(e)}),An.resetWcConnection()}),this.universalProvider.on("chainChanged",e=>{const t=this.getCaipNetworks().find(s=>s.id==e),n=this.getCaipNetwork();if(!t){this.setUnsupportedNetwork(e);return}(n==null?void 0:n.id)!==(t==null?void 0:t.id)&&this.setCaipNetwork(t)}),this.universalProvider.on("session_event",e=>{if(My.isSessionEventData(e)){const{name:t,data:n}=e.params.event;t==="accountsChanged"&&Array.isArray(n)&&ir.isCaipAddress(n[0])&&this.syncAccount(_s.parseCaipAddress(n[0]))}}))}createUniversalProvider(){var e;return!this.universalProviderInitPromise&&ir.isClient()&&((e=this.options)!=null&&e.projectId)&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){Kl.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const t=Object.entries(Zl.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[n,s]=t??[],{message:i,alertErrorKey:o}=s??{};if(n&&i&&!this.reportedAlertErrors[n]){const a=Zl.ALERT_ERRORS[o];a&&(Nd.open(a,"error"),this.reportedAlertErrors[n]=!0)}}getAdapter(e){var t;if(e)return(t=this.chainAdapters)==null?void 0:t[e]}createAdapter(e){var s;if(!e)return;const t=e.namespace;if(!t)return;this.createClients();const n=e;n.namespace=t,n.construct({namespace:t,projectId:(s=this.options)==null?void 0:s.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=n)}async open(e){if(await this.injectModalUi(),e!=null&&e.uri&&An.setUri(e.uri),e!=null&&e.arguments)switch(e==null?void 0:e.view){case"Swap":return Ea.open({...e,data:{swap:e.arguments}})}return Ea.open(e)}async close(){await this.injectModalUi(),Ea.close()}setLoading(e,t){Ea.setLoading(e,t)}async disconnect(e){await An.disconnect(e)}getError(){return""}getChainId(){var e;return(e=G.state.activeCaipNetwork)==null?void 0:e.id}async switchNetwork(e){const t=this.getCaipNetworks().find(n=>n.id===e.id);if(!t){Nd.open(Zl.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await G.switchActiveNetwork(t)}getWalletProvider(){return G.state.activeChain?je.state.providers[G.state.activeChain]:null}getWalletProviderType(){return je.getProviderId(G.state.activeChain)}subscribeProviders(e){return je.subscribeProviders(e)}getThemeMode(){return Wn.state.themeMode}getThemeVariables(){return Wn.state.themeVariables}setThemeMode(e){Wn.setThemeMode(e),rN(Wn.state.themeMode)}setTermsConditionsUrl(e){me.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){me.setPrivacyPolicyUrl(e)}setThemeVariables(e){Wn.setThemeVariables(e),nN(Wn.state.themeVariables)}subscribeTheme(e){return Wn.subscribe(e)}getWalletInfo(){return Ae.state.connectedWalletInfo}getAccount(e){var i;const t=st.getAuthConnector(e),n=G.getAccountData(e),s=G.state.activeChain;if(n)return{allAccounts:n.allAccounts,caipAddress:n.caipAddress,address:ir.getPlainAddress(n.caipAddress),isConnected:!!n.caipAddress,status:n.status,embeddedWalletInfo:t?{user:n.user?{...n.user,username:it.getConnectedSocialUsername()}:void 0,authProvider:n.socialProvider||"email",accountType:(i=n.preferredAccountTypes)==null?void 0:i[e||s],isSmartAccountDeployed:!!n.smartAccountDeployed}:void 0}}subscribeAccount(e,t){const n=()=>{const s=this.getAccount(t);s&&e(s)};t?G.subscribeChainProp("accountState",n,t):G.subscribe(n),st.subscribe(n)}subscribeNetwork(e){return G.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t==null?void 0:t.id,caipNetworkId:t==null?void 0:t.caipNetworkId})})}subscribeWalletInfo(e){return Ae.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){Ae.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){G.subscribeKey("activeCaipNetwork",e)}getState(){return Id.state}subscribeState(e){return Id.subscribe(e)}showErrorMessage(e){Cw.showError(e)}showSuccessMessage(e){Cw.showSuccess(e)}getEvent(){return{...Kl.state}}subscribeEvents(e){return Kl.subscribe(e)}replace(e){Ts.replace(e)}redirect(e){Ts.push(e)}popTransactionStack(e){Ts.popTransactionStack(e)}isOpen(){return Ea.state.open}isTransactionStackEmpty(){return Ts.state.transactionStack.length===0}isTransactionShouldReplaceView(){var e;return(e=Ts.state.transactionStack[Ts.state.transactionStack.length-1])==null?void 0:e.replace}static getInstance(){return this.instance}updateFeatures(e){me.setFeatures(e)}updateOptions(e){const n={...me.state||{},...e};me.setOptions(n)}setConnectMethodsOrder(e){me.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){me.setWalletFeaturesOrder(e)}setCollapseWallets(e){me.setCollapseWallets(e)}setSocialsOrder(e){me.setSocialsOrder(e)}getConnectMethodsOrder(){return Nm.getConnectOrderMethod(me.state.features,st.getConnectors())}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const n=this.extendCaipNetwork(t,this.options);this.getCaipNetworks().find(s=>s.id===n.id)||G.addNetwork(n)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===t)&&G.removeNetwork(e,t)}}let Ov=!1;class CF extends _F{setupAuthConnectorListeners(e){e.onRpcRequest(t=>{jr.checkIfRequestExists(t)?jr.checkIfRequestIsSafe(t)||this.handleUnsafeRPCRequest():(this.open(),console.error(hn.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:t.method}),setTimeout(()=>{this.showErrorMessage(hn.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack(!0))}),e.onRpcSuccess((t,n)=>{const s=jr.checkIfRequestIsSafe(n),i=Ae.state.address,o=G.state.activeCaipNetwork;s||(this.isTransactionStackEmpty()?(this.close(),i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace)):(this.popTransactionStack(),i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace)))}),e.onNotConnected(()=>{const t=G.state.activeChain;st.getConnectorId(t)===oe.CONNECTOR_ID.AUTH&&(this.setCaipAddress(void 0,t),this.setLoading(!1,t))}),e.onConnect(async t=>{var a,c;const n=G.state.activeChain,s=n===oe.CHAIN.EVM?`eip155:${t.chainId}:${t.address}`:`${t.chainId}:${t.address}`,i=t.preferredAccountType||((a=Ae.state.preferredAccountTypes)==null?void 0:a[n])||me.state.defaultAccountTypes[n];ep.isLowerCaseMatch(t.address,Ae.state.address)||this.syncIdentity({address:t.address,chainId:t.chainId,chainNamespace:n}),this.setCaipAddress(s,n),this.setUser({...Ae.state.user||{},...t},n),this.setSmartAccountDeployed(!!t.smartAccountDeployed,n),this.setPreferredAccountType(i,n);const o=(c=t.accounts)==null?void 0:c.map(l=>{var u;return ir.createAccount(n,l.address,l.type||((u=Ae.state.preferredAccountTypes)==null?void 0:u[n])||me.state.defaultAccountTypes[n])});this.setAllAccounts(o||[ir.createAccount(n,t.address,t.preferredAccountType||i)],n),await e.getSmartAccountEnabledNetworks(),this.setLoading(!1,n)}),e.onSocialConnected(({userName:t})=>{this.setUser({...Ae.state.user||{},username:t},G.state.activeChain)}),e.onGetSmartAccountEnabledNetworks(t=>{this.setSmartAccountEnabledNetworks(t,G.state.activeChain)}),e.onSetPreferredAccount(({address:t,type:n})=>{t&&this.setPreferredAccountType(n,G.state.activeChain)})}async syncAuthConnector(e,t){var u,h,d,f;const n=oe.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t);if(!n)return;this.setLoading(!0,t);const s=e.getLoginEmailUsed();this.setLoading(s,t),s&&this.setStatus("connecting",t);const i=e.getEmail(),o=e.getUsername();this.setUser({...((u=Ae.state)==null?void 0:u.user)||{},username:o,email:i},G.state.activeChain),this.setupAuthConnectorListeners(e);const{isConnected:a}=await e.isConnected(),c=Wn.getSnapshot(),l=me.getSnapshot();e.syncDappData({metadata:l.metadata,sdkVersion:l.sdkVersion,projectId:l.projectId,sdkType:l.sdkType}),e.syncTheme({themeMode:c.themeMode,themeVariables:c.themeVariables,w3mThemeVariables:sN(c.themeVariables,c.themeMode)}),t&&n&&(a&&((h=this.connectionControllerClient)!=null&&h.connectExternal)?(await((f=this.connectionControllerClient)==null?void 0:f.connectExternal({id:oe.CONNECTOR_ID.AUTH,info:{name:oe.CONNECTOR_ID.AUTH},type:Ye.CONNECTOR_TYPE_AUTH,provider:e,chainId:(d=G.state.activeCaipNetwork)==null?void 0:d.id,chain:t})),this.setStatus("connected",t)):st.getConnectorId(t)===oe.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",t),it.removeConnectedNamespace(t))),this.setLoading(!1,t)}async checkExistingTelegramSocialConnection(e){var t;try{if(!ir.isTelegram())return;const n=it.getTelegramSocialProvider();if(!n||typeof window>"u"||typeof document>"u")return;const i=new URL(window.location.href).searchParams.get("result_uri");if(!i)return;Ae.setSocialProvider(n,e),await((t=this.authProvider)==null?void 0:t.init());const o=st.getAuthConnector();n&&o&&(this.setLoading(!0,e),await o.provider.connectSocial(i),await An.connectExternal(o,o.chain),it.setConnectedSocialProvider(n),it.removeTelegramSocialProvider(),Kl.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:n}}))}catch(n){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",n)}try{const n=new URL(window.location.href);n.searchParams.delete("result_uri"),window.history.replaceState({},document.title,n.toString())}catch(n){console.error("tma social login failed",n)}}createAuthProvider(e){var o,a,c,l,u,h,d,f,p,m,v,_,y;if(!oe.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const n=((a=(o=this.options)==null?void 0:o.features)==null?void 0:a.email)===void 0?Cd.DEFAULT_FEATURES.email:(l=(c=this.options)==null?void 0:c.features)==null?void 0:l.email,s=(h=(u=this.options)==null?void 0:u.features)!=null&&h.socials?((p=(f=(d=this.options)==null?void 0:d.features)==null?void 0:f.socials)==null?void 0:p.length)>0:Cd.DEFAULT_FEATURES.socials,i=n||s;!this.authProvider&&((m=this.options)!=null&&m.projectId)&&i&&(this.authProvider=uu.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:(v=this.getCaipNetwork(e))==null?void 0:v.caipNetworkId,onTimeout:()=>{Nd.open(Zl.ALERT_ERRORS.SOCIALS_TIMEOUT,"error")}}),Id.subscribeOpen(C=>{var U;!C&&this.isTransactionStackEmpty()&&((U=this.authProvider)==null||U.rejectRpcRequests())}),e===oe.CHAIN.EVM&&((_=Ae.state.preferredAccountTypes)!=null&&_.eip155)&&this.authProvider.setPreferredAccount((y=Ae.state.preferredAccountTypes)==null?void 0:y.eip155),this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){var t,n,s;this.createAuthProvider(e),this.authProvider&&((s=(n=(t=this.chainAdapters)==null?void 0:t[e])==null?void 0:n.setAuthProvider)==null||s.call(n,this.authProvider))}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&go.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){var i,o;if(!e)return;const t=G.state.activeChain,n=e.chainNamespace,s=this.getAddressByChainNamespace(e.chainNamespace);if(e.chainNamespace===G.state.activeChain&&s){const a=this.getAdapter(n),c=je.getProvider(n),l=je.getProviderId(n);await(a==null?void 0:a.switchNetwork({caipNetwork:e,provider:c,providerType:l})),this.setCaipNetwork(e)}else{const c=je.getProviderId(t)===Ye.CONNECTOR_TYPE_AUTH,l=je.getProviderId(n),u=l===Ye.CONNECTOR_TYPE_AUTH,h=oe.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n);if((c||u)&&h)try{G.state.activeChain=e.chainNamespace,await((o=(i=this.connectionControllerClient)==null?void 0:i.connectExternal)==null?void 0:o.call(i,{id:oe.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:n,chainId:e.id,type:Ye.CONNECTOR_TYPE_AUTH,caipNetwork:e})),this.setCaipNetwork(e)}catch{const f=this.getAdapter(n);await(f==null?void 0:f.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:l}))}else l===Ye.CONNECTOR_TYPE_WALLET_CONNECT?(this.setCaipNetwork(e),this.syncWalletConnectAccount()):(this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:n}))}}async initChainAdapter(e){await super.initChainAdapter(e),this.createAuthProviderForAdapter(e)}async syncIdentity({address:e,chainId:t,chainNamespace:n}){var o;const s=`${n}:${t}`,i=(o=this.caipNetworks)==null?void 0:o.find(a=>a.caipNetworkId===s);if(n!==oe.CHAIN.EVM||i!=null&&i.testnet){this.setProfileName(null,n),this.setProfileImage(null,n);return}try{const{name:a,avatar:c}=await this.fetchIdentity({address:e,caipNetworkId:s});if(this.setProfileName(a,n),this.setProfileImage(c,n),!a){const l=this.getAdapter(n),u=await(l==null?void 0:l.getProfile({address:e,chainId:Number(t)}));u!=null&&u.profileName?(this.setProfileName(u.profileName,n),u.profileImage&&this.setProfileImage(u.profileImage,n)):(await this.syncReownName(e,n),this.setProfileImage(null,n))}}catch{await this.syncReownName(e,n),t!==1&&this.setProfileImage(null,n)}}syncConnectedWalletInfo(e){const t=je.getProviderId(e);if(t===Ye.CONNECTOR_TYPE_AUTH){const n=this.authProvider;if(n){const s=it.getConnectedSocialProvider()??"email",i=n.getEmail()??n.getUsername();this.setConnectedWalletInfo({name:t,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(!Ov&&ir.isClient()){const e={...Cd.DEFAULT_FEATURES,...this.options.features},t=[];if(e&&((e.email||e.socials&&e.socials.length)&&t.push(Xr(()=>import("./embedded-wallet-CBey_rsj.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),e.email&&t.push(Xr(()=>import("./email-_tWtlrJA.js"),__vite__mapDeps([14,1,2,3,4,5,13,9,12,8,15,10]))),e.socials&&t.push(Xr(()=>import("./socials-BZ5xT5xi.js"),__vite__mapDeps([16,1,2,3,4,5,17,8,9,18,12,13,19,7,20]))),e.swaps&&t.push(Xr(()=>import("./swaps-D4vKYttl.js"),__vite__mapDeps([21,1,2,3,4,5,8,9,22,23,24,7,12,20,10]))),e.send&&t.push(Xr(()=>import("./send-CoBfPAxt.js"),__vite__mapDeps([25,1,2,3,4,5,8,9,12,13,24,7,10,26]))),e.receive&&t.push(Xr(()=>import("./receive-CBahSyy5.js"),__vite__mapDeps([27,1,2,3,4,5,28,7,19]))),e.onramp&&t.push(Xr(()=>import("./onramp-CZMwhg9q.js"),__vite__mapDeps([29,1,2,3,4,5,30,20,12,7,9,31,17,8,13,10]))),e.history&&t.push(Xr(()=>import("./transactions-DojEOgET.js"),__vite__mapDeps([32,1,2,3,4,5,33,30,20,12,13,7])))),await Promise.all([...t,Xr(()=>import("./index-BwALIEL4.js"),__vite__mapDeps([34,1,2,3,4,5,7,9,26,12,35,23,11,31,8,33,30,20,13,22,10,15,17,18,6,28,19])),Xr(()=>import("./w3m-modal-8Cul1RWG.js"),__vite__mapDeps([36,1,2,3,4,5,11,7,12,9,23,35]))]),!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!me.state.disableAppend&&!me.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}Ov=!0}}}const IF="1.7.3";let dd;function NF(r){return dd||(dd=new CF({...r,sdkVersion:ir.generateSdkVersion(r.adapters??[],"react",IF)}),iN(dd)),dd}const xF="6.13.5";function PF(r,e,t){const n=e.split("|").map(i=>i.trim());for(let i=0;i<n.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof r===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${t}`,s.value=r,s}async function sr(r){const e=Object.keys(r);return(await Promise.all(e.map(n=>Promise.resolve(r[n])))).reduce((n,s,i)=>(n[e[i]]=s,n),{})}function we(r,e,t){for(let n in e){let s=e[n];const i=t?t[n]:null;i&&PF(s,i,n),Object.defineProperty(r,n,{enumerable:!0,value:s,writable:!1})}}function Za(r){if(r==null)return"null";if(Array.isArray(r))return"[ "+r.map(Za).join(", ")+" ]";if(r instanceof Uint8Array){const e="0123456789abcdef";let t="0x";for(let n=0;n<r.length;n++)t+=e[r[n]>>4],t+=e[r[n]&15];return t}if(typeof r=="object"&&typeof r.toJSON=="function")return Za(r.toJSON());switch(typeof r){case"boolean":case"symbol":return r.toString();case"bigint":return BigInt(r).toString();case"number":return r.toString();case"string":return JSON.stringify(r);case"object":{const e=Object.keys(r);return e.sort(),"{ "+e.map(t=>`${Za(t)}: ${Za(r[t])}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function qt(r,e){return r&&r.code===e}function jy(r){return qt(r,"CALL_EXCEPTION")}function ct(r,e,t){let n=r;{const i=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${Za(t)}`);for(const o in t){if(o==="shortMessage")continue;const a=t[o];i.push(o+"="+Za(a))}}i.push(`code=${e}`),i.push(`version=${xF}`),i.length&&(r+=" ("+i.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(r);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(r);break;default:s=new Error(r)}return we(s,{code:e}),t&&Object.assign(s,t),s.shortMessage==null&&we(s,{shortMessage:n}),s}function V(r,e,t,n){if(!r)throw ct(e,t,n)}function M(r,e,t,n){V(r,e,"INVALID_ARGUMENT",{argument:t,value:n})}function q_(r,e,t){t==null&&(t=""),t&&(t=": "+t),V(r>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:r,expectedCount:e}),V(r<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:r,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((r,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"".normalize("NFD")!=="e")throw new Error("broken");r.push(e)}catch{}return r},[]);function Fh(r,e,t){if(t==null&&(t=""),r!==e){let n=t,s="new";t&&(n+=".",s+=" "+t),V(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function z_(r,e,t){if(r instanceof Uint8Array)return t?new Uint8Array(r):r;if(typeof r=="string"&&r.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const n=new Uint8Array((r.length-2)/2);let s=2;for(let i=0;i<n.length;i++)n[i]=parseInt(r.substring(s,s+2),16),s+=2;return n}M(!1,"invalid BytesLike value",e||"value",r)}function $e(r,e){return z_(r,e,!1)}function or(r,e){return z_(r,e,!0)}function tt(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&r.length!==2+2*e||e===!0&&r.length%2!==0)}function Hy(r){return tt(r,!0)||r instanceof Uint8Array}const Sv="0123456789abcdef";function le(r){const e=$e(r);let t="0x";for(let n=0;n<e.length;n++){const s=e[n];t+=Sv[(s&240)>>4]+Sv[s&15]}return t}function bt(r){return"0x"+r.map(e=>le(e).substring(2)).join("")}function ic(r){return tt(r,!0)?(r.length-2)/2:$e(r).length}function ft(r,e,t){const n=$e(r);return t!=null&&t>n.length&&V(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:t}),le(n.slice(e??0,t??n.length))}function V_(r,e,t){const n=$e(r);V(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),t?s.set(n,e-n.length):s.set(n,0),le(s)}function ca(r,e){return V_(r,e,!0)}function TF(r,e){return V_(r,e,!1)}const rp=BigInt(0),On=BigInt(1),xm=9007199254740991;function ff(r,e){const t=np(r,"value"),n=BigInt(Ne(e,"width"));if(V(t>>n===rp,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:r}),t>>n-On){const s=(On<<n)-On;return-((~t&s)+On)}return t}function G_(r,e){let t=de(r,"value");const n=BigInt(Ne(e,"width")),s=On<<n-On;if(t<rp){t=-t,V(t<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});const i=(On<<n)-On;return(~t&i)+On}else V(t<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});return t}function bo(r,e){const t=np(r,"value"),n=BigInt(Ne(e,"bits"));return t&(On<<n)-On}function de(r,e){switch(typeof r){case"bigint":return r;case"number":return M(Number.isInteger(r),"underflow",e||"value",r),M(r>=-9007199254740991&&r<=xm,"overflow",e||"value",r),BigInt(r);case"string":try{if(r==="")throw new Error("empty string");return r[0]==="-"&&r[1]!=="-"?-BigInt(r.substring(1)):BigInt(r)}catch(t){M(!1,`invalid BigNumberish string: ${t.message}`,e||"value",r)}}M(!1,"invalid BigNumberish value",e||"value",r)}function np(r,e){const t=de(r,e);return V(t>=rp,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:r}),t}const Rv="0123456789abcdef";function sp(r){if(r instanceof Uint8Array){let e="0x0";for(const t of r)e+=Rv[t>>4],e+=Rv[t&15];return BigInt(e)}return de(r)}function Ne(r,e){switch(typeof r){case"bigint":return M(r>=-9007199254740991&&r<=xm,"overflow",e||"value",r),Number(r);case"number":return M(Number.isInteger(r),"underflow",e||"value",r),M(r>=-9007199254740991&&r<=xm,"overflow",e||"value",r),r;case"string":try{if(r==="")throw new Error("empty string");return Ne(BigInt(r),e)}catch(t){M(!1,`invalid numeric string: ${t.message}`,e||"value",r)}}M(!1,"invalid numeric value",e||"value",r)}function OF(r){return Ne(sp(r))}function Gi(r,e){let n=np(r,"value").toString(16);if(e==null)n.length%2&&(n="0"+n);else{const s=Ne(e,"width");for(V(s*2>=n.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:r});n.length<s*2;)n="0"+n}return"0x"+n}function cr(r){const e=np(r,"value");if(e===rp)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);const n=new Uint8Array(t.length/2);for(let s=0;s<n.length;s++){const i=s*2;n[s]=parseInt(t.substring(i,i+2),16)}return n}function Ya(r){let e=le(Hy(r)?r:cr(r)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const Dv="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const kv=BigInt(58);function SF(r){const e=$e(r);let t=sp(e),n="";for(;t;)n=Dv[Number(t%kv)]+n,t/=kv;for(let s=0;s<e.length&&!e[s];s++)n=Dv[0]+n;return n}function RF(r){r=atob(r);const e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return $e(e)}function DF(r){const e=$e(r);let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}var dc;class K_{constructor(e,t,n){F(this,"filter");F(this,"emitter");H(this,dc);R(this,dc,t),we(this,{emitter:e,filter:n})}async removeListener(){w(this,dc)!=null&&await this.emitter.off(this.filter,w(this,dc))}}dc=new WeakMap;function kF(r,e,t,n,s){M(!1,`invalid codepoint at offset ${e}; ${r}`,"bytes",t)}function W_(r,e,t,n,s){if(r==="BAD_PREFIX"||r==="UNEXPECTED_CONTINUE"){let i=0;for(let o=e+1;o<t.length&&t[o]>>6===2;o++)i++;return i}return r==="OVERRUN"?t.length-e-1:0}function UF(r,e,t,n,s){return r==="OVERLONG"?(M(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),n.push(s),0):(n.push(65533),W_(r,e,t))}const BF=Object.freeze({error:kF,ignore:W_,replace:UF});function $F(r,e){e==null&&(e=BF.error);const t=$e(r,"bytes"),n=[];let s=0;for(;s<t.length;){const i=t[s++];if(i>>7===0){n.push(i);continue}let o=null,a=null;if((i&224)===192)o=1,a=127;else if((i&240)===224)o=2,a=2047;else if((i&248)===240)o=3,a=65535;else{(i&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,t,n):s+=e("BAD_PREFIX",s-1,t,n);continue}if(s-1+o>=t.length){s+=e("OVERRUN",s-1,t,n);continue}let c=i&(1<<8-o-1)-1;for(let l=0;l<o;l++){let u=t[s];if((u&192)!=128){s+=e("MISSING_CONTINUE",s,t,n),c=null;break}c=c<<6|u&63,s++}if(c!==null){if(c>1114111){s+=e("OUT_OF_RANGE",s-1-o,t,n,c);continue}if(c>=55296&&c<=57343){s+=e("UTF16_SURROGATE",s-1-o,t,n,c);continue}if(c<=a){s+=e("OVERLONG",s-1-o,t,n,c);continue}n.push(c)}}return n}function ds(r,e){M(typeof r=="string","invalid string value","str",r);let t=[];for(let n=0;n<r.length;n++){const s=r.charCodeAt(n);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){n++;const i=r.charCodeAt(n);M(n<r.length&&(i&64512)===56320,"invalid surrogate pair","str",r);const o=65536+((s&1023)<<10)+(i&1023);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return new Uint8Array(t)}function LF(r){return r.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function pf(r,e){return LF($F(r,e))}function Q_(r){async function e(t,n){V(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const s=t.url.split(":")[0].toLowerCase();V(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),V(s==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,a=setTimeout(()=>{i=ct("request timeout","TIMEOUT"),o.abort()},t.timeout);n&&n.addListener(()=>{i=ct("request cancelled","CANCELLED"),o.abort()});const c={method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:o.signal};let l;try{l=await fetch(t.url,c)}catch(f){throw clearTimeout(a),i||f}clearTimeout(a);const u={};l.headers.forEach((f,p)=>{u[p.toLowerCase()]=f});const h=await l.arrayBuffer(),d=h==null?null:new Uint8Array(h);return{statusCode:l.status,statusMessage:l.statusText,headers:u,body:d}}return e}const MF=12,FF=250;let Uv=Q_();const jF=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),HF=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let lg=!1;async function J_(r,e){try{const t=r.match(jF);if(!t)throw new Error("invalid data");return new Hi(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?RF(t[3]):zF(t[3]))}catch{return new Hi(599,"BAD REQUEST (invalid data: URI)",{},null,new ys(r))}}function Z_(r){async function e(t,n){try{const s=t.match(HF);if(!s)throw new Error("invalid link");return new ys(`${r}${s[2]}`)}catch{return new Hi(599,"BAD REQUEST (invalid IPFS URI)",{},null,new ys(t))}}return e}const fd={data:J_,ipfs:Z_("https://gateway.ipfs.io/ipfs/")},Y_=new WeakMap;var _o,yi;class qF{constructor(e){H(this,_o);H(this,yi);R(this,_o,[]),R(this,yi,!1),Y_.set(e,()=>{if(!w(this,yi)){R(this,yi,!0);for(const t of w(this,_o))setTimeout(()=>{t()},0);R(this,_o,[])}})}addListener(e){V(!w(this,yi),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),w(this,_o).push(e)}get cancelled(){return w(this,yi)}checkSignal(){V(!this.cancelled,"cancelled","CANCELLED",{})}}_o=new WeakMap,yi=new WeakMap;function pd(r){if(r==null)throw new Error("missing signal; should not happen");return r.checkSignal(),r}var fc,pc,Cn,Rs,gc,mc,Pt,Ur,Ds,Co,Io,No,Yn,In,wi,xo,Yl;const Pf=class Pf{constructor(e){H(this,xo);H(this,fc);H(this,pc);H(this,Cn);H(this,Rs);H(this,gc);H(this,mc);H(this,Pt);H(this,Ur);H(this,Ds);H(this,Co);H(this,Io);H(this,No);H(this,Yn);H(this,In);H(this,wi);R(this,mc,String(e)),R(this,fc,!1),R(this,pc,!0),R(this,Cn,{}),R(this,Rs,""),R(this,gc,3e5),R(this,In,{slotInterval:FF,maxAttempts:MF}),R(this,wi,null)}get url(){return w(this,mc)}set url(e){R(this,mc,String(e))}get body(){return w(this,Pt)==null?null:new Uint8Array(w(this,Pt))}set body(e){if(e==null)R(this,Pt,void 0),R(this,Ur,void 0);else if(typeof e=="string")R(this,Pt,ds(e)),R(this,Ur,"text/plain");else if(e instanceof Uint8Array)R(this,Pt,e),R(this,Ur,"application/octet-stream");else if(typeof e=="object")R(this,Pt,ds(JSON.stringify(e))),R(this,Ur,"application/json");else throw new Error("invalid body")}hasBody(){return w(this,Pt)!=null}get method(){return w(this,Rs)?w(this,Rs):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),R(this,Rs,String(e).toUpperCase())}get headers(){const e=Object.assign({},w(this,Cn));return w(this,Ds)&&(e.authorization=`Basic ${DF(ds(w(this,Ds)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&w(this,Ur)&&(e["content-type"]=w(this,Ur)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){w(this,Cn)[String(e).toLowerCase()]=String(t)}clearHeaders(){R(this,Cn,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return w(this,Ds)||null}setCredentials(e,t){M(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),R(this,Ds,`${e}:${t}`)}get allowGzip(){return w(this,pc)}set allowGzip(e){R(this,pc,!!e)}get allowInsecureAuthentication(){return!!w(this,fc)}set allowInsecureAuthentication(e){R(this,fc,!!e)}get timeout(){return w(this,gc)}set timeout(e){M(e>=0,"timeout must be non-zero","timeout",e),R(this,gc,e)}get preflightFunc(){return w(this,Co)||null}set preflightFunc(e){R(this,Co,e)}get processFunc(){return w(this,Io)||null}set processFunc(e){R(this,Io,e)}get retryFunc(){return w(this,No)||null}set retryFunc(e){R(this,No,e)}get getUrlFunc(){return w(this,wi)||Uv}set getUrlFunc(e){R(this,wi,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${w(this,Pt)?le(w(this,Pt)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(w(this,In).slotInterval=e.slotInterval),e.maxAttempts!=null&&(w(this,In).maxAttempts=e.maxAttempts)}send(){return V(w(this,Yn)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),R(this,Yn,new qF(this)),W(this,xo,Yl).call(this,0,Bv()+this.timeout,0,this,new Hi(0,"",{},null,this))}cancel(){V(w(this,Yn)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=Y_.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),n=e.split(":")[0].toLowerCase();V(this.method==="GET"&&(t!=="https"||n!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new Pf(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,R(s,Cn,Object.assign({},w(this,Cn))),w(this,Pt)&&R(s,Pt,new Uint8Array(w(this,Pt))),R(s,Ur,w(this,Ur)),s}clone(){const e=new Pf(this.url);return R(e,Rs,w(this,Rs)),w(this,Pt)&&R(e,Pt,w(this,Pt)),R(e,Ur,w(this,Ur)),R(e,Cn,Object.assign({},w(this,Cn))),R(e,Ds,w(this,Ds)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),R(e,Co,w(this,Co)),R(e,Io,w(this,Io)),R(e,No,w(this,No)),R(e,In,Object.assign({},w(this,In))),R(e,wi,w(this,wi)),e}static lockConfig(){lg=!0}static getGateway(e){return fd[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(lg)throw new Error("gateways locked");fd[e]=t}static registerGetUrl(e){if(lg)throw new Error("gateways locked");Uv=e}static createGetUrlFunc(e){return Q_()}static createDataGateway(){return J_}static createIpfsGatewayFunc(e){return Z_(e)}};fc=new WeakMap,pc=new WeakMap,Cn=new WeakMap,Rs=new WeakMap,gc=new WeakMap,mc=new WeakMap,Pt=new WeakMap,Ur=new WeakMap,Ds=new WeakMap,Co=new WeakMap,Io=new WeakMap,No=new WeakMap,Yn=new WeakMap,In=new WeakMap,wi=new WeakMap,xo=new WeakSet,Yl=async function(e,t,n,s,i){var u,h,d;if(e>=w(this,In).maxAttempts)return i.makeServerError("exceeded maximum retry limit");V(Bv()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),n>0&&await VF(n);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in fd){const f=await fd[a](o.url,pd(w(s,Yn)));if(f instanceof Hi){let p=f;if(this.processFunc){pd(w(s,Yn));try{p=await this.processFunc(o,p)}catch(m){(m.throttle==null||typeof m.stall!="number")&&p.makeServerError("error in post-processing function",m).assertOk()}}return p}o=f}this.preflightFunc&&(o=await this.preflightFunc(o));const c=await this.getUrlFunc(o,pd(w(s,Yn)));let l=new Hi(c.statusCode,c.statusMessage,c.headers,c.body,s);if(l.statusCode===301||l.statusCode===302){try{const f=l.headers.location||"";return W(u=o.redirect(f),xo,Yl).call(u,e+1,t,0,s,l)}catch{}return l}else if(l.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,l,e))){const f=l.headers["retry-after"];let p=w(this,In).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof f=="string"&&f.match(/^[1-9][0-9]*$/)&&(p=parseInt(f)),W(h=o.clone(),xo,Yl).call(h,e+1,t,p,s,l)}if(this.processFunc){pd(w(s,Yn));try{l=await this.processFunc(o,l)}catch(f){(f.throttle==null||typeof f.stall!="number")&&l.makeServerError("error in post-processing function",f).assertOk();let p=w(this,In).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return f.stall>=0&&(p=f.stall),W(d=o.clone(),xo,Yl).call(d,e+1,t,p,s,l)}}return l};let ys=Pf;var uh,hh,dh,Br,yc,Po;const uw=class uw{constructor(e,t,n,s,i){H(this,uh);H(this,hh);H(this,dh);H(this,Br);H(this,yc);H(this,Po);R(this,uh,e),R(this,hh,t),R(this,dh,Object.keys(n).reduce((o,a)=>(o[a.toLowerCase()]=String(n[a]),o),{})),R(this,Br,s==null?null:new Uint8Array(s)),R(this,yc,i||null),R(this,Po,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${w(this,Br)?le(w(this,Br)):"null"}>`}get statusCode(){return w(this,uh)}get statusMessage(){return w(this,hh)}get headers(){return Object.assign({},w(this,dh))}get body(){return w(this,Br)==null?null:new Uint8Array(w(this,Br))}get bodyText(){try{return w(this,Br)==null?"":pf(w(this,Br))}catch{V(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{V(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let n;e?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new uw(599,n,this.headers,this.body,w(this,yc)||void 0);return R(s,Po,{message:e,error:t}),s}throwThrottleError(e,t){t==null?t=-1:M(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const n=new Error(e||"throttling requests");throw we(n,{stall:t,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return w(this,Br)!=null}get request(){return w(this,yc)}ok(){return w(this,Po).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=w(this,Po);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let s=null;try{w(this,Br)&&(s=pf(w(this,Br)))}catch{}V(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:n,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};uh=new WeakMap,hh=new WeakMap,dh=new WeakMap,Br=new WeakMap,yc=new WeakMap,Po=new WeakMap;let Hi=uw;function Bv(){return new Date().getTime()}function zF(r){return ds(r.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function VF(r){return new Promise(e=>setTimeout(e,r))}const GF=BigInt(-1),vn=BigInt(0),Xa=BigInt(1),KF=BigInt(5),Ma={};let oc="0000";for(;oc.length<80;)oc+=oc;function eo(r){let e=oc;for(;e.length<r;)e+=e;return BigInt("1"+e.substring(0,r))}function zl(r,e,t){const n=BigInt(e.width);if(e.signed){const s=Xa<<n-Xa;V(t==null||r>=-s&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r>vn?r=ff(bo(r,n),n):r=-ff(bo(-r,n),n)}else{const s=Xa<<n;V(t==null||r>=0&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r=(r%s+s)%s&s-Xa}return r}function ug(r){typeof r=="number"&&(r=`fixed128x${r}`);let e=!0,t=128,n=18;if(typeof r=="string"){if(r!=="fixed")if(r==="ufixed")e=!1;else{const i=r.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);M(i,"invalid fixed format","format",r),e=i[1]!=="u",t=parseInt(i[2]),n=parseInt(i[3])}}else if(r){const i=r,o=(a,c,l)=>i[a]==null?l:(M(typeof i[a]===c,"invalid fixed format ("+a+" not "+c+")","format."+a,i[a]),i[a]);e=o("signed","boolean",e),t=o("width","number",t),n=o("decimals","number",n)}M(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),M(n<=80,"invalid FixedNumber decimals (too large)","format.decimals",n);const s=(e?"":"u")+"fixed"+String(t)+"x"+String(n);return{signed:e,width:t,decimals:n,name:s}}function WF(r,e){let t="";r<vn&&(t="-",r*=GF);let n=r.toString();if(e===0)return t+n;for(;n.length<=e;)n=oc+n;const s=n.length-e;for(n=n.substring(0,s)+"."+n.substring(s);n[0]==="0"&&n[1]!==".";)n=n.substring(1);for(;n[n.length-1]==="0"&&n[n.length-2]!==".";)n=n.substring(0,n.length-1);return t+n}var Nn,Ge,rr,Ve,no,Is,Pm,Tm,Om,Sm;const pi=class pi{constructor(e,t,n){H(this,Ve);F(this,"format");H(this,Nn);H(this,Ge);H(this,rr);F(this,"_value");Fh(e,Ma,"FixedNumber"),R(this,Ge,t),R(this,Nn,n);const s=WF(t,n.decimals);we(this,{format:n.name,_value:s}),R(this,rr,eo(n.decimals))}get signed(){return w(this,Nn).signed}get width(){return w(this,Nn).width}get decimals(){return w(this,Nn).decimals}get value(){return w(this,Ge)}addUnsafe(e){return W(this,Ve,Pm).call(this,e)}add(e){return W(this,Ve,Pm).call(this,e,"add")}subUnsafe(e){return W(this,Ve,Tm).call(this,e)}sub(e){return W(this,Ve,Tm).call(this,e,"sub")}mulUnsafe(e){return W(this,Ve,Om).call(this,e)}mul(e){return W(this,Ve,Om).call(this,e,"mul")}mulSignal(e){W(this,Ve,no).call(this,e);const t=w(this,Ge)*w(e,Ge);return V(t%w(this,rr)===vn,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),W(this,Ve,Is).call(this,t/w(this,rr),"mulSignal")}divUnsafe(e){return W(this,Ve,Sm).call(this,e)}div(e){return W(this,Ve,Sm).call(this,e,"div")}divSignal(e){V(w(e,Ge)!==vn,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),W(this,Ve,no).call(this,e);const t=w(this,Ge)*w(this,rr);return V(t%w(e,Ge)===vn,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),W(this,Ve,Is).call(this,t/w(e,Ge),"divSignal")}cmp(e){let t=this.value,n=e.value;const s=this.decimals-e.decimals;return s>0?n*=eo(s):s<0&&(t*=eo(-s)),t<n?-1:t>n?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=w(this,Ge);return w(this,Ge)<vn&&(e-=w(this,rr)-Xa),e=w(this,Ge)/w(this,rr)*w(this,rr),W(this,Ve,Is).call(this,e,"floor")}ceiling(){let e=w(this,Ge);return w(this,Ge)>vn&&(e+=w(this,rr)-Xa),e=w(this,Ge)/w(this,rr)*w(this,rr),W(this,Ve,Is).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const t=this.decimals-e,n=KF*eo(t-1);let s=this.value+n;const i=eo(t);return s=s/i*i,zl(s,w(this,Nn),"round"),new pi(Ma,s,w(this,Nn))}isZero(){return w(this,Ge)===vn}isNegative(){return w(this,Ge)<vn}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return pi.fromString(this.toString(),e)}static fromValue(e,t,n){const s=t==null?0:Ne(t),i=ug(n);let o=de(e,"value");const a=s-i.decimals;if(a>0){const c=eo(a);V(o%c===vn,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=c}else a<0&&(o*=eo(-a));return zl(o,i,"fromValue"),new pi(Ma,o,i)}static fromString(e,t){const n=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);M(n&&n[2].length+n[3].length>0,"invalid FixedNumber string value","value",e);const s=ug(t);let i=n[2]||"0",o=n[3]||"";for(;o.length<s.decimals;)o+=oc;V(o.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,s.decimals);const a=BigInt(n[1]+i+o);return zl(a,s,"fromString"),new pi(Ma,a,s)}static fromBytes(e,t){let n=sp($e(e,"value"));const s=ug(t);return s.signed&&(n=ff(n,s.width)),zl(n,s,"fromBytes"),new pi(Ma,n,s)}};Nn=new WeakMap,Ge=new WeakMap,rr=new WeakMap,Ve=new WeakSet,no=function(e){M(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},Is=function(e,t){return e=zl(e,w(this,Nn),t),new pi(Ma,e,w(this,Nn))},Pm=function(e,t){return W(this,Ve,no).call(this,e),W(this,Ve,Is).call(this,w(this,Ge)+w(e,Ge),t)},Tm=function(e,t){return W(this,Ve,no).call(this,e),W(this,Ve,Is).call(this,w(this,Ge)-w(e,Ge),t)},Om=function(e,t){return W(this,Ve,no).call(this,e),W(this,Ve,Is).call(this,w(this,Ge)*w(e,Ge)/w(this,rr),t)},Sm=function(e,t){return V(w(e,Ge)!==vn,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),W(this,Ve,no).call(this,e),W(this,Ve,Is).call(this,w(this,Ge)*w(this,rr)/w(e,Ge),t)};let gf=pi;function QF(r){let e=r.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function $v(r,e,t){let n=0;for(let s=0;s<t;s++)n=n*256+r[e+s];return n}function Lv(r,e,t,n){const s=[];for(;t<e+1+n;){const i=X_(r,t);s.push(i.result),t+=i.consumed,V(t<=e+1+n,"child data too short","BUFFER_OVERRUN",{buffer:r,length:n,offset:e})}return{consumed:1+n,result:s}}function X_(r,e){V(r.length!==0,"data too short","BUFFER_OVERRUN",{buffer:r,length:0,offset:1});const t=n=>{V(n<=r.length,"data short segment too short","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n})};if(r[e]>=248){const n=r[e]-247;t(e+1+n);const s=$v(r,e+1,n);return t(e+1+n+s),Lv(r,e,e+1+n,n+s)}else if(r[e]>=192){const n=r[e]-192;return t(e+1+n),Lv(r,e,e+1,n)}else if(r[e]>=184){const n=r[e]-183;t(e+1+n);const s=$v(r,e+1,n);t(e+1+n+s);const i=le(r.slice(e+1+n,e+1+n+s));return{consumed:1+n+s,result:i}}else if(r[e]>=128){const n=r[e]-128;t(e+1+n);const s=le(r.slice(e+1,e+1+n));return{consumed:1+n,result:s}}return{consumed:1,result:QF(r[e])}}function ip(r){const e=$e(r,"data"),t=X_(e,0);return M(t.consumed===e.length,"unexpected junk after rlp payload","data",r),t.result}function Mv(r){const e=[];for(;r;)e.unshift(r&255),r>>=8;return e}function eC(r){if(Array.isArray(r)){let n=[];if(r.forEach(function(i){n=n.concat(eC(i))}),n.length<=55)return n.unshift(192+n.length),n;const s=Mv(n.length);return s.unshift(247+s.length),s.concat(n)}const e=Array.prototype.slice.call($e(r,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=Mv(e.length);return t.unshift(183+t.length),t.concat(e)}const Fv="0123456789abcdef";function la(r){let e="0x";for(const t of eC(r))e+=Fv[t>>4],e+=Fv[t&15];return e}const tC=["wei","kwei","mwei","gwei","szabo","finney","ether"];function rC(r,e){let t=18;if(typeof e=="string"){const n=tC.indexOf(e);M(n>=0,"invalid unit","unit",e),t=3*n}else e!=null&&(t=Ne(e,"unit"));return gf.fromValue(r,t,{decimals:t,width:512}).toString()}function JF(r,e){M(typeof r=="string","value must be a string","value",r);let t=18;if(typeof e=="string"){const n=tC.indexOf(e);M(n>=0,"invalid unit","unit",e),t=3*n}else e!=null&&(t=Ne(e,"unit"));return gf.fromString(r,{decimals:t,width:512}).value}function ZF(r){return rC(r,18)}const lr=32,Rm=new Uint8Array(lr),YF=["then"],gd={},nC=new WeakMap;function uo(r){return nC.get(r)}function jv(r,e){nC.set(r,e)}function Vl(r,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${r}`);throw t.error=e,t}function Dm(r,e,t){return r.indexOf(null)>=0?e.map((n,s)=>n instanceof hl?Dm(uo(n),n,t):n):r.reduce((n,s,i)=>{let o=e.getValue(s);return s in n||(t&&o instanceof hl&&(o=Dm(uo(o),o,t)),n[s]=o),n},{})}var wc;const ec=class ec extends Array{constructor(...t){const n=t[0];let s=t[1],i=(t[2]||[]).slice(),o=!0;n!==gd&&(s=t,i=[],o=!1);super(s.length);H(this,wc);s.forEach((l,u)=>{this[u]=l});const a=i.reduce((l,u)=>(typeof u=="string"&&l.set(u,(l.get(u)||0)+1),l),new Map);if(jv(this,Object.freeze(s.map((l,u)=>{const h=i[u];return h!=null&&a.get(h)===1?h:null}))),R(this,wc,[]),w(this,wc)==null&&w(this,wc),!o)return;Object.freeze(this);const c=new Proxy(this,{get:(l,u,h)=>{if(typeof u=="string"){if(u.match(/^[0-9]+$/)){const f=Ne(u,"%index");if(f<0||f>=this.length)throw new RangeError("out of result range");const p=l[f];return p instanceof Error&&Vl(`index ${f}`,p),p}if(YF.indexOf(u)>=0)return Reflect.get(l,u,h);const d=l[u];if(d instanceof Function)return function(...f){return d.apply(this===h?l:this,f)};if(!(u in l))return l.getValue.apply(this===h?l:this,[u])}return Reflect.get(l,u,h)}});return jv(c,uo(this)),c}toArray(t){const n=[];return this.forEach((s,i)=>{s instanceof Error&&Vl(`index ${i}`,s),t&&s instanceof ec&&(s=s.toArray(t)),n.push(s)}),n}toObject(t){const n=uo(this);return n.reduce((s,i,o)=>(V(i!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),Dm(n,this,t)),{})}slice(t,n){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const s=uo(this),i=[],o=[];for(let a=t;a<n;a++)i.push(this[a]),o.push(s[a]);return new ec(gd,i,o)}filter(t,n){const s=uo(this),i=[],o=[];for(let a=0;a<this.length;a++){const c=this[a];c instanceof Error&&Vl(`index ${a}`,c),t.call(n,c,a,this)&&(i.push(c),o.push(s[a]))}return new ec(gd,i,o)}map(t,n){const s=[];for(let i=0;i<this.length;i++){const o=this[i];o instanceof Error&&Vl(`index ${i}`,o),s.push(t.call(n,o,i,this))}return s}getValue(t){const n=uo(this).indexOf(t);if(n===-1)return;const s=this[n];return s instanceof Error&&Vl(`property ${JSON.stringify(t)}`,s.error),s}static fromItems(t,n){return new ec(gd,t,n)}};wc=new WeakMap;let hl=ec;function Hv(r){let e=cr(r);return V(e.length<=lr,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:lr,offset:e.length}),e.length!==lr&&(e=or(bt([Rm.slice(e.length%lr),e]))),e}class ti{constructor(e,t,n,s){F(this,"name");F(this,"type");F(this,"localName");F(this,"dynamic");we(this,{name:e,type:t,localName:n,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){M(!1,e,this.localName,t)}}var ks,To,bc,Ld;class km{constructor(){H(this,bc);H(this,ks);H(this,To);R(this,ks,[]),R(this,To,0)}get data(){return bt(w(this,ks))}get length(){return w(this,To)}appendWriter(e){return W(this,bc,Ld).call(this,or(e.data))}writeBytes(e){let t=or(e);const n=t.length%lr;return n&&(t=or(bt([t,Rm.slice(n)]))),W(this,bc,Ld).call(this,t)}writeValue(e){return W(this,bc,Ld).call(this,Hv(e))}writeUpdatableValue(){const e=w(this,ks).length;return w(this,ks).push(Rm),R(this,To,w(this,To)+lr),t=>{w(this,ks)[e]=Hv(t)}}}ks=new WeakMap,To=new WeakMap,bc=new WeakSet,Ld=function(e){return w(this,ks).push(e),R(this,To,w(this,To)+e.length),e.length};var vr,$r,Oo,So,bi,ga,Bm,sC;const hw=class hw{constructor(e,t,n){H(this,ga);F(this,"allowLoose");H(this,vr);H(this,$r);H(this,Oo);H(this,So);H(this,bi);we(this,{allowLoose:!!t}),R(this,vr,or(e)),R(this,Oo,0),R(this,So,null),R(this,bi,n??1024),R(this,$r,0)}get data(){return le(w(this,vr))}get dataLength(){return w(this,vr).length}get consumed(){return w(this,$r)}get bytes(){return new Uint8Array(w(this,vr))}subReader(e){const t=new hw(w(this,vr).slice(w(this,$r)+e),this.allowLoose,w(this,bi));return R(t,So,this),t}readBytes(e,t){let n=W(this,ga,sC).call(this,0,e,!!t);return W(this,ga,Bm).call(this,e),R(this,$r,w(this,$r)+n.length),n.slice(0,e)}readValue(){return sp(this.readBytes(lr))}readIndex(){return OF(this.readBytes(lr))}};vr=new WeakMap,$r=new WeakMap,Oo=new WeakMap,So=new WeakMap,bi=new WeakMap,ga=new WeakSet,Bm=function(e){var t;if(w(this,So))return W(t=w(this,So),ga,Bm).call(t,e);R(this,Oo,w(this,Oo)+e),V(w(this,bi)<1||w(this,Oo)<=w(this,bi)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${w(this,bi)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:or(w(this,vr)),offset:w(this,$r),length:e,info:{bytesRead:w(this,Oo),dataLength:this.dataLength}})},sC=function(e,t,n){let s=Math.ceil(t/lr)*lr;return w(this,$r)+s>w(this,vr).length&&(this.allowLoose&&n&&w(this,$r)+t<=w(this,vr).length?s=t:V(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:or(w(this,vr)),length:w(this,vr).length,offset:w(this,$r)+s})),w(this,vr).slice(w(this,$r),w(this,$r)+s)};let Um=hw;function mf(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`Wrong positive integer: ${r}`)}function qy(r,...e){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(r.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${r.length}`)}function XF(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");mf(r.outputLen),mf(r.blockLen)}function dl(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function iC(r,e){qy(r);const t=e.outputLen;if(r.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const hg=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const oC=r=>r instanceof Uint8Array,e9=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),dg=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),Gn=(r,e)=>r<<32-e|r>>>e,t9=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!t9)throw new Error("Non little-endian hardware is not supported");function r9(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function op(r){if(typeof r=="string"&&(r=r9(r)),!oC(r))throw new Error(`expected Uint8Array, got ${typeof r}`);return r}function n9(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!oC(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}class zy{clone(){return this._cloneInto()}}function Vy(r){const e=n=>r().update(op(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function s9(r=32){if(hg&&typeof hg.getRandomValues=="function")return hg.getRandomValues(new Uint8Array(r));throw new Error("crypto.getRandomValues must be defined")}class aC extends zy{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,XF(e);const n=op(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return dl(this),this.iHash.update(e),this}digestInto(e){dl(this),qy(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const cC=(r,e,t)=>new aC(r,e).update(t).digest();cC.create=(r,e)=>new aC(r,e);function i9(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}class lC extends zy{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=dg(this.buffer)}update(e){dl(this);const{view:t,buffer:n,blockLen:s}=this;e=op(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=dg(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){dl(this),iC(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;i9(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=dg(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}}const o9=(r,e,t)=>r&e^~r&t,a9=(r,e,t)=>r&e^r&t^e&t,c9=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),oi=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ai=new Uint32Array(64);class l9 extends lC{constructor(){super(64,32,8,!1),this.A=oi[0]|0,this.B=oi[1]|0,this.C=oi[2]|0,this.D=oi[3]|0,this.E=oi[4]|0,this.F=oi[5]|0,this.G=oi[6]|0,this.H=oi[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)ai[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const d=ai[h-15],f=ai[h-2],p=Gn(d,7)^Gn(d,18)^d>>>3,m=Gn(f,17)^Gn(f,19)^f>>>10;ai[h]=m+ai[h-7]+p+ai[h-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let h=0;h<64;h++){const d=Gn(a,6)^Gn(a,11)^Gn(a,25),f=u+d+o9(a,c,l)+c9[h]+ai[h]|0,m=(Gn(n,2)^Gn(n,13)^Gn(n,22))+a9(n,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=n,n=f+m|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){ai.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const uC=Vy(()=>new l9),md=BigInt(2**32-1),$m=BigInt(32);function hC(r,e=!1){return e?{h:Number(r&md),l:Number(r>>$m&md)}:{h:Number(r>>$m&md)|0,l:Number(r&md)|0}}function dC(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=hC(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const u9=(r,e)=>BigInt(r>>>0)<<$m|BigInt(e>>>0),h9=(r,e,t)=>r>>>t,d9=(r,e,t)=>r<<32-t|e>>>t,f9=(r,e,t)=>r>>>t|e<<32-t,p9=(r,e,t)=>r<<32-t|e>>>t,g9=(r,e,t)=>r<<64-t|e>>>t-32,m9=(r,e,t)=>r>>>t-32|e<<64-t,y9=(r,e)=>e,w9=(r,e)=>r,fC=(r,e,t)=>r<<t|e>>>32-t,pC=(r,e,t)=>e<<t|r>>>32-t,gC=(r,e,t)=>e<<t-32|r>>>64-t,mC=(r,e,t)=>r<<t-32|e>>>64-t;function b9(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const v9=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),E9=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,A9=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),_9=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,C9=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),I9=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,Te={fromBig:hC,split:dC,toBig:u9,shrSH:h9,shrSL:d9,rotrSH:f9,rotrSL:p9,rotrBH:g9,rotrBL:m9,rotr32H:y9,rotr32L:w9,rotlSH:fC,rotlSL:pC,rotlBH:gC,rotlBL:mC,add:b9,add3L:v9,add3H:E9,add4L:A9,add4H:_9,add5H:I9,add5L:C9},[N9,x9]=Te.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),ci=new Uint32Array(80),li=new Uint32Array(80);class P9 extends lC{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:d,Gh:f,Gl:p,Hh:m,Hl:v}=this;return[e,t,n,s,i,o,a,c,l,u,h,d,f,p,m,v]}set(e,t,n,s,i,o,a,c,l,u,h,d,f,p,m,v){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=d|0,this.Gh=f|0,this.Gl=p|0,this.Hh=m|0,this.Hl=v|0}process(e,t){for(let C=0;C<16;C++,t+=4)ci[C]=e.getUint32(t),li[C]=e.getUint32(t+=4);for(let C=16;C<80;C++){const U=ci[C-15]|0,L=li[C-15]|0,B=Te.rotrSH(U,L,1)^Te.rotrSH(U,L,8)^Te.shrSH(U,L,7),$=Te.rotrSL(U,L,1)^Te.rotrSL(U,L,8)^Te.shrSL(U,L,7),g=ci[C-2]|0,b=li[C-2]|0,N=Te.rotrSH(g,b,19)^Te.rotrBH(g,b,61)^Te.shrSH(g,b,6),x=Te.rotrSL(g,b,19)^Te.rotrBL(g,b,61)^Te.shrSL(g,b,6),I=Te.add4L($,x,li[C-7],li[C-16]),D=Te.add4H(I,B,N,ci[C-7],ci[C-16]);ci[C]=D|0,li[C]=I|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:d,Fh:f,Fl:p,Gh:m,Gl:v,Hh:_,Hl:y}=this;for(let C=0;C<80;C++){const U=Te.rotrSH(h,d,14)^Te.rotrSH(h,d,18)^Te.rotrBH(h,d,41),L=Te.rotrSL(h,d,14)^Te.rotrSL(h,d,18)^Te.rotrBL(h,d,41),B=h&f^~h&m,$=d&p^~d&v,g=Te.add5L(y,L,$,x9[C],li[C]),b=Te.add5H(g,_,U,B,N9[C],ci[C]),N=g|0,x=Te.rotrSH(n,s,28)^Te.rotrBH(n,s,34)^Te.rotrBH(n,s,39),I=Te.rotrSL(n,s,28)^Te.rotrBL(n,s,34)^Te.rotrBL(n,s,39),D=n&i^n&a^i&a,S=s&o^s&c^o&c;_=m|0,y=v|0,m=f|0,v=p|0,f=h|0,p=d|0,{h,l:d}=Te.add(l|0,u|0,b|0,N|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const E=Te.add3L(N,I,S);n=Te.add3H(E,b,x,D),s=E|0}({h:n,l:s}=Te.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=Te.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Te.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Te.add(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:d}=Te.add(this.Eh|0,this.El|0,h|0,d|0),{h:f,l:p}=Te.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:m,l:v}=Te.add(this.Gh|0,this.Gl|0,m|0,v|0),{h:_,l:y}=Te.add(this.Hh|0,this.Hl|0,_|0,y|0),this.set(n,s,i,o,a,c,l,u,h,d,f,p,m,v,_,y)}roundClean(){ci.fill(0),li.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const T9=Vy(()=>new P9);function O9(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof be<"u")return be;throw new Error("unable to locate global object")}const qv=O9();qv.crypto||qv.msCrypto;function S9(r){switch(r){case"sha256":return uC.create();case"sha512":return T9.create()}M(!1,"invalid hashing algorithm name","algorithm",r)}const[yC,wC,bC]=[[],[],[]],R9=BigInt(0),Gl=BigInt(1),D9=BigInt(2),k9=BigInt(7),U9=BigInt(256),B9=BigInt(113);for(let r=0,e=Gl,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],yC.push(2*(5*n+t)),wC.push((r+1)*(r+2)/2%64);let s=R9;for(let i=0;i<7;i++)e=(e<<Gl^(e>>k9)*B9)%U9,e&D9&&(s^=Gl<<(Gl<<BigInt(i))-Gl);bC.push(s)}const[$9,L9]=dC(bC,!0),zv=(r,e,t)=>t>32?gC(r,e,t):fC(r,e,t),Vv=(r,e,t)=>t>32?mC(r,e,t):pC(r,e,t);function M9(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],h=zv(l,u,1)^t[a],d=Vv(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)r[o+f]^=h,r[o+f+1]^=d}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=wC[o],c=zv(s,i,a),l=Vv(s,i,a),u=yC[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=$9[n],r[1]^=L9[n]}t.fill(0)}class Gy extends zy{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,mf(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=e9(this.state)}keccak(){M9(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){dl(this);const{blockLen:t,state:n}=this;e=op(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,(t&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){dl(this,!1),qy(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return mf(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(iC(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Gy(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const F9=(r,e,t)=>Vy(()=>new Gy(e,r,t)),j9=F9(1,136,256/8);let vC=!1;const EC=function(r){return j9(r)};let AC=EC;function At(r){const e=$e(r,"data");return le(AC(e))}At._=EC;At.lock=function(){vC=!0};At.register=function(r){if(vC)throw new TypeError("keccak256 is locked");AC=r};Object.freeze(At);const _C=function(r){return S9("sha256").update(r).digest()};let CC=_C,IC=!1;function xl(r){const e=$e(r,"data");return le(CC(e))}xl._=_C;xl.lock=function(){IC=!0};xl.register=function(r){if(IC)throw new Error("sha256 is locked");CC=r};Object.freeze(xl);Object.freeze(xl);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const NC=BigInt(0),ap=BigInt(1),H9=BigInt(2),cp=r=>r instanceof Uint8Array,q9=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function fl(r){if(!cp(r))throw new Error("Uint8Array expected");let e="";for(let t=0;t<r.length;t++)e+=q9[r[t]];return e}function xC(r){const e=r.toString(16);return e.length&1?`0${e}`:e}function Ky(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return BigInt(r===""?"0":`0x${r}`)}function pl(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let n=0;n<t.length;n++){const s=n*2,i=r.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[n]=o}return t}function Zo(r){return Ky(fl(r))}function Wy(r){if(!cp(r))throw new Error("Uint8Array expected");return Ky(fl(Uint8Array.from(r).reverse()))}function gl(r,e){return pl(r.toString(16).padStart(e*2,"0"))}function Qy(r,e){return gl(r,e).reverse()}function z9(r){return pl(xC(r))}function _n(r,e,t){let n;if(typeof e=="string")try{n=pl(e)}catch(i){throw new Error(`${r} must be valid hex string, got "${e}". Cause: ${i}`)}else if(cp(e))n=Uint8Array.from(e);else throw new Error(`${r} must be hex string or Uint8Array`);const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(`${r} expected ${t} bytes, got ${s}`);return n}function eh(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!cp(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}function V9(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function G9(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function K9(r){let e;for(e=0;r>NC;r>>=ap,e+=1);return e}function W9(r,e){return r>>BigInt(e)&ap}const Q9=(r,e,t)=>r|(t?ap:NC)<<BigInt(e),Jy=r=>(H9<<BigInt(r-1))-ap,fg=r=>new Uint8Array(r),Gv=r=>Uint8Array.from(r);function PC(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=fg(r),s=fg(r),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...h)=>t(s,n,...h),c=(h=fg())=>{s=a(Gv([0]),h),n=a(),h.length!==0&&(s=a(Gv([1]),h),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const d=[];for(;h<e;){n=a();const f=n.slice();d.push(f),h+=n.length}return eh(...d)};return(h,d)=>{o(),c(h);let f;for(;!(f=d(l()));)c();return o(),f}}const J9={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||r instanceof Uint8Array,isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function jh(r,e,t={}){const n=(s,i,o)=>{const a=J9[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${i}`)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}const Z9=Object.freeze(Object.defineProperty({__proto__:null,bitGet:W9,bitLen:K9,bitMask:Jy,bitSet:Q9,bytesToHex:fl,bytesToNumberBE:Zo,bytesToNumberLE:Wy,concatBytes:eh,createHmacDrbg:PC,ensureBytes:_n,equalBytes:V9,hexToBytes:pl,hexToNumber:Ky,numberToBytesBE:gl,numberToBytesLE:Qy,numberToHexUnpadded:xC,numberToVarBytesBE:z9,utf8ToBytes:G9,validateObject:jh},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const kt=BigInt(0),yt=BigInt(1),ho=BigInt(2),Y9=BigInt(3),Lm=BigInt(4),Kv=BigInt(5),Wv=BigInt(8);BigInt(9);BigInt(16);function _r(r,e){const t=r%e;return t>=kt?t:e+t}function X9(r,e,t){if(t<=kt||e<kt)throw new Error("Expected power/modulo > 0");if(t===yt)return kt;let n=yt;for(;e>kt;)e&yt&&(n=n*r%t),r=r*r%t,e>>=yt;return n}function Qr(r,e,t){let n=r;for(;e-- >kt;)n*=n,n%=t;return n}function Mm(r,e){if(r===kt||e<=kt)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=_r(r,e),n=e,s=kt,i=yt;for(;t!==kt;){const a=n/t,c=n%t,l=s-i*a;n=t,t=c,s=i,i=l}if(n!==yt)throw new Error("invert: does not exist");return _r(s,e)}function ej(r){const e=(r-yt)/ho;let t,n,s;for(t=r-yt,n=0;t%ho===kt;t/=ho,n++);for(s=ho;s<r&&X9(s,e,r)!==r-yt;s++);if(n===1){const o=(r+yt)/Lm;return function(c,l){const u=c.pow(l,o);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}const i=(t+yt)/ho;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=n,u=a.pow(a.mul(a.ONE,s),t),h=a.pow(c,i),d=a.pow(c,t);for(;!a.eql(d,a.ONE);){if(a.eql(d,a.ZERO))return a.ZERO;let f=1;for(let m=a.sqr(d);f<l&&!a.eql(m,a.ONE);f++)m=a.sqr(m);const p=a.pow(u,yt<<BigInt(l-f-1));u=a.sqr(p),h=a.mul(h,p),d=a.mul(d,u),l=f}return h}}function tj(r){if(r%Lm===Y9){const e=(r+yt)/Lm;return function(n,s){const i=n.pow(s,e);if(!n.eql(n.sqr(i),s))throw new Error("Cannot find square root");return i}}if(r%Wv===Kv){const e=(r-Kv)/Wv;return function(n,s){const i=n.mul(s,ho),o=n.pow(i,e),a=n.mul(s,o),c=n.mul(n.mul(a,ho),o),l=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(l),s))throw new Error("Cannot find square root");return l}}return ej(r)}const rj=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function nj(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=rj.reduce((n,s)=>(n[s]="function",n),e);return jh(r,t)}function sj(r,e,t){if(t<kt)throw new Error("Expected power > 0");if(t===kt)return r.ONE;if(t===yt)return e;let n=r.ONE,s=e;for(;t>kt;)t&yt&&(n=r.mul(n,s)),s=r.sqr(s),t>>=yt;return n}function ij(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function TC(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function oj(r,e,t=!1,n={}){if(r<=kt)throw new Error(`Expected Field ORDER > 0, got ${r}`);const{nBitLength:s,nByteLength:i}=TC(r,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=tj(r),a=Object.freeze({ORDER:r,BITS:s,BYTES:i,MASK:Jy(s),ZERO:kt,ONE:yt,create:c=>_r(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return kt<=c&&c<r},is0:c=>c===kt,isOdd:c=>(c&yt)===yt,neg:c=>_r(-c,r),eql:(c,l)=>c===l,sqr:c=>_r(c*c,r),add:(c,l)=>_r(c+l,r),sub:(c,l)=>_r(c-l,r),mul:(c,l)=>_r(c*l,r),pow:(c,l)=>sj(a,c,l),div:(c,l)=>_r(c*Mm(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Mm(c,r),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>ij(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?Qy(c,i):gl(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return t?Wy(c):Zo(c)}});return Object.freeze(a)}function OC(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function SC(r){const e=OC(r);return e+Math.ceil(e/2)}function aj(r,e,t=!1){const n=r.length,s=OC(e),i=SC(e);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);const o=t?Zo(r):Wy(r),a=_r(o,e-yt)+yt;return t?Qy(a,s):gl(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const cj=BigInt(0),pg=BigInt(1);function lj(r,e){const t=(s,i)=>{const o=i.negate();return s?o:i},n=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:t,unsafeLadder(s,i){let o=r.ZERO,a=s;for(;i>cj;)i&pg&&(o=o.add(a)),a=a.double(),i>>=pg;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=n(i),c=[];let l=s,u=l;for(let h=0;h<o;h++){u=l,c.push(u);for(let d=1;d<a;d++)u=u.add(l),c.push(u);l=u.double()}return c},wNAF(s,i,o){const{windows:a,windowSize:c}=n(s);let l=r.ZERO,u=r.BASE;const h=BigInt(2**s-1),d=2**s,f=BigInt(s);for(let p=0;p<a;p++){const m=p*c;let v=Number(o&h);o>>=f,v>c&&(v-=d,o+=pg);const _=m,y=m+Math.abs(v)-1,C=p%2!==0,U=v<0;v===0?u=u.add(t(C,i[_])):l=l.add(t(U,i[y]))}return{p:l,f:u}},wNAFCached(s,i,o,a){const c=s._WINDOW_SIZE||1;let l=i.get(s);return l||(l=this.precomputeWindow(s,c),c!==1&&i.set(s,a(l))),this.wNAF(c,l,o)}}}function RC(r){return nj(r.Fp),jh(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...TC(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function uj(r){const e=RC(r);jh(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:hj,hexToBytes:dj}=Z9,vo={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(r){const{Err:e}=vo;if(r.length<2||r[0]!==2)throw new e("Invalid signature integer tag");const t=r[1],n=r.subarray(2,t+2);if(!t||n.length!==t)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:hj(n),l:r.subarray(t+2)}},toSig(r){const{Err:e}=vo,t=typeof r=="string"?dj(r):r;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let n=t.length;if(n<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=vo._parseInt(t.subarray(2)),{d:o,l:a}=vo._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(r){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,t=l=>{const u=l.toString(16);return u.length&1?`0${u}`:u},n=e(t(r.s)),s=e(t(r.r)),i=n.length/2,o=s.length/2,a=t(i),c=t(o);return`30${t(o+i+4)}02${c}${s}02${a}${n}`}},Vs=BigInt(0),ln=BigInt(1);BigInt(2);const Qv=BigInt(3);BigInt(4);function fj(r){const e=uj(r),{Fp:t}=e,n=e.toBytes||((p,m,v)=>{const _=m.toAffine();return eh(Uint8Array.from([4]),t.toBytes(_.x),t.toBytes(_.y))}),s=e.fromBytes||(p=>{const m=p.subarray(1),v=t.fromBytes(m.subarray(0,t.BYTES)),_=t.fromBytes(m.subarray(t.BYTES,2*t.BYTES));return{x:v,y:_}});function i(p){const{a:m,b:v}=e,_=t.sqr(p),y=t.mul(_,p);return t.add(t.add(y,t.mul(p,m)),v)}if(!t.eql(t.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(p){return typeof p=="bigint"&&Vs<p&&p<e.n}function a(p){if(!o(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(p){const{allowedPrivateKeyLengths:m,nByteLength:v,wrapPrivateKey:_,n:y}=e;if(m&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=fl(p)),typeof p!="string"||!m.includes(p.length))throw new Error("Invalid key");p=p.padStart(v*2,"0")}let C;try{C=typeof p=="bigint"?p:Zo(_n("private key",p,v))}catch{throw new Error(`private key must be ${v} bytes, hex or bigint, not ${typeof p}`)}return _&&(C=_r(C,y)),a(C),C}const l=new Map;function u(p){if(!(p instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(m,v,_){if(this.px=m,this.py=v,this.pz=_,m==null||!t.isValid(m))throw new Error("x required");if(v==null||!t.isValid(v))throw new Error("y required");if(_==null||!t.isValid(_))throw new Error("z required")}static fromAffine(m){const{x:v,y:_}=m||{};if(!m||!t.isValid(v)||!t.isValid(_))throw new Error("invalid affine point");if(m instanceof h)throw new Error("projective point not allowed");const y=C=>t.eql(C,t.ZERO);return y(v)&&y(_)?h.ZERO:new h(v,_,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(m){const v=t.invertBatch(m.map(_=>_.pz));return m.map((_,y)=>_.toAffine(v[y])).map(h.fromAffine)}static fromHex(m){const v=h.fromAffine(s(_n("pointHex",m)));return v.assertValidity(),v}static fromPrivateKey(m){return h.BASE.multiply(c(m))}_setWindowSize(m){this._WINDOW_SIZE=m,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:m,y:v}=this.toAffine();if(!t.isValid(m)||!t.isValid(v))throw new Error("bad point: x or y not FE");const _=t.sqr(v),y=i(m);if(!t.eql(_,y))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:m}=this.toAffine();if(t.isOdd)return!t.isOdd(m);throw new Error("Field doesn't support isOdd")}equals(m){u(m);const{px:v,py:_,pz:y}=this,{px:C,py:U,pz:L}=m,B=t.eql(t.mul(v,L),t.mul(C,y)),$=t.eql(t.mul(_,L),t.mul(U,y));return B&&$}negate(){return new h(this.px,t.neg(this.py),this.pz)}double(){const{a:m,b:v}=e,_=t.mul(v,Qv),{px:y,py:C,pz:U}=this;let L=t.ZERO,B=t.ZERO,$=t.ZERO,g=t.mul(y,y),b=t.mul(C,C),N=t.mul(U,U),x=t.mul(y,C);return x=t.add(x,x),$=t.mul(y,U),$=t.add($,$),L=t.mul(m,$),B=t.mul(_,N),B=t.add(L,B),L=t.sub(b,B),B=t.add(b,B),B=t.mul(L,B),L=t.mul(x,L),$=t.mul(_,$),N=t.mul(m,N),x=t.sub(g,N),x=t.mul(m,x),x=t.add(x,$),$=t.add(g,g),g=t.add($,g),g=t.add(g,N),g=t.mul(g,x),B=t.add(B,g),N=t.mul(C,U),N=t.add(N,N),g=t.mul(N,x),L=t.sub(L,g),$=t.mul(N,b),$=t.add($,$),$=t.add($,$),new h(L,B,$)}add(m){u(m);const{px:v,py:_,pz:y}=this,{px:C,py:U,pz:L}=m;let B=t.ZERO,$=t.ZERO,g=t.ZERO;const b=e.a,N=t.mul(e.b,Qv);let x=t.mul(v,C),I=t.mul(_,U),D=t.mul(y,L),S=t.add(v,_),E=t.add(C,U);S=t.mul(S,E),E=t.add(x,I),S=t.sub(S,E),E=t.add(v,y);let A=t.add(C,L);return E=t.mul(E,A),A=t.add(x,D),E=t.sub(E,A),A=t.add(_,y),B=t.add(U,L),A=t.mul(A,B),B=t.add(I,D),A=t.sub(A,B),g=t.mul(b,E),B=t.mul(N,D),g=t.add(B,g),B=t.sub(I,g),g=t.add(I,g),$=t.mul(B,g),I=t.add(x,x),I=t.add(I,x),D=t.mul(b,D),E=t.mul(N,E),I=t.add(I,D),D=t.sub(x,D),D=t.mul(b,D),E=t.add(E,D),x=t.mul(I,E),$=t.add($,x),x=t.mul(A,E),B=t.mul(S,B),B=t.sub(B,x),x=t.mul(S,I),g=t.mul(A,g),g=t.add(g,x),new h(B,$,g)}subtract(m){return this.add(m.negate())}is0(){return this.equals(h.ZERO)}wNAF(m){return f.wNAFCached(this,l,m,v=>{const _=t.invertBatch(v.map(y=>y.pz));return v.map((y,C)=>y.toAffine(_[C])).map(h.fromAffine)})}multiplyUnsafe(m){const v=h.ZERO;if(m===Vs)return v;if(a(m),m===ln)return this;const{endo:_}=e;if(!_)return f.unsafeLadder(this,m);let{k1neg:y,k1:C,k2neg:U,k2:L}=_.splitScalar(m),B=v,$=v,g=this;for(;C>Vs||L>Vs;)C&ln&&(B=B.add(g)),L&ln&&($=$.add(g)),g=g.double(),C>>=ln,L>>=ln;return y&&(B=B.negate()),U&&($=$.negate()),$=new h(t.mul($.px,_.beta),$.py,$.pz),B.add($)}multiply(m){a(m);let v=m,_,y;const{endo:C}=e;if(C){const{k1neg:U,k1:L,k2neg:B,k2:$}=C.splitScalar(v);let{p:g,f:b}=this.wNAF(L),{p:N,f:x}=this.wNAF($);g=f.constTimeNegate(U,g),N=f.constTimeNegate(B,N),N=new h(t.mul(N.px,C.beta),N.py,N.pz),_=g.add(N),y=b.add(x)}else{const{p:U,f:L}=this.wNAF(v);_=U,y=L}return h.normalizeZ([_,y])[0]}multiplyAndAddUnsafe(m,v,_){const y=h.BASE,C=(L,B)=>B===Vs||B===ln||!L.equals(y)?L.multiplyUnsafe(B):L.multiply(B),U=C(this,v).add(C(m,_));return U.is0()?void 0:U}toAffine(m){const{px:v,py:_,pz:y}=this,C=this.is0();m==null&&(m=C?t.ONE:t.inv(y));const U=t.mul(v,m),L=t.mul(_,m),B=t.mul(y,m);if(C)return{x:t.ZERO,y:t.ZERO};if(!t.eql(B,t.ONE))throw new Error("invZ was invalid");return{x:U,y:L}}isTorsionFree(){const{h:m,isTorsionFree:v}=e;if(m===ln)return!0;if(v)return v(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:m,clearCofactor:v}=e;return m===ln?this:v?v(h,this):this.multiplyUnsafe(e.h)}toRawBytes(m=!0){return this.assertValidity(),n(h,this,m)}toHex(m=!0){return fl(this.toRawBytes(m))}}h.BASE=new h(e.Gx,e.Gy,t.ONE),h.ZERO=new h(t.ZERO,t.ONE,t.ZERO);const d=e.nBitLength,f=lj(h,e.endo?Math.ceil(d/2):d);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}function pj(r){const e=RC(r);return jh(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function gj(r){const e=pj(r),{Fp:t,n}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o(E){return Vs<E&&E<t.ORDER}function a(E){return _r(E,n)}function c(E){return Mm(E,n)}const{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:d}=fj({...e,toBytes(E,A,T){const O=A.toAffine(),k=t.toBytes(O.x),j=eh;return T?j(Uint8Array.from([A.hasEvenY()?2:3]),k):j(Uint8Array.from([4]),k,t.toBytes(O.y))},fromBytes(E){const A=E.length,T=E[0],O=E.subarray(1);if(A===s&&(T===2||T===3)){const k=Zo(O);if(!o(k))throw new Error("Point is not on curve");const j=h(k);let q=t.sqrt(j);const z=(q&ln)===ln;return(T&1)===1!==z&&(q=t.neg(q)),{x:k,y:q}}else if(A===i&&T===4){const k=t.fromBytes(O.subarray(0,t.BYTES)),j=t.fromBytes(O.subarray(t.BYTES,2*t.BYTES));return{x:k,y:j}}else throw new Error(`Point of length ${A} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),f=E=>fl(gl(E,e.nByteLength));function p(E){const A=n>>ln;return E>A}function m(E){return p(E)?a(-E):E}const v=(E,A,T)=>Zo(E.slice(A,T));class _{constructor(A,T,O){this.r=A,this.s=T,this.recovery=O,this.assertValidity()}static fromCompact(A){const T=e.nByteLength;return A=_n("compactSignature",A,T*2),new _(v(A,0,T),v(A,T,2*T))}static fromDER(A){const{r:T,s:O}=vo.toSig(_n("DER",A));return new _(T,O)}assertValidity(){if(!d(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!d(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(A){return new _(this.r,this.s,A)}recoverPublicKey(A){const{r:T,s:O,recovery:k}=this,j=$(_n("msgHash",A));if(k==null||![0,1,2,3].includes(k))throw new Error("recovery id invalid");const q=k===2||k===3?T+e.n:T;if(q>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const z=(k&1)===0?"02":"03",Q=l.fromHex(z+f(q)),J=c(q),Z=a(-j*J),te=a(O*J),re=l.BASE.multiplyAndAddUnsafe(Q,Z,te);if(!re)throw new Error("point at infinify");return re.assertValidity(),re}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new _(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return pl(this.toDERHex())}toDERHex(){return vo.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return pl(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const y={isValidPrivateKey(E){try{return u(E),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const E=SC(e.n);return aj(e.randomBytes(E),e.n)},precompute(E=8,A=l.BASE){return A._setWindowSize(E),A.multiply(BigInt(3)),A}};function C(E,A=!0){return l.fromPrivateKey(E).toRawBytes(A)}function U(E){const A=E instanceof Uint8Array,T=typeof E=="string",O=(A||T)&&E.length;return A?O===s||O===i:T?O===2*s||O===2*i:E instanceof l}function L(E,A,T=!0){if(U(E))throw new Error("first arg must be private key");if(!U(A))throw new Error("second arg must be public key");return l.fromHex(A).multiply(u(E)).toRawBytes(T)}const B=e.bits2int||function(E){const A=Zo(E),T=E.length*8-e.nBitLength;return T>0?A>>BigInt(T):A},$=e.bits2int_modN||function(E){return a(B(E))},g=Jy(e.nBitLength);function b(E){if(typeof E!="bigint")throw new Error("bigint expected");if(!(Vs<=E&&E<g))throw new Error(`bigint expected < 2^${e.nBitLength}`);return gl(E,e.nByteLength)}function N(E,A,T=x){if(["recovered","canonical"].some(ge=>ge in T))throw new Error("sign() legacy options not supported");const{hash:O,randomBytes:k}=e;let{lowS:j,prehash:q,extraEntropy:z}=T;j==null&&(j=!0),E=_n("msgHash",E),q&&(E=_n("prehashed msgHash",O(E)));const Q=$(E),J=u(A),Z=[b(J),b(Q)];if(z!=null){const ge=z===!0?k(t.BYTES):z;Z.push(_n("extraEntropy",ge))}const te=eh(...Z),re=Q;function pe(ge){const De=B(ge);if(!d(De))return;const xe=c(De),Se=l.BASE.multiply(De).toAffine(),fe=a(Se.x);if(fe===Vs)return;const ue=a(xe*a(re+fe*J));if(ue===Vs)return;let Ee=(Se.x===fe?0:2)|Number(Se.y&ln),Tr=ue;return j&&p(ue)&&(Tr=m(ue),Ee^=1),new _(fe,Tr,Ee)}return{seed:te,k2sig:pe}}const x={lowS:e.lowS,prehash:!1},I={lowS:e.lowS,prehash:!1};function D(E,A,T=x){const{seed:O,k2sig:k}=N(E,A,T),j=e;return PC(j.hash.outputLen,j.nByteLength,j.hmac)(O,k)}l.BASE._setWindowSize(8);function S(E,A,T,O=I){var Se;const k=E;if(A=_n("msgHash",A),T=_n("publicKey",T),"strict"in O)throw new Error("options.strict was renamed to lowS");const{lowS:j,prehash:q}=O;let z,Q;try{if(typeof k=="string"||k instanceof Uint8Array)try{z=_.fromDER(k)}catch(fe){if(!(fe instanceof vo.Err))throw fe;z=_.fromCompact(k)}else if(typeof k=="object"&&typeof k.r=="bigint"&&typeof k.s=="bigint"){const{r:fe,s:ue}=k;z=new _(fe,ue)}else throw new Error("PARSE");Q=l.fromHex(T)}catch(fe){if(fe.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(j&&z.hasHighS())return!1;q&&(A=e.hash(A));const{r:J,s:Z}=z,te=$(A),re=c(Z),pe=a(te*re),ge=a(J*re),De=(Se=l.BASE.multiplyAndAddUnsafe(Q,pe,ge))==null?void 0:Se.toAffine();return De?a(De.x)===J:!1}return{CURVE:e,getPublicKey:C,getSharedSecret:L,sign:D,verify:S,ProjectivePoint:l,Signature:_,utils:y}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function mj(r){return{hash:r,hmac:(e,...t)=>cC(r,e,n9(...t)),randomBytes:s9}}function yj(r,e){const t=n=>gj({...r,...mj(n)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const DC=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Jv=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),wj=BigInt(1),Fm=BigInt(2),Zv=(r,e)=>(r+e/Fm)/e;function bj(r){const e=DC,t=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=r*r*r%e,u=l*l*r%e,h=Qr(u,t,e)*u%e,d=Qr(h,t,e)*u%e,f=Qr(d,Fm,e)*l%e,p=Qr(f,s,e)*f%e,m=Qr(p,i,e)*p%e,v=Qr(m,a,e)*m%e,_=Qr(v,c,e)*v%e,y=Qr(_,a,e)*m%e,C=Qr(y,t,e)*u%e,U=Qr(C,o,e)*p%e,L=Qr(U,n,e)*l%e,B=Qr(L,Fm,e);if(!jm.eql(jm.sqr(B),r))throw new Error("Cannot find square root");return B}const jm=oj(DC,void 0,void 0,{sqrt:bj}),di=yj({a:BigInt(0),b:BigInt(7),Fp:jm,n:Jv,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{const e=Jv,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-wj*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,o=BigInt("0x100000000000000000000000000000000"),a=Zv(i*r,e),c=Zv(-n*r,e);let l=_r(r-a*t-c*s,e),u=_r(-a*n-c*i,e);const h=l>o,d=u>o;if(h&&(l=e-l),d&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:h,k1:l,k2neg:d,k2:u}}}},uC);BigInt(0);di.ProjectivePoint;const th="0x0000000000000000000000000000000000000000",Yv="0x0000000000000000000000000000000000000000000000000000000000000000",Xv=BigInt(0),eE=BigInt(1),tE=BigInt(2),rE=BigInt(27),nE=BigInt(28),yd=BigInt(35),Fa={};function sE(r){return ca(cr(r),32)}var vc,Ec,Ac,Ro;const En=class En{constructor(e,t,n,s){H(this,vc);H(this,Ec);H(this,Ac);H(this,Ro);Fh(e,Fa,"Signature"),R(this,vc,t),R(this,Ec,n),R(this,Ac,s),R(this,Ro,null)}get r(){return w(this,vc)}set r(e){M(ic(e)===32,"invalid r","value",e),R(this,vc,le(e))}get s(){return w(this,Ec)}set s(e){M(ic(e)===32,"invalid s","value",e);const t=le(e);M(parseInt(t.substring(0,3))<8,"non-canonical s","value",t),R(this,Ec,t)}get v(){return w(this,Ac)}set v(e){const t=Ne(e,"value");M(t===27||t===28,"invalid v","v",e),R(this,Ac,t)}get networkV(){return w(this,Ro)}get legacyChainId(){const e=this.networkV;return e==null?null:En.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=$e(this.s);return this.yParity&&(e[0]|=128),le(e)}get compactSerialized(){return bt([this.r,this.yParityAndS])}get serialized(){return bt([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this.s}", yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new En(Fa,this.r,this.s,this.v);return this.networkV&&R(e,Ro,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this.s,v:this.v}}static getChainId(e){const t=de(e,"v");return t==rE||t==nE?Xv:(M(t>=yd,"invalid EIP-155 v","v",e),(t-yd)/tE)}static getChainIdV(e,t){return de(e)*tE+BigInt(35+t-27)}static getNormalizedV(e){const t=de(e);return t===Xv||t===rE?27:t===eE||t===nE?28:(M(t>=yd,"invalid v","v",e),t&eE?27:28)}static from(e){function t(l,u){M(l,u,"signature",e)}if(e==null)return new En(Fa,Yv,Yv,27);if(typeof e=="string"){const l=$e(e,"signature");if(l.length===64){const u=le(l.slice(0,32)),h=l.slice(32,64),d=h[0]&128?28:27;return h[0]&=127,new En(Fa,u,le(h),d)}if(l.length===65){const u=le(l.slice(0,32)),h=l.slice(32,64);t((h[0]&128)===0,"non-canonical s");const d=En.getNormalizedV(l[64]);return new En(Fa,u,le(h),d)}t(!1,"invalid raw signature length")}if(e instanceof En)return e.clone();const n=e.r;t(n!=null,"missing r");const s=sE(n),i=function(l,u){if(l!=null)return sE(l);if(u!=null){t(tt(u,32),"invalid yParityAndS");const h=$e(u);return h[0]&=127,le(h)}t(!1,"missing s")}(e.s,e.yParityAndS);t(($e(i)[0]&128)==0,"non-canonical s");const{networkV:o,v:a}=function(l,u,h){if(l!=null){const d=de(l);return{networkV:d>=yd?d:void 0,v:En.getNormalizedV(d)}}if(u!=null)return t(tt(u,32),"invalid yParityAndS"),{v:$e(u)[0]&128?28:27};if(h!=null){switch(Ne(h,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),c=new En(Fa,s,i,a);return o&&R(c,Ro,o),t(e.yParity==null||Ne(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}};vc=new WeakMap,Ec=new WeakMap,Ac=new WeakMap,Ro=new WeakMap;let $n=En;var Us;const fo=class fo{constructor(e){H(this,Us);M(ic(e)===32,"invalid private key","privateKey","[REDACTED]"),R(this,Us,le(e))}get privateKey(){return w(this,Us)}get publicKey(){return fo.computePublicKey(w(this,Us))}get compressedPublicKey(){return fo.computePublicKey(w(this,Us),!0)}sign(e){M(ic(e)===32,"invalid digest length","digest",e);const t=di.sign(or(e),or(w(this,Us)),{lowS:!0});return $n.from({r:Gi(t.r,32),s:Gi(t.s,32),v:t.recovery?28:27})}computeSharedSecret(e){const t=fo.computePublicKey(e);return le(di.getSharedSecret(or(w(this,Us)),$e(t),!1))}static computePublicKey(e,t){let n=$e(e,"key");if(n.length===32){const i=di.getPublicKey(n,!!t);return le(i)}if(n.length===64){const i=new Uint8Array(65);i[0]=4,i.set(n,1),n=i}const s=di.ProjectivePoint.fromHex(n);return le(s.toRawBytes(t))}static recoverPublicKey(e,t){M(ic(e)===32,"invalid digest length","digest",e);const n=$n.from(t);let s=di.Signature.fromCompact(or(bt([n.r,n.s])));s=s.addRecoveryBit(n.yParity);const i=s.recoverPublicKey(or(e));return M(i!=null,"invalid signautre for digest","signature",t),"0x"+i.toHex(!1)}static addPoints(e,t,n){const s=di.ProjectivePoint.fromHex(fo.computePublicKey(e).substring(2)),i=di.ProjectivePoint.fromHex(fo.computePublicKey(t).substring(2));return"0x"+s.add(i).toHex(!!n)}};Us=new WeakMap;let rh=fo;const vj=BigInt(0),Ej=BigInt(36);function iE(r){r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const n=$e(At(t));for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(n[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const Zy={};for(let r=0;r<10;r++)Zy[String(r)]=String(r);for(let r=0;r<26;r++)Zy[String.fromCharCode(65+r)]=String(10+r);const oE=15;function Aj(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(n=>Zy[n]).join("");for(;e.length>=oE;){let n=e.substring(0,oE);e=parseInt(n,10)%97+e.substring(n.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const _j=function(){const r={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];r[t]=BigInt(e)}return r}();function Cj(r){r=r.toLowerCase();let e=vj;for(let t=0;t<r.length;t++)e=e*Ej+_j[r[t]];return e}function We(r){if(M(typeof r=="string","invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/)){r.startsWith("0x")||(r="0x"+r);const e=iE(r);return M(!r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===r,"bad address checksum","address",r),e}if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){M(r.substring(2,4)===Aj(r),"bad icap checksum","address",r);let e=Cj(r.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return iE("0x"+e)}M(!1,"invalid address","address",r)}function Ij(r){const e=We(r.from);let n=de(r.nonce,"tx.nonce").toString(16);return n==="0"?n="0x":n.length%2?n="0x0"+n:n="0x"+n,We(ft(At(la([e,n])),12))}function kC(r){return r&&typeof r.getAddress=="function"}async function gg(r,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(V(typeof r!="string","unconfigured name","UNCONFIGURED_NAME",{value:r}),M(!1,"invalid AddressLike value; did not resolve to a value address","target",r)),We(t)}function ur(r,e){if(typeof r=="string")return r.match(/^0x[0-9a-f]{40}$/i)?We(r):(V(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),gg(r,e.resolveName(r)));if(kC(r))return gg(r,r.getAddress());if(r&&typeof r.then=="function")return gg(r,r);M(!1,"unsupported addressable value","target",r)}const Ns={};function ce(r,e){let t=!1;return e<0&&(t=!0,e*=-1),new Yt(Ns,`${t?"":"u"}int${e}`,r,{signed:t,width:e})}function Fe(r,e){return new Yt(Ns,`bytes${e||""}`,r,{size:e})}const aE=Symbol.for("_ethers_typed");var Do;const xs=class xs{constructor(e,t,n,s){F(this,"type");F(this,"value");H(this,Do);F(this,"_typedSymbol");s==null&&(s=null),Fh(Ns,e,"Typed"),we(this,{_typedSymbol:aE,type:t,value:n}),R(this,Do,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return w(this,Do)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return w(this,Do)===!0?-1:w(this,Do)===!1?this.value.length:null}static from(e,t){return new xs(Ns,e,t)}static uint8(e){return ce(e,8)}static uint16(e){return ce(e,16)}static uint24(e){return ce(e,24)}static uint32(e){return ce(e,32)}static uint40(e){return ce(e,40)}static uint48(e){return ce(e,48)}static uint56(e){return ce(e,56)}static uint64(e){return ce(e,64)}static uint72(e){return ce(e,72)}static uint80(e){return ce(e,80)}static uint88(e){return ce(e,88)}static uint96(e){return ce(e,96)}static uint104(e){return ce(e,104)}static uint112(e){return ce(e,112)}static uint120(e){return ce(e,120)}static uint128(e){return ce(e,128)}static uint136(e){return ce(e,136)}static uint144(e){return ce(e,144)}static uint152(e){return ce(e,152)}static uint160(e){return ce(e,160)}static uint168(e){return ce(e,168)}static uint176(e){return ce(e,176)}static uint184(e){return ce(e,184)}static uint192(e){return ce(e,192)}static uint200(e){return ce(e,200)}static uint208(e){return ce(e,208)}static uint216(e){return ce(e,216)}static uint224(e){return ce(e,224)}static uint232(e){return ce(e,232)}static uint240(e){return ce(e,240)}static uint248(e){return ce(e,248)}static uint256(e){return ce(e,256)}static uint(e){return ce(e,256)}static int8(e){return ce(e,-8)}static int16(e){return ce(e,-16)}static int24(e){return ce(e,-24)}static int32(e){return ce(e,-32)}static int40(e){return ce(e,-40)}static int48(e){return ce(e,-48)}static int56(e){return ce(e,-56)}static int64(e){return ce(e,-64)}static int72(e){return ce(e,-72)}static int80(e){return ce(e,-80)}static int88(e){return ce(e,-88)}static int96(e){return ce(e,-96)}static int104(e){return ce(e,-104)}static int112(e){return ce(e,-112)}static int120(e){return ce(e,-120)}static int128(e){return ce(e,-128)}static int136(e){return ce(e,-136)}static int144(e){return ce(e,-144)}static int152(e){return ce(e,-152)}static int160(e){return ce(e,-160)}static int168(e){return ce(e,-168)}static int176(e){return ce(e,-176)}static int184(e){return ce(e,-184)}static int192(e){return ce(e,-192)}static int200(e){return ce(e,-200)}static int208(e){return ce(e,-208)}static int216(e){return ce(e,-216)}static int224(e){return ce(e,-224)}static int232(e){return ce(e,-232)}static int240(e){return ce(e,-240)}static int248(e){return ce(e,-248)}static int256(e){return ce(e,-256)}static int(e){return ce(e,-256)}static bytes1(e){return Fe(e,1)}static bytes2(e){return Fe(e,2)}static bytes3(e){return Fe(e,3)}static bytes4(e){return Fe(e,4)}static bytes5(e){return Fe(e,5)}static bytes6(e){return Fe(e,6)}static bytes7(e){return Fe(e,7)}static bytes8(e){return Fe(e,8)}static bytes9(e){return Fe(e,9)}static bytes10(e){return Fe(e,10)}static bytes11(e){return Fe(e,11)}static bytes12(e){return Fe(e,12)}static bytes13(e){return Fe(e,13)}static bytes14(e){return Fe(e,14)}static bytes15(e){return Fe(e,15)}static bytes16(e){return Fe(e,16)}static bytes17(e){return Fe(e,17)}static bytes18(e){return Fe(e,18)}static bytes19(e){return Fe(e,19)}static bytes20(e){return Fe(e,20)}static bytes21(e){return Fe(e,21)}static bytes22(e){return Fe(e,22)}static bytes23(e){return Fe(e,23)}static bytes24(e){return Fe(e,24)}static bytes25(e){return Fe(e,25)}static bytes26(e){return Fe(e,26)}static bytes27(e){return Fe(e,27)}static bytes28(e){return Fe(e,28)}static bytes29(e){return Fe(e,29)}static bytes30(e){return Fe(e,30)}static bytes31(e){return Fe(e,31)}static bytes32(e){return Fe(e,32)}static address(e){return new xs(Ns,"address",e)}static bool(e){return new xs(Ns,"bool",!!e)}static bytes(e){return new xs(Ns,"bytes",e)}static string(e){return new xs(Ns,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new xs(Ns,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===aE}static dereference(e,t){if(xs.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};Do=new WeakMap;let Yt=xs;class Nj extends ti{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let n=Yt.dereference(t,"string");try{n=We(n)}catch(s){return this._throwError(s.message,t)}return e.writeValue(n)}decode(e){return We(Gi(e.readValue(),20))}}class xj extends ti{constructor(t){super(t.name,t.type,"_",t.dynamic);F(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,n){return this.coder.encode(t,n)}decode(t){return this.coder.decode(t)}}function UC(r,e,t){let n=[];if(Array.isArray(t))n=t;else if(t&&typeof t=="object"){let c={};n=e.map(l=>{const u=l.localName;return V(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),V(!c[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),c[u]=!0,t[u]})}else M(!1,"invalid tuple value","tuple",t);M(e.length===n.length,"types/value length mismatch","tuple",t);let s=new km,i=new km,o=[];e.forEach((c,l)=>{let u=n[l];if(c.dynamic){let h=i.length;c.encode(i,u);let d=s.writeUpdatableValue();o.push(f=>{d(f+h)})}else c.encode(s,u)}),o.forEach(c=>{c(s.length)});let a=r.appendWriter(s);return a+=r.appendWriter(i),a}function BC(r,e){let t=[],n=[],s=r.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let a=r.readIndex(),c=s.subReader(a);try{o=i.decode(c)}catch(l){if(qt(l,"BUFFER_OVERRUN"))throw l;o=l,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(r)}catch(a){if(qt(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");t.push(o),n.push(i.localName||null)}),hl.fromItems(t,n)}class Pj extends ti{constructor(t,n,s){const i=t.type+"["+(n>=0?n:"")+"]",o=n===-1||t.dynamic;super("array",i,s,o);F(this,"coder");F(this,"length");we(this,{coder:t,length:n})}defaultValue(){const t=this.coder.defaultValue(),n=[];for(let s=0;s<this.length;s++)n.push(t);return n}encode(t,n){const s=Yt.dereference(n,"array");Array.isArray(s)||this._throwError("expected array value",s);let i=this.length;i===-1&&(i=s.length,t.writeValue(s.length)),q_(s.length,i,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let a=0;a<s.length;a++)o.push(this.coder);return UC(t,o,s)}decode(t){let n=this.length;n===-1&&(n=t.readIndex(),V(n*lr<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:n*lr,length:t.dataLength}));let s=[];for(let i=0;i<n;i++)s.push(new xj(this.coder));return BC(t,s)}}class Tj extends ti{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const n=Yt.dereference(t,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class $C extends ti{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=or(t);let n=e.writeValue(t.length);return n+=e.writeBytes(t),n}decode(e){return e.readBytes(e.readIndex(),!0)}}class Oj extends $C{constructor(e){super("bytes",e)}decode(e){return le(super.decode(e))}}class Sj extends ti{constructor(t,n){let s="bytes"+String(t);super(s,s,n,!1);F(this,"size");we(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,n){let s=or(Yt.dereference(n,this.type));return s.length!==this.size&&this._throwError("incorrect data length",n),t.writeBytes(s)}decode(t){return le(t.readBytes(this.size))}}const Rj=new Uint8Array([]);class Dj extends ti{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(Rj)}decode(e){return e.readBytes(0),null}}const kj=BigInt(0),Uj=BigInt(1),Bj=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class $j extends ti{constructor(t,n,s){const i=(n?"int":"uint")+t*8;super(i,i,s,!1);F(this,"size");F(this,"signed");we(this,{size:t,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,n){let s=de(Yt.dereference(n,this.type)),i=bo(Bj,lr*8);if(this.signed){let o=bo(i,this.size*8-1);(s>o||s<-(o+Uj))&&this._throwError("value out-of-bounds",n),s=G_(s,8*lr)}else(s<kj||s>bo(i,this.size*8))&&this._throwError("value out-of-bounds",n);return t.writeValue(s)}decode(t){let n=bo(t.readValue(),this.size*8);return this.signed&&(n=ff(n,this.size*8)),n}}class Lj extends $C{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,ds(Yt.dereference(t,"string")))}decode(e){return pf(super.decode(e))}}class wd extends ti{constructor(t,n){let s=!1;const i=[];t.forEach(a=>{a.dynamic&&(s=!0),i.push(a.type)});const o="tuple("+i.join(",")+")";super("tuple",o,n,s);F(this,"coders");we(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(s=>{t.push(s.defaultValue())});const n=this.coders.reduce((s,i)=>{const o=i.localName;return o&&(s[o]||(s[o]=0),s[o]++),s},{});return this.coders.forEach((s,i)=>{let o=s.localName;!o||n[o]!==1||(o==="length"&&(o="_length"),t[o]==null&&(t[o]=t[i]))}),Object.freeze(t)}encode(t,n){const s=Yt.dereference(n,"tuple");return UC(t,this.coders,s)}decode(t){return BC(t,this.coders)}}function ua(r){return At(ds(r))}var Mj="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const cE=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),lE=4;function Fj(r){let e=0;function t(){return r[e++]<<8|r[e++]}let n=t(),s=1,i=[0,1];for(let L=1;L<n;L++)i.push(s+=t());let o=t(),a=e;e+=o;let c=0,l=0;function u(){return c==0&&(l=l<<8|r[e++],c=8),l>>--c&1}const h=31,d=2**h,f=d>>>1,p=f>>1,m=d-1;let v=0;for(let L=0;L<h;L++)v=v<<1|u();let _=[],y=0,C=d;for(;;){let L=Math.floor(((v-y+1)*s-1)/C),B=0,$=n;for(;$-B>1;){let N=B+$>>>1;L<i[N]?$=N:B=N}if(B==0)break;_.push(B);let g=y+Math.floor(C*i[B]/s),b=y+Math.floor(C*i[B+1]/s)-1;for(;((g^b)&f)==0;)v=v<<1&m|u(),g=g<<1&m,b=b<<1&m|1;for(;g&~b&p;)v=v&f|v<<1&m>>>1|u(),g=g<<1^f,b=(b^f)<<1|f|1;y=g,C=1+b-g}let U=n-4;return _.map(L=>{switch(L-U){case 3:return U+65792+(r[a++]<<16|r[a++]<<8|r[a++]);case 2:return U+256+(r[a++]<<8|r[a++]);case 1:return U+r[a++];default:return L-1}})}function jj(r){let e=0;return()=>r[e++]}function LC(r){return jj(Fj(Hj(r)))}function Hj(r){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,i)=>e[s.charCodeAt(0)]=i);let t=r.length,n=new Uint8Array(6*t>>3);for(let s=0,i=0,o=0,a=0;s<t;s++)a=a<<6|e[r.charCodeAt(s)],o+=6,o>=8&&(n[i++]=a>>(o-=8));return n}function qj(r){return r&1?~r>>1:r>>1}function zj(r,e){let t=Array(r);for(let n=0,s=0;n<r;n++)t[n]=s+=qj(e());return t}function nh(r,e=0){let t=[];for(;;){let n=r(),s=r();if(!s)break;e+=n;for(let i=0;i<s;i++)t.push(e+i);e+=s+1}return t}function MC(r){return sh(()=>{let e=nh(r);if(e.length)return e})}function FC(r){let e=[];for(;;){let t=r();if(t==0)break;e.push(Vj(t,r))}for(;;){let t=r()-1;if(t<0)break;e.push(Gj(t,r))}return e.flat()}function sh(r){let e=[];for(;;){let t=r(e.length);if(!t)break;e.push(t)}return e}function jC(r,e,t){let n=Array(r).fill().map(()=>[]);for(let s=0;s<e;s++)zj(r,t).forEach((i,o)=>n[o].push(i));return n}function Vj(r,e){let t=1+e(),n=e(),s=sh(e);return jC(s.length,1+r,e).flatMap((o,a)=>{let[c,...l]=o;return Array(s[a]).fill().map((u,h)=>{let d=h*n;return[c+h*t,l.map(f=>f+d)]})})}function Gj(r,e){let t=1+e();return jC(t,1+r,e).map(s=>[s[0],s.slice(1)])}function Kj(r){let e=[],t=nh(r);return s(n([]),[]),e;function n(i){let o=r(),a=sh(()=>{let c=nh(r).map(l=>t[l]);if(c.length)return n(c)});return{S:o,B:a,Q:i}}function s({S:i,B:o},a,c){if(!(i&4&&c===a[a.length-1])){i&2&&(c=a[a.length-1]),i&1&&e.push(a);for(let l of o)for(let u of l.Q)s(l,[...a,u],c)}}}function Wj(r){return r.toString(16).toUpperCase().padStart(2,"0")}function HC(r){return`{${Wj(r)}}`}function Qj(r){let e=[];for(let t=0,n=r.length;t<n;){let s=r.codePointAt(t);t+=s<65536?1:2,e.push(s)}return e}function ml(r){let t=r.length;if(t<4096)return String.fromCodePoint(...r);let n=[];for(let s=0;s<t;)n.push(String.fromCodePoint(...r.slice(s,s+=4096)));return n.join("")}function Jj(r,e){let t=r.length,n=t-e.length;for(let s=0;n==0&&s<t;s++)n=r[s]-e[s];return n}var Zj="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const ih=44032,yf=4352,wf=4449,bf=4519,qC=19,zC=21,yl=28,vf=zC*yl,Yj=qC*vf,Xj=ih+Yj,e7=yf+qC,t7=wf+zC,r7=bf+yl;function Xl(r){return r>>24&255}function VC(r){return r&16777215}let Hm,uE,qm,Md;function n7(){let r=LC(Zj);Hm=new Map(MC(r).flatMap((e,t)=>e.map(n=>[n,t+1<<24]))),uE=new Set(nh(r)),qm=new Map,Md=new Map;for(let[e,t]of FC(r)){if(!uE.has(e)&&t.length==2){let[n,s]=t,i=Md.get(n);i||(i=new Map,Md.set(n,i)),i.set(s,e)}qm.set(e,t.reverse())}}function GC(r){return r>=ih&&r<Xj}function s7(r,e){if(r>=yf&&r<e7&&e>=wf&&e<t7)return ih+(r-yf)*vf+(e-wf)*yl;if(GC(r)&&e>bf&&e<r7&&(r-ih)%yl==0)return r+(e-bf);{let t=Md.get(r);return t&&(t=t.get(e),t)?t:-1}}function KC(r){Hm||n7();let e=[],t=[],n=!1;function s(i){let o=Hm.get(i);o&&(n=!0,i|=o),e.push(i)}for(let i of r)for(;;){if(i<128)e.push(i);else if(GC(i)){let o=i-ih,a=o/vf|0,c=o%vf/yl|0,l=o%yl;s(yf+a),s(wf+c),l>0&&s(bf+l)}else{let o=qm.get(i);o?t.push(...o):s(i)}if(!t.length)break;i=t.pop()}if(n&&e.length>1){let i=Xl(e[0]);for(let o=1;o<e.length;o++){let a=Xl(e[o]);if(a==0||i<=a){i=a;continue}let c=o-1;for(;;){let l=e[c+1];if(e[c+1]=e[c],e[c]=l,!c||(i=Xl(e[--c]),i<=a))break}i=Xl(e[o])}}return e}function i7(r){let e=[],t=[],n=-1,s=0;for(let i of r){let o=Xl(i),a=VC(i);if(n==-1)o==0?n=a:e.push(a);else if(s>0&&s>=o)o==0?(e.push(n,...t),t.length=0,n=a):t.push(a),s=o;else{let c=s7(n,a);c>=0?n=c:s==0&&o==0?(e.push(n),n=a):(t.push(a),s=o)}}return n>=0&&e.push(n,...t),e}function WC(r){return KC(r).map(VC)}function o7(r){return i7(KC(r))}const hE=45,QC=".",JC=65039,ZC=1,Ef=r=>Array.from(r);function oh(r,e){return r.P.has(e)||r.Q.has(e)}class a7 extends Array{get is_emoji(){return!0}}let zm,YC,Eo,Vm,XC,ac,mg,Ga,so,dE,Gm;function Yy(){if(zm)return;let r=LC(Mj);const e=()=>nh(r),t=()=>new Set(e()),n=(u,h)=>h.forEach(d=>u.add(d));zm=new Map(FC(r)),YC=t(),Eo=e(),Vm=new Set(e().map(u=>Eo[u])),Eo=new Set(Eo),XC=t(),t();let s=MC(r),i=r();const o=()=>{let u=new Set;return e().forEach(h=>n(u,s[h])),n(u,e()),u};ac=sh(u=>{let h=sh(r).map(d=>d+96);if(h.length){let d=u>=i;h[0]-=32,h=ml(h),d&&(h=`Restricted[${h}]`);let f=o(),p=o(),m=!r();return{N:h,P:f,Q:p,M:m,R:d}}}),mg=t(),Ga=new Map;let a=e().concat(Ef(mg)).sort((u,h)=>u-h);a.forEach((u,h)=>{let d=r(),f=a[h]=d?a[h-d]:{V:[],M:new Map};f.V.push(u),mg.has(u)||Ga.set(u,f)});for(let{V:u,M:h}of new Set(Ga.values())){let d=[];for(let p of u){let m=ac.filter(_=>oh(_,p)),v=d.find(({G:_})=>m.some(y=>_.has(y)));v||(v={G:new Set,V:[]},d.push(v)),v.V.push(p),n(v.G,m)}let f=d.flatMap(p=>Ef(p.G));for(let{G:p,V:m}of d){let v=new Set(f.filter(_=>!p.has(_)));for(let _ of m)h.set(_,v)}}so=new Set;let c=new Set;const l=u=>so.has(u)?c.add(u):so.add(u);for(let u of ac){for(let h of u.P)l(h);for(let h of u.Q)l(h)}for(let u of so)!Ga.has(u)&&!c.has(u)&&Ga.set(u,ZC);n(so,WC(so)),dE=Kj(r).map(u=>a7.from(u)).sort(Jj),Gm=new Map;for(let u of dE){let h=[Gm];for(let d of u){let f=h.map(p=>{let m=p.get(d);return m||(m=new Map,p.set(d,m)),m});d===JC?h.push(...f):h=f}for(let d of h)d.V=u}}function Xy(r){return(eI(r)?"":`${ew(lp([r]))} `)+HC(r)}function ew(r){return`"${r}"`}function c7(r){if(r.length>=4&&r[2]==hE&&r[3]==hE)throw new Error(`invalid label extension: "${ml(r.slice(0,4))}"`)}function l7(r){for(let t=r.lastIndexOf(95);t>0;)if(r[--t]!==95)throw new Error("underscore allowed only at start")}function u7(r){let e=r[0],t=cE.get(e);if(t)throw hu(`leading ${t}`);let n=r.length,s=-1;for(let i=1;i<n;i++){e=r[i];let o=cE.get(e);if(o){if(s==i)throw hu(`${t} + ${o}`);s=i+1,t=o}}if(s==n)throw hu(`trailing ${t}`)}function lp(r,e=1/0,t=HC){let n=[];h7(r[0])&&n.push(""),r.length>e&&(e>>=1,r=[...r.slice(0,e),8230,...r.slice(-e)]);let s=0,i=r.length;for(let o=0;o<i;o++){let a=r[o];eI(a)&&(n.push(ml(r.slice(s,o))),n.push(t(a)),s=o+1)}return n.push(ml(r.slice(s,i))),n.join("")}function h7(r){return Yy(),Eo.has(r)}function eI(r){return Yy(),XC.has(r)}function d7(r){return m7(f7(r,o7,b7))}function f7(r,e,t){if(!r)return[];Yy();let n=0;return r.split(QC).map(s=>{let i=Qj(s),o={input:i,offset:n};n+=i.length+1;try{let a=o.tokens=w7(i,e,t),c=a.length,l;if(!c)throw new Error("empty label");let u=o.output=a.flat();if(l7(u),!(o.emoji=c>1||a[0].is_emoji)&&u.every(d=>d<128))c7(u),l="ASCII";else{let d=a.flatMap(f=>f.is_emoji?[]:f);if(!d.length)l="Emoji";else{if(Eo.has(u[0]))throw hu("leading combining mark");for(let m=1;m<c;m++){let v=a[m];if(!v.is_emoji&&Eo.has(v[0]))throw hu(`emoji + combining mark: "${ml(a[m-1])} + ${lp([v[0]])}"`)}u7(u);let f=Ef(new Set(d)),[p]=g7(f);y7(p,d),p7(p,f),l=p.N}}o.type=l}catch(a){o.error=a}return o})}function p7(r,e){let t,n=[];for(let s of e){let i=Ga.get(s);if(i===ZC)return;if(i){let o=i.M.get(s);if(t=t?t.filter(a=>o.has(a)):Ef(o),!t.length)return}else n.push(s)}if(t){for(let s of t)if(n.every(i=>oh(s,i)))throw new Error(`whole-script confusable: ${r.N}/${s.N}`)}}function g7(r){let e=ac;for(let t of r){let n=e.filter(s=>oh(s,t));if(!n.length)throw ac.some(s=>oh(s,t))?rI(e[0],t):tI(t);if(e=n,n.length==1)break}return e}function m7(r){return r.map(({input:e,error:t,output:n})=>{if(t){let s=t.message;throw new Error(r.length==1?s:`Invalid label ${ew(lp(e,63))}: ${s}`)}return ml(n)}).join(QC)}function tI(r){return new Error(`disallowed character: ${Xy(r)}`)}function rI(r,e){let t=Xy(e),n=ac.find(s=>s.P.has(e));return n&&(t=`${n.N} ${t}`),new Error(`illegal mixture: ${r.N} + ${t}`)}function hu(r){return new Error(`illegal placement: ${r}`)}function y7(r,e){for(let t of e)if(!oh(r,t))throw rI(r,t);if(r.M){let t=WC(e);for(let n=1,s=t.length;n<s;n++)if(Vm.has(t[n])){let i=n+1;for(let o;i<s&&Vm.has(o=t[i]);i++)for(let a=n;a<i;a++)if(t[a]==o)throw new Error(`duplicate non-spacing marks: ${Xy(o)}`);if(i-n>lE)throw new Error(`excessive non-spacing marks: ${ew(lp(t.slice(n-1,i)))} (${i-n}/${lE})`);n=i}}}function w7(r,e,t){let n=[],s=[];for(r=r.slice().reverse();r.length;){let i=v7(r);if(i)s.length&&(n.push(e(s)),s=[]),n.push(t(i));else{let o=r.pop();if(so.has(o))s.push(o);else{let a=zm.get(o);if(a)s.push(...a);else if(!YC.has(o))throw tI(o)}}}return s.length&&n.push(e(s)),n}function b7(r){return r.filter(e=>e!=JC)}function v7(r,e){let t=Gm,n,s=r.length;for(;s&&(t=t.get(r[--s]),!!t);){let{V:i}=t;i&&(n=i,r.length=s)}return n}const nI=new Uint8Array(32);nI.fill(0);function fE(r){return M(r.length!==0,"invalid ENS name; empty component","comp",r),r}function sI(r){const e=ds(E7(r)),t=[];if(r.length===0)return t;let n=0;for(let s=0;s<e.length;s++)e[s]===46&&(t.push(fE(e.slice(n,s))),n=s+1);return M(n<e.length,"invalid ENS name; empty component","name",r),t.push(fE(e.slice(n))),t}function E7(r){try{if(r.length===0)throw new Error("empty label");return d7(r)}catch(e){M(!1,`invalid ENS name (${e.message})`,"name",r)}}function Km(r){M(typeof r=="string","invalid ENS name; not a string","name",r),M(r.length,"invalid ENS name (empty label)","name",r);let e=nI;const t=sI(r);for(;t.length;)e=At(bt([e,At(t.pop())]));return le(e)}function A7(r,e){const t=e;return M(t<=255,"DNS encoded label cannot exceed 255","length",t),le(bt(sI(r).map(n=>{M(n.length<=t,`label ${JSON.stringify(r)} exceeds ${t} bytes`,"name",r);const s=new Uint8Array(n.length+1);return s.set(n,1),s[0]=s.length-1,s})))+"00"}function yg(r,e){return{address:We(r),storageKeys:e.map((t,n)=>(M(tt(t,32),"invalid slot",`storageKeys[${n}]`,t),t.toLowerCase()))}}function va(r){if(Array.isArray(r))return r.map((t,n)=>Array.isArray(t)?(M(t.length===2,"invalid slot set",`value[${n}]`,t),yg(t[0],t[1])):(M(t!=null&&typeof t=="object","invalid address-slot set","value",r),yg(t.address,t.storageKeys)));M(r!=null&&typeof r=="object","invalid access list","value",r);const e=Object.keys(r).map(t=>{const n=r[t].reduce((s,i)=>(s[i]=!0,s),{});return yg(t,Object.keys(n).sort())});return e.sort((t,n)=>t.address.localeCompare(n.address)),e}function _7(r){let e;return typeof r=="string"?e=rh.computePublicKey(r,!1):e=r.publicKey,We(At("0x"+e.substring(4)).substring(26))}function C7(r,e){return _7(rh.recoverPublicKey(r,e))}const Ot=BigInt(0),I7=BigInt(2),N7=BigInt(27),x7=BigInt(28),P7=BigInt(35),T7=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),wg=4096*32;function pE(r,e){let t=r.toString(16);for(;t.length<2;)t="0"+t;return t+=xl(e).substring(4),"0x"+t}function up(r){return r==="0x"?null:We(r)}function tw(r,e){try{return va(r)}catch(t){M(!1,t.message,e,r)}}function Hh(r,e){return r==="0x"?0:Ne(r,e)}function wt(r,e){if(r==="0x")return Ot;const t=de(r,e);return M(t<=T7,"value exceeds uint size",e,t),t}function ot(r,e){const t=de(r,"value"),n=cr(t);return M(n.length<=32,"value too large",`tx.${e}`,t),n}function rw(r){return va(r).map(e=>[e.address,e.storageKeys])}function O7(r,e){M(Array.isArray(r),`invalid ${e}`,"value",r);for(let t=0;t<r.length;t++)M(tt(r[t],32),"invalid ${ param } hash",`value[${t}]`,r[t]);return r}function S7(r){const e=ip(r);M(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",r);const t={type:0,nonce:Hh(e[0],"nonce"),gasPrice:wt(e[1],"gasPrice"),gasLimit:wt(e[2],"gasLimit"),to:up(e[3]),value:wt(e[4],"value"),data:le(e[5]),chainId:Ot};if(e.length===6)return t;const n=wt(e[6],"v"),s=wt(e[7],"r"),i=wt(e[8],"s");if(s===Ot&&i===Ot)t.chainId=n;else{let o=(n-P7)/I7;o<Ot&&(o=Ot),t.chainId=o,M(o!==Ot||n===N7||n===x7,"non-canonical legacy v","v",e[6]),t.signature=$n.from({r:ca(e[7],32),s:ca(e[8],32),v:n})}return t}function R7(r,e){const t=[ot(r.nonce,"nonce"),ot(r.gasPrice||0,"gasPrice"),ot(r.gasLimit,"gasLimit"),r.to||"0x",ot(r.value,"value"),r.data];let n=Ot;if(r.chainId!=Ot)n=de(r.chainId,"tx.chainId"),M(!e||e.networkV==null||e.legacyChainId===n,"tx.chainId/sig.v mismatch","sig",e);else if(r.signature){const i=r.signature.legacyChainId;i!=null&&(n=i)}if(!e)return n!==Ot&&(t.push(cr(n)),t.push("0x"),t.push("0x")),la(t);let s=BigInt(27+e.yParity);return n!==Ot?s=$n.getChainIdV(n,e.v):BigInt(e.v)!==s&&M(!1,"tx.chainId/sig.v mismatch","sig",e),t.push(cr(s)),t.push(cr(e.r)),t.push(cr(e.s)),la(t)}function nw(r,e){let t;try{if(t=Hh(e[0],"yParity"),t!==0&&t!==1)throw new Error("bad yParity")}catch{M(!1,"invalid yParity","yParity",e[0])}const n=ca(e[1],32),s=ca(e[2],32),i=$n.from({r:n,s,yParity:t});r.signature=i}function D7(r){const e=ip($e(r).slice(1));M(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",le(r));const t={type:2,chainId:wt(e[0],"chainId"),nonce:Hh(e[1],"nonce"),maxPriorityFeePerGas:wt(e[2],"maxPriorityFeePerGas"),maxFeePerGas:wt(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:wt(e[4],"gasLimit"),to:up(e[5]),value:wt(e[6],"value"),data:le(e[7]),accessList:tw(e[8],"accessList")};return e.length===9||nw(t,e.slice(9)),t}function k7(r,e){const t=[ot(r.chainId,"chainId"),ot(r.nonce,"nonce"),ot(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ot(r.maxFeePerGas||0,"maxFeePerGas"),ot(r.gasLimit,"gasLimit"),r.to||"0x",ot(r.value,"value"),r.data,rw(r.accessList||[])];return e&&(t.push(ot(e.yParity,"yParity")),t.push(cr(e.r)),t.push(cr(e.s))),bt(["0x02",la(t)])}function U7(r){const e=ip($e(r).slice(1));M(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",le(r));const t={type:1,chainId:wt(e[0],"chainId"),nonce:Hh(e[1],"nonce"),gasPrice:wt(e[2],"gasPrice"),gasLimit:wt(e[3],"gasLimit"),to:up(e[4]),value:wt(e[5],"value"),data:le(e[6]),accessList:tw(e[7],"accessList")};return e.length===8||nw(t,e.slice(8)),t}function B7(r,e){const t=[ot(r.chainId,"chainId"),ot(r.nonce,"nonce"),ot(r.gasPrice||0,"gasPrice"),ot(r.gasLimit,"gasLimit"),r.to||"0x",ot(r.value,"value"),r.data,rw(r.accessList||[])];return e&&(t.push(ot(e.yParity,"recoveryParam")),t.push(cr(e.r)),t.push(cr(e.s))),bt(["0x01",la(t)])}function $7(r){let e=ip($e(r).slice(1)),t="3",n=null;if(e.length===4&&Array.isArray(e[0])){t="3 (network format)";const i=e[1],o=e[2],a=e[3];M(Array.isArray(i),"invalid network format: blobs not an array","fields[1]",i),M(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),M(Array.isArray(a),"invalid network format: proofs not an array","fields[3]",a),M(i.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),M(i.length===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),n=[];for(let c=0;c<e[1].length;c++)n.push({data:i[c],commitment:o[c],proof:a[c]});e=e[0]}M(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${t}`,"data",le(r));const s={type:3,chainId:wt(e[0],"chainId"),nonce:Hh(e[1],"nonce"),maxPriorityFeePerGas:wt(e[2],"maxPriorityFeePerGas"),maxFeePerGas:wt(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:wt(e[4],"gasLimit"),to:up(e[5]),value:wt(e[6],"value"),data:le(e[7]),accessList:tw(e[8],"accessList"),maxFeePerBlobGas:wt(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};n&&(s.blobs=n),M(s.to!=null,`invalid address for transaction type: ${t}`,"data",r),M(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",r);for(let i=0;i<s.blobVersionedHashes.length;i++)M(tt(s.blobVersionedHashes[i],32),`invalid blobVersionedHash at index ${i}: must be length 32`,"data",r);return e.length===11||nw(s,e.slice(11)),s}function L7(r,e,t){const n=[ot(r.chainId,"chainId"),ot(r.nonce,"nonce"),ot(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ot(r.maxFeePerGas||0,"maxFeePerGas"),ot(r.gasLimit,"gasLimit"),r.to||th,ot(r.value,"value"),r.data,rw(r.accessList||[]),ot(r.maxFeePerBlobGas||0,"maxFeePerBlobGas"),O7(r.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(n.push(ot(e.yParity,"yParity")),n.push(cr(e.r)),n.push(cr(e.s)),t)?bt(["0x03",la([n,t.map(s=>s.data),t.map(s=>s.commitment),t.map(s=>s.proof)])]):bt(["0x03",la(n)])}var Xn,_c,Cc,Ic,Nc,xc,Pc,Tc,Oc,Sc,Rc,Dc,ko,vi,Bs,Ei,kc,Fd;const Ps=class Ps{constructor(){H(this,kc);H(this,Xn);H(this,_c);H(this,Cc);H(this,Ic);H(this,Nc);H(this,xc);H(this,Pc);H(this,Tc);H(this,Oc);H(this,Sc);H(this,Rc);H(this,Dc);H(this,ko);H(this,vi);H(this,Bs);H(this,Ei);R(this,Xn,null),R(this,_c,null),R(this,Ic,0),R(this,Nc,Ot),R(this,xc,null),R(this,Pc,null),R(this,Tc,null),R(this,Cc,"0x"),R(this,Oc,Ot),R(this,Sc,Ot),R(this,Rc,null),R(this,Dc,null),R(this,ko,null),R(this,vi,null),R(this,Ei,null),R(this,Bs,null)}get type(){return w(this,Xn)}set type(e){switch(e){case null:R(this,Xn,null);break;case 0:case"legacy":R(this,Xn,0);break;case 1:case"berlin":case"eip-2930":R(this,Xn,1);break;case 2:case"london":case"eip-1559":R(this,Xn,2);break;case 3:case"cancun":case"eip-4844":R(this,Xn,3);break;default:M(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844"}return null}get to(){const e=w(this,_c);return e==null&&this.type===3?th:e}set to(e){R(this,_c,e==null?null:We(e))}get nonce(){return w(this,Ic)}set nonce(e){R(this,Ic,Ne(e,"value"))}get gasLimit(){return w(this,Nc)}set gasLimit(e){R(this,Nc,de(e))}get gasPrice(){const e=w(this,xc);return e==null&&(this.type===0||this.type===1)?Ot:e}set gasPrice(e){R(this,xc,e==null?null:de(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=w(this,Pc);return e??(this.type===2||this.type===3?Ot:null)}set maxPriorityFeePerGas(e){R(this,Pc,e==null?null:de(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=w(this,Tc);return e??(this.type===2||this.type===3?Ot:null)}set maxFeePerGas(e){R(this,Tc,e==null?null:de(e,"maxFeePerGas"))}get data(){return w(this,Cc)}set data(e){R(this,Cc,le(e))}get value(){return w(this,Oc)}set value(e){R(this,Oc,de(e,"value"))}get chainId(){return w(this,Sc)}set chainId(e){R(this,Sc,de(e))}get signature(){return w(this,Rc)||null}set signature(e){R(this,Rc,e==null?null:$n.from(e))}get accessList(){const e=w(this,Dc)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){R(this,Dc,e==null?null:va(e))}get maxFeePerBlobGas(){const e=w(this,ko);return e==null&&this.type===3?Ot:e}set maxFeePerBlobGas(e){R(this,ko,e==null?null:de(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=w(this,vi);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){M(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)M(tt(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}R(this,vi,e)}get blobs(){return w(this,Ei)==null?null:w(this,Ei).map(e=>Object.assign({},e))}set blobs(e){if(e==null){R(this,Ei,null);return}const t=[],n=[];for(let s=0;s<e.length;s++){const i=e[s];if(Hy(i)){V(w(this,Bs),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=$e(i);if(M(o.length<=wg,"blob is too large",`blobs[${s}]`,i),o.length!==wg){const l=new Uint8Array(wg);l.set(o),o=l}const a=w(this,Bs).blobToKzgCommitment(o),c=le(w(this,Bs).computeBlobKzgProof(o,a));t.push({data:le(o),commitment:le(a),proof:c}),n.push(pE(1,a))}else{const o=le(i.commitment);t.push({data:le(i.data),commitment:o,proof:le(i.proof)}),n.push(pE(1,o))}}R(this,Ei,t),R(this,vi,n)}get kzg(){return w(this,Bs)}set kzg(e){R(this,Bs,e)}get hash(){return this.signature==null?null:At(W(this,kc,Fd).call(this,!0,!1))}get unsignedHash(){return At(this.unsignedSerialized)}get from(){return this.signature==null?null:C7(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:rh.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return W(this,kc,Fd).call(this,!0,!0)}get unsignedSerialized(){return W(this,kc,Fd).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,t=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,n=this.accessList!=null,s=w(this,ko)!=null||w(this,vi);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&V(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),V(!t||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),V(this.type!==0||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):t?i.push(2):e?(i.push(1),n||i.push(0)):n?(i.push(1),i.push(2)):(s&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return Ps.from(this)}toJSON(){const e=t=>t==null?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new Ps;if(typeof e=="string"){const n=$e(e);if(n[0]>=127)return Ps.from(S7(n));switch(n[0]){case 1:return Ps.from(U7(n));case 2:return Ps.from(D7(n));case 3:return Ps.from($7(n))}V(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const t=new Ps;return e.type!=null&&(t.type=e.type),e.to!=null&&(t.to=e.to),e.nonce!=null&&(t.nonce=e.nonce),e.gasLimit!=null&&(t.gasLimit=e.gasLimit),e.gasPrice!=null&&(t.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(t.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(t.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(t.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(t.data=e.data),e.value!=null&&(t.value=e.value),e.chainId!=null&&(t.chainId=e.chainId),e.signature!=null&&(t.signature=$n.from(e.signature)),e.accessList!=null&&(t.accessList=e.accessList),e.blobVersionedHashes!=null&&(t.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(t.kzg=e.kzg),e.blobs!=null&&(t.blobs=e.blobs),e.hash!=null&&(M(t.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),M(t.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(M(t.isSigned(),"unsigned transaction cannot define '.from'","tx",e),M(t.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),t}};Xn=new WeakMap,_c=new WeakMap,Cc=new WeakMap,Ic=new WeakMap,Nc=new WeakMap,xc=new WeakMap,Pc=new WeakMap,Tc=new WeakMap,Oc=new WeakMap,Sc=new WeakMap,Rc=new WeakMap,Dc=new WeakMap,ko=new WeakMap,vi=new WeakMap,Bs=new WeakMap,Ei=new WeakMap,kc=new WeakSet,Fd=function(e,t){V(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=e?this.signature:null;switch(this.inferType()){case 0:return R7(this,n);case 1:return B7(this,n);case 2:return k7(this,n);case 3:return L7(this,n,t?this.blobs:null)}V(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let Af=Ps;const iI=new Uint8Array(32);iI.fill(0);const M7=BigInt(-1),oI=BigInt(0),aI=BigInt(1),F7=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function j7(r){const e=$e(r),t=e.length%32;return t?bt([e,iI.slice(t)]):le(e)}const H7=Gi(aI,32),q7=Gi(oI,32),gE={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},bg=["name","version","chainId","verifyingContract","salt"];function mE(r){return function(e){return M(typeof e=="string",`invalid domain value for ${JSON.stringify(r)}`,`domain.${r}`,e),e}}const z7={name:mE("name"),version:mE("version"),chainId:function(r){const e=de(r,"domain.chainId");return M(e>=0,"invalid chain ID","domain.chainId",r),Number.isSafeInteger(e)?Number(e):Ya(e)},verifyingContract:function(r){try{return We(r).toLowerCase()}catch{}M(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",r)},salt:function(r){const e=$e(r,"domain.salt");return M(e.length===32,'invalid domain value "salt"',"domain.salt",r),le(e)}};function vg(r){{const e=r.match(/^(u?)int(\d+)$/);if(e){const t=e[1]==="",n=parseInt(e[2]);M(n%8===0&&n!==0&&n<=256&&e[2]===String(n),"invalid numeric width","type",r);const s=bo(F7,t?n-1:n),i=t?(s+aI)*M7:oI;return function(o){const a=de(o,"value");return M(a>=i&&a<=s,`value out-of-bounds for ${r}`,"value",a),Gi(t?G_(a,256):a,32)}}}{const e=r.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return M(t!==0&&t<=32&&e[1]===String(t),"invalid bytes width","type",r),function(n){const s=$e(n);return M(s.length===t,`invalid length for ${r}`,"value",n),j7(n)}}}switch(r){case"address":return function(e){return ca(We(e),32)};case"bool":return function(e){return e?H7:q7};case"bytes":return function(e){return At(e)};case"string":return function(e){return ua(e)}}return null}function yE(r,e){return`${r}(${e.map(({name:t,type:n})=>n+" "+t).join(",")})`}function bd(r){const e=r.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:r}}var fh,$s,Uc,Tf,cI;const tn=class tn{constructor(e){H(this,Tf);F(this,"primaryType");H(this,fh);H(this,$s);H(this,Uc);R(this,$s,new Map),R(this,Uc,new Map);const t=new Map,n=new Map,s=new Map,i={};Object.keys(e).forEach(c=>{i[c]=e[c].map(({name:l,type:u})=>{let{base:h,index:d}=bd(u);return h==="int"&&!e.int&&(h="int256"),h==="uint"&&!e.uint&&(h="uint256"),{name:l,type:h+(d||"")}}),t.set(c,new Set),n.set(c,[]),s.set(c,new Set)}),R(this,fh,JSON.stringify(i));for(const c in i){const l=new Set;for(const u of i[c]){M(!l.has(u.name),`duplicate variable name ${JSON.stringify(u.name)} in ${JSON.stringify(c)}`,"types",e),l.add(u.name);const h=bd(u.type).base;M(h!==c,`circular type reference to ${JSON.stringify(h)}`,"types",e),!vg(h)&&(M(n.has(h),`unknown type ${JSON.stringify(h)}`,"types",e),n.get(h).push(c),t.get(c).add(h))}}const o=Array.from(n.keys()).filter(c=>n.get(c).length===0);M(o.length!==0,"missing primary type","types",e),M(o.length===1,`ambiguous primary types or unused types: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"types",e),we(this,{primaryType:o[0]});function a(c,l){M(!l.has(c),`circular type reference to ${JSON.stringify(c)}`,"types",e),l.add(c);for(const u of t.get(c))if(n.has(u)){a(u,l);for(const h of l)s.get(h).add(u)}l.delete(c)}a(this.primaryType,new Set);for(const[c,l]of s){const u=Array.from(l);u.sort(),w(this,$s).set(c,yE(c,i[c])+u.map(h=>yE(h,i[h])).join(""))}}get types(){return JSON.parse(w(this,fh))}getEncoder(e){let t=w(this,Uc).get(e);return t||(t=W(this,Tf,cI).call(this,e),w(this,Uc).set(e,t)),t}encodeType(e){const t=w(this,$s).get(e);return M(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return At(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,n){if(vg(e))return n(e,t);const s=bd(e).array;if(s)return M(s.count===-1||s.count===t.length,`array length mismatch; expected length ${s.count}`,"value",t),t.map(o=>this._visit(s.prefix,o,n));const i=this.types[e];if(i)return i.reduce((o,{name:a,type:c})=>(o[a]=this._visit(c,t[a],n),o),{});M(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new tn(e)}static getPrimaryType(e){return tn.from(e).primaryType}static hashStruct(e,t,n){return tn.from(t).hashStruct(e,n)}static hashDomain(e){const t=[];for(const n in e){if(e[n]==null)continue;const s=gE[n];M(s,`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",e),t.push({name:n,type:s})}return t.sort((n,s)=>bg.indexOf(n.name)-bg.indexOf(s.name)),tn.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,n){return bt(["0x1901",tn.hashDomain(e),tn.from(t).hash(n)])}static hash(e,t,n){return At(tn.encode(e,t,n))}static async resolveNames(e,t,n,s){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const i={};e.verifyingContract&&!tt(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const o=tn.from(t);o.visit(n,(a,c)=>(a==="address"&&!tt(c,20)&&(i[c]="0x"),c));for(const a in i)i[a]=await s(a);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),n=o.visit(n,(a,c)=>a==="address"&&i[c]?i[c]:c),{domain:e,value:n}}static getPayload(e,t,n){tn.hashDomain(e);const s={},i=[];bg.forEach(c=>{const l=e[c];l!=null&&(s[c]=z7[c](l),i.push({name:c,type:gE[c]}))});const o=tn.from(t);t=o.types;const a=Object.assign({},t);return M(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",t),a.EIP712Domain=i,o.encode(n),{types:a,domain:s,primaryType:o.primaryType,message:o.visit(n,(c,l)=>{if(c.match(/^bytes(\d*)/))return le($e(l));if(c.match(/^u?int/))return de(l).toString();switch(c){case"address":return l.toLowerCase();case"bool":return!!l;case"string":return M(typeof l=="string","invalid string","value",l),l}M(!1,"unsupported type","type",c)})}}};fh=new WeakMap,$s=new WeakMap,Uc=new WeakMap,Tf=new WeakSet,cI=function(e){{const s=vg(e);if(s)return s}const t=bd(e).array;if(t){const s=t.prefix,i=this.getEncoder(s);return o=>{M(t.count===-1||t.count===o.length,`array length mismatch; expected length ${t.count}`,"value",o);let a=o.map(i);return w(this,$s).has(s)&&(a=a.map(At)),At(bt(a))}}const n=this.types[e];if(n){const s=ua(w(this,$s).get(e));return i=>{const o=n.map(({name:a,type:c})=>{const l=this.getEncoder(c)(i[a]);return w(this,$s).has(c)?At(l):l});return o.unshift(s),bt(o)}}M(!1,`unknown type: ${e}`,"type",e)};let _f=tn;function hr(r){const e=new Set;return r.forEach(t=>e.add(t)),Object.freeze(e)}const V7="external public payable override",G7=hr(V7.split(" ")),lI="constant external internal payable private public pure view override",K7=hr(lI.split(" ")),uI="constructor error event fallback function receive struct",hI=hr(uI.split(" ")),dI="calldata memory storage payable indexed",W7=hr(dI.split(" ")),Q7="tuple returns",J7=[uI,dI,Q7,lI].join(" "),Z7=hr(J7.split(" ")),Y7={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},X7=new RegExp("^(\\s*)"),eH=new RegExp("^([0-9]+)"),tH=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),fI=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),pI=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var Ft,xn,ph,Wm;const Of=class Of{constructor(e){H(this,ph);H(this,Ft);H(this,xn);R(this,Ft,0),R(this,xn,e.slice())}get offset(){return w(this,Ft)}get length(){return w(this,xn).length-w(this,Ft)}clone(){return new Of(w(this,xn))}reset(){R(this,Ft,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=W(this,ph,Wm).call(this,w(this,Ft)+1,e.match+1);return R(this,Ft,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;w(this,Ft)<e.match-1;){const n=this.peek().linkNext;t.push(W(this,ph,Wm).call(this,w(this,Ft)+1,n)),R(this,Ft,n)}return R(this,Ft,e.match+1),t}peek(){if(w(this,Ft)>=w(this,xn).length)throw new Error("out-of-bounds");return w(this,xn)[w(this,Ft)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return Pl(this,Ft)._++,e}toString(){const e=[];for(let t=w(this,Ft);t<w(this,xn).length;t++){const n=w(this,xn)[t];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}};Ft=new WeakMap,xn=new WeakMap,ph=new WeakSet,Wm=function(e=0,t=0){return new Of(w(this,xn).slice(e,t).map(n=>Object.freeze(Object.assign({},n,{match:n.match-e,linkBack:n.linkBack-e,linkNext:n.linkNext-e}))))};let Ln=Of;function Qi(r){const e=[],t=o=>{const a=i<r.length?JSON.stringify(r[i]):"$EOI";throw new Error(`invalid token ${a} at ${i}: ${o}`)};let n=[],s=[],i=0;for(;i<r.length;){let o=r.substring(i),a=o.match(X7);a&&(i+=a[1].length,o=r.substring(i));const c={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(c);let l=Y7[o[0]]||"";if(l){if(c.type=l,c.text=o[0],i++,l==="OPEN_PAREN")n.push(e.length-1),s.push(e.length-1);else if(l=="CLOSE_PAREN")n.length===0&&t("no matching open bracket"),c.match=n.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1;else if(l==="COMMA")c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(l==="OPEN_BRACKET")c.type="BRACKET";else if(l==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const h=e.pop().text;u=h+u,e[e.length-1].value=Ne(h)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(a=o.match(tH),a){if(c.text=a[1],i+=c.text.length,Z7.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(pI)){c.type="TYPE";continue}c.type="ID";continue}if(a=o.match(eH),a){c.text=a[1],c.type="NUMBER",i+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new Ln(e.map(o=>Object.freeze(o)))}function wE(r,e){let t=[];for(const n in e.keys())r.has(n)&&t.push(n);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function hp(r,e){if(e.peekKeyword(hI)){const t=e.pop().text;if(t!==r)throw new Error(`expected ${r}, got ${t}`)}return e.popType("ID")}function ei(r,e){const t=new Set;for(;;){const n=r.peekType("KEYWORD");if(n==null||e&&!e.has(n))break;if(r.pop(),t.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);t.add(n)}return Object.freeze(t)}function gI(r){let e=ei(r,K7);return wE(e,hr("constant payable nonpayable".split(" "))),wE(e,hr("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function Js(r,e){return r.popParams().map(t=>zt.from(t,e))}function mI(r){if(r.peekType("AT")){if(r.pop(),r.peekType("NUMBER"))return de(r.pop().text);throw new Error("invalid gas")}return null}function ha(r){if(r.length)throw new Error(`unexpected tokens at offset ${r.offset}: ${r.toString()}`)}const rH=new RegExp(/^(.*)\[([0-9]*)\]$/);function bE(r){const e=r.match(pI);if(M(e,"invalid type","type",r),r==="uint")return"uint256";if(r==="int")return"int256";if(e[2]){const t=parseInt(e[2]);M(t!==0&&t<=32,"invalid bytes length","type",r)}else if(e[3]){const t=parseInt(e[3]);M(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",r)}return r}const ht={},Nr=Symbol.for("_ethers_internal"),vE="_ParamTypeInternal",EE="_ErrorInternal",AE="_EventInternal",_E="_ConstructorInternal",CE="_FallbackInternal",IE="_FunctionInternal",NE="_StructInternal";var Bc,jd;const rn=class rn{constructor(e,t,n,s,i,o,a,c){H(this,Bc);F(this,"name");F(this,"type");F(this,"baseType");F(this,"indexed");F(this,"components");F(this,"arrayLength");F(this,"arrayChildren");if(Fh(e,ht,"ParamType"),Object.defineProperty(this,Nr,{value:vE}),o&&(o=Object.freeze(o.slice())),s==="array"){if(a==null||c==null)throw new Error("")}else if(a!=null||c!=null)throw new Error("");if(s==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");we(this,{name:t,type:n,baseType:s,indexed:i,components:o,arrayLength:a,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const n=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=n,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(n=>n.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(s=>n.arrayChildren.walk(s,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((s,i)=>n.components[i].walk(s,t))}return t(this.type,e)}async walkAsync(e,t){const n=[],s=[e];return W(this,Bc,jd).call(this,n,e,t,i=>{s[0]=i}),n.length&&await Promise.all(n),s[0]}static from(e,t){if(rn.isParamType(e))return e;if(typeof e=="string")try{return rn.from(Qi(e),t)}catch{M(!1,"invalid param type","obj",e)}else if(e instanceof Ln){let a="",c="",l=null;ei(e,hr(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",l=e.popParams().map(m=>rn.from(m)),a=`tuple(${l.map(m=>m.format()).join(",")})`):(a=bE(e.popType("TYPE")),c=a);let u=null,h=null;for(;e.length&&e.peekType("BRACKET");){const m=e.pop();u=new rn(ht,"",a,c,null,l,h,u),h=m.value,a+=m.text,c="array",l=null}let d=null;if(ei(e,W7).has("indexed")){if(!t)throw new Error("");d=!0}const p=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new rn(ht,p,a,c,d,l,h,u)}const n=e.name;M(!n||typeof n=="string"&&n.match(fI),"invalid name","obj.name",n);let s=e.indexed;s!=null&&(M(t,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let i=e.type,o=i.match(rH);if(o){const a=parseInt(o[2]||"-1"),c=rn.from({type:o[1],components:e.components});return new rn(ht,n||"",i,"array",s,null,a,c)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const a=e.components!=null?e.components.map(l=>rn.from(l)):null;return new rn(ht,n||"",i,"tuple",s,a,null,null)}return i=bE(e.type),new rn(ht,n||"",i,i,s,null,null,null)}static isParamType(e){return e&&e[Nr]===vE}};Bc=new WeakSet,jd=function(e,t,n,s){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=t.slice();a.forEach((c,l)=>{var u;W(u=o,Bc,jd).call(u,e,c,n,h=>{a[l]=h})}),s(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(t))a=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");a=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in t))throw new Error(`missing value for component ${c.name}`);return t[c.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((c,l)=>{var u;W(u=o[l],Bc,jd).call(u,e,c,n,h=>{a[l]=h})}),s(a);return}const i=n(this.type,t);i.then?e.push(async function(){s(await i)}()):s(i)};let zt=rn;class da{constructor(e,t,n){F(this,"type");F(this,"inputs");Fh(e,ht,"Fragment"),n=Object.freeze(n.slice()),we(this,{type:t,inputs:n})}static from(e){if(typeof e=="string"){try{da.from(JSON.parse(e))}catch{}return da.from(Qi(e))}if(e instanceof Ln)switch(e.peekKeyword(hI)){case"constructor":return Gs.from(e);case"error":return Cr.from(e);case"event":return ls.from(e);case"fallback":case"receive":return Ss.from(e);case"function":return us.from(e);case"struct":return Yo.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return Gs.from(e);case"error":return Cr.from(e);case"event":return ls.from(e);case"fallback":case"receive":return Ss.from(e);case"function":return us.from(e);case"struct":return Yo.from(e)}V(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}M(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return Gs.isFragment(e)}static isError(e){return Cr.isFragment(e)}static isEvent(e){return ls.isFragment(e)}static isFunction(e){return us.isFragment(e)}static isStruct(e){return Yo.isFragment(e)}}class dp extends da{constructor(t,n,s,i){super(t,n,i);F(this,"name");M(typeof s=="string"&&s.match(fI),"invalid identifier","name",s),i=Object.freeze(i.slice()),we(this,{name:s})}}function ah(r,e){return"("+e.map(t=>t.format(r)).join(r==="full"?", ":",")+")"}class Cr extends dp{constructor(e,t,n){super(e,"error",t,n),Object.defineProperty(this,Nr,{value:EE})}get selector(){return ua(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+ah(e,this.inputs)),t.join(" ")}static from(e){if(Cr.isFragment(e))return e;if(typeof e=="string")return Cr.from(Qi(e));if(e instanceof Ln){const t=hp("error",e),n=Js(e);return ha(e),new Cr(ht,t,n)}return new Cr(ht,e.name,e.inputs?e.inputs.map(zt.from):[])}static isFragment(e){return e&&e[Nr]===EE}}class ls extends dp{constructor(t,n,s,i){super(t,"event",n,s);F(this,"anonymous");Object.defineProperty(this,Nr,{value:AE}),we(this,{anonymous:i})}get topicHash(){return ua(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("event"),n.push(this.name+ah(t,this.inputs)),t!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(t,n){return n=(n||[]).map(i=>zt.from(i)),new ls(ht,t,n,!1).topicHash}static from(t){if(ls.isFragment(t))return t;if(typeof t=="string")try{return ls.from(Qi(t))}catch{M(!1,"invalid event fragment","obj",t)}else if(t instanceof Ln){const n=hp("event",t),s=Js(t,!0),i=!!ei(t,hr(["anonymous"])).has("anonymous");return ha(t),new ls(ht,n,s,i)}return new ls(ht,t.name,t.inputs?t.inputs.map(n=>zt.from(n,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[Nr]===AE}}class Gs extends da{constructor(t,n,s,i,o){super(t,n,s);F(this,"payable");F(this,"gas");Object.defineProperty(this,Nr,{value:_E}),we(this,{payable:i,gas:o})}format(t){if(V(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[`constructor${ah(t,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(t){if(Gs.isFragment(t))return t;if(typeof t=="string")try{return Gs.from(Qi(t))}catch{M(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof Ln){ei(t,hr(["constructor"]));const n=Js(t),s=!!ei(t,G7).has("payable"),i=mI(t);return ha(t),new Gs(ht,"constructor",n,s,i)}return new Gs(ht,"constructor",t.inputs?t.inputs.map(zt.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Nr]===_E}}class Ss extends da{constructor(t,n,s){super(t,"fallback",n);F(this,"payable");Object.defineProperty(this,Nr,{value:CE}),we(this,{payable:s})}format(t){const n=this.inputs.length===0?"receive":"fallback";if(t==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:s})}return`${n}()${this.payable?" payable":""}`}static from(t){if(Ss.isFragment(t))return t;if(typeof t=="string")try{return Ss.from(Qi(t))}catch{M(!1,"invalid fallback fragment","obj",t)}else if(t instanceof Ln){const n=t.toString(),s=t.peekKeyword(hr(["fallback","receive"]));if(M(s,"type must be fallback or receive","obj",n),t.popKeyword(hr(["fallback","receive"]))==="receive"){const c=Js(t);return M(c.length===0,"receive cannot have arguments","obj.inputs",c),ei(t,hr(["payable"])),ha(t),new Ss(ht,[],!0)}let o=Js(t);o.length?M(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(c=>c.format("minimal")).join(", ")):o=[zt.from("bytes")];const a=gI(t);if(M(a==="nonpayable"||a==="payable","fallback cannot be constants","obj.stateMutability",a),ei(t,hr(["returns"])).has("returns")){const c=Js(t);M(c.length===1&&c[0].type==="bytes","invalid fallback outputs","obj.outputs",c.map(l=>l.format("minimal")).join(", "))}return ha(t),new Ss(ht,o,a==="payable")}if(t.type==="receive")return new Ss(ht,[],!0);if(t.type==="fallback"){const n=[zt.from("bytes")],s=t.stateMutability==="payable";return new Ss(ht,n,s)}M(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[Nr]===CE}}class us extends dp{constructor(t,n,s,i,o,a){super(t,"function",n,i);F(this,"constant");F(this,"outputs");F(this,"stateMutability");F(this,"payable");F(this,"gas");Object.defineProperty(this,Nr,{value:IE}),o=Object.freeze(o.slice()),we(this,{constant:s==="view"||s==="pure",gas:a,outputs:o,payable:s==="payable",stateMutability:s})}get selector(){return ua(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t))),outputs:this.outputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("function"),n.push(this.name+ah(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(ah(t,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(t,n){return n=(n||[]).map(i=>zt.from(i)),new us(ht,t,"view",n,[],null).selector}static from(t){if(us.isFragment(t))return t;if(typeof t=="string")try{return us.from(Qi(t))}catch{M(!1,"invalid function fragment","obj",t)}else if(t instanceof Ln){const s=hp("function",t),i=Js(t),o=gI(t);let a=[];ei(t,hr(["returns"])).has("returns")&&(a=Js(t));const c=mI(t);return ha(t),new us(ht,s,o,i,a,c)}let n=t.stateMutability;return n==null&&(n="payable",typeof t.constant=="boolean"?(n="view",t.constant||(n="payable",typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable")),new us(ht,t.name,n,t.inputs?t.inputs.map(zt.from):[],t.outputs?t.outputs.map(zt.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Nr]===IE}}class Yo extends dp{constructor(e,t,n){super(e,"struct",t,n),Object.defineProperty(this,Nr,{value:NE})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Yo.from(Qi(e))}catch{M(!1,"invalid struct fragment","obj",e)}else if(e instanceof Ln){const t=hp("struct",e),n=Js(e);return ha(e),new Yo(ht,t,n)}return new Yo(ht,e.name,e.inputs?e.inputs.map(zt.from):[])}static isFragment(e){return e&&e[Nr]===NE}}const jn=new Map;jn.set(0,"GENERIC_PANIC");jn.set(1,"ASSERT_FALSE");jn.set(17,"OVERFLOW");jn.set(18,"DIVIDE_BY_ZERO");jn.set(33,"ENUM_RANGE_ERROR");jn.set(34,"BAD_STORAGE_DATA");jn.set(49,"STACK_UNDERFLOW");jn.set(50,"ARRAY_RANGE_ERROR");jn.set(65,"OUT_OF_MEMORY");jn.set(81,"UNINITIALIZED_FUNCTION_CALL");const nH=new RegExp(/^bytes([0-9]*)$/),sH=new RegExp(/^(u?int)([0-9]*)$/);let Eg=null,xE=1024;function iH(r,e,t,n){let s="missing revert data",i=null;const o=null;let a=null;if(t){s="execution reverted";const l=$e(t);if(t=le(t),l.length===0)s+=" (no data present; likely require(false) occurred",i="require(false)";else if(l.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(le(l.slice(0,4))==="0x08c379a0")try{i=n.decode(["string"],l.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[i]},s+=`: ${JSON.stringify(i)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(le(l.slice(0,4))==="0x4e487b71")try{const u=Number(n.decode(["uint256"],l.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[u]},i=`Panic due to ${jn.get(u)||"UNKNOWN"}(${u})`,s+=`: ${i}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const c={to:e.to?We(e.to):null,data:e.data||"0x"};return e.from&&(c.from=We(e.from)),ct(s,"CALL_EXCEPTION",{action:r,data:t,reason:i,transaction:c,invocation:o,revert:a})}var Ai,Ka;const Sf=class Sf{constructor(){H(this,Ai)}getDefaultValue(e){const t=e.map(s=>W(this,Ai,Ka).call(this,zt.from(s)));return new wd(t,"_").defaultValue()}encode(e,t){q_(t.length,e.length,"types/values length mismatch");const n=e.map(o=>W(this,Ai,Ka).call(this,zt.from(o))),s=new wd(n,"_"),i=new km;return s.encode(i,t),i.data}decode(e,t,n){const s=e.map(o=>W(this,Ai,Ka).call(this,zt.from(o)));return new wd(s,"_").decode(new Um(t,n,xE))}static _setDefaultMaxInflation(e){M(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),xE=e}static defaultAbiCoder(){return Eg==null&&(Eg=new Sf),Eg}static getBuiltinCallException(e,t,n){return iH(e,t,n,Sf.defaultAbiCoder())}};Ai=new WeakSet,Ka=function(e){if(e.isArray())return new Pj(W(this,Ai,Ka).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new wd(e.components.map(n=>W(this,Ai,Ka).call(this,n)),e.name);switch(e.baseType){case"address":return new Nj(e.name);case"bool":return new Tj(e.name);case"string":return new Lj(e.name);case"bytes":return new Oj(e.name);case"":return new Dj(e.name)}let t=e.type.match(sH);if(t){let n=parseInt(t[2]||"256");return M(n!==0&&n<=256&&n%8===0,"invalid "+t[1]+" bit length","param",e),new $j(n/8,t[1]==="int",e.name)}if(t=e.type.match(nH),t){let n=parseInt(t[1]);return M(n!==0&&n<=32,"invalid bytes length","param",e),new Sj(n,e.name)}M(!1,"invalid type","type",e.type)};let ch=Sf;class oH{constructor(e,t,n){F(this,"fragment");F(this,"name");F(this,"signature");F(this,"topic");F(this,"args");const s=e.name,i=e.format();we(this,{fragment:e,name:s,signature:i,topic:t,args:n})}}class aH{constructor(e,t,n,s){F(this,"fragment");F(this,"name");F(this,"args");F(this,"signature");F(this,"selector");F(this,"value");const i=e.name,o=e.format();we(this,{fragment:e,name:i,args:n,signature:o,selector:t,value:s})}}class cH{constructor(e,t,n){F(this,"fragment");F(this,"name");F(this,"args");F(this,"signature");F(this,"selector");const s=e.name,i=e.format();we(this,{fragment:e,name:s,args:n,signature:i,selector:t})}}class PE{constructor(e){F(this,"hash");F(this,"_isIndexed");we(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const TE={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},OE={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:r=>`reverted with reason string ${JSON.stringify(r)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:r=>{let e="unknown panic code";return r>=0&&r<=255&&TE[r.toString()]&&(e=TE[r.toString()]),`reverted with panic code 0x${r.toString(16)} (${e})`}}};var es,ts,rs,Qt,fs,Hd,qd;const po=class po{constructor(e){H(this,fs);F(this,"fragments");F(this,"deploy");F(this,"fallback");F(this,"receive");H(this,es);H(this,ts);H(this,rs);H(this,Qt);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,R(this,rs,new Map),R(this,es,new Map),R(this,ts,new Map);const n=[];for(const o of t)try{n.push(da.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}we(this,{fragments:Object.freeze(n)});let s=null,i=!1;R(this,Qt,this.getAbiCoder()),this.fragments.forEach((o,a)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}we(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(M(!s||o.payable!==s.payable,"conflicting fallback fragments",`fragments[${a}]`,o),s=o,i=s.payable);return;case"function":c=w(this,rs);break;case"event":c=w(this,ts);break;case"error":c=w(this,es);break;default:return}const l=o.format();c.has(l)||c.set(l,o)}),this.deploy||we(this,{deploy:Gs.from("constructor()")}),we(this,{fallback:s,receive:i})}format(e){const t=e?"minimal":"full";return this.fragments.map(s=>s.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return ch.defaultAbiCoder()}getFunctionName(e){const t=W(this,fs,Hd).call(this,e,null,!1);return M(t,"no matching function","key",e),t.name}hasFunction(e){return!!W(this,fs,Hd).call(this,e,null,!1)}getFunction(e,t){return W(this,fs,Hd).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(w(this,rs).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(w(this,rs).get(s),n)}}getEventName(e){const t=W(this,fs,qd).call(this,e,null,!1);return M(t,"no matching event","key",e),t.name}hasEvent(e){return!!W(this,fs,qd).call(this,e,null,!1)}getEvent(e,t){return W(this,fs,qd).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(w(this,ts).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(w(this,ts).get(s),n)}}getError(e,t){if(tt(e)){const s=e.toLowerCase();if(OE[s])return Cr.from(OE[s].signature);for(const i of w(this,es).values())if(s===i.selector)return i;return null}if(e.indexOf("(")===-1){const s=[];for(const[i,o]of w(this,es))i.split("(")[0]===e&&s.push(o);if(s.length===0)return e==="Error"?Cr.from("error Error(string)"):e==="Panic"?Cr.from("error Panic(uint256)"):null;if(s.length>1){const i=s.map(o=>JSON.stringify(o.format())).join(", ");M(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return s[0]}if(e=Cr.from(e).format(),e==="Error(string)")return Cr.from("error Error(string)");if(e==="Panic(uint256)")return Cr.from("error Panic(uint256)");const n=w(this,es).get(e);return n||null}forEachError(e){const t=Array.from(w(this,es).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(w(this,es).get(s),n)}}_decodeParams(e,t){return w(this,Qt).decode(e,t)}_encodeParams(e,t){return w(this,Qt).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);M(n,"unknown error","fragment",e),e=n}return M(ft(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,ft(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);M(n,"unknown error","fragment",e),e=n}return bt([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);M(n,"unknown function","fragment",e),e=n}return M(ft(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,ft(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);M(n,"unknown function","fragment",e),e=n}return bt([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const i=this.getFunction(e);M(i,"unknown function","fragment",e),e=i}let n="invalid length for result data";const s=or(t);if(s.length%32===0)try{return w(this,Qt).decode(e.outputs,s)}catch{n="could not decode result data"}V(!1,n,"BAD_DATA",{value:le(s),info:{method:e.name,signature:e.format()}})}makeError(e,t){const n=$e(e,"data"),s=ch.getBuiltinCallException("call",t,n);if(s.message.startsWith("execution reverted (unknown custom error)")){const a=le(n.slice(0,4)),c=this.getError(a);if(c)try{const l=w(this,Qt).decode(c.inputs,n.slice(4));s.revert={name:c.name,signature:c.format(),args:l},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(t);return o&&(s.invocation={method:o.name,signature:o.signature,args:o.args}),s}encodeFunctionResult(e,t){if(typeof e=="string"){const n=this.getFunction(e);M(n,"unknown function","fragment",e),e=n}return le(w(this,Qt).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const i=this.getEvent(e);M(i,"unknown event","eventFragment",e),e=i}V(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const s=(i,o)=>i.type==="string"?ua(o):i.type==="bytes"?At(le(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=Gi(o):i.type.match(/^bytes/)?o=TF(o,32):i.type==="address"&&w(this,Qt).encode(["address"],[o]),ca(le(o),32));for(t.forEach((i,o)=>{const a=e.inputs[o];if(!a.indexed){M(i==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,i);return}i==null?n.push(null):a.baseType==="array"||a.baseType==="tuple"?M(!1,"filtering with tuples or arrays not supported","contract."+a.name,i):Array.isArray(i)?n.push(i.map(c=>s(a,c))):n.push(s(a,i))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,t){if(typeof e=="string"){const o=this.getEvent(e);M(o,"unknown event","eventFragment",e),e=o}const n=[],s=[],i=[];return e.anonymous||n.push(e.topicHash),M(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((o,a)=>{const c=t[a];if(o.indexed)if(o.type==="string")n.push(ua(c));else if(o.type==="bytes")n.push(At(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");n.push(w(this,Qt).encode([o.type],[c]))}else s.push(o),i.push(c)}),{data:w(this,Qt).encode(s,i),topics:n}}decodeEventLog(e,t,n){if(typeof e=="string"){const f=this.getEvent(e);M(f,"unknown event","eventFragment",e),e=f}if(n!=null&&!e.anonymous){const f=e.topicHash;M(tt(n[0],32)&&n[0].toLowerCase()===f,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const s=[],i=[],o=[];e.inputs.forEach((f,p)=>{f.indexed?f.type==="string"||f.type==="bytes"||f.baseType==="tuple"||f.baseType==="array"?(s.push(zt.from({type:"bytes32",name:f.name})),o.push(!0)):(s.push(f),o.push(!1)):(i.push(f),o.push(!1))});const a=n!=null?w(this,Qt).decode(s,bt(n)):null,c=w(this,Qt).decode(i,t,!0),l=[],u=[];let h=0,d=0;return e.inputs.forEach((f,p)=>{let m=null;if(f.indexed)if(a==null)m=new PE(null);else if(o[p])m=new PE(a[d++]);else try{m=a[d++]}catch(v){m=v}else try{m=c[h++]}catch(v){m=v}l.push(m),u.push(f.name||null)}),hl.fromItems(l,u)}parseTransaction(e){const t=$e(e.data,"tx.data"),n=de(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(le(t.slice(0,4)));if(!s)return null;const i=w(this,Qt).decode(s.inputs,t.slice(4));return new aH(s,s.selector,i,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new oH(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=le(e),n=this.getError(ft(t,0,4));if(!n)return null;const s=w(this,Qt).decode(n.inputs,ft(t,4));return new cH(n,n.selector,s)}static from(e){return e instanceof po?e:typeof e=="string"?new po(JSON.parse(e)):typeof e.formatJson=="function"?new po(e.formatJson()):typeof e.format=="function"?new po(e.format("json")):new po(e)}};es=new WeakMap,ts=new WeakMap,rs=new WeakMap,Qt=new WeakMap,fs=new WeakSet,Hd=function(e,t,n){if(tt(e)){const i=e.toLowerCase();for(const o of w(this,rs).values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of w(this,rs))o.split("(")[0]===e&&i.push(a);if(t){const o=t.length>0?t[t.length-1]:null;let a=t.length,c=!0;Yt.isTyped(o)&&o.type==="overrides"&&(c=!1,a--);for(let l=i.length-1;l>=0;l--){const u=i[l].inputs.length;u!==a&&(!c||u!==a-1)&&i.splice(l,1)}for(let l=i.length-1;l>=0;l--){const u=i[l].inputs;for(let h=0;h<t.length;h++)if(Yt.isTyped(t[h])){if(h>=u.length){if(t[h].type==="overrides")continue;i.splice(l,1);break}if(t[h].type!==u[h].baseType){i.splice(l,1);break}}}}if(i.length===1&&t&&t.length!==i[0].inputs.length){const o=t[t.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");M(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const s=w(this,rs).get(us.from(e).format());return s||null},qd=function(e,t,n){if(tt(e)){const i=e.toLowerCase();for(const o of w(this,ts).values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of w(this,ts))o.split("(")[0]===e&&i.push(a);if(t){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<t.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const a=i[o].inputs;for(let c=0;c<t.length;c++)if(Yt.isTyped(t[c])&&t[c].type!==a[c].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");M(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const s=w(this,ts).get(ls.from(e).format());return s||null};let Qm=po;const yI=BigInt(0);function cc(r){return r??null}function pt(r){return r==null?null:r.toString()}class SE{constructor(e,t,n){F(this,"gasPrice");F(this,"maxFeePerGas");F(this,"maxPriorityFeePerGas");we(this,{gasPrice:cc(e),maxFeePerGas:cc(t),maxPriorityFeePerGas:cc(n)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:n}=this;return{_type:"FeeData",gasPrice:pt(e),maxFeePerGas:pt(t),maxPriorityFeePerGas:pt(n)}}}function Cf(r){const e={};r.to&&(e.to=r.to),r.from&&(e.from=r.from),r.data&&(e.data=le(r.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of t)!(s in r)||r[s]==null||(e[s]=de(r[s],`request.${s}`));const n="type,nonce".split(/,/);for(const s of n)!(s in r)||r[s]==null||(e[s]=Ne(r[s],`request.${s}`));return r.accessList&&(e.accessList=va(r.accessList)),"blockTag"in r&&(e.blockTag=r.blockTag),"enableCcipRead"in r&&(e.enableCcipRead=!!r.enableCcipRead),"customData"in r&&(e.customData=r.customData),"blobVersionedHashes"in r&&r.blobVersionedHashes&&(e.blobVersionedHashes=r.blobVersionedHashes.slice()),"kzg"in r&&(e.kzg=r.kzg),"blobs"in r&&r.blobs&&(e.blobs=r.blobs.map(s=>Hy(s)?le(s):Object.assign({},s))),e}var Ls;class lH{constructor(e,t){F(this,"provider");F(this,"number");F(this,"hash");F(this,"timestamp");F(this,"parentHash");F(this,"parentBeaconBlockRoot");F(this,"nonce");F(this,"difficulty");F(this,"gasLimit");F(this,"gasUsed");F(this,"stateRoot");F(this,"receiptsRoot");F(this,"blobGasUsed");F(this,"excessBlobGas");F(this,"miner");F(this,"prevRandao");F(this,"extraData");F(this,"baseFeePerGas");H(this,Ls);R(this,Ls,e.transactions.map(n=>typeof n!="string"?new lh(n,t):n)),we(this,{provider:t,hash:cc(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:cc(e.prevRandao),extraData:e.extraData,baseFeePerGas:cc(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return w(this,Ls).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=w(this,Ls).slice();return e.length===0?[]:(V(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:n,gasLimit:s,gasUsed:i,hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:h,parentBeaconBlockRoot:d,stateRoot:f,receiptsRoot:p,timestamp:m,transactions:v}=this;return{_type:"Block",baseFeePerGas:pt(e),difficulty:pt(t),extraData:n,gasLimit:pt(s),gasUsed:pt(i),blobGasUsed:pt(this.blobGasUsed),excessBlobGas:pt(this.excessBlobGas),hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:h,timestamp:m,parentBeaconBlockRoot:d,stateRoot:f,receiptsRoot:p,transactions:v}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return w(this,Ls).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let t;if(typeof e=="number")t=w(this,Ls)[e];else{const n=e.toLowerCase();for(const s of w(this,Ls))if(typeof s=="string"){if(s!==n)continue;t=s;break}else{if(s.hash!==n)continue;t=s;break}}if(t==null)throw new Error("no such tx");return typeof t=="string"?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if(typeof e=="number")return t[e];e=e.toLowerCase();for(const n of t)if(n.hash===e)return n;M(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return uH(this)}}Ls=new WeakMap;class qh{constructor(e,t){F(this,"provider");F(this,"transactionHash");F(this,"blockHash");F(this,"blockNumber");F(this,"removed");F(this,"address");F(this,"data");F(this,"topics");F(this,"index");F(this,"transactionIndex");this.provider=t;const n=Object.freeze(e.topics.slice());we(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:n,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:n,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:l}=this;return{_type:"log",address:e,blockHash:t,blockNumber:n,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:l}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return V(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return V(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return V(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return hH(this)}}var gh;class wI{constructor(e,t){F(this,"provider");F(this,"to");F(this,"from");F(this,"contractAddress");F(this,"hash");F(this,"index");F(this,"blockHash");F(this,"blockNumber");F(this,"logsBloom");F(this,"gasUsed");F(this,"blobGasUsed");F(this,"cumulativeGasUsed");F(this,"gasPrice");F(this,"blobGasPrice");F(this,"type");F(this,"status");F(this,"root");H(this,gh);R(this,gh,Object.freeze(e.logs.map(s=>new qh(s,t))));let n=yI;e.effectiveGasPrice!=null?n=e.effectiveGasPrice:e.gasPrice!=null&&(n=e.gasPrice),we(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:n,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return w(this,gh)}toJSON(){const{to:e,from:t,contractAddress:n,hash:s,index:i,blockHash:o,blockNumber:a,logsBloom:c,logs:l,status:u,root:h}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:n,cumulativeGasUsed:pt(this.cumulativeGasUsed),from:t,gasPrice:pt(this.gasPrice),blobGasUsed:pt(this.blobGasUsed),blobGasPrice:pt(this.blobGasPrice),gasUsed:pt(this.gasUsed),hash:s,index:i,logs:l,logsBloom:c,root:h,status:u,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return vI(this)}reorderedEvent(e){return V(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),bI(this,e)}}gh=new WeakMap;var _i;const dw=class dw{constructor(e,t){F(this,"provider");F(this,"blockNumber");F(this,"blockHash");F(this,"index");F(this,"hash");F(this,"type");F(this,"to");F(this,"from");F(this,"nonce");F(this,"gasLimit");F(this,"gasPrice");F(this,"maxPriorityFeePerGas");F(this,"maxFeePerGas");F(this,"maxFeePerBlobGas");F(this,"data");F(this,"value");F(this,"chainId");F(this,"signature");F(this,"accessList");F(this,"blobVersionedHashes");H(this,_i);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,R(this,_i,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:n,hash:s,type:i,to:o,from:a,nonce:c,data:l,signature:u,accessList:h,blobVersionedHashes:d}=this;return{_type:"TransactionResponse",accessList:h,blockNumber:e,blockHash:t,blobVersionedHashes:d,chainId:pt(this.chainId),data:l,from:a,gasLimit:pt(this.gasLimit),gasPrice:pt(this.gasPrice),hash:s,maxFeePerGas:pt(this.maxFeePerGas),maxPriorityFeePerGas:pt(this.maxPriorityFeePerGas),maxFeePerBlobGas:pt(this.maxFeePerBlobGas),nonce:c,signature:u,to:o,index:n,type:i,value:pt(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const n=await this.getTransaction();n&&(e=n.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:n}=await sr({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:n-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const n=e??1,s=t??0;let i=w(this,_i),o=-1,a=i===-1;const c=async()=>{if(a)return null;const{blockNumber:d,nonce:f}=await sr({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(f<this.nonce){i=d;return}if(a)return null;const p=await this.getTransaction();if(!(p&&p.blockNumber!=null))for(o===-1&&(o=i-3,o<w(this,_i)&&(o=w(this,_i)));o<=d;){if(a)return null;const m=await this.provider.getBlock(o,!0);if(m==null)return;for(const v of m)if(v===this.hash)return;for(let v=0;v<m.length;v++){const _=await m.getTransaction(v);if(_.from===this.from&&_.nonce===this.nonce){if(a)return null;const y=await this.provider.getTransactionReceipt(_.hash);if(y==null||d-y.blockNumber+1<n)return;let C="replaced";_.data===this.data&&_.to===this.to&&_.value===this.value?C="repriced":_.data==="0x"&&_.from===_.to&&_.value===yI&&(C="cancelled"),V(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:C==="replaced"||C==="cancelled",reason:C,replacement:_.replaceableTransaction(i),hash:_.hash,receipt:y})}}o++}},l=d=>{if(d==null||d.status!==0)return d;V(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:d.to,from:d.from,data:""},receipt:d})},u=await this.provider.getTransactionReceipt(this.hash);if(n===0)return l(u);if(u){if(await u.confirmations()>=n)return l(u)}else if(await c(),n===0)return null;return await new Promise((d,f)=>{const p=[],m=()=>{p.forEach(_=>_())};if(p.push(()=>{a=!0}),s>0){const _=setTimeout(()=>{m(),f(ct("wait for transaction timeout","TIMEOUT"))},s);p.push(()=>{clearTimeout(_)})}const v=async _=>{if(await _.confirmations()>=n){m();try{d(l(_))}catch(y){f(y)}}};if(p.push(()=>{this.provider.off(this.hash,v)}),this.provider.on(this.hash,v),i>=0){const _=async()=>{try{await c()}catch(y){if(qt(y,"TRANSACTION_REPLACED")){m(),f(y);return}}a||this.provider.once("block",_)};p.push(()=>{this.provider.off("block",_)}),this.provider.once("block",_)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return V(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),vI(this)}reorderedEvent(e){return V(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),V(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),bI(this,e)}replaceableTransaction(e){M(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new dw(this,this.provider);return R(t,_i,e),t}};_i=new WeakMap;let lh=dw;function uH(r){return{orphan:"drop-block",hash:r.hash,number:r.number}}function bI(r,e){return{orphan:"reorder-transaction",tx:r,other:e}}function vI(r){return{orphan:"drop-transaction",tx:r}}function hH(r){return{orphan:"drop-log",log:{transactionHash:r.transactionHash,blockHash:r.blockHash,blockNumber:r.blockNumber,address:r.address,data:r.data,topics:Object.freeze(r.topics.slice()),index:r.index}}}class sw extends qh{constructor(t,n,s){super(t,t.provider);F(this,"interface");F(this,"fragment");F(this,"args");const i=n.decodeEventLog(s,t.data,t.topics);we(this,{args:i,fragment:s,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class EI extends qh{constructor(t,n){super(t,t.provider);F(this,"error");we(this,{error:n})}}var $c;class dH extends wI{constructor(t,n,s){super(s,n);H(this,$c);R(this,$c,t)}get logs(){return super.logs.map(t=>{const n=t.topics.length?w(this,$c).getEvent(t.topics[0]):null;if(n)try{return new sw(t,w(this,$c),n)}catch(s){return new EI(t,s)}return t})}}$c=new WeakMap;var mh;class iw extends lh{constructor(t,n,s){super(s,n);H(this,mh);R(this,mh,t)}async wait(t,n){const s=await super.wait(t,n);return s==null?null:new dH(w(this,mh),this.provider,s)}}mh=new WeakMap;class AI extends K_{constructor(t,n,s,i){super(t,n,s);F(this,"log");we(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class fH extends AI{constructor(e,t,n,s,i){super(e,t,n,new sw(i,e.interface,s));const o=e.interface.decodeEventLog(s,this.log.data,this.log.topics);we(this,{args:o,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const RE=BigInt(0);function _I(r){return r&&typeof r.call=="function"}function CI(r){return r&&typeof r.estimateGas=="function"}function fp(r){return r&&typeof r.resolveName=="function"}function II(r){return r&&typeof r.sendTransaction=="function"}function NI(r){if(r!=null){if(fp(r))return r;if(r.provider)return r.provider}}var yh;class pH{constructor(e,t,n){H(this,yh);F(this,"fragment");if(we(this,{fragment:t}),t.inputs.length<n.length)throw new Error("too many arguments");const s=fa(e.runner,"resolveName"),i=fp(s)?s:null;R(this,yh,async function(){const o=await Promise.all(t.inputs.map((a,c)=>n[c]==null?null:a.walkAsync(n[c],(u,h)=>u==="address"?Array.isArray(h)?Promise.all(h.map(d=>ur(d,i))):ur(h,i):h)));return e.interface.encodeFilterTopics(t,o)}())}getTopicFilter(){return w(this,yh)}}yh=new WeakMap;function fa(r,e){return r==null?null:typeof r[e]=="function"?r:r.provider&&typeof r.provider[e]=="function"?r.provider:null}function Ao(r){return r==null?null:r.provider||null}async function xI(r,e){const t=Yt.dereference(r,"overrides");M(typeof t=="object","invalid overrides parameter","overrides",r);const n=Cf(t);return M(n.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),M(n.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function gH(r,e,t){const n=fa(r,"resolveName"),s=fp(n)?n:null;return await Promise.all(e.map((i,o)=>i.walkAsync(t[o],(a,c)=>(c=Yt.dereference(c,a),a==="address"?ur(c,s):c))))}function mH(r){const e=async function(o){const a=await xI(o,["data"]);a.to=await r.getAddress(),a.from&&(a.from=await ur(a.from,NI(r.runner)));const c=r.interface,l=de(a.value||RE,"overrides.value")===RE,u=(a.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!u&&!l&&M(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),M(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data);const h=c.receive||c.fallback&&c.fallback.payable;return M(h||l,"cannot send value to non-payable fallback","overrides.value",a.value),M(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data),a},t=async function(o){const a=fa(r.runner,"call");V(_I(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(o);try{return await a.call(c)}catch(l){throw jy(l)&&l.data?r.interface.makeError(l.data,c):l}},n=async function(o){const a=r.runner;V(II(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await a.sendTransaction(await e(o)),l=Ao(r.runner);return new iw(r.interface,l,c)},s=async function(o){const a=fa(r.runner,"estimateGas");return V(CI(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},i=async o=>await n(o);return we(i,{_contract:r,estimateGas:s,populateTransaction:e,send:n,staticCall:t}),i}function yH(r,e){const t=function(...l){const u=r.interface.getFunction(e,l);return V(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:l}}),u},n=async function(...l){const u=t(...l);let h={};if(u.inputs.length+1===l.length&&(h=await xI(l.pop()),h.from&&(h.from=await ur(h.from,NI(r.runner)))),u.inputs.length!==l.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const d=await gH(r.runner,u.inputs,l);return Object.assign({},h,await sr({to:r.getAddress(),data:r.interface.encodeFunctionData(u,d)}))},s=async function(...l){const u=await a(...l);return u.length===1?u[0]:u},i=async function(...l){const u=r.runner;V(II(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const h=await u.sendTransaction(await n(...l)),d=Ao(r.runner);return new iw(r.interface,d,h)},o=async function(...l){const u=fa(r.runner,"estimateGas");return V(CI(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await n(...l))},a=async function(...l){const u=fa(r.runner,"call");V(_I(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const h=await n(...l);let d="0x";try{d=await u.call(h)}catch(p){throw jy(p)&&p.data?r.interface.makeError(p.data,h):p}const f=t(...l);return r.interface.decodeFunctionResult(f,d)},c=async(...l)=>t(...l).constant?await s(...l):await i(...l);return we(c,{name:r.interface.getFunctionName(e),_contract:r,_key:e,getFragment:t,estimateGas:o,populateTransaction:n,send:i,staticCall:s,staticCallResult:a}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const l=r.interface.getFunction(e);return V(l,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),l}}),c}function wH(r,e){const t=function(...s){const i=r.interface.getEvent(e,s);return V(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),i},n=function(...s){return new pH(r,t(...s),s)};return we(n,{name:r.interface.getEventName(e),_contract:r,_key:e,getFragment:t}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=r.interface.getEvent(e);return V(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),n}const If=Symbol.for("_ethersInternal_contract"),PI=new WeakMap;function bH(r,e){PI.set(r[If],e)}function kr(r){return PI.get(r[If])}function vH(r){return r&&typeof r=="object"&&"getTopicFilter"in r&&typeof r.getTopicFilter=="function"&&r.fragment}async function ow(r,e){let t,n=null;if(Array.isArray(e)){const i=function(o){if(tt(o,32))return o;const a=r.interface.getEvent(o);return M(a,"unknown fragment","name",o),a.topicHash};t=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?t=[null]:typeof e=="string"?tt(e,32)?t=[e]:(n=r.interface.getEvent(e),M(n,"unknown fragment","event",e),t=[n.topicHash]):vH(e)?t=await e.getTopicFilter():"fragment"in e?(n=e.fragment,t=[n.topicHash]):M(!1,"unknown event name","event",e);t=t.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const s=t.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:n,tag:s,topics:t}}async function eu(r,e){const{subs:t}=kr(r);return t.get((await ow(r,e)).tag)||null}async function DE(r,e,t){const n=Ao(r.runner);V(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:i,topics:o}=await ow(r,t),{addr:a,subs:c}=kr(r);let l=c.get(i);if(!l){const h={address:a||r,topics:o},d=v=>{let _=s;if(_==null)try{_=r.interface.getEvent(v.topics[0])}catch{}if(_){const y=_,C=s?r.interface.decodeEventLog(s,v.data,v.topics):[];Zm(r,t,C,U=>new fH(r,U,t,y,v))}else Zm(r,t,[],y=>new AI(r,y,t,v))};let f=[];l={tag:i,listeners:[],start:()=>{f.length||f.push(n.on(h,d))},stop:async()=>{if(f.length==0)return;let v=f;f=[],await Promise.all(v),n.off(h,d)}},c.set(i,l)}return l}let Jm=Promise.resolve();async function EH(r,e,t,n){await Jm;const s=await eu(r,e);if(!s)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter(({listener:o,once:a})=>{const c=Array.from(t);n&&c.push(n(a?null:o));try{o.call(r,...c)}catch{}return!a}),s.listeners.length===0&&(s.stop(),kr(r).subs.delete(s.tag)),i>0}async function Zm(r,e,t,n){try{await Jm}catch{}const s=EH(r,e,t,n);return Jm=s,await s}const vd=["then"];var KE;KE=If;const du=class du{constructor(e,t,n,s){F(this,"target");F(this,"interface");F(this,"runner");F(this,"filters");F(this,KE);F(this,"fallback");M(typeof e=="string"||kC(e),"invalid value for Contract target","target",e),n==null&&(n=null);const i=Qm.from(t);we(this,{target:e,runner:n,interface:i}),Object.defineProperty(this,If,{value:{}});let o,a=null,c=null;if(s){const h=Ao(n);c=new iw(this.interface,h,s)}let l=new Map;if(typeof e=="string")if(tt(e))a=e,o=Promise.resolve(e);else{const h=fa(n,"resolveName");if(!fp(h))throw ct("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=h.resolveName(e).then(d=>{if(d==null)throw ct("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return kr(this).addr=d,d})}else o=e.getAddress().then(h=>{if(h==null)throw new Error("TODO");return kr(this).addr=h,h});bH(this,{addrPromise:o,addr:a,deployTx:c,subs:l});const u=new Proxy({},{get:(h,d,f)=>{if(typeof d=="symbol"||vd.indexOf(d)>=0)return Reflect.get(h,d,f);try{return this.getEvent(d)}catch(p){if(!qt(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(h,d)=>vd.indexOf(d)>=0?Reflect.has(h,d):Reflect.has(h,d)||this.interface.hasEvent(String(d))});return we(this,{filters:u}),we(this,{fallback:i.receive||i.fallback?mH(this):null}),new Proxy(this,{get:(h,d,f)=>{if(typeof d=="symbol"||d in h||vd.indexOf(d)>=0)return Reflect.get(h,d,f);try{return h.getFunction(d)}catch(p){if(!qt(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(h,d)=>typeof d=="symbol"||d in h||vd.indexOf(d)>=0?Reflect.has(h,d):h.interface.hasFunction(d)})}connect(e){return new du(this.target,this.interface,e)}attach(e){return new du(e,this.interface,this.runner)}async getAddress(){return await kr(this).addrPromise}async getDeployedCode(){const e=Ao(this.runner);V(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=Ao(this.runner);return V(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);n.once("block",o)}catch(a){i(a)}};o()})}deploymentTransaction(){return kr(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),yH(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),wH(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,n){t==null&&(t=0),n==null&&(n="latest");const{addr:s,addrPromise:i}=kr(this),o=s||await i,{fragment:a,topics:c}=await ow(this,e),l={address:o,topics:c,fromBlock:t,toBlock:n},u=Ao(this.runner);return V(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(l)).map(h=>{let d=a;if(d==null)try{d=this.interface.getEvent(h.topics[0])}catch{}if(d)try{return new sw(h,this.interface,d)}catch(f){return new EI(h,f)}return new qh(h,u)})}async on(e,t){const n=await DE(this,"on",e);return n.listeners.push({listener:t,once:!1}),n.start(),this}async once(e,t){const n=await DE(this,"once",e);return n.listeners.push({listener:t,once:!0}),n.start(),this}async emit(e,...t){return await Zm(this,e,t,null)}async listenerCount(e){if(e){const s=await eu(this,e);return s?s.listeners.length:0}const{subs:t}=kr(this);let n=0;for(const{listeners:s}of t.values())n+=s.length;return n}async listeners(e){if(e){const s=await eu(this,e);return s?s.listeners.map(({listener:i})=>i):[]}const{subs:t}=kr(this);let n=[];for(const{listeners:s}of t.values())n=n.concat(s.map(({listener:i})=>i));return n}async off(e,t){const n=await eu(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(t==null||n.listeners.length===0)&&(n.stop(),kr(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const t=await eu(this,e);if(!t)return this;t.stop(),kr(this).subs.delete(t.tag)}else{const{subs:t}=kr(this);for(const{tag:n,stop:s}of t.values())s(),t.delete(n)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends du{constructor(s,i=null){super(s,e,i)}}return t}static from(e,t,n){return n==null&&(n=null),new this(e,t,n)}};let Ym=du;function AH(){return Ym}class lc extends AH(){}function Ag(r){return r.match(/^ipfs:\/\/ipfs\//i)?r=r.substring(12):r.match(/^ipfs:\/\//i)?r=r.substring(7):M(!1,"unsupported IPFS format","link",r),`https://gateway.ipfs.io/ipfs/${r}`}class _H{constructor(e){F(this,"name");we(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const TI=new RegExp("^(ipfs)://(.*)$","i"),kE=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),TI,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var Ci,Uo,Ii,Wa,Rf,OI;const tc=class tc{constructor(e,t,n){H(this,Ii);F(this,"provider");F(this,"address");F(this,"name");H(this,Ci);H(this,Uo);we(this,{provider:e,address:t,name:n}),R(this,Ci,null),R(this,Uo,new lc(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return w(this,Ci)==null&&R(this,Ci,(async()=>{try{return await w(this,Uo).supportsInterface("0x9061b923")}catch(e){if(qt(e,"CALL_EXCEPTION"))return!1;throw R(this,Ci,null),e}})()),await w(this,Ci)}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await W(this,Ii,Wa).call(this,"addr(bytes32)");return i==null||i===th?null:i}catch(i){if(qt(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await W(this,Ii,Wa).call(this,"addr(bytes32,uint)",[i]);if(tt(o,20))return We(o)}let t=null;for(const i of this.provider.plugins)if(i instanceof _H&&i.supportsCoinType(e)){t=i;break}if(t==null)return null;const n=await W(this,Ii,Wa).call(this,"addr(bytes32,uint)",[e]);if(n==null||n==="0x")return null;const s=await t.decodeAddress(e,n);if(s!=null)return s;V(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:n}})}async getText(e){const t=await W(this,Ii,Wa).call(this,"text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){const e=await W(this,Ii,Wa).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const s=t[1]==="e3010170"?"ipfs":"ipns",i=parseInt(t[4],16);if(t[5].length===i*2)return`${s}://${SF("0x"+t[2])}`}const n=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===64)return`bzz://${n[1]}`;V(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let n=0;n<kE.length;n++){const s=t.match(kE[n]);if(s==null)continue;const i=s[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const o=Ag(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:t});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const c=(s[2]||"").split("/");if(c.length!==2)return e.push({type:`!${i}caip`,value:s[2]||""}),{url:null,linkage:e};const l=c[1],u=new lc(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const m=await u.ownerOf(l);if(a!==m)return e.push({type:"!owner",value:m}),{url:null,linkage:e};e.push({type:"owner",value:m})}else if(i==="erc1155"){const m=await u.balanceOf(a,l);if(!m)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:m.toString()})}let h=await u[o](l);if(h==null||h==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:h}),i==="erc1155"&&(h=h.replace("{id}",Gi(l,32).substring(2)),e.push({type:"metadata-url-expanded",value:h})),h.match(/^ipfs:/i)&&(h=Ag(h)),e.push({type:"metadata-url",value:h});let d={};const f=await new ys(h).send();f.assertOk();try{d=f.bodyJson}catch{try{e.push({type:"!metadata",value:f.bodyText})}catch{const _=f.body;return _&&e.push({type:"!metadata",value:le(_)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!d)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(d)});let p=d.image;if(typeof p!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!p.match(/^(https:\/\/|data:)/i)){if(p.match(TI)==null)return e.push({type:"!imageUrl-ipfs",value:p}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:p}),p=Ag(p)}return e.push({type:"url",value:p}),{linkage:e,url:p}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),n=t.getPlugin("org.ethers.plugins.network.Ens");return V(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),n.address}static async fromName(e,t){var s;let n=t;for(;;){if(n===""||n==="."||t!=="eth"&&n==="eth")return null;const i=await W(s=tc,Rf,OI).call(s,e,n);if(i!=null){const o=new tc(e,i,t);return n!==t&&!await o.supportsWildcard()?null:o}n=n.split(".").slice(1).join(".")}}};Ci=new WeakMap,Uo=new WeakMap,Ii=new WeakSet,Wa=async function(e,t){t=(t||[]).slice();const n=w(this,Uo).interface;t.unshift(Km(this.name));let s=null;await this.supportsWildcard()&&(s=n.getFunction(e),V(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[A7(this.name,255),n.encodeFunctionData(s,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const i=await w(this,Uo)[e](...t);return s?n.decodeFunctionResult(s,i)[0]:i}catch(i){if(!qt(i,"CALL_EXCEPTION"))throw i}return null},Rf=new WeakSet,OI=async function(e,t){const n=await tc.getEnsAddress(e);try{const i=await new lc(n,["function resolver(bytes32) view returns (address)"],e).resolver(Km(t),{enableCcipRead:!0});return i===th?null:i}catch(s){throw s}return null},H(tc,Rf);let Nf=tc;const UE=BigInt(0);function Be(r,e){return function(t){return t==null?e:r(t)}}function pp(r,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(n=>r(n))}}function zh(r,e){return t=>{const n={};for(const s in r){let i=s;if(e&&s in e&&!(i in t)){for(const o of e[s])if(o in t){i=o;break}}try{const o=r[s](t[i]);o!==void 0&&(n[s]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";V(!1,`invalid value for value.${s} (${a})`,"BAD_DATA",{value:t})}}return n}}function CH(r){switch(r){case!0:case"true":return!0;case!1:case"false":return!1}M(!1,`invalid boolean; ${JSON.stringify(r)}`,"value",r)}function wl(r){return M(tt(r,!0),"invalid data","value",r),r}function Ht(r){return M(tt(r,32),"invalid hash","value",r),r}const IH=zh({address:We,blockHash:Ht,blockNumber:Ne,data:wl,index:Ne,removed:Be(CH,!1),topics:pp(Ht),transactionHash:Ht,transactionIndex:Ne},{index:["logIndex"]});function NH(r){return IH(r)}const xH=zh({hash:Be(Ht),parentHash:Ht,parentBeaconBlockRoot:Be(Ht,null),number:Ne,timestamp:Ne,nonce:Be(wl),difficulty:de,gasLimit:de,gasUsed:de,stateRoot:Be(Ht,null),receiptsRoot:Be(Ht,null),blobGasUsed:Be(de,null),excessBlobGas:Be(de,null),miner:Be(We),prevRandao:Be(Ht,null),extraData:wl,baseFeePerGas:Be(de)},{prevRandao:["mixHash"]});function PH(r){const e=xH(r);return e.transactions=r.transactions.map(t=>typeof t=="string"?t:SI(t)),e}const TH=zh({transactionIndex:Ne,blockNumber:Ne,transactionHash:Ht,address:We,topics:pp(Ht),data:wl,index:Ne,blockHash:Ht},{index:["logIndex"]});function OH(r){return TH(r)}const SH=zh({to:Be(We,null),from:Be(We,null),contractAddress:Be(We,null),index:Ne,root:Be(le),gasUsed:de,blobGasUsed:Be(de,null),logsBloom:Be(wl),blockHash:Ht,hash:Ht,logs:pp(OH),blockNumber:Ne,cumulativeGasUsed:de,effectiveGasPrice:Be(de),blobGasPrice:Be(de,null),status:Be(Ne),type:Be(Ne,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function RH(r){return SH(r)}function SI(r){r.to&&de(r.to)===UE&&(r.to="0x0000000000000000000000000000000000000000");const e=zh({hash:Ht,index:Be(Ne,void 0),type:t=>t==="0x"||t==null?0:Ne(t),accessList:Be(va,null),blobVersionedHashes:Be(pp(Ht,!0),null),blockHash:Be(Ht,null),blockNumber:Be(Ne,null),transactionIndex:Be(Ne,null),from:We,gasPrice:Be(de),maxPriorityFeePerGas:Be(de),maxFeePerGas:Be(de),maxFeePerBlobGas:Be(de,null),gasLimit:de,to:Be(We,null),value:de,nonce:Ne,data:wl,creates:Be(We,null),chainId:Be(de,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(r);if(e.to==null&&e.creates==null&&(e.creates=Ij(e)),(r.type===1||r.type===2)&&r.accessList==null&&(e.accessList=[]),r.signature?e.signature=$n.from(r.signature):e.signature=$n.from(r),e.chainId==null){const t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&de(e.blockHash)===UE&&(e.blockHash=null),e}const DH="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class Vh{constructor(e){F(this,"name");we(this,{name:e})}clone(){return new Vh(this.name)}}class gp extends Vh{constructor(t,n){t==null&&(t=0);super(`org.ethers.network.plugins.GasCost#${t||0}`);F(this,"effectiveBlock");F(this,"txBase");F(this,"txCreate");F(this,"txDataZero");F(this,"txDataNonzero");F(this,"txAccessListStorageKey");F(this,"txAccessListAddress");const s={effectiveBlock:t};function i(o,a){let c=(n||{})[o];c==null&&(c=a),M(typeof c=="number",`invalud value for ${o}`,"costs",n),s[o]=c}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),we(this,s)}clone(){return new gp(this.effectiveBlock,this)}}class mp extends Vh{constructor(t,n){super("org.ethers.plugins.network.Ens");F(this,"address");F(this,"targetNetwork");we(this,{address:t||DH,targetNetwork:n??1})}clone(){return new mp(this.address,this.targetNetwork)}}var wh,bh;class kH extends Vh{constructor(t,n){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");H(this,wh);H(this,bh);R(this,wh,t),R(this,bh,n)}get url(){return w(this,wh)}get processFunc(){return w(this,bh)}clone(){return this}}wh=new WeakMap,bh=new WeakMap;const _g=new Map;var Lc,Mc,Ni;const rc=class rc{constructor(e,t){H(this,Lc);H(this,Mc);H(this,Ni);R(this,Lc,e),R(this,Mc,de(t)),R(this,Ni,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return w(this,Lc)}set name(e){R(this,Lc,e)}get chainId(){return w(this,Mc)}set chainId(e){R(this,Mc,de(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===de(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===de(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===de(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(w(this,Ni).values())}attachPlugin(e){if(w(this,Ni).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return w(this,Ni).set(e.name,e.clone()),this}getPlugin(e){return w(this,Ni).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const e=new rc(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new gp;let n=t.txBase;if(e.to==null&&(n+=t.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?n+=t.txDataZero:n+=t.txDataNonzero;if(e.accessList){const s=va(e.accessList);for(const i in s)n+=t.txAccessListAddress+t.txAccessListStorageKey*s[i].storageKeys.length}return n}static from(e){if(UH(),e==null)return rc.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const t=_g.get(e);if(t)return t();if(typeof e=="bigint")return new rc("unknown",e);M(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){M(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const t=new rc(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new mp(e.ensAddress,e.ensNetwork)),t}M(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));const n=_g.get(e);n&&M(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",e),_g.set(e,t)}};Lc=new WeakMap,Mc=new WeakMap,Ni=new WeakMap;let Dn=rc;function BE(r,e){const t=String(r);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${r}`);const n=t.split(".");if(n.length===1&&n.push(""),n.length!==2)throw new Error(`invalid gwei value: ${r}`);for(;n[1].length<e;)n[1]+="0";if(n[1].length>9){let s=BigInt(n[1].substring(0,9));n[1].substring(9).match(/^0+$/)||s++,n[1]=s.toString()}return BigInt(n[0]+n[1])}function $E(r){return new kH(r,async(e,t,n)=>{n.setHeader("User-Agent","ethers");let s;try{const[i,o]=await Promise.all([n.send(),e()]);s=i;const a=s.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:BE(a.maxFee,9),maxPriorityFeePerGas:BE(a.maxPriorityFee,9)}}catch(i){V(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:s,error:i})}})}let LE=!1;function UH(){if(LE)return;LE=!0;function r(e,t,n){const s=function(){const i=new Dn(e,t);return n.ensNetwork!=null&&i.attachPlugin(new mp(null,n.ensNetwork)),i.attachPlugin(new gp),(n.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};Dn.register(e,s),Dn.register(t,s),n.altNames&&n.altNames.forEach(i=>{Dn.register(i,s)})}r("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),r("ropsten",3,{ensNetwork:3}),r("rinkeby",4,{ensNetwork:4}),r("goerli",5,{ensNetwork:5}),r("kovan",42,{ensNetwork:42}),r("sepolia",11155111,{ensNetwork:11155111}),r("holesky",17e3,{ensNetwork:17e3}),r("classic",61,{}),r("classicKotti",6,{}),r("arbitrum",42161,{ensNetwork:1}),r("arbitrum-goerli",421613,{}),r("arbitrum-sepolia",421614,{}),r("base",8453,{ensNetwork:1}),r("base-goerli",84531,{}),r("base-sepolia",84532,{}),r("bnb",56,{ensNetwork:1}),r("bnbt",97,{}),r("linea",59144,{ensNetwork:1}),r("linea-goerli",59140,{}),r("linea-sepolia",59141,{}),r("matic",137,{ensNetwork:1,plugins:[$E("https://gasstation.polygon.technology/v2")]}),r("matic-amoy",80002,{}),r("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[$E("https://gasstation-testnet.polygon.technology/v2")]}),r("optimism",10,{ensNetwork:1,plugins:[]}),r("optimism-goerli",420,{}),r("optimism-sepolia",11155420,{}),r("xdai",100,{ensNetwork:1})}function Xm(r){return JSON.parse(JSON.stringify(r))}var Ms,nn,xi,ns,Fc,zd;class BH{constructor(e){H(this,Fc);H(this,Ms);H(this,nn);H(this,xi);H(this,ns);R(this,Ms,e),R(this,nn,null),R(this,xi,4e3),R(this,ns,-2)}get pollingInterval(){return w(this,xi)}set pollingInterval(e){R(this,xi,e)}start(){w(this,nn)||(R(this,nn,w(this,Ms)._setTimeout(W(this,Fc,zd).bind(this),w(this,xi))),W(this,Fc,zd).call(this))}stop(){w(this,nn)&&(w(this,Ms)._clearTimeout(w(this,nn)),R(this,nn,null))}pause(e){this.stop(),e&&R(this,ns,-2)}resume(){this.start()}}Ms=new WeakMap,nn=new WeakMap,xi=new WeakMap,ns=new WeakMap,Fc=new WeakSet,zd=async function(){try{const e=await w(this,Ms).getBlockNumber();if(w(this,ns)===-2){R(this,ns,e);return}if(e!==w(this,ns)){for(let t=w(this,ns)+1;t<=e;t++){if(w(this,nn)==null)return;await w(this,Ms).emit("block",t)}R(this,ns,e)}}catch{}w(this,nn)!=null&&R(this,nn,w(this,Ms)._setTimeout(W(this,Fc,zd).bind(this),w(this,xi)))};var Bo,$o,Pi;class aw{constructor(e){H(this,Bo);H(this,$o);H(this,Pi);R(this,Bo,e),R(this,Pi,!1),R(this,$o,t=>{this._poll(t,w(this,Bo))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){w(this,Pi)||(R(this,Pi,!0),w(this,$o).call(this,-2),w(this,Bo).on("block",w(this,$o)))}stop(){w(this,Pi)&&(R(this,Pi,!1),w(this,Bo).off("block",w(this,$o)))}pause(e){this.stop()}resume(){this.start()}}Bo=new WeakMap,$o=new WeakMap,Pi=new WeakMap;var jc,Fs;class $H extends aw{constructor(t,n){super(t);H(this,jc);H(this,Fs);R(this,jc,n),R(this,Fs,-2)}pause(t){t&&R(this,Fs,-2),super.pause(t)}async _poll(t,n){const s=await n.getBlock(w(this,jc));s!=null&&(w(this,Fs)===-2?R(this,Fs,s.number):s.number>w(this,Fs)&&(n.emit(w(this,jc),s.number),R(this,Fs,s.number)))}}jc=new WeakMap,Fs=new WeakMap;var Df;class LH extends aw{constructor(t,n){super(t);H(this,Df);R(this,Df,Xm(n))}async _poll(t,n){throw new Error("@TODO")}}Df=new WeakMap;var Hc;class MH extends aw{constructor(t,n){super(t);H(this,Hc);R(this,Hc,n)}async _poll(t,n){const s=await n.getTransactionReceipt(w(this,Hc));s&&n.emit(w(this,Hc),s)}}Hc=new WeakMap;var js,qc,zc,Ti,sn,kf,RI;class cw{constructor(e,t){H(this,kf);H(this,js);H(this,qc);H(this,zc);H(this,Ti);H(this,sn);R(this,js,e),R(this,qc,Xm(t)),R(this,zc,W(this,kf,RI).bind(this)),R(this,Ti,!1),R(this,sn,-2)}start(){w(this,Ti)||(R(this,Ti,!0),w(this,sn)===-2&&w(this,js).getBlockNumber().then(e=>{R(this,sn,e)}),w(this,js).on("block",w(this,zc)))}stop(){w(this,Ti)&&(R(this,Ti,!1),w(this,js).off("block",w(this,zc)))}pause(e){this.stop(),e&&R(this,sn,-2)}resume(){this.start()}}js=new WeakMap,qc=new WeakMap,zc=new WeakMap,Ti=new WeakMap,sn=new WeakMap,kf=new WeakSet,RI=async function(e){if(w(this,sn)===-2)return;const t=Xm(w(this,qc));t.fromBlock=w(this,sn)+1,t.toBlock=e;const n=await w(this,js).getLogs(t);if(n.length===0){w(this,sn)<e-60&&R(this,sn,e-60);return}for(const s of n)w(this,js).emit(w(this,qc),s),R(this,sn,s.blockNumber)};const FH=BigInt(2),jH=10;function Ed(r){return r&&typeof r.then=="function"}function Vd(r,e){return r+":"+JSON.stringify(e,(t,n)=>{if(n==null)return"null";if(typeof n=="bigint")return`bigint:${n.toString()}`;if(typeof n=="string")return n.toLowerCase();if(typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n);return s.sort(),s.reduce((i,o)=>(i[o]=n[o],i),{})}return n})}class xf{constructor(e){F(this,"name");we(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function HH(r){return JSON.parse(JSON.stringify(r))}function ey(r){return r=Array.from(new Set(r).values()),r.sort(),r}async function Cg(r,e){if(r==null)throw new Error("invalid event");if(Array.isArray(r)&&(r={topics:r}),typeof r=="string")switch(r){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:r,tag:r}}if(tt(r,32)){const t=r.toLowerCase();return{type:"transaction",tag:Vd("tx",{hash:t}),hash:t}}if(r.orphan){const t=r;return{type:"orphan",tag:Vd("orphan",t),filter:HH(t)}}if(r.address||r.topics){const t=r,n={topics:(t.topics||[]).map(s=>s==null?null:Array.isArray(s)?ey(s.map(i=>i.toLowerCase())):s.toLowerCase())};if(t.address){const s=[],i=[],o=a=>{tt(a)?s.push(a):i.push((async()=>{s.push(await ur(a,e))})())};Array.isArray(t.address)?t.address.forEach(o):o(t.address),i.length&&await Promise.all(i),n.address=ey(s.map(a=>a.toLowerCase()))}return{filter:n,tag:Vd("event",n),type:"event"}}M(!1,"unknown ProviderEvent","event",r)}function Ig(){return new Date().getTime()}const qH={cacheTimeout:250,pollingInterval:4e3};var Jt,Oi,Zt,Vc,Lr,Lo,Si,Hs,vh,on,Gc,Kc,Re,Rr,ty,ry,tu,ny,ru,Gd;class zH{constructor(e,t){H(this,Re);H(this,Jt);H(this,Oi);H(this,Zt);H(this,Vc);H(this,Lr);H(this,Lo);H(this,Si);H(this,Hs);H(this,vh);H(this,on);H(this,Gc);H(this,Kc);if(R(this,Kc,Object.assign({},qH,t||{})),e==="any")R(this,Lo,!0),R(this,Lr,null);else if(e){const n=Dn.from(e);R(this,Lo,!1),R(this,Lr,Promise.resolve(n)),setTimeout(()=>{this.emit("network",n,null)},0)}else R(this,Lo,!1),R(this,Lr,null);R(this,Hs,-1),R(this,Si,new Map),R(this,Jt,new Map),R(this,Oi,new Map),R(this,Zt,null),R(this,Vc,!1),R(this,vh,1),R(this,on,new Map),R(this,Gc,!1)}get pollingInterval(){return w(this,Kc).pollingInterval}get provider(){return this}get plugins(){return Array.from(w(this,Oi).values())}attachPlugin(e){if(w(this,Oi).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return w(this,Oi).set(e.name,e.connect(this)),this}getPlugin(e){return w(this,Oi).get(e)||null}get disableCcipRead(){return w(this,Gc)}set disableCcipRead(e){R(this,Gc,!!e)}async ccipReadFetch(e,t,n){if(this.disableCcipRead||n.length===0||e.to==null)return null;const s=e.to.toLowerCase(),i=t.toLowerCase(),o=[];for(let a=0;a<n.length;a++){const c=n[a],l=c.replace("{sender}",s).replace("{data}",i),u=new ys(l);c.indexOf("{data}")===-1&&(u.body={data:i,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:a,urls:n});let h="unknown error",d;try{d=await u.send()}catch(f){o.push(f.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:f}});continue}try{const f=d.bodyJson;if(f.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:f}),f.data;f.message&&(h=f.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:f})}catch{}V(d.statusCode<400||d.statusCode>=500,`response not found during CCIP fetch: ${h}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:h}}),o.push(h)}V(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:n,errorMessages:o}})}_wrapBlock(e,t){return new lH(PH(e),this)}_wrapLog(e,t){return new qh(NH(e),this)}_wrapTransactionReceipt(e,t){return new wI(RH(e),this)}_wrapTransactionResponse(e,t){return new lh(SI(e),this)}_detectNetwork(){V(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){V(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=Ne(await W(this,Re,Rr).call(this,{method:"getBlockNumber"}),"%response");return w(this,Hs)>=0&&R(this,Hs,e),e}_getAddress(e){return ur(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(tt(e))return tt(e,32)?e:Ya(e);if(typeof e=="bigint"&&(e=Ne(e,"blockTag")),typeof e=="number")return e>=0?Ya(e):w(this,Hs)>=0?Ya(w(this,Hs)+e):this.getBlockNumber().then(t=>Ya(t+e));M(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const t=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?ey(c.map(l=>l.toLowerCase())):c.toLowerCase()),n="blockHash"in e?e.blockHash:void 0,s=(c,l,u)=>{let h;switch(c.length){case 0:break;case 1:h=c[0];break;default:c.sort(),h=c}if(n&&(l!=null||u!=null))throw new Error("invalid filter");const d={};return h&&(d.address=h),t.length&&(d.topics=t),l&&(d.fromBlock=l),u&&(d.toBlock=u),n&&(d.blockHash=n),d};let i=[];if(e.address)if(Array.isArray(e.address))for(const c of e.address)i.push(this._getAddress(c));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),i.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(i),o,a]).then(c=>s(c[0],c[1],c[2])):s(i,o,a)}_getTransactionRequest(e){const t=Cf(e),n=[];if(["to","from"].forEach(s=>{if(t[s]==null)return;const i=ur(t[s],this);Ed(i)?n.push(async function(){t[s]=await i}()):t[s]=i}),t.blockTag!=null){const s=this._getBlockTag(t.blockTag);Ed(s)?n.push(async function(){t.blockTag=await s}()):t.blockTag=s}return n.length?async function(){return await Promise.all(n),t}():t}async getNetwork(){if(w(this,Lr)==null){const s=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw w(this,Lr)===s&&R(this,Lr,null),i}})();return R(this,Lr,s),(await s).clone()}const e=w(this,Lr),[t,n]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==n.chainId&&(w(this,Lo)?(this.emit("network",n,t),w(this,Lr)===e&&R(this,Lr,Promise.resolve(n))):V(!1,`network changed: ${t.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:s,gasPrice:i,priorityFee:o}=await sr({_block:W(this,Re,ny).call(this,"latest",!1),gasPrice:(async()=>{try{const u=await W(this,Re,Rr).call(this,{method:"getGasPrice"});return de(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const u=await W(this,Re,Rr).call(this,{method:"getPriorityFee"});return de(u,"%response")}catch{}return null})()});let a=null,c=null;const l=this._wrapBlock(s,e);return l&&l.baseFeePerGas&&(c=o??BigInt("1000000000"),a=l.baseFeePerGas*FH+c),new SE(i,a,c)},n=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const s=new ys(n.url),i=await n.processFunc(t,this,s);return new SE(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return Ed(t)&&(t=await t),de(await W(this,Re,Rr).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:n}=await sr({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await W(this,Re,ry).call(this,W(this,Re,ty).call(this,t,n,e.enableCcipRead?0:-1))}async getBalance(e,t){return de(await W(this,Re,tu).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return Ne(await W(this,Re,tu).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return le(await W(this,Re,tu).call(this,{method:"getCode"},e,t))}async getStorage(e,t,n){const s=de(t,"position");return le(await W(this,Re,tu).call(this,{method:"getStorage",position:s},e,n))}async broadcastTransaction(e){const{blockNumber:t,hash:n,network:s}=await sr({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=Af.from(e);if(i.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,s).replaceableTransaction(t)}async getBlock(e,t){const{network:n,params:s}=await sr({network:this.getNetwork(),params:W(this,Re,ny).call(this,e,!!t)});return s==null?null:this._wrapBlock(s,n)}async getTransaction(e){const{network:t,params:n}=await sr({network:this.getNetwork(),params:W(this,Re,Rr).call(this,{method:"getTransaction",hash:e})});return n==null?null:this._wrapTransactionResponse(n,t)}async getTransactionReceipt(e){const{network:t,params:n}=await sr({network:this.getNetwork(),params:W(this,Re,Rr).call(this,{method:"getTransactionReceipt",hash:e})});if(n==null)return null;if(n.gasPrice==null&&n.effectiveGasPrice==null){const s=await W(this,Re,Rr).call(this,{method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(n,t)}async getTransactionResult(e){const{result:t}=await sr({network:this.getNetwork(),result:W(this,Re,Rr).call(this,{method:"getTransactionResult",hash:e})});return t==null?null:le(t)}async getLogs(e){let t=this._getFilter(e);Ed(t)&&(t=await t);const{network:n,params:s}=await sr({network:this.getNetwork(),params:W(this,Re,Rr).call(this,{method:"getLogs",filter:t})});return s.map(i=>this._wrapLog(i,n))}_getProvider(e){V(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await Nf.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=We(e);const t=Km(e.substring(2).toLowerCase()+".addr.reverse");try{const n=await Nf.getEnsAddress(this),i=await new lc(n,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(i==null||i===th)return null;const a=await new lc(i,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(a)!==e?null:a}catch(n){if(qt(n,"BAD_DATA")&&n.value==="0x"||qt(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(e,t,n){const s=t??1;return s===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let a=null;const c=async l=>{try{const u=await this.getTransactionReceipt(e);if(u!=null&&l-u.blockNumber+1>=s){i(u),a&&(clearTimeout(a),a=null);return}}catch(u){console.log("EEE",u)}this.once("block",c)};n!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",c),o(ct("timeout","TIMEOUT",{reason:"timeout"})))},n)),c(await this.getBlockNumber())})}async waitForBlock(e){V(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=w(this,on).get(e);t&&(t.timer&&clearTimeout(t.timer),w(this,on).delete(e))}_setTimeout(e,t){t==null&&(t=0);const n=Pl(this,vh)._++,s=()=>{w(this,on).delete(n),e()};if(this.paused)w(this,on).set(n,{timer:null,func:s,time:t});else{const i=setTimeout(s,t);w(this,on).set(n,{timer:i,func:s,time:Ig()})}return n}_forEachSubscriber(e){for(const t of w(this,Jt).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new xf(e.type);case"block":{const t=new BH(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new $H(this,e.type);case"event":return new cw(this,e.filter);case"transaction":return new MH(this,e.hash);case"orphan":return new LH(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const n of w(this,Jt).values())if(n.subscriber===e){n.started&&n.subscriber.stop(),n.subscriber=t,n.started&&t.start(),w(this,Zt)!=null&&t.pause(w(this,Zt));break}}async on(e,t){const n=await W(this,Re,Gd).call(this,e);return n.listeners.push({listener:t,once:!1}),n.started||(n.subscriber.start(),n.started=!0,w(this,Zt)!=null&&n.subscriber.pause(w(this,Zt))),this}async once(e,t){const n=await W(this,Re,Gd).call(this,e);return n.listeners.push({listener:t,once:!0}),n.started||(n.subscriber.start(),n.started=!0,w(this,Zt)!=null&&n.subscriber.pause(w(this,Zt))),this}async emit(e,...t){const n=await W(this,Re,ru).call(this,e,t);if(!n||n.listeners.length===0)return!1;const s=n.listeners.length;return n.listeners=n.listeners.filter(({listener:i,once:o})=>{const a=new K_(this,o?null:i,e);try{i.call(this,...t,a)}catch{}return!o}),n.listeners.length===0&&(n.started&&n.subscriber.stop(),w(this,Jt).delete(n.tag)),s>0}async listenerCount(e){if(e){const n=await W(this,Re,ru).call(this,e);return n?n.listeners.length:0}let t=0;for(const{listeners:n}of w(this,Jt).values())t+=n.length;return t}async listeners(e){if(e){const n=await W(this,Re,ru).call(this,e);return n?n.listeners.map(({listener:s})=>s):[]}let t=[];for(const{listeners:n}of w(this,Jt).values())t=t.concat(n.map(({listener:s})=>s));return t}async off(e,t){const n=await W(this,Re,ru).call(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(!t||n.listeners.length===0)&&(n.started&&n.subscriber.stop(),w(this,Jt).delete(n.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:n,subscriber:s}=await W(this,Re,Gd).call(this,e);n&&s.stop(),w(this,Jt).delete(t)}else for(const[t,{started:n,subscriber:s}]of w(this,Jt))n&&s.stop(),w(this,Jt).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return w(this,Vc)}destroy(){this.removeAllListeners();for(const e of w(this,on).keys())this._clearTimeout(e);R(this,Vc,!0)}get paused(){return w(this,Zt)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(R(this,Hs,-1),w(this,Zt)!=null){if(w(this,Zt)==!!e)return;V(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),R(this,Zt,!!e);for(const t of w(this,on).values())t.timer&&clearTimeout(t.timer),t.time=Ig()-t.time}resume(){if(w(this,Zt)!=null){this._forEachSubscriber(e=>e.resume()),R(this,Zt,null);for(const e of w(this,on).values()){let t=e.time;t<0&&(t=0),e.time=Ig(),setTimeout(e.func,t)}}}}Jt=new WeakMap,Oi=new WeakMap,Zt=new WeakMap,Vc=new WeakMap,Lr=new WeakMap,Lo=new WeakMap,Si=new WeakMap,Hs=new WeakMap,vh=new WeakMap,on=new WeakMap,Gc=new WeakMap,Kc=new WeakMap,Re=new WeakSet,Rr=async function(e){const t=w(this,Kc).cacheTimeout;if(t<0)return await this._perform(e);const n=Vd(e.method,e);let s=w(this,Si).get(n);return s||(s=this._perform(e),w(this,Si).set(n,s),setTimeout(()=>{w(this,Si).get(n)===s&&w(this,Si).delete(n)},t)),await s},ty=async function(e,t,n){V(n<jH,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const s=Cf(e);try{return le(await this._perform({method:"call",transaction:s,blockTag:t}))}catch(i){if(!this.disableCcipRead&&jy(i)&&i.data&&n>=0&&t==="latest"&&s.to!=null&&ft(i.data,0,4)==="0x556f1830"){const o=i.data,a=await ur(s.to,this);let c;try{c=QH(ft(i.data,4))}catch(h){V(!1,h.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:o}})}V(c.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});const l=await this.ccipReadFetch(s,c.calldata,c.urls);V(l!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:i.data,errorArgs:c.errorArgs}});const u={to:a,data:bt([c.selector,WH([l,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const h=await W(this,Re,ty).call(this,u,t,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:h}),h}catch(h){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:h}),h}}throw i}},ry=async function(e){const{value:t}=await sr({network:this.getNetwork(),value:e});return t},tu=async function(e,t,n){let s=this._getAddress(t),i=this._getBlockTag(n);return(typeof s!="string"||typeof i!="string")&&([s,i]=await Promise.all([s,i])),await W(this,Re,ry).call(this,W(this,Re,Rr).call(this,Object.assign(e,{address:s,blockTag:i})))},ny=async function(e,t){if(tt(e,32))return await W(this,Re,Rr).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let n=this._getBlockTag(e);return typeof n!="string"&&(n=await n),await W(this,Re,Rr).call(this,{method:"getBlock",blockTag:n,includeTransactions:t})},ru=async function(e,t){let n=await Cg(e,this);return n.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(n=await Cg({orphan:"drop-log",log:t[0]},this)),w(this,Jt).get(n.tag)||null},Gd=async function(e){const t=await Cg(e,this),n=t.tag;let s=w(this,Jt).get(n);return s||(s={subscriber:this._getSubscriber(t),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},w(this,Jt).set(n,s)),s};function VH(r,e){try{const t=sy(r,e);if(t)return pf(t)}catch{}return null}function sy(r,e){if(r==="0x")return null;try{const t=Ne(ft(r,e,e+32)),n=Ne(ft(r,t,t+32));return ft(r,t+32,t+32+n)}catch{}return null}function ME(r){const e=cr(r);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function GH(r){if(r.length%32===0)return r;const e=new Uint8Array(Math.ceil(r.length/32)*32);return e.set(r),e}const KH=new Uint8Array([]);function WH(r){const e=[];let t=0;for(let n=0;n<r.length;n++)e.push(KH),t+=32;for(let n=0;n<r.length;n++){const s=$e(r[n]);e[n]=ME(t),e.push(ME(s.length)),e.push(GH(s)),t+=32+Math.ceil(s.length/32)*32}return bt(e)}const FE="0x0000000000000000000000000000000000000000000000000000000000000000";function QH(r){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};V(ic(r)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const t=ft(r,0,32);V(ft(t,0,12)===ft(FE,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=ft(t,12);try{const n=[],s=Ne(ft(r,32,64)),i=Ne(ft(r,s,s+32)),o=ft(r,s+32);for(let a=0;a<i;a++){const c=VH(o,a*32);if(c==null)throw new Error("abort");n.push(c)}e.urls=n}catch{V(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=sy(r,64);if(n==null)throw new Error("abort");e.calldata=n}catch{V(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}V(ft(r,100,128)===ft(FE,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=ft(r,96,100);try{const n=sy(r,128);if(n==null)throw new Error("abort");e.extraData=n}catch{V(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(n=>e[n]),e}function ja(r,e){if(r.provider)return r.provider;V(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function jE(r,e){let t=Cf(e);if(t.to!=null&&(t.to=ur(t.to,r)),t.from!=null){const n=t.from;t.from=Promise.all([r.getAddress(),ur(n,r)]).then(([s,i])=>(M(s.toLowerCase()===i.toLowerCase(),"transaction from mismatch","tx.from",i),s))}else t.from=r.getAddress();return await sr(t)}class JH{constructor(e){F(this,"provider");we(this,{provider:e||null})}async getNonce(e){return ja(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await jE(this,e)}async populateTransaction(e){const t=ja(this,"populateTransaction"),n=await jE(this,e);n.nonce==null&&(n.nonce=await this.getNonce("pending")),n.gasLimit==null&&(n.gasLimit=await this.estimateGas(n));const s=await this.provider.getNetwork();if(n.chainId!=null){const o=de(n.chainId);M(o===s.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else n.chainId=s.chainId;const i=n.maxFeePerGas!=null||n.maxPriorityFeePerGas!=null;if(n.gasPrice!=null&&(n.type===2||i)?M(!1,"eip-1559 transaction do not support gasPrice","tx",e):(n.type===0||n.type===1)&&i&&M(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(n.type===2||n.type==null)&&n.maxFeePerGas!=null&&n.maxPriorityFeePerGas!=null)n.type=2;else if(n.type===0||n.type===1){const o=await t.getFeeData();V(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice)}else{const o=await t.getFeeData();if(n.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(n.type=2,n.gasPrice!=null){const a=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=a,n.maxPriorityFeePerGas=a}else n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(V(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice),n.type=0):V(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(n.type===2||n.type===3)&&(n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await sr(n)}async estimateGas(e){return ja(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return ja(this,"call").call(await this.populateCall(e))}async resolveName(e){return await ja(this,"resolveName").resolveName(e)}async sendTransaction(e){const t=ja(this,"sendTransaction"),n=await this.populateTransaction(e);delete n.from;const s=Af.from(n);return await t.broadcastTransaction(await this.signTransaction(s))}}const HE=new Set;function ZH(r){HE.has(r)||(HE.add(r),console.log("========= NOTICE ========="),console.log(`Request-Rate Exceeded for ${r} (this message will not be repeated)`),console.log(""),console.log("The default API keys for each service are provided as a highly-throttled,"),console.log("community resource for low-traffic projects and early prototyping."),console.log(""),console.log("While your application will continue to function, we highly recommended"),console.log("signing up for your own API keys to improve performance, increase your"),console.log("request rate/limit and enable other perks, such as metrics and advanced APIs."),console.log(""),console.log("For more details: https://docs.ethers.org/api-keys/"),console.log("=========================="))}function YH(r){return JSON.parse(JSON.stringify(r))}var nr,ss,Mo,Ri,Fo,Wc,Ki,iy,oy;class DI{constructor(e){H(this,Ki);H(this,nr);H(this,ss);H(this,Mo);H(this,Ri);H(this,Fo);H(this,Wc);R(this,nr,e),R(this,ss,null),R(this,Mo,W(this,Ki,iy).bind(this)),R(this,Ri,!1),R(this,Fo,null),R(this,Wc,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){w(this,Ri)||(R(this,Ri,!0),W(this,Ki,iy).call(this,-2))}stop(){w(this,Ri)&&(R(this,Ri,!1),R(this,Wc,!0),W(this,Ki,oy).call(this),w(this,nr).off("block",w(this,Mo)))}pause(e){e&&W(this,Ki,oy).call(this),w(this,nr).off("block",w(this,Mo))}resume(){this.start()}}nr=new WeakMap,ss=new WeakMap,Mo=new WeakMap,Ri=new WeakMap,Fo=new WeakMap,Wc=new WeakMap,Ki=new WeakSet,iy=async function(e){try{w(this,ss)==null&&R(this,ss,this._subscribe(w(this,nr)));let t=null;try{t=await w(this,ss)}catch(i){if(!qt(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(t==null){R(this,ss,null),w(this,nr)._recoverSubscriber(this,this._recover(w(this,nr)));return}const n=await w(this,nr).getNetwork();if(w(this,Fo)||R(this,Fo,n),w(this,Fo).chainId!==n.chainId)throw new Error("chaid changed");if(w(this,Wc))return;const s=await w(this,nr).send("eth_getFilterChanges",[t]);await this._emitResults(w(this,nr),s)}catch(t){console.log("@TODO",t)}w(this,nr).once("block",w(this,Mo))},oy=function(){const e=w(this,ss);e&&(R(this,ss,null),e.then(t=>{w(this,nr).destroyed||w(this,nr).send("eth_uninstallFilter",[t])}))};var jo;class XH extends DI{constructor(t,n){super(t);H(this,jo);R(this,jo,YH(n))}_recover(t){return new cw(t,w(this,jo))}async _subscribe(t){return await t.send("eth_newFilter",[w(this,jo)])}async _emitResults(t,n){for(const s of n)t.emit(w(this,jo),t._wrapLog(s,t._network))}}jo=new WeakMap;class eq extends DI{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const n of t)e.emit("pending",n)}}const tq="bigint,boolean,function,number,string,symbol".split(/,/g);function Kd(r){if(r==null||tq.indexOf(typeof r)>=0||typeof r.getAddress=="function")return r;if(Array.isArray(r))return r.map(Kd);if(typeof r=="object")return Object.keys(r).reduce((e,t)=>(e[t]=r[t],e),{});throw new Error(`should not happen: ${r} (${typeof r})`)}function rq(r){return new Promise(e=>{setTimeout(e,r)})}function Ha(r){return r&&r.toLowerCase()}function qE(r){return r&&typeof r.pollingInterval=="number"}const kI={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class uc extends JH{constructor(t,n){super(t);F(this,"address");n=We(n),we(this,{address:n})}connect(t){V(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const n=Kd(t),s=[];if(n.from){const o=n.from;s.push((async()=>{const a=await ur(o,this.provider);M(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=a})())}else n.from=this.address;if(n.gasLimit==null&&s.push((async()=>{n.gasLimit=await this.provider.estimateGas({...n,from:this.address})})()),n.to!=null){const o=n.to;s.push((async()=>{n.to=await ur(o,this.provider)})())}s.length&&await Promise.all(s);const i=this.provider.getRpcTransaction(n);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(t){const n=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(t);return await new Promise((i,o)=>{const a=[1e3,100];let c=0;const l=async()=>{try{const u=await this.provider.getTransaction(s);if(u!=null){i(u.replaceableTransaction(n));return}}catch(u){if(qt(u,"CANCELLED")||qt(u,"BAD_DATA")||qt(u,"NETWORK_ERROR")||qt(u,"UNSUPPORTED_OPERATION")){u.info==null&&(u.info={}),u.info.sendTransactionHash=s,o(u);return}if(qt(u,"INVALID_ARGUMENT")&&(c++,u.info==null&&(u.info={}),u.info.sendTransactionHash=s,c>10)){o(u);return}this.provider.emit("error",ct("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:u}))}this.provider._setTimeout(()=>{l()},a.pop()||4e3)};l()})}async signTransaction(t){const n=Kd(t);if(n.from){const i=await ur(n.from,this.provider);M(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=i}else n.from=this.address;const s=this.provider.getRpcTransaction(n);return await this.provider.send("eth_signTransaction",[s])}async signMessage(t){const n=typeof t=="string"?ds(t):t;return await this.provider.send("personal_sign",[le(n),this.address.toLowerCase()])}async signTypedData(t,n,s){const i=Kd(s),o=await _f.resolveNames(t,n,i,async a=>{const c=await ur(a);return M(c!=null,"TypedData does not support null address","value",a),c});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(_f.getPayload(o.domain,n,o.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const n=typeof t=="string"?ds(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),le(n)])}}var Ho,Qc,qs,is,Pn,an,Er,Eh,ay;class UI extends zH{constructor(t,n){super(t,n);H(this,Eh);H(this,Ho);H(this,Qc);H(this,qs);H(this,is);H(this,Pn);H(this,an);H(this,Er);R(this,Qc,1),R(this,Ho,Object.assign({},kI,n||{})),R(this,qs,[]),R(this,is,null),R(this,an,null),R(this,Er,null);{let i=null;const o=new Promise(a=>{i=a});R(this,Pn,{promise:o,resolve:i})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(M(!s||t!=="any","staticNetwork cannot be used on special network 'any'","options",n),s&&t!=null&&R(this,an,Dn.from(t))):s&&(M(t==null||s.matches(t),"staticNetwork MUST match network object","options",n),R(this,an,s))}_getOption(t){return w(this,Ho)[t]}get _network(){return V(w(this,an),"network is not available yet","NETWORK_ERROR"),w(this,an)}async _perform(t){if(t.method==="call"||t.method==="estimateGas"){let s=t.transaction;if(s&&s.type!=null&&de(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(t=Object.assign({},t,{transaction:Object.assign({},s,{type:void 0})}))}}const n=this.getRpcRequest(t);return n!=null?await this.send(n.method,n.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t)if(t===!0){if(w(this,an))return w(this,an)}else return t;return w(this,Er)?await w(this,Er):this.ready?(R(this,Er,(async()=>{try{const n=Dn.from(de(await this.send("eth_chainId",[])));return R(this,Er,null),n}catch(n){throw R(this,Er,null),n}})()),await w(this,Er)):(R(this,Er,(async()=>{const n={id:Pl(this,Qc)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:n});let s;try{s=(await this._send(n))[0],R(this,Er,null)}catch(i){throw R(this,Er,null),this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return Dn.from(de(s.result));throw this.getRpcError(n,s)})()),await w(this,Er))}_start(){w(this,Pn)==null||w(this,Pn).resolve==null||(w(this,Pn).resolve(),R(this,Pn,null),(async()=>{for(;w(this,an)==null&&!this.destroyed;)try{R(this,an,await this._detectNetwork())}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",ct("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await rq(1e3)}W(this,Eh,ay).call(this)})())}async _waitUntilReady(){if(w(this,Pn)!=null)return await w(this,Pn).promise}_getSubscriber(t){return t.type==="pending"?new eq(this):t.type==="event"?this._getOption("polling")?new cw(this,t.filter):new XH(this,t.filter):t.type==="orphan"&&t.filter.orphan==="drop-log"?new xf("orphan"):super._getSubscriber(t)}get ready(){return w(this,Pn)==null}getRpcTransaction(t){const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(t[s]==null)return;let i=s;s==="gasLimit"&&(i="gas"),n[i]=Ya(de(t[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{t[s]!=null&&(n[s]=le(t[s]))}),t.accessList&&(n.accessList=va(t.accessList)),t.blobVersionedHashes&&(n.blobVersionedHashes=t.blobVersionedHashes.map(s=>s.toLowerCase())),n}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Ha(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Ha(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[Ha(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Ha(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&t.filter.address!=null&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(Ha):t.filter.address=Ha(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,n){const{method:s}=t,{error:i}=n;if(s==="eth_estimateGas"&&i.message){const c=i.message;if(!c.match(/revert/i)&&c.match(/insufficient funds/i))return ct("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:i}})}if(s==="eth_call"||s==="eth_estimateGas"){const c=cy(i),l=ch.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",t.params[0],c?c.data:null);return l.info={error:i,payload:t},l}const o=JSON.stringify(nq(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return ct("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:t,error:i}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const c=t.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return ct("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:c,info:{error:i}});if(o.match(/nonce/i)&&o.match(/too low/i))return ct("nonce has already been used","NONCE_EXPIRED",{transaction:c,info:{error:i}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return ct("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:c,info:{error:i}});if(o.match(/only replay-protected/i))return ct("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:c,info:{error:i}}})}let a=!!o.match(/the method .* does not exist/i);return a||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(a=!0),a?ct("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:i,payload:t}}):ct("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:t})}send(t,n){if(this.destroyed)return Promise.reject(ct("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const s=Pl(this,Qc)._++,i=new Promise((o,a)=>{w(this,qs).push({resolve:o,reject:a,payload:{method:t,params:n,id:s,jsonrpc:"2.0"}})});return W(this,Eh,ay).call(this),i}async getSigner(t){t==null&&(t=0);const n=this.send("eth_accounts",[]);if(typeof t=="number"){const i=await n;if(t>=i.length)throw new Error("no such account");return new uc(this,i[t])}const{accounts:s}=await sr({network:this.getNetwork(),accounts:n});t=We(t);for(const i of s)if(We(i)===t)return new uc(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(n=>new uc(this,n))}destroy(){w(this,is)&&(clearTimeout(w(this,is)),R(this,is,null));for(const{payload:t,reject:n}of w(this,qs))n(ct("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));R(this,qs,[]),super.destroy()}}Ho=new WeakMap,Qc=new WeakMap,qs=new WeakMap,is=new WeakMap,Pn=new WeakMap,an=new WeakMap,Er=new WeakMap,Eh=new WeakSet,ay=function(){if(w(this,is))return;const t=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");R(this,is,setTimeout(()=>{R(this,is,null);const n=w(this,qs);for(R(this,qs,[]);n.length;){const s=[n.shift()];for(;n.length&&s.length!==w(this,Ho).batchMaxCount;)if(s.push(n.shift()),JSON.stringify(s.map(o=>o.payload)).length>w(this,Ho).batchMaxSize){n.unshift(s.pop());break}(async()=>{const i=s.length===1?s[0].payload:s.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{const o=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:a,reject:c,payload:l}of s){if(this.destroyed){c(ct("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:l.method}));continue}const u=o.filter(h=>h.id===l.id)[0];if(u==null){const h=ct("missing response for request","BAD_DATA",{value:o,info:{payload:l}});this.emit("error",h),c(h);continue}if("error"in u){c(this.getRpcError(l,u));continue}a(u.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:a}of s)a(o)}})()}},t))};var Di;class BI extends UI{constructor(t,n){super(t,n);H(this,Di);let s=this._getOption("pollingInterval");s==null&&(s=kI.pollingInterval),R(this,Di,s)}_getSubscriber(t){const n=super._getSubscriber(t);return qE(n)&&(n.pollingInterval=w(this,Di)),n}get pollingInterval(){return w(this,Di)}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");R(this,Di,t),this._forEachSubscriber(n=>{qE(n)&&(n.pollingInterval=w(this,Di))})}}Di=new WeakMap;var Jc;class $I extends BI{constructor(t,n,s){t==null&&(t="http://localhost:8545");super(n,s);H(this,Jc);typeof t=="string"?R(this,Jc,new ys(t)):R(this,Jc,t.clone())}_getConnection(){return w(this,Jc).clone()}async send(t,n){return await this._start(),await super.send(t,n)}async _send(t){const n=this._getConnection();n.body=JSON.stringify(t),n.setHeader("content-type","application/json");const s=await n.send();s.assertOk();let i=s.bodyJson;return Array.isArray(i)||(i=[i]),i}}Jc=new WeakMap;function cy(r){if(r==null)return null;if(typeof r.message=="string"&&r.message.match(/revert/i)&&tt(r.data))return{message:r.message,data:r.data};if(typeof r=="object"){for(const e in r){const t=cy(r[e]);if(t)return t}return null}if(typeof r=="string")try{return cy(JSON.parse(r))}catch{}return null}function ly(r,e){if(r!=null){if(typeof r.message=="string"&&e.push(r.message),typeof r=="object")for(const t in r)ly(r[t],e);if(typeof r=="string")try{return ly(JSON.parse(r),e)}catch{}}}function nq(r){const e=[];return ly(r,e),e}function sq(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof be<"u")return be;throw new Error("unable to locate global object")}const iq=sq().WebSocket;var os,Ah,ki,qo,Ui;class lw{constructor(e,t){H(this,os);H(this,Ah);H(this,ki);H(this,qo);H(this,Ui);R(this,os,e),R(this,Ah,JSON.stringify(t)),R(this,ki,null),R(this,qo,null),R(this,Ui,null)}get filter(){return JSON.parse(w(this,Ah))}start(){R(this,ki,w(this,os).send("eth_subscribe",this.filter).then(e=>(w(this,os)._register(e,this),e)))}stop(){w(this,ki).then(e=>{w(this,os).destroyed||w(this,os).send("eth_unsubscribe",[e])}),R(this,ki,null)}pause(e){V(e,"preserve logs while paused not supported by SocketSubscriber yet","UNSUPPORTED_OPERATION",{operation:"pause(false)"}),R(this,qo,!!e)}resume(){R(this,qo,null)}_handleMessage(e){if(w(this,ki)!=null&&w(this,qo)===null){let t=w(this,Ui);t==null?t=this._emit(w(this,os),e):t=t.then(async()=>{await this._emit(w(this,os),e)}),R(this,Ui,t.then(()=>{w(this,Ui)===t&&R(this,Ui,null)}))}}async _emit(e,t){throw new Error("sub-classes must implemente this; _emit")}}os=new WeakMap,Ah=new WeakMap,ki=new WeakMap,qo=new WeakMap,Ui=new WeakMap;class oq extends lw{constructor(e){super(e,["newHeads"])}async _emit(e,t){e.emit("block",parseInt(t.number))}}class aq extends lw{constructor(e){super(e,["newPendingTransactions"])}async _emit(e,t){e.emit("pending",t)}}var _h;class cq extends lw{constructor(t,n){super(t,["logs",n]);H(this,_h);R(this,_h,JSON.stringify(n))}get logFilter(){return JSON.parse(w(this,_h))}async _emit(t,n){t.emit(this.logFilter,t._wrapLog(n,t._network))}}_h=new WeakMap;var zo,Zc,Bi;class lq extends UI{constructor(t,n){const s=Object.assign({},n??{});M(s.batchMaxCount==null||s.batchMaxCount===1,"sockets-based providers do not support batches","options.batchMaxCount",n),s.batchMaxCount=1,s.staticNetwork==null&&(s.staticNetwork=!0);super(t,s);H(this,zo);H(this,Zc);H(this,Bi);R(this,zo,new Map),R(this,Zc,new Map),R(this,Bi,new Map)}_getSubscriber(t){switch(t.type){case"close":return new xf("close");case"block":return new oq(this);case"pending":return new aq(this);case"event":return new cq(this,t.filter);case"orphan":if(t.filter.orphan==="drop-log")return new xf("drop-log")}return super._getSubscriber(t)}_register(t,n){w(this,Zc).set(t,n);const s=w(this,Bi).get(t);if(s){for(const i of s)n._handleMessage(i);w(this,Bi).delete(t)}}async _send(t){M(!Array.isArray(t),"WebSocket does not support batch send","payload",t);const n=new Promise((s,i)=>{w(this,zo).set(t.id,{payload:t,resolve:s,reject:i})});return await this._waitUntilReady(),await this._write(JSON.stringify(t)),[await n]}async _processMessage(t){const n=JSON.parse(t);if(n&&typeof n=="object"&&"id"in n){const s=w(this,zo).get(n.id);if(s==null){this.emit("error",ct("received result for unknown id","UNKNOWN_ERROR",{reasonCode:"UNKNOWN_ID",result:n}));return}w(this,zo).delete(n.id),s.resolve(n)}else if(n&&n.method==="eth_subscription"){const s=n.params.subscription,i=w(this,Zc).get(s);if(i)i._handleMessage(n.params.result);else{let o=w(this,Bi).get(s);o==null&&(o=[],w(this,Bi).set(s,o)),o.push(n.params.result)}}else{this.emit("error",ct("received unexpected message","UNKNOWN_ERROR",{reasonCode:"UNEXPECTED_MESSAGE",result:n}));return}}async _write(t){throw new Error("sub-classes must override this")}}zo=new WeakMap,Zc=new WeakMap,Bi=new WeakMap;var Vo,Tn;class uq extends lq{constructor(t,n,s){super(n,s);H(this,Vo);H(this,Tn);typeof t=="string"?(R(this,Vo,()=>new iq(t)),R(this,Tn,w(this,Vo).call(this))):typeof t=="function"?(R(this,Vo,t),R(this,Tn,t())):(R(this,Vo,null),R(this,Tn,t)),this.websocket.onopen=async()=>{try{await this._start(),this.resume()}catch(i){console.log("failed to start WebsocketProvider",i)}},this.websocket.onmessage=i=>{this._processMessage(i.data)}}get websocket(){if(w(this,Tn)==null)throw new Error("websocket closed");return w(this,Tn)}async _write(t){this.websocket.send(t)}async destroy(){w(this,Tn)!=null&&(w(this,Tn).close(),R(this,Tn,null)),super.destroy()}}Vo=new WeakMap,Tn=new WeakMap;const nu="84842078b09946638c03157f83405213";function hq(r){switch(r){case"mainnet":return"mainnet.infura.io";case"goerli":return"goerli.infura.io";case"sepolia":return"sepolia.infura.io";case"arbitrum":return"arbitrum-mainnet.infura.io";case"arbitrum-goerli":return"arbitrum-goerli.infura.io";case"arbitrum-sepolia":return"arbitrum-sepolia.infura.io";case"base":return"base-mainnet.infura.io";case"base-goerlia":return"base-goerli.infura.io";case"base-sepolia":return"base-sepolia.infura.io";case"bnb":return"bnbsmartchain-mainnet.infura.io";case"bnbt":return"bnbsmartchain-testnet.infura.io";case"linea":return"linea-mainnet.infura.io";case"linea-goerli":return"linea-goerli.infura.io";case"linea-sepolia":return"linea-sepolia.infura.io";case"matic":return"polygon-mainnet.infura.io";case"matic-amoy":return"polygon-amoy.infura.io";case"matic-mumbai":return"polygon-mumbai.infura.io";case"optimism":return"optimism-mainnet.infura.io";case"optimism-goerli":return"optimism-goerli.infura.io";case"optimism-sepolia":return"optimism-sepolia.infura.io"}M(!1,"unsupported network","network",r)}class dq extends uq{constructor(t,n){const s=new pa(t,n),i=s._getConnection();V(!i.credentials,"INFURA WebSocket project secrets unsupported","UNSUPPORTED_OPERATION",{operation:"InfuraProvider.getWebSocketProvider()"});const o=i.url.replace(/^http/i,"ws").replace("/v3/","/ws/v3/");super(o,s._network);F(this,"projectId");F(this,"projectSecret");we(this,{projectId:s.projectId,projectSecret:s.projectSecret})}isCommunityResource(){return this.projectId===nu}}class pa extends $I{constructor(t,n,s){t==null&&(t="mainnet");const i=Dn.from(t);n==null&&(n=nu),s==null&&(s=null);const o=pa.getRequest(i,n,s);super(o,i,{staticNetwork:i});F(this,"projectId");F(this,"projectSecret");we(this,{projectId:n,projectSecret:s})}_getProvider(t){try{return new pa(t,this.projectId,this.projectSecret)}catch{}return super._getProvider(t)}isCommunityResource(){return this.projectId===nu}static getWebSocketProvider(t,n){return new dq(t,n)}static getRequest(t,n,s){n==null&&(n=nu),s==null&&(s=null);const i=new ys(`https://${hq(t.name)}/v3/${n}`);return i.allowGzip=!0,s&&i.setCredentials("",s),n===nu&&(i.retryFunc=async(o,a,c)=>(ZH("InfuraProvider"),!0)),i}}var Yc;class Ng extends BI{constructor(t,n,s){const i=Object.assign({},s??{},{batchMaxCount:1});M(t&&t.request,"invalid EIP-1193 provider","ethereum",t);super(n,i);H(this,Yc);R(this,Yc,async(o,a)=>{const c={method:o,params:a};this.emit("debug",{action:"sendEip1193Request",payload:c});try{const l=await t.request(c);return this.emit("debug",{action:"receiveEip1193Result",result:l}),l}catch(l){const u=new Error(l.message);throw u.code=l.code,u.data=l.data,u.payload=c,this.emit("debug",{action:"receiveEip1193Error",error:u}),u}})}async send(t,n){return await this._start(),await super.send(t,n)}async _send(t){M(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const n=await w(this,Yc).call(this,t.method,t.params||[]);return[{id:t.id,result:n}]}catch(n){return[{id:t.id,error:{code:n.code,data:n.data,message:n.message}}]}}getRpcError(t,n){switch(n=JSON.parse(JSON.stringify(n)),n.error.code||-1){case 4001:n.error.message=`ethers-user-denied: ${n.error.message}`;break;case 4200:n.error.message=`ethers-unsupported: ${n.error.message}`;break}return super.getRpcError(t,n)}async hasSigner(t){t==null&&(t=0);const n=await this.send("eth_accounts",[]);return typeof t=="number"?n.length>t:(t=t.toLowerCase(),n.filter(s=>s.toLowerCase()===t).length!==0)}async getSigner(t){if(t==null&&(t=0),!await this.hasSigner(t))try{await w(this,Yc).call(this,"eth_requestAccounts",[])}catch(n){const s=n.payload;throw this.getRpcError(s,{id:s.id,error:n})}return await super.getSigner(t)}}Yc=new WeakMap;const hc={hexStringToNumber(r){const e=r.startsWith("0x")?r.slice(2):r;return parseInt(e,16)},numberToHexString(r){return`0x${r.toString(16)}`},async getUserInfo(r){const[e,t]=await Promise.all([hc.getAddresses(r),hc.getChainId(r)]);return{chainId:t,addresses:e}},async getChainId(r){const e=await r.request({method:"eth_chainId"});return Number(e)},async getAddress(r){const[e]=await r.request({method:"eth_accounts"});return e},async getAddresses(r){return await r.request({method:"eth_accounts"})},async addEthereumChain(r,e){var n,s;const t=((n=e.rpcUrls.chainDefault)==null?void 0:n.http)||[];await r.request({method:"wallet_addEthereumChain",params:[{chainId:hc.numberToHexString(e.id),rpcUrls:[...t],chainName:e.name,nativeCurrency:{name:e.nativeCurrency.name,decimals:e.nativeCurrency.decimals,symbol:e.nativeCurrency.symbol},blockExplorerUrls:[(s=e.blockExplorers)==null?void 0:s.default.url],iconUrls:[cs.NetworkImageIds[e.id]]}]})}},ui={signMessage:async(r,e,t)=>{if(!e)throw new Error("signMessage - provider is undefined");const n=tt(r)?r:le(ds(r));return await e.request({method:"personal_sign",params:[n,t]})},estimateGas:async(r,e,t,n)=>{if(!e)throw new Error("estimateGas - provider is undefined");if(!t)throw new Error("estimateGas - address is undefined");if(r.chainNamespace&&r.chainNamespace!=="eip155")throw new Error("estimateGas - chainNamespace is not eip155");const s={from:r.address,to:r.to,data:r.data,type:0},i=new Ng(e,n);return await new uc(i,t).estimateGas(s)},sendTransaction:async(r,e,t,n)=>{if(!e)throw new Error("sendTransaction - provider is undefined");if(!t)throw new Error("sendTransaction - address is undefined");if(r.chainNamespace&&r.chainNamespace!=="eip155")throw new Error("sendTransaction - chainNamespace is not eip155");const s={to:r.to,value:r.value,gasLimit:r.gas,gasPrice:r.gasPrice,data:r.data,type:0},i=new Ng(e,n),c=await(await new uc(i,t).sendTransaction(s)).wait();return(c==null?void 0:c.hash)||null},writeContract:async(r,e,t,n)=>{if(!e)throw new Error("writeContract - provider is undefined");if(!t)throw new Error("writeContract - address is undefined");const s=new Ng(e,n),i=new uc(s,t),o=new lc(r.tokenAddress,r.abi,i);if(!o||!r.method)throw new Error("Contract method is undefined");const a=o[r.method];if(a)return await a(...r.args);throw new Error("Contract method is undefined")},getEnsAddress:async(r,e)=>{try{const t=Number(e.id);let n=null,s=!1;return ZN(r)&&(s=await My.resolveReownName(r)||!1),t===1&&(n=await new pa("mainnet").resolveName(r)),n||s||!1}catch{return!1}},getEnsAvatar:async(r,e)=>e===1&&await new pa("mainnet").getAvatar(r)||!1,parseWalletCapabilities:r=>{try{return JSON.parse(r)}catch{throw new Error("Error parsing wallet capabilities")}},parseUnits:JF,formatUnits:rC};class fq extends H_{constructor(){super({adapterType:oe.ADAPTER_TYPES.ETHERS,namespace:oe.CHAIN.EVM}),this.balancePromises={},this.providerHandlers=null}async createEthersConfig(e){if(!e.metadata)return;let t;function n(){if(t)return t;if(!(typeof window>"u")&&window.ethereum)return t=window.ethereum,t}async function s(){var o,a,c;try{const{createCoinbaseWalletSDK:l}=await Xr(async()=>{const{createCoinbaseWalletSDK:h}=await import("./index-CYlSFoUR.js");return{createCoinbaseWalletSDK:h}},__vite__mapDeps([37,4,2,3]));return typeof window>"u"?void 0:l({appName:(o=e==null?void 0:e.metadata)==null?void 0:o.name,appLogoUrl:(a=e==null?void 0:e.metadata)==null?void 0:a.icons[0],appChainIds:((c=e.networks)==null?void 0:c.map(h=>h.id))||[1,84532],preference:{options:e.coinbasePreference??"all"}}).getProvider()}catch(l){console.error("Failed to import Coinbase Wallet SDK:",l);return}}const i={metadata:e.metadata};if(e.enableInjected!==!1&&(i.injected=n()),e.enableCoinbase!==!1){const o=await s();o&&(i.coinbase=o)}return i.EIP6963=e.enableEIP6963!==!1,i}async signMessage(e){const{message:t,address:n,provider:s}=e;if(!s)throw new Error("Provider is undefined");try{return{signature:await ui.signMessage(t,s,n)}}catch{throw new Error("EthersAdapter:signMessage - Sign message failed")}}async sendTransaction(e){var n;if(!e.provider)throw new Error("Provider is undefined");return{hash:await ui.sendTransaction({value:e.value,to:e.to,data:e.data,gas:e.gas,gasPrice:e.gasPrice,address:e.address},e.provider,e.address,Number((n=e.caipNetwork)==null?void 0:n.id))}}async writeContract(e){var s;if(!e.provider)throw new Error("Provider is undefined");const{address:t}=_s.parseCaipAddress(e.caipAddress);return{hash:await ui.writeContract(e,e.provider,t,Number((s=e.caipNetwork)==null?void 0:s.id))}}async estimateGas(e){const{provider:t,caipNetwork:n,address:s}=e;if(!t)throw new Error("Provider is undefined");try{return{gas:await ui.estimateGas({data:e.data,to:e.to,address:s},t,s,Number(n==null?void 0:n.id))}}catch{throw new Error("EthersAdapter:estimateGas - Estimate gas failed")}}async getEnsAddress(e){const{name:t,caipNetwork:n}=e;return n?{address:await ui.getEnsAddress(t,n)}:{address:""}}parseUnits(e){return ui.parseUnits(e.value,e.decimals)}formatUnits(e){return ui.formatUnits(e.value,e.decimals)}async syncConnection(e){const{id:t,chainId:n}=e,s=this.connectors.find(c=>c.id===t),i=s==null?void 0:s.provider;if(!i)throw new Error("Provider not found");const o=await i.request({method:"eth_requestAccounts"}),a=await i.request({method:"eth_chainId"});if(this.listenProviderEvents(i),!o[0])throw new Error("No accounts found");if(!(s!=null&&s.type))throw new Error("Connector type not found");return{address:o[0],chainId:Number(a)||Number(n),provider:i,type:s.type,id:t}}async syncConnectors(e){var n;this.ethersConfig=await this.createEthersConfig(e),(n=this.ethersConfig)!=null&&n.EIP6963&&this.listenInjectedConnector(!0),Object.keys(this.ethersConfig||{}).filter(s=>s!=="metadata"&&s!=="EIP6963").forEach(s=>{var a,c;const i=s==="coinbase"?"coinbaseWalletSDK":s,o=s===oe.CONNECTOR_ID.INJECTED;this.namespace&&this.addConnector({id:i,explorerId:cs.ConnectorExplorerIds[i],imageUrl:(a=e==null?void 0:e.connectorImages)==null?void 0:a[i],name:cs.ConnectorNamesMap[i]||"Unknown",imageId:cs.ConnectorImageIds[i],type:cs.ConnectorTypesMap[i]??"EXTERNAL",info:o?void 0:{rdns:i},chain:this.namespace,chains:[],provider:(c=this.ethersConfig)==null?void 0:c[s]})})}setUniversalProvider(e){this.addConnector(new Fy({provider:e,caipNetworks:this.getCaipNetworks(),namespace:"eip155"}))}eip6963EventHandler(e){var t;if(e.detail){const{info:n,provider:s}=e.detail;if(!((t=this.connectors)==null?void 0:t.find(o=>o.name===(n==null?void 0:n.name)))){const o=cs.ConnectorTypesMap[oe.CONNECTOR_ID.EIP6963],a=(n==null?void 0:n.rdns)||(n==null?void 0:n.name)||(n==null?void 0:n.uuid);this.namespace&&a&&this.addConnector({id:a,type:o,imageUrl:n==null?void 0:n.icon,name:(n==null?void 0:n.name)||"Unknown",provider:s,info:n,chain:this.namespace,chains:[]})}}}listenInjectedConnector(e){if(typeof window<"u"&&e){const t=this.eip6963EventHandler.bind(this);window.addEventListener(Ye.EIP6963_ANNOUNCE_EVENT,t),window.dispatchEvent(new Event(Ye.EIP6963_REQUEST_EVENT))}}async connect({id:e,type:t,chainId:n}){var c;const s=this.connectors.find(l=>l.id===e),i=s==null?void 0:s.provider;if(!i)throw new Error("Provider not found");let o=[],a;if(t==="AUTH"){const{address:l}=await i.connect({chainId:n,preferredAccountType:(c=Ae.state.preferredAccountTypes)==null?void 0:c.eip155});o=[l],this.emit("accountChanged",{address:o[0],chainId:Number(n)})}else{if(o=await i.request({method:"eth_requestAccounts"}),a=await i.request({method:"eth_chainId"}),a!==n){const l=this.getCaipNetworks().find(u=>u.id===n);if(!l)throw new Error("EthersAdapter:connect - could not find the caipNetwork to switch");try{await this.switchNetwork({caipNetwork:l,provider:i,providerType:t})}catch{throw new Error("EthersAdapter:connect - Switch network failed")}}this.emit("accountChanged",{address:o[0],chainId:Number(n)}),this.listenProviderEvents(i)}return{address:o[0],chainId:Number(n),provider:i,type:t,id:e}}async reconnect(e){var i;const{id:t,chainId:n}=e,s=this.connectors.find(o=>o.id===t);s&&s.type==="AUTH"&&n&&await s.provider.connect({chainId:n,preferredAccountType:(i=Ae.state.preferredAccountTypes)==null?void 0:i.eip155})}async getAccounts(e){const t=this.connectors.find(i=>i.id===e.id),n=t==null?void 0:t.provider;if(!n||!t)throw new Error("Provider not found");if(e.id===oe.CONNECTOR_ID.AUTH){const i=t.provider;if(!i.user)return{accounts:[]};const{accounts:o,address:a}=i.user;return Promise.resolve({accounts:(o||[{address:a,type:"eoa"}]).map(c=>ir.createAccount("eip155",c.address,c.type))})}return{accounts:(await n.request({method:"eth_requestAccounts"})).map(i=>ir.createAccount("eip155",i,"eoa"))}}async disconnect(e){if(!e.provider||!e.providerType)throw new Error("Provider or providerType not provided");switch(e.providerType){case"WALLET_CONNECT":e.provider.session&&e.provider.disconnect();break;case"AUTH":await e.provider.disconnect();break;case"ANNOUNCED":case"EXTERNAL":await this.revokeProviderPermissions(e.provider);break;default:throw new Error("Unsupported provider type")}}async getBalance(e){const t=e.address,n=this.getCaipNetworks().find(s=>s.id===e.chainId);if(!t)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(n&&n.chainNamespace==="eip155"){const s=`${n.caipNetworkId}:${t}`,i=this.balancePromises[s];if(i)return i;const o=it.getNativeBalanceCacheForCaipAddress(s);if(o)return{balance:o.balance,symbol:o.symbol};const a=new $I(n.rpcUrls.default.http[0],{chainId:n.id,name:n.name});if(a)try{return this.balancePromises[s]=new Promise(async c=>{const l=await a.getBalance(t),u=ZF(l);it.updateNativeBalanceCache({caipAddress:s,balance:u,symbol:n.nativeCurrency.symbol,timestamp:Date.now()}),c({balance:u,symbol:n.nativeCurrency.symbol})}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"}}catch{return{balance:"0.00",symbol:"ETH"}}}return{balance:"0.00",symbol:"ETH"}}async getProfile(e){if(e.chainId===1){const t=new pa("mainnet"),n=await t.lookupAddress(e.address),s=await t.getAvatar(e.address);return{profileName:n||void 0,profileImage:s||void 0}}return{profileName:void 0,profileImage:void 0}}listenProviderEvents(e){const t=()=>{this.removeProviderListeners(e),this.emit("disconnect")},n=i=>{i.length>0?this.emit("accountChanged",{address:i[0]}):t()},s=i=>{const o=typeof i=="string"?hc.hexStringToNumber(i):Number(i);this.emit("switchNetwork",{chainId:o})};e.on("disconnect",t),e.on("accountsChanged",n),e.on("chainChanged",s),this.providerHandlers={disconnect:t,accountsChanged:n,chainChanged:s}}removeProviderListeners(e){this.providerHandlers&&(e.removeListener("disconnect",this.providerHandlers.disconnect),e.removeListener("accountsChanged",this.providerHandlers.accountsChanged),e.removeListener("chainChanged",this.providerHandlers.chainChanged),this.providerHandlers=null)}async switchNetwork(e){var i,o;const{caipNetwork:t,provider:n,providerType:s}=e;if(s==="AUTH"){await super.switchNetwork(e);return}try{await n.request({method:"wallet_switchEthereumChain",params:[{chainId:hc.numberToHexString(t.id)}]})}catch(a){if(a.code===Mi.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||a.code===Mi.ERROR_INVALID_CHAIN_ID||a.code===Mi.ERROR_CODE_DEFAULT||((o=(i=a==null?void 0:a.data)==null?void 0:i.originalError)==null?void 0:o.code)===Mi.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)await hc.addEthereumChain(n,t);else if(s==="ANNOUNCED"||s==="EXTERNAL"||s==="INJECTED")throw new Error("Chain is not supported")}}getWalletConnectProvider(){var e;return(e=this.connectors.find(t=>t.type==="WALLET_CONNECT"))==null?void 0:e.provider}async revokeProviderPermissions(e){try{(await e.request({method:"wallet_getPermissions"})).find(s=>s.parentCapability==="eth_accounts")&&await e.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]})}catch(t){console.info("Could not revoke permissions from wallet. Disconnecting...",t)}}async getCapabilities(e){var s,i;const t=je.getProvider(oe.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");const n=(i=(s=t.session)==null?void 0:s.sessionProperties)==null?void 0:i.capabilities;if(n){const a=ui.parseWalletCapabilities(n)[e];if(a)return a}return await t.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){const t=je.getProvider(oe.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){const t=je.getProvider(oe.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_revokePermissions",params:[e]})}async walletGetAssets(e){const t=je.getProvider(oe.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_getAssets",params:[e]})}}const pq="35c1db7cbde70997e97b1eed713a76f0",gq=[j_],mq={name:Iw,description:Iw,url:"https://kingsvault.io/",icons:["https://avatars.githubusercontent.com/u/205055404?s=200&v=4"]},yq=NF({adapters:[new fq],defaultNetwork:j_,networks:gq,metadata:mq,projectId:pq,features:{analytics:!1,onramp:!0,connectMethodsOrder:["wallet"],legalCheckbox:!0},defaultAccountTypes:{eip155:"eoa"},enableWalletConnect:!0,enableNetworkSwitch:!1,debug:!0});function wq({children:r}){const[e,t]=Xe.useState(!1);return Xe.useEffect(()=>{yq&&t(!0)},[]),e?r:Kn.jsx(Tg,{name:"..."})}var bq=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,xg=Math.ceil,Zr=Math.floor,wr="[BigNumber Error] ",zE=wr+"Number primitive has more than 15 significant digits: ",wn=1e14,Ce=14,VE=9007199254740991,Pg=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],hi=1e7,Sr=1e9;function LI(r){var e,t,n,s=y.prototype={constructor:y,toString:null,valueOf:null},i=new y(1),o=20,a=4,c=-7,l=21,u=-1e7,h=1e7,d=!1,f=1,p=0,m={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},v="0123456789abcdefghijklmnopqrstuvwxyz",_=!0;function y(g,b){var N,x,I,D,S,E,A,T,O=this;if(!(O instanceof y))return new y(g,b);if(b==null){if(g&&g._isBigNumber===!0){O.s=g.s,!g.c||g.e>h?O.c=O.e=null:g.e<u?O.c=[O.e=0]:(O.e=g.e,O.c=g.c.slice());return}if((E=typeof g=="number")&&g*0==0){if(O.s=1/g<0?(g=-g,-1):1,g===~~g){for(D=0,S=g;S>=10;S/=10,D++);D>h?O.c=O.e=null:(O.e=D,O.c=[g]);return}T=String(g)}else{if(!bq.test(T=String(g)))return n(O,T,E);O.s=T.charCodeAt(0)==45?(T=T.slice(1),-1):1}(D=T.indexOf("."))>-1&&(T=T.replace(".","")),(S=T.search(/e/i))>0?(D<0&&(D=S),D+=+T.slice(S+1),T=T.substring(0,S)):D<0&&(D=T.length)}else{if(lt(b,2,v.length,"Base"),b==10&&_)return O=new y(g),B(O,o+O.e+1,a);if(T=String(g),E=typeof g=="number"){if(g*0!=0)return n(O,T,E,b);if(O.s=1/g<0?(T=T.slice(1),-1):1,y.DEBUG&&T.replace(/^0\.0*|\./,"").length>15)throw Error(zE+g)}else O.s=T.charCodeAt(0)===45?(T=T.slice(1),-1):1;for(N=v.slice(0,b),D=S=0,A=T.length;S<A;S++)if(N.indexOf(x=T.charAt(S))<0){if(x=="."){if(S>D){D=A;continue}}else if(!I&&(T==T.toUpperCase()&&(T=T.toLowerCase())||T==T.toLowerCase()&&(T=T.toUpperCase()))){I=!0,S=-1,D=0;continue}return n(O,String(g),E,b)}E=!1,T=t(T,b,10,O.s),(D=T.indexOf("."))>-1?T=T.replace(".",""):D=T.length}for(S=0;T.charCodeAt(S)===48;S++);for(A=T.length;T.charCodeAt(--A)===48;);if(T=T.slice(S,++A)){if(A-=S,E&&y.DEBUG&&A>15&&(g>VE||g!==Zr(g)))throw Error(zE+O.s*g);if((D=D-S-1)>h)O.c=O.e=null;else if(D<u)O.c=[O.e=0];else{if(O.e=D,O.c=[],S=(D+1)%Ce,D<0&&(S+=Ce),S<A){for(S&&O.c.push(+T.slice(0,S)),A-=Ce;S<A;)O.c.push(+T.slice(S,S+=Ce));S=Ce-(T=T.slice(S)).length}else S-=A;for(;S--;T+="0");O.c.push(+T)}}else O.c=[O.e=0]}y.clone=LI,y.ROUND_UP=0,y.ROUND_DOWN=1,y.ROUND_CEIL=2,y.ROUND_FLOOR=3,y.ROUND_HALF_UP=4,y.ROUND_HALF_DOWN=5,y.ROUND_HALF_EVEN=6,y.ROUND_HALF_CEIL=7,y.ROUND_HALF_FLOOR=8,y.EUCLID=9,y.config=y.set=function(g){var b,N;if(g!=null)if(typeof g=="object"){if(g.hasOwnProperty(b="DECIMAL_PLACES")&&(N=g[b],lt(N,0,Sr,b),o=N),g.hasOwnProperty(b="ROUNDING_MODE")&&(N=g[b],lt(N,0,8,b),a=N),g.hasOwnProperty(b="EXPONENTIAL_AT")&&(N=g[b],N&&N.pop?(lt(N[0],-1e9,0,b),lt(N[1],0,Sr,b),c=N[0],l=N[1]):(lt(N,-1e9,Sr,b),c=-(l=N<0?-N:N))),g.hasOwnProperty(b="RANGE"))if(N=g[b],N&&N.pop)lt(N[0],-1e9,-1,b),lt(N[1],1,Sr,b),u=N[0],h=N[1];else if(lt(N,-1e9,Sr,b),N)u=-(h=N<0?-N:N);else throw Error(wr+b+" cannot be zero: "+N);if(g.hasOwnProperty(b="CRYPTO"))if(N=g[b],N===!!N)if(N)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))d=N;else throw d=!N,Error(wr+"crypto unavailable");else d=N;else throw Error(wr+b+" not true or false: "+N);if(g.hasOwnProperty(b="MODULO_MODE")&&(N=g[b],lt(N,0,9,b),f=N),g.hasOwnProperty(b="POW_PRECISION")&&(N=g[b],lt(N,0,Sr,b),p=N),g.hasOwnProperty(b="FORMAT"))if(N=g[b],typeof N=="object")m=N;else throw Error(wr+b+" not an object: "+N);if(g.hasOwnProperty(b="ALPHABET"))if(N=g[b],typeof N=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(N))_=N.slice(0,10)=="0123456789",v=N;else throw Error(wr+b+" invalid: "+N)}else throw Error(wr+"Object expected: "+g);return{DECIMAL_PLACES:o,ROUNDING_MODE:a,EXPONENTIAL_AT:[c,l],RANGE:[u,h],CRYPTO:d,MODULO_MODE:f,POW_PRECISION:p,FORMAT:m,ALPHABET:v}},y.isBigNumber=function(g){if(!g||g._isBigNumber!==!0)return!1;if(!y.DEBUG)return!0;var b,N,x=g.c,I=g.e,D=g.s;e:if({}.toString.call(x)=="[object Array]"){if((D===1||D===-1)&&I>=-1e9&&I<=Sr&&I===Zr(I)){if(x[0]===0){if(I===0&&x.length===1)return!0;break e}if(b=(I+1)%Ce,b<1&&(b+=Ce),String(x[0]).length==b){for(b=0;b<x.length;b++)if(N=x[b],N<0||N>=wn||N!==Zr(N))break e;if(N!==0)return!0}}}else if(x===null&&I===null&&(D===null||D===1||D===-1))return!0;throw Error(wr+"Invalid BigNumber: "+g)},y.maximum=y.max=function(){return U(arguments,-1)},y.minimum=y.min=function(){return U(arguments,1)},y.random=function(){var g=9007199254740992,b=Math.random()*g&2097151?function(){return Zr(Math.random()*g)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(N){var x,I,D,S,E,A=0,T=[],O=new y(i);if(N==null?N=o:lt(N,0,Sr),S=xg(N/Ce),d)if(crypto.getRandomValues){for(x=crypto.getRandomValues(new Uint32Array(S*=2));A<S;)E=x[A]*131072+(x[A+1]>>>11),E>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),x[A]=I[0],x[A+1]=I[1]):(T.push(E%1e14),A+=2);A=S/2}else if(crypto.randomBytes){for(x=crypto.randomBytes(S*=7);A<S;)E=(x[A]&31)*281474976710656+x[A+1]*1099511627776+x[A+2]*4294967296+x[A+3]*16777216+(x[A+4]<<16)+(x[A+5]<<8)+x[A+6],E>=9e15?crypto.randomBytes(7).copy(x,A):(T.push(E%1e14),A+=7);A=S/7}else throw d=!1,Error(wr+"crypto unavailable");if(!d)for(;A<S;)E=b(),E<9e15&&(T[A++]=E%1e14);for(S=T[--A],N%=Ce,S&&N&&(E=Pg[Ce-N],T[A]=Zr(S/E)*E);T[A]===0;T.pop(),A--);if(A<0)T=[D=0];else{for(D=-1;T[0]===0;T.splice(0,1),D-=Ce);for(A=1,E=T[0];E>=10;E/=10,A++);A<Ce&&(D-=Ce-A)}return O.e=D,O.c=T,O}}(),y.sum=function(){for(var g=1,b=arguments,N=new y(b[0]);g<b.length;)N=N.plus(b[g++]);return N},t=function(){var g="0123456789";function b(N,x,I,D){for(var S,E=[0],A,T=0,O=N.length;T<O;){for(A=E.length;A--;E[A]*=x);for(E[0]+=D.indexOf(N.charAt(T++)),S=0;S<E.length;S++)E[S]>I-1&&(E[S+1]==null&&(E[S+1]=0),E[S+1]+=E[S]/I|0,E[S]%=I)}return E.reverse()}return function(N,x,I,D,S){var E,A,T,O,k,j,q,z,Q=N.indexOf("."),J=o,Z=a;for(Q>=0&&(O=p,p=0,N=N.replace(".",""),z=new y(x),j=z.pow(N.length-Q),p=O,z.c=b(As(Jr(j.c),j.e,"0"),10,I,g),z.e=z.c.length),q=b(N,x,I,S?(E=v,g):(E=g,v)),T=O=q.length;q[--O]==0;q.pop());if(!q[0])return E.charAt(0);if(Q<0?--T:(j.c=q,j.e=T,j.s=D,j=e(j,z,J,Z,I),q=j.c,k=j.r,T=j.e),A=T+J+1,Q=q[A],O=I/2,k=k||A<0||q[A+1]!=null,k=Z<4?(Q!=null||k)&&(Z==0||Z==(j.s<0?3:2)):Q>O||Q==O&&(Z==4||k||Z==6&&q[A-1]&1||Z==(j.s<0?8:7)),A<1||!q[0])N=k?As(E.charAt(1),-J,E.charAt(0)):E.charAt(0);else{if(q.length=A,k)for(--I;++q[--A]>I;)q[A]=0,A||(++T,q=[1].concat(q));for(O=q.length;!q[--O];);for(Q=0,N="";Q<=O;N+=E.charAt(q[Q++]));N=As(N,T,E.charAt(0))}return N}}(),e=function(){function g(x,I,D){var S,E,A,T,O=0,k=x.length,j=I%hi,q=I/hi|0;for(x=x.slice();k--;)A=x[k]%hi,T=x[k]/hi|0,S=q*A+T*j,E=j*A+S%hi*hi+O,O=(E/D|0)+(S/hi|0)+q*T,x[k]=E%D;return O&&(x=[O].concat(x)),x}function b(x,I,D,S){var E,A;if(D!=S)A=D>S?1:-1;else for(E=A=0;E<D;E++)if(x[E]!=I[E]){A=x[E]>I[E]?1:-1;break}return A}function N(x,I,D,S){for(var E=0;D--;)x[D]-=E,E=x[D]<I[D]?1:0,x[D]=E*S+x[D]-I[D];for(;!x[0]&&x.length>1;x.splice(0,1));}return function(x,I,D,S,E){var A,T,O,k,j,q,z,Q,J,Z,te,re,pe,ge,De,xe,Se,fe=x.s==I.s?1:-1,ue=x.c,Ee=I.c;if(!ue||!ue[0]||!Ee||!Ee[0])return new y(!x.s||!I.s||(ue?Ee&&ue[0]==Ee[0]:!Ee)?NaN:ue&&ue[0]==0||!Ee?fe*0:fe/0);for(Q=new y(fe),J=Q.c=[],T=x.e-I.e,fe=D+T+1,E||(E=wn,T=Yr(x.e/Ce)-Yr(I.e/Ce),fe=fe/Ce|0),O=0;Ee[O]==(ue[O]||0);O++);if(Ee[O]>(ue[O]||0)&&T--,fe<0)J.push(1),k=!0;else{for(ge=ue.length,xe=Ee.length,O=0,fe+=2,j=Zr(E/(Ee[0]+1)),j>1&&(Ee=g(Ee,j,E),ue=g(ue,j,E),xe=Ee.length,ge=ue.length),pe=xe,Z=ue.slice(0,xe),te=Z.length;te<xe;Z[te++]=0);Se=Ee.slice(),Se=[0].concat(Se),De=Ee[0],Ee[1]>=E/2&&De++;do{if(j=0,A=b(Ee,Z,xe,te),A<0){if(re=Z[0],xe!=te&&(re=re*E+(Z[1]||0)),j=Zr(re/De),j>1)for(j>=E&&(j=E-1),q=g(Ee,j,E),z=q.length,te=Z.length;b(q,Z,z,te)==1;)j--,N(q,xe<z?Se:Ee,z,E),z=q.length,A=1;else j==0&&(A=j=1),q=Ee.slice(),z=q.length;if(z<te&&(q=[0].concat(q)),N(Z,q,te,E),te=Z.length,A==-1)for(;b(Ee,Z,xe,te)<1;)j++,N(Z,xe<te?Se:Ee,te,E),te=Z.length}else A===0&&(j++,Z=[0]);J[O++]=j,Z[0]?Z[te++]=ue[pe]||0:(Z=[ue[pe]],te=1)}while((pe++<ge||Z[0]!=null)&&fe--);k=Z[0]!=null,J[0]||J.splice(0,1)}if(E==wn){for(O=1,fe=J[0];fe>=10;fe/=10,O++);B(Q,D+(Q.e=O+T*Ce-1)+1,S,k)}else Q.e=T,Q.r=+k;return Q}}();function C(g,b,N,x){var I,D,S,E,A;if(N==null?N=a:lt(N,0,8),!g.c)return g.toString();if(I=g.c[0],S=g.e,b==null)A=Jr(g.c),A=x==1||x==2&&(S<=c||S>=l)?_d(A,S):As(A,S,"0");else if(g=B(new y(g),b,N),D=g.e,A=Jr(g.c),E=A.length,x==1||x==2&&(b<=D||D<=c)){for(;E<b;A+="0",E++);A=_d(A,D)}else if(b-=S,A=As(A,D,"0"),D+1>E){if(--b>0)for(A+=".";b--;A+="0");}else if(b+=D-E,b>0)for(D+1==E&&(A+=".");b--;A+="0");return g.s<0&&I?"-"+A:A}function U(g,b){for(var N,x,I=1,D=new y(g[0]);I<g.length;I++)x=new y(g[I]),(!x.s||(N=to(D,x))===b||N===0&&D.s===b)&&(D=x);return D}function L(g,b,N){for(var x=1,I=b.length;!b[--I];b.pop());for(I=b[0];I>=10;I/=10,x++);return(N=x+N*Ce-1)>h?g.c=g.e=null:N<u?g.c=[g.e=0]:(g.e=N,g.c=b),g}n=function(){var g=/^(-?)0([xbo])(?=\w[\w.]*$)/i,b=/^([^.]+)\.$/,N=/^\.([^.]+)$/,x=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(D,S,E,A){var T,O=E?S:S.replace(I,"");if(x.test(O))D.s=isNaN(O)?null:O<0?-1:1;else{if(!E&&(O=O.replace(g,function(k,j,q){return T=(q=q.toLowerCase())=="x"?16:q=="b"?2:8,!A||A==T?j:k}),A&&(T=A,O=O.replace(b,"$1").replace(N,"0.$1")),S!=O))return new y(O,T);if(y.DEBUG)throw Error(wr+"Not a"+(A?" base "+A:"")+" number: "+S);D.s=null}D.c=D.e=null}}();function B(g,b,N,x){var I,D,S,E,A,T,O,k=g.c,j=Pg;if(k){e:{for(I=1,E=k[0];E>=10;E/=10,I++);if(D=b-I,D<0)D+=Ce,S=b,A=k[T=0],O=Zr(A/j[I-S-1]%10);else if(T=xg((D+1)/Ce),T>=k.length)if(x){for(;k.length<=T;k.push(0));A=O=0,I=1,D%=Ce,S=D-Ce+1}else break e;else{for(A=E=k[T],I=1;E>=10;E/=10,I++);D%=Ce,S=D-Ce+I,O=S<0?0:Zr(A/j[I-S-1]%10)}if(x=x||b<0||k[T+1]!=null||(S<0?A:A%j[I-S-1]),x=N<4?(O||x)&&(N==0||N==(g.s<0?3:2)):O>5||O==5&&(N==4||x||N==6&&(D>0?S>0?A/j[I-S]:0:k[T-1])%10&1||N==(g.s<0?8:7)),b<1||!k[0])return k.length=0,x?(b-=g.e+1,k[0]=j[(Ce-b%Ce)%Ce],g.e=-b||0):k[0]=g.e=0,g;if(D==0?(k.length=T,E=1,T--):(k.length=T+1,E=j[Ce-D],k[T]=S>0?Zr(A/j[I-S]%j[S])*E:0),x)for(;;)if(T==0){for(D=1,S=k[0];S>=10;S/=10,D++);for(S=k[0]+=E,E=1;S>=10;S/=10,E++);D!=E&&(g.e++,k[0]==wn&&(k[0]=1));break}else{if(k[T]+=E,k[T]!=wn)break;k[T--]=0,E=1}for(D=k.length;k[--D]===0;k.pop());}g.e>h?g.c=g.e=null:g.e<u&&(g.c=[g.e=0])}return g}function $(g){var b,N=g.e;return N===null?g.toString():(b=Jr(g.c),b=N<=c||N>=l?_d(b,N):As(b,N,"0"),g.s<0?"-"+b:b)}return s.absoluteValue=s.abs=function(){var g=new y(this);return g.s<0&&(g.s=1),g},s.comparedTo=function(g,b){return to(this,new y(g,b))},s.decimalPlaces=s.dp=function(g,b){var N,x,I,D=this;if(g!=null)return lt(g,0,Sr),b==null?b=a:lt(b,0,8),B(new y(D),g+D.e+1,b);if(!(N=D.c))return null;if(x=((I=N.length-1)-Yr(this.e/Ce))*Ce,I=N[I])for(;I%10==0;I/=10,x--);return x<0&&(x=0),x},s.dividedBy=s.div=function(g,b){return e(this,new y(g,b),o,a)},s.dividedToIntegerBy=s.idiv=function(g,b){return e(this,new y(g,b),0,1)},s.exponentiatedBy=s.pow=function(g,b){var N,x,I,D,S,E,A,T,O,k=this;if(g=new y(g),g.c&&!g.isInteger())throw Error(wr+"Exponent not an integer: "+$(g));if(b!=null&&(b=new y(b)),E=g.e>14,!k.c||!k.c[0]||k.c[0]==1&&!k.e&&k.c.length==1||!g.c||!g.c[0])return O=new y(Math.pow(+$(k),E?g.s*(2-Ad(g)):+$(g))),b?O.mod(b):O;if(A=g.s<0,b){if(b.c?!b.c[0]:!b.s)return new y(NaN);x=!A&&k.isInteger()&&b.isInteger(),x&&(k=k.mod(b))}else{if(g.e>9&&(k.e>0||k.e<-1||(k.e==0?k.c[0]>1||E&&k.c[1]>=24e7:k.c[0]<8e13||E&&k.c[0]<=9999975e7)))return D=k.s<0&&Ad(g)?-0:0,k.e>-1&&(D=1/D),new y(A?1/D:D);p&&(D=xg(p/Ce+2))}for(E?(N=new y(.5),A&&(g.s=1),T=Ad(g)):(I=Math.abs(+$(g)),T=I%2),O=new y(i);;){if(T){if(O=O.times(k),!O.c)break;D?O.c.length>D&&(O.c.length=D):x&&(O=O.mod(b))}if(I){if(I=Zr(I/2),I===0)break;T=I%2}else if(g=g.times(N),B(g,g.e+1,1),g.e>14)T=Ad(g);else{if(I=+$(g),I===0)break;T=I%2}k=k.times(k),D?k.c&&k.c.length>D&&(k.c.length=D):x&&(k=k.mod(b))}return x?O:(A&&(O=i.div(O)),b?O.mod(b):D?B(O,p,a,S):O)},s.integerValue=function(g){var b=new y(this);return g==null?g=a:lt(g,0,8),B(b,b.e+1,g)},s.isEqualTo=s.eq=function(g,b){return to(this,new y(g,b))===0},s.isFinite=function(){return!!this.c},s.isGreaterThan=s.gt=function(g,b){return to(this,new y(g,b))>0},s.isGreaterThanOrEqualTo=s.gte=function(g,b){return(b=to(this,new y(g,b)))===1||b===0},s.isInteger=function(){return!!this.c&&Yr(this.e/Ce)>this.c.length-2},s.isLessThan=s.lt=function(g,b){return to(this,new y(g,b))<0},s.isLessThanOrEqualTo=s.lte=function(g,b){return(b=to(this,new y(g,b)))===-1||b===0},s.isNaN=function(){return!this.s},s.isNegative=function(){return this.s<0},s.isPositive=function(){return this.s>0},s.isZero=function(){return!!this.c&&this.c[0]==0},s.minus=function(g,b){var N,x,I,D,S=this,E=S.s;if(g=new y(g,b),b=g.s,!E||!b)return new y(NaN);if(E!=b)return g.s=-b,S.plus(g);var A=S.e/Ce,T=g.e/Ce,O=S.c,k=g.c;if(!A||!T){if(!O||!k)return O?(g.s=-b,g):new y(k?S:NaN);if(!O[0]||!k[0])return k[0]?(g.s=-b,g):new y(O[0]?S:a==3?-0:0)}if(A=Yr(A),T=Yr(T),O=O.slice(),E=A-T){for((D=E<0)?(E=-E,I=O):(T=A,I=k),I.reverse(),b=E;b--;I.push(0));I.reverse()}else for(x=(D=(E=O.length)<(b=k.length))?E:b,E=b=0;b<x;b++)if(O[b]!=k[b]){D=O[b]<k[b];break}if(D&&(I=O,O=k,k=I,g.s=-g.s),b=(x=k.length)-(N=O.length),b>0)for(;b--;O[N++]=0);for(b=wn-1;x>E;){if(O[--x]<k[x]){for(N=x;N&&!O[--N];O[N]=b);--O[N],O[x]+=wn}O[x]-=k[x]}for(;O[0]==0;O.splice(0,1),--T);return O[0]?L(g,O,T):(g.s=a==3?-1:1,g.c=[g.e=0],g)},s.modulo=s.mod=function(g,b){var N,x,I=this;return g=new y(g,b),!I.c||!g.s||g.c&&!g.c[0]?new y(NaN):!g.c||I.c&&!I.c[0]?new y(I):(f==9?(x=g.s,g.s=1,N=e(I,g,0,3),g.s=x,N.s*=x):N=e(I,g,0,f),g=I.minus(N.times(g)),!g.c[0]&&f==1&&(g.s=I.s),g)},s.multipliedBy=s.times=function(g,b){var N,x,I,D,S,E,A,T,O,k,j,q,z,Q,J,Z=this,te=Z.c,re=(g=new y(g,b)).c;if(!te||!re||!te[0]||!re[0])return!Z.s||!g.s||te&&!te[0]&&!re||re&&!re[0]&&!te?g.c=g.e=g.s=null:(g.s*=Z.s,!te||!re?g.c=g.e=null:(g.c=[0],g.e=0)),g;for(x=Yr(Z.e/Ce)+Yr(g.e/Ce),g.s*=Z.s,A=te.length,k=re.length,A<k&&(z=te,te=re,re=z,I=A,A=k,k=I),I=A+k,z=[];I--;z.push(0));for(Q=wn,J=hi,I=k;--I>=0;){for(N=0,j=re[I]%J,q=re[I]/J|0,S=A,D=I+S;D>I;)T=te[--S]%J,O=te[S]/J|0,E=q*T+O*j,T=j*T+E%J*J+z[D]+N,N=(T/Q|0)+(E/J|0)+q*O,z[D--]=T%Q;z[D]=N}return N?++x:z.splice(0,1),L(g,z,x)},s.negated=function(){var g=new y(this);return g.s=-g.s||null,g},s.plus=function(g,b){var N,x=this,I=x.s;if(g=new y(g,b),b=g.s,!I||!b)return new y(NaN);if(I!=b)return g.s=-b,x.minus(g);var D=x.e/Ce,S=g.e/Ce,E=x.c,A=g.c;if(!D||!S){if(!E||!A)return new y(I/0);if(!E[0]||!A[0])return A[0]?g:new y(E[0]?x:I*0)}if(D=Yr(D),S=Yr(S),E=E.slice(),I=D-S){for(I>0?(S=D,N=A):(I=-I,N=E),N.reverse();I--;N.push(0));N.reverse()}for(I=E.length,b=A.length,I-b<0&&(N=A,A=E,E=N,b=I),I=0;b;)I=(E[--b]=E[b]+A[b]+I)/wn|0,E[b]=wn===E[b]?0:E[b]%wn;return I&&(E=[I].concat(E),++S),L(g,E,S)},s.precision=s.sd=function(g,b){var N,x,I,D=this;if(g!=null&&g!==!!g)return lt(g,1,Sr),b==null?b=a:lt(b,0,8),B(new y(D),g,b);if(!(N=D.c))return null;if(I=N.length-1,x=I*Ce+1,I=N[I]){for(;I%10==0;I/=10,x--);for(I=N[0];I>=10;I/=10,x++);}return g&&D.e+1>x&&(x=D.e+1),x},s.shiftedBy=function(g){return lt(g,-9007199254740991,VE),this.times("1e"+g)},s.squareRoot=s.sqrt=function(){var g,b,N,x,I,D=this,S=D.c,E=D.s,A=D.e,T=o+4,O=new y("0.5");if(E!==1||!S||!S[0])return new y(!E||E<0&&(!S||S[0])?NaN:S?D:1/0);if(E=Math.sqrt(+$(D)),E==0||E==1/0?(b=Jr(S),(b.length+A)%2==0&&(b+="0"),E=Math.sqrt(+b),A=Yr((A+1)/2)-(A<0||A%2),E==1/0?b="5e"+A:(b=E.toExponential(),b=b.slice(0,b.indexOf("e")+1)+A),N=new y(b)):N=new y(E+""),N.c[0]){for(A=N.e,E=A+T,E<3&&(E=0);;)if(I=N,N=O.times(I.plus(e(D,I,T,1))),Jr(I.c).slice(0,E)===(b=Jr(N.c)).slice(0,E))if(N.e<A&&--E,b=b.slice(E-3,E+1),b=="9999"||!x&&b=="4999"){if(!x&&(B(I,I.e+o+2,0),I.times(I).eq(D))){N=I;break}T+=4,E+=4,x=1}else{(!+b||!+b.slice(1)&&b.charAt(0)=="5")&&(B(N,N.e+o+2,1),g=!N.times(N).eq(D));break}}return B(N,N.e+o+1,a,g)},s.toExponential=function(g,b){return g!=null&&(lt(g,0,Sr),g++),C(this,g,b,1)},s.toFixed=function(g,b){return g!=null&&(lt(g,0,Sr),g=g+this.e+1),C(this,g,b)},s.toFormat=function(g,b,N){var x,I=this;if(N==null)g!=null&&b&&typeof b=="object"?(N=b,b=null):g&&typeof g=="object"?(N=g,g=b=null):N=m;else if(typeof N!="object")throw Error(wr+"Argument not an object: "+N);if(x=I.toFixed(g,b),I.c){var D,S=x.split("."),E=+N.groupSize,A=+N.secondaryGroupSize,T=N.groupSeparator||"",O=S[0],k=S[1],j=I.s<0,q=j?O.slice(1):O,z=q.length;if(A&&(D=E,E=A,A=D,z-=D),E>0&&z>0){for(D=z%E||E,O=q.substr(0,D);D<z;D+=E)O+=T+q.substr(D,E);A>0&&(O+=T+q.slice(D)),j&&(O="-"+O)}x=k?O+(N.decimalSeparator||"")+((A=+N.fractionGroupSize)?k.replace(new RegExp("\\d{"+A+"}\\B","g"),"$&"+(N.fractionGroupSeparator||"")):k):O}return(N.prefix||"")+x+(N.suffix||"")},s.toFraction=function(g){var b,N,x,I,D,S,E,A,T,O,k,j,q=this,z=q.c;if(g!=null&&(E=new y(g),!E.isInteger()&&(E.c||E.s!==1)||E.lt(i)))throw Error(wr+"Argument "+(E.isInteger()?"out of range: ":"not an integer: ")+$(E));if(!z)return new y(q);for(b=new y(i),T=N=new y(i),x=A=new y(i),j=Jr(z),D=b.e=j.length-q.e-1,b.c[0]=Pg[(S=D%Ce)<0?Ce+S:S],g=!g||E.comparedTo(b)>0?D>0?b:T:E,S=h,h=1/0,E=new y(j),A.c[0]=0;O=e(E,b,0,1),I=N.plus(O.times(x)),I.comparedTo(g)!=1;)N=x,x=I,T=A.plus(O.times(I=T)),A=I,b=E.minus(O.times(I=b)),E=I;return I=e(g.minus(N),x,0,1),A=A.plus(I.times(T)),N=N.plus(I.times(x)),A.s=T.s=q.s,D=D*2,k=e(T,x,D,a).minus(q).abs().comparedTo(e(A,N,D,a).minus(q).abs())<1?[T,x]:[A,N],h=S,k},s.toNumber=function(){return+$(this)},s.toPrecision=function(g,b){return g!=null&&lt(g,1,Sr),C(this,g,b,2)},s.toString=function(g){var b,N=this,x=N.s,I=N.e;return I===null?x?(b="Infinity",x<0&&(b="-"+b)):b="NaN":(g==null?b=I<=c||I>=l?_d(Jr(N.c),I):As(Jr(N.c),I,"0"):g===10&&_?(N=B(new y(N),o+I+1,a),b=As(Jr(N.c),N.e,"0")):(lt(g,2,v.length,"Base"),b=t(As(Jr(N.c),I,"0"),10,g,x,!0)),x<0&&N.c[0]&&(b="-"+b)),b},s.valueOf=s.toJSON=function(){return $(this)},s._isBigNumber=!0,s[Symbol.toStringTag]="BigNumber",s[Symbol.for("nodejs.util.inspect.custom")]=s.valueOf,r!=null&&y.set(r),y}function Yr(r){var e=r|0;return r>0||r===e?e:e-1}function Jr(r){for(var e,t,n=1,s=r.length,i=r[0]+"";n<s;){for(e=r[n++]+"",t=Ce-e.length;t--;e="0"+e);i+=e}for(s=i.length;i.charCodeAt(--s)===48;);return i.slice(0,s+1||1)}function to(r,e){var t,n,s=r.c,i=e.c,o=r.s,a=e.s,c=r.e,l=e.e;if(!o||!a)return null;if(t=s&&!s[0],n=i&&!i[0],t||n)return t?n?0:-a:o;if(o!=a)return o;if(t=o<0,n=c==l,!s||!i)return n?0:!s^t?1:-1;if(!n)return c>l^t?1:-1;for(a=(c=s.length)<(l=i.length)?c:l,o=0;o<a;o++)if(s[o]!=i[o])return s[o]>i[o]^t?1:-1;return c==l?0:c>l^t?1:-1}function lt(r,e,t,n){if(r<e||r>t||r!==Zr(r))throw Error(wr+(n||"Argument")+(typeof r=="number"?r<e||r>t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(r))}function Ad(r){var e=r.c.length-1;return Yr(r.e/Ce)==e&&r.c[e]%2!=0}function _d(r,e){return(r.length>1?r.charAt(0)+"."+r.slice(1):r)+(e<0?"e":"e+")+e}function As(r,e,t){var n,s;if(e<0){for(s=t+".";++e;s+=t);r=s+r}else if(n=r.length,++e>n){for(s=t,e-=n;--e;s+=t);r+=s}else e<n&&(r=r.slice(0,e)+"."+r.slice(e));return r}var GE=LI();GE.set({DECIMAL_PLACES:18,ROUNDING_MODE:GE.ROUND_DOWN});function vq({children:r}){const[e,t]=Xe.useState(!1);return Xe.useEffect(()=>{JN.init(),t(!0)},[]),e?Kn.jsxs(Xe.Suspense,{fallback:Kn.jsx(Tg,{name:".."}),children:[Kn.jsx(GN,{rtl:!1,newestOnTop:!0,position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:!0,theme:"colored"}),Kn.jsx(aN,{store:cN,children:Kn.jsx(lN.Provider,{value:uN,children:Kn.jsx(wq,{children:Kn.jsx(oN,{children:Kn.jsx(hN,{children:r})})})})})]}):Kn.jsx(Tg,{name:".."})}const fz=Object.freeze(Object.defineProperty({__proto__:null,default:vq},Symbol.toStringTag,{value:"Module"}));export{Ye as C,R_ as E,fz as P,jr as W,bF as a,Nm as b,$d as c};
